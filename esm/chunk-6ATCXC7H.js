var TC=Object.create;var eo=Object.defineProperty,RC=Object.defineProperties,Wp=Object.getOwnPropertyDescriptor,EC=Object.getOwnPropertyDescriptors,FC=Object.getOwnPropertyNames,Ra=Object.getOwnPropertySymbols,SC=Object.getPrototypeOf,Ac=Object.prototype.hasOwnProperty,Vp=Object.prototype.propertyIsEnumerable;var Ic=(s,e,t)=>e in s?eo(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,D=(s,e)=>{for(var t in e||(e={}))Ac.call(e,t)&&Ic(s,t,e[t]);if(Ra)for(var t of Ra(e))Vp.call(e,t)&&Ic(s,t,e[t]);return s},N=(s,e)=>RC(s,EC(e)),jp=s=>eo(s,"__esModule",{value:!0});var vF=(s,e)=>{var t={};for(var i in s)Ac.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&Ra)for(var i of Ra(s))e.indexOf(i)<0&&Vp.call(s,i)&&(t[i]=s[i]);return t};var _=(s,e)=>()=>(s&&(e=s(s=0)),e);var De=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),Ne=(s,e)=>{jp(s);for(var t in e)eo(s,t,{get:e[t],enumerable:!0})},OC=(s,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of FC(e))!Ac.call(s,i)&&i!=="default"&&eo(s,i,{get:()=>e[i],enumerable:!(t=Wp(e,i))||t.enumerable});return s},Ur=s=>OC(jp(eo(s!=null?TC(SC(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s),wF=(s,e,t,i)=>{for(var r=i>1?void 0:i?Wp(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(r=(i?n(e,t,r):n(r))||r);return i&&r&&eo(e,t,r),r};var P=(s,e,t)=>(Ic(s,typeof e!="symbol"?e+"":e,t),t);var Ge=(s,e,t)=>new Promise((i,r)=>{var o=l=>{try{a(t.next(l))}catch(u){r(u)}},n=l=>{try{a(t.throw(l))}catch(u){r(u)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(o,n);a((t=t.apply(s,e)).next())});var Bi,ho,um=_(()=>{Bi={imgly_font_bernier_regular:"imgly_font_sancreek",imgly_font_cheque_regular:"imgly_font_kumar_one_outline",imgly_font_gagalin_regular:"imgly_font_permanent_marker",imgly_font_hagin_caps_thin:"imgly_font_nixie_one",imgly_font_intro_inline:"imgly_font_bungee_inline",imgly_font_nexa_script:"imgly_font_molle",imgly_font_panton_blackitalic_caps:"imgly_font_roboto_black_italic",imgly_font_panton_lightitalic_caps:"imgly_font_roboto_light_italic",imgly_font_perfograma:"imgly_font_codystar",imgly_font_panton_black_caps:"imgly_font_roboto_black",imgly_font_panton_light_caps:"imgly_font_roboto_light",imgly_font_summer_font_light:"imgly_font_sue_ellen_francisco"},ho=(s,e=!1)=>Bi[s]?(e&&console.warn(`Font ${s} was deprecated. Please use ${Bi[s]} instead.`),Bi[s]):s});var Zf=De((SI,$f)=>{var gk=typeof Element!="undefined",_k=typeof Map=="function",yk=typeof Set=="function",bk=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function $a(s,e){if(s===e)return!0;if(s&&e&&typeof s=="object"&&typeof e=="object"){if(s.constructor!==e.constructor)return!1;var t,i,r;if(Array.isArray(s)){if(t=s.length,t!=e.length)return!1;for(i=t;i--!=0;)if(!$a(s[i],e[i]))return!1;return!0}var o;if(_k&&s instanceof Map&&e instanceof Map){if(s.size!==e.size)return!1;for(o=s.entries();!(i=o.next()).done;)if(!e.has(i.value[0]))return!1;for(o=s.entries();!(i=o.next()).done;)if(!$a(i.value[1],e.get(i.value[0])))return!1;return!0}if(yk&&s instanceof Set&&e instanceof Set){if(s.size!==e.size)return!1;for(o=s.entries();!(i=o.next()).done;)if(!e.has(i.value[0]))return!1;return!0}if(bk&&ArrayBuffer.isView(s)&&ArrayBuffer.isView(e)){if(t=s.length,t!=e.length)return!1;for(i=t;i--!=0;)if(s[i]!==e[i])return!1;return!0}if(s.constructor===RegExp)return s.source===e.source&&s.flags===e.flags;if(s.valueOf!==Object.prototype.valueOf)return s.valueOf()===e.valueOf();if(s.toString!==Object.prototype.toString)return s.toString()===e.toString();if(r=Object.keys(s),t=r.length,t!==Object.keys(e).length)return!1;for(i=t;i--!=0;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;if(gk&&s instanceof Element)return!1;for(i=t;i--!=0;)if(!((r[i]==="_owner"||r[i]==="__v"||r[i]==="__o")&&s.$$typeof)&&!$a(s[r[i]],e[r[i]]))return!1;return!0}return s!==s&&e!==e}$f.exports=function(e,t){try{return $a(e,t)}catch(i){if((i.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw i}}});var ng=De((RP,og)=>{"use strict";og.exports=(s,e=1,t)=>{if(t=D({indent:" ",includeEmptyLines:!1},t),typeof s!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof s}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof t.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof t.indent}\``);if(e===0)return s;let i=t.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return s.replace(i,t.indent.repeat(e))}});var ag=De(()=>{});var mg=De((SP,cg)=>{"use strict";var lg=ag(),ug=/\s+at.*(?:\(|\s)(.*)\)?/,Ak=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,Ik=typeof lg.homedir=="undefined"?"":lg.homedir();cg.exports=(s,e)=>(e=Object.assign({pretty:!1},e),s.replace(/\\/g,"/").split(`
`).filter(t=>{let i=t.match(ug);if(i===null||!i[1])return!0;let r=i[1];return r.includes(".app/Contents/Resources/electron.asar")||r.includes(".app/Contents/Resources/default_app.asar")?!1:!Ak.test(r)}).filter(t=>t.trim()!=="").map(t=>e.pretty?t.replace(ug,(i,r)=>i.replace(r,r.replace(Ik,"~"))):t).join(`
`))});var pg=De((OP,hg)=>{"use strict";var Pk=ng(),Mk=mg(),Bk=s=>s.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),dg=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let t=e.map(i=>typeof i.stack=="string"?Bk(Mk(i.stack)):String(i)).join(`
`);t=`
`+Pk(t,4);super(t);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};hg.exports=dg});var ol=De((hm,fg)=>{"use strict";var Lk=pg();fg.exports=(r,o,...n)=>Ge(hm,[r,o,...n],function*(s,e,{concurrency:t=1/0,stopOnError:i=!0}={}){return new Promise((a,l)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(t)||t===1/0)&&t>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);let u=[],c=[],p=s[Symbol.iterator](),m=!1,d=!1,f=0,b=0,y=()=>{if(m)return;let g=p.next(),C=b;if(b++,g.done){d=!0,f===0&&(!i&&c.length!==0?l(new Lk(c)):a(u));return}f++,(()=>Ge(hm,null,function*(){try{let x=yield g.value;u[C]=yield e(x,C),f--,y()}catch(x){i?(m=!0,l(x)):(c.push(x),f--,y())}}))()};for(let g=0;g<t&&(y(),!d);g++);})})});var bt={};Ne(bt,{FragmentPrecision:()=>Ut,ImageFormat:()=>Qr,OptionType:()=>h,RenderType:()=>St,RendererType:()=>K,UniformType:()=>A});var St,Qr,h,A,K,Ut,Ot=_(()=>{St={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"},Qr={PNG:"image/png",JPEG:"image/jpeg",RAW:"raw"};(function(d){d.NUMBER="number",d.VECTOR2="vector2",d.COLOR_MATRIX="color-matrix",d.COLOR="color",d.ARRAY="array",d.OBJECT="object",d.STRING="string",d.BOOLEAN="boolean",d.CONFIGURABLE="configurable",d.IMAGE="image",d.FUNCTION="function",d.TEXTURE="texture",d.ALL="*"})(h||(h={}));(function(b){b.SAMPLER2D="sampler2d",b.INT="i",b.INT1="1i",b.INT2="2i",b.INT3="3i",b.INT4="4i",b.FLOAT="f",b.FLOAT1="1f",b.FLOAT2="2f",b.FLOAT_VECTOR2="2fv",b.FLOAT3="3f",b.FLOAT4="4f",b.MAT3="mat3",b.MAT3FV="mat3fv",b.MAT4="mat4"})(A||(A={}));(function(t){t.WEBGL="webgl",t.CANVAS="canvas"})(K||(K={}));(function(i){i.High="highp",i.Medium="mediump",i.Low="lowp"})(Ut||(Ut={}))});var In,Eg,Fg=_(()=>{In=()=>document.createElement("canvas"),Eg=(s,e)=>{let t=e||In();t.width=s.width,t.height=s.height;let i=t.getContext("2d");if(!i)throw new Error("Cannot render context");return i.clearRect(0,0,t.width,t.height),i.drawImage(s,0,0,s.width,s.height),t}});var fo,Dm=_(()=>{fo=class{constructor(e,t,i){this.width=e;this.height=t;this.data=i}}});var Sg={};Ne(Sg,{glGet:()=>cl,webUtils:()=>Qk});var cl,Jk,$k,Zk,Qk,Og=_(()=>{Fg();Dm();cl=s=>{let e={preserveDrawingBuffer:!0};return s.getContext("webgl",e)||s.getContext("experimental-webgl",e)},Jk=()=>{let s=cl(In()),e=s.getParameter(s.MAX_TEXTURE_SIZE),t=s.getExtension("WEBGL_lose_context");return t&&t.loseContext(),e},$k=(s,e)=>{if(e instanceof fo)s.texImage2D(s.TEXTURE_2D,0,s.RGBA,e.width,e.height,0,s.RGBA,s.UNSIGNED_BYTE,e.data);else{let t=Eg(e);s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t)}},Zk=s=>Boolean(s.tagName&&s.tagName.toUpperCase()==="IMG"),Qk={isSupported:()=>Boolean(cl(In())),isCanvas:s=>s.constructor.name==="Canvas"||Boolean(s.tagName&&s.tagName.toUpperCase()==="CANVAS"),isImage:Zk,Image:typeof window!="undefined"?window.Image:void 0,glMaxTexture:Jk,glGet:cl,createCanvas:In,glResize(s,e){return s},glTexImage:$k}});var Ag,$e,go,km,Ig,di=_(()=>{Ot();Ag=(Og(),Sg).webUtils;$e=Ag,go=s=>s._type===K.WEBGL,km=s=>Boolean(s&&"tagName"in s&&s.tagName&&s.tagName.toUpperCase()==="CANVAS"),Ig=s=>Boolean("tagName"in s&&s.tagName.toUpperCase()==="IMG")});var ml,Pg,Mg=_(()=>{ml=class{static head(e){return e[0]}static tail(e){return e.slice(1)}static last(e){return e[e.length-1]}static init(e){return e.slice(0,e.length-1)}static remove(e,t){return e.filter((i,r,o)=>!t(i,r,o))}static findIndex(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return i;return-1}static find(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return e[i]}static flatten(e){return e.reduce(function(t,i){return t.concat(Array.isArray(i)?ml.flatten(i):i)},[])}static range(e,t){let i=[];if(t>e)for(let r=e;r<t;r++)i.push(r);return i}static repeat(e,t){let i=[];for(let r=0;r<t;r++)i[r]=e;return i}static zip(e,t){let i=Math.min(e.length,t.length),r=[];for(let o=0;o<i;o++)r[o]=[e[o],t[o]];return r}},Pg=ml});var fr,eT,ti,_o=_(()=>{fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",eT={encode(s){let e="",t,i,r,o,n,a,l,u=0;do t=s[u++],i=s[u++],r=s[u++],o=t>>2,n=(t&3)<<4|i>>4,a=(i&15)<<2|r>>6,l=r&63,isNaN(i)?a=l=64:isNaN(r)&&(l=64),e=e+fr.charAt(o)+fr.charAt(n)+fr.charAt(a)+fr.charAt(l),t=i=r="",o=n=a=l="";while(u<s.length);return e},decode(s){let e,t,i,r,o,n,a,l=0,u=[];if(/[^A-Za-z0-9+/=]/g.exec(s))throw new Error(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`);s=s.replace(/[^A-Za-z0-9+/=]/g,"");do r=fr.indexOf(s.charAt(l++)),o=fr.indexOf(s.charAt(l++)),n=fr.indexOf(s.charAt(l++)),a=fr.indexOf(s.charAt(l++)),e=r<<2|o>>4,t=(o&15)<<4|n>>2,i=(n&3)<<6|a,u.push(e),n!==64&&u.push(t),a!==64&&u.push(i),e=t=i="",r=o=n=a="";while(l<s.length);return u}},ti=eT});var es,Tm,E,hi=_(()=>{di();Mg();_o();es=class{static mapRange(e,t,i){return(e-t.getMin())*i.getLength()/t.getLength()+i.getMin()}static isPlainObject(e){if(typeof e!="object"||!e)return!1;if(typeof Object.getPrototypeOf=="function"){let t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}return Object.prototype.toString.call(e)==="[object Object]"}static isMobile(){if(typeof navigator=="undefined")return!1;let e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}static isBrowser(){return typeof window!="undefined"}static values(e){let t=[];for(let i in e)t.push(e[i]);return t}static generateUUID(){let e=new Date().getTime();return typeof window.performance!="undefined"&&typeof window.performance.now=="function"&&(e+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let i=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t==="x"?i:i&3|8).toString(16)})}static resizeVectorToFit(e,t){let i=Math.min(t.x/e.x,t.y/e.y);return e.clone().multiply(i)}static resizeVectorToFill(e,t){let i=e.x/e.y,r=t.x/t.y;return i>r?t.clone().set(t.y*i,t.y):t.clone().set(t.x,t.x/i)}static isExtendable(e){return typeof e!="undefined"&&e!==null&&(typeof e=="object"||typeof e=="function")}static defaults(e,...t){let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){let o=t[r];for(let n in o)typeof i[n]=="undefined"&&(i[n]=o[n])}return i}static deepMerge(e,...t){let i=(r,o)=>{if(o===void 0)return i(null,r);if(Array.isArray(o))return[...o];if(!es.isPlainObject(o))return o;if(!es.isPlainObject(r))return D({},o);let n=D({},r);return Object.keys(o).forEach(a=>{let l=o[a];l!==void 0&&(n[a]=i(r[a],l))}),n};return t.reduce(i,e)}static deepDefaults(e,...t){let i=[...t].reverse();return es.deepMerge(...i,e)}static deepClone(e){let t={};for(let i in e)es.isExtendable(e[i])?t[i]=es.deepClone(e[i]):t[i]=e[i];return t}static extend(e,...t){let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){let o=t[r];for(let n in o)i[n]=o[n]}return i}static clone(e){return this.extend({},e)}static getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}static createCanvas(){return $e.createCanvas()}static isPowerOfTwo(e){return(e.x&e.x-1)==0&&(e.y&e.y-1)==0}static nextLowestPOT(e){for(let t=1;t<32;t<<=1)e|=e>>t;return e-(e>>1)}static nextHighestPOT(e){e--;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}static moveArrayItem(e,t,i){if(i>=e.length){let r=i-e.length;for(;r--+1;)e.push(void 0)}e.splice(i,0,e.splice(t,1)[0])}static ensureCanvasDimensions(e,t){return e.width!==t.x||e.height!==t.y?(e.width=t.x,e.height=t.y,!0):!1}static byteArrayToString(e){return e.map(t=>String.fromCharCode(t)).join("")}static clamp(e,t,i){return Math.max(t,Math.min(e,i))}static wildCardMatch(e,t){return new RegExp(`^${t.split("*").join(".*")}$`).test(e)}static flipObject(e){let t={};for(let i in e)t[e[i]]=i;return t}static ISODateString(e){function t(i){return i<10?`0${i}`:i}return`${e.getUTCFullYear()}-${t(e.getUTCMonth()+1)}-${t(e.getUTCDate())}T${t(e.getUTCHours())}:${t(e.getUTCMinutes())}:${t(e.getUTCSeconds())}Z`}static getCrossOriginValue(e){if(!e)return"anonymous";if(e!=="none")return e}static invariant(e,t){if(!e)throw new Error(t)}static executePromises(e){let t=e.length,i=0,r=[],o=[];return new Promise((n,a)=>{let l=()=>{i++,i>=t&&(o.length<=0?n(r):a(o))},u=p=>{r.push(p),l()},c=p=>{o.push(p),l()};e.forEach(p=>{p.then(u).catch(c)})})}},Tm=es;P(Tm,"Array",Pg);E=Tm});var tT,Bg,iT,rT,Lg,Rm,B,ii=_(()=>{hi();tT=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}],Bg=()=>console&&console.group&&console.groupCollapsed&&console.groupEnd,iT=()=>typeof navigator!="undefined"&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/),rT=(s,e)=>["background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0",`background: ${s}; color: ${e}; line-height: 20px; padding: 4px 0; font-weight: bold`,"background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0"],Lg=class{constructor(e="warn",t=tT){this._levels=[...t],this._maxLevel=this.getLevelIndexByName(e),this._consoleFuncs={trace:(...i)=>{Bg()?(console.groupCollapsed(...i),console.trace(),console.groupEnd()):console.trace(...i)}},this._levels.forEach(({name:i})=>{this[i]=(r,...o)=>{this._log(i,r,...o)}})}getLevelIndexByName(e){return E.Array.findIndex(this._levels,t=>t.name===e)}getLevelObjectByName(e){return E.Array.find(this._levels,t=>t.name===e)}canLog(e){let t=this.getLevelIndexByName(e);return t<0?!1:t>=this._maxLevel}setLevel(e){let t=this.getLevelIndexByName(e);t<0||(this._maxLevel=t)}_log(e,t,...i){let r=this.getLevelObjectByName(e);if(!r||!this.canLog(e))return;let{name:o,type:n,background:a,color:l}=r,u=i.filter(d=>d!==void 0).map(d=>d.toObject?JSON.parse(JSON.stringify(d.toObject())):d),c=this._consoleFuncs[n]||console[n]?(...d)=>console[n](...d):(...d)=>console.log(...d),p=u.length,m=rT(a,l);if(!iT()){let d=u.length;if(d<=0){c(`PhotoEditorSDK | ${t} `);return}if(d===1&&typeof u[0]=="string"){c(`PhotoEditorSDK | ${t} | ${u[0]}`);return}c(`PhotoEditorSDK | ${t} | `,...u);return}if(p<=0){c(`%c  %c PhotoEditorSDK %c  %c ${t} %c %c  `,...m);return}if(p===1&&typeof u[0]=="string"){c(`%c  %c PhotoEditorSDK %c  %c ${t} %c  ${u[0]}  %c  `,...m);return}Bg()?(console.groupCollapsed(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...E.Array.init(m)),c(...u),console.groupEnd()):c(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...E.Array.init(m),...u)}image(e="",t){{let i=new window.Image,r=()=>{let{width:o}=i,{height:n}=i;e&&console.log(e),console.log("%c+",`
        font-size: 1px;
        padding: 0px ${Math.floor(o/2)}px;
        line-height: ${n}px;
        background: url(${i.src});
        color: transparent;
        background-repeat: no-repeat;
        background-size: ${o}px ${n}px;`)};return i.onload=r,t instanceof window.HTMLCanvasElement?i.src=t.toDataURL():t instanceof window.Image?(i=t,r()):typeof t=="string"?i.src=t:this.log(e,t),i}}texture(e="",t){{if(!t){this.log(e,"texture: null or undefined");return}let i=t.getBaseTexture(),r=i.getRenderers(),o=E.Array.find(r,l=>l&&l.constructor.type==="webgl"),{width:n,height:a}=i.getFrame();if(o){let l=o.getContext(),u=i.getGLTextureForRenderer(o);this.logGlTexture(l,u,n,a,e)}else Rm.image(e,i.getSource())}}logGlTexture(e,t,i=150,r=150,o){{e.bindTexture(e.TEXTURE_2D,t);let n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);let a=new Uint8Array(i*r*4);e.readPixels(0,0,i,r,e.RGBA,e.UNSIGNED_BYTE,a),e.deleteFramebuffer(n);let l=document.createElement("canvas");l.width=i,l.height=r;let u=l.getContext("2d"),c=u.createImageData(i,r);return c.data.set(a),u.putImageData(c,0,0),Rm.image(o,l)}}},Rm=new Lg("warn"),B=Rm});var mt,yo=_(()=>{mt={load(s,e={cors:!0,value:"anonymous"}){return(()=>Promise.resolve([s,s]))().then(([i,r])=>this._createAndLoadImage(i,r,e))},loadImage(s,e={cors:!0,value:"anonymous"}){return this._loadWithoutExif(s,e)},_loadWithoutExif(s,e={cors:!0,value:"anonymous"}){return new Promise((t,i)=>{let r=new window.Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${s}`))}),e.cors&&(r.crossOrigin=e.value),r.src=s})},_createAndLoadImage(s,e,t={cors:!0,value:"anonymous"}){return new Promise((i,r)=>{{let o=this._loadWithoutExif(e,t).then(a=>i(a)),n=new Promise((a,l)=>{this._loadAsDataURL(e,t).then(u=>{let c=new window.Image;c.addEventListener("load",()=>{a(c)}),c.src=u,c.rawSource=u}).catch(u=>{o.then(c=>a(c))})});return this._stringEndsWith(e,".svg")?o.then(a=>i(a)):n.then(a=>i(a))}})},_stringEndsWith(s,e,t=s.length){return(t===void 0||t>s.length)&&(t=s.length),s.substring(t-e.length,t)===e},_loadAsDataURL(s,e={cors:!0,value:"anonymous"}){return new Promise((t,i)=>{let r=new XMLHttpRequest;r.onload=function(){let o=new FileReader;o.onloadend=function(){o.error&&i(o.error),t(o.result)},o.readAsDataURL(r.response)},r.open("GET",s),r.responseType="blob",r.withCredentials=e.cors&&e.value==="use-credentials",r.send()})},loadXHR(s,e){return new Promise((t,i)=>{let r;window.XDomainRequest?(r=new window.XDomainRequest,e&&r.overrideMimeType(e),r.onload=function(){t(r)},r.onerror=function(o){i(o)}):window.XMLHttpRequest&&(r=new window.XMLHttpRequest,e&&r.overrideMimeType(e),r.onreadystatechange=function(o){r.readyState===4&&(r.status===200?t(r):i(new Error(`HTTP Status ${r.status}`)))}),r.open("GET",s,!0),r.send()})}}});var Ng=De((nL,zg)=>{"use strict";function sT(s,e){return Object.prototype.hasOwnProperty.call(s,e)}zg.exports=function(s,e,t,i){e=e||"&",t=t||"=";var r={};if(typeof s!="string"||s.length===0)return r;var o=/\+/g;s=s.split(e);var n=1e3;i&&typeof i.maxKeys=="number"&&(n=i.maxKeys);var a=s.length;n>0&&a>n&&(a=n);for(var l=0;l<a;++l){var u=s[l].replace(o,"%20"),c=u.indexOf(t),p,m,d,f;c>=0?(p=u.substr(0,c),m=u.substr(c+1)):(p=u,m=""),d=decodeURIComponent(p),f=decodeURIComponent(m),sT(r,d)?Array.isArray(r[d])?r[d].push(f):r[d]=[r[d],f]:r[d]=f}return r}});var Gg=De((aL,Ug)=>{"use strict";var Pn=function(s){switch(typeof s){case"string":return s;case"boolean":return s?"true":"false";case"number":return isFinite(s)?s:"";default:return""}};Ug.exports=function(s,e,t,i){return e=e||"&",t=t||"=",s===null&&(s=void 0),typeof s=="object"?Object.keys(s).map(function(r){var o=encodeURIComponent(Pn(r))+t;return Array.isArray(s[r])?s[r].map(function(n){return o+encodeURIComponent(Pn(n))}).join(e):o+encodeURIComponent(Pn(s[r]))}).join(e):i?encodeURIComponent(Pn(i))+t+encodeURIComponent(Pn(s)):""}});var Wg=De(Mn=>{"use strict";Mn.decode=Mn.parse=Ng();Mn.encode=Mn.stringify=Gg()});function Bn(s){typeof s=="string"&&(s=xo(s));var e=function(t,i,r){var o=t.auth,n=t.hostname,a=t.protocol||"",l=t.pathname||"",u=t.hash||"",c=t.query||"",p=!1;o=o?encodeURIComponent(o).replace(/%3A/i,":")+"@":"",t.host?p=o+t.host:n&&(p=o+(~n.indexOf(":")?"["+n+"]":n),t.port&&(p+=":"+t.port)),c&&typeof c=="object"&&(c=i.encode(c));var m=t.search||c&&"?"+c||"";return a&&a.substr(-1)!==":"&&(a+=":"),t.slashes||(!a||r.test(a))&&p!==!1?(p="//"+(p||""),l&&l[0]!=="/"&&(l="/"+l)):p||(p=""),u&&u[0]!=="#"&&(u="#"+u),m&&m[0]!=="?"&&(m="?"+m),{protocol:a,host:p,pathname:l=l.replace(/[?#]/g,encodeURIComponent),search:m=m.replace("#","%23"),hash:u}}(s,Em.default,oT);return""+e.protocol+e.host+e.pathname+e.search+e.hash}function Vg(s,e){var t=typeof s=="string"?xo(s):s;s=typeof s=="object"?Bn(s):s;var i=xo(e),r="";t.protocol&&!t.slashes&&(r=t.protocol,s=s.replace(t.protocol,""),r+=e[0]==="/"||s[0]==="/"?"/":""),r&&i.protocol&&(r="",i.slashes||(r=i.protocol,e=e.replace(i.protocol,"")));var o=s.match(nT);o&&!i.protocol&&(s=s.substr((r=o[1]+(o[2]||"")).length),/^\/\/[^/]/.test(e)&&(r=r.slice(0,-1)));var n=new URL(s,Om+"/"),a=new URL(e,n).toString().replace(Om,""),l=i.protocol||t.protocol;return l+=t.slashes||i.slashes?"//":"",!r&&l?a=a.replace(Fm,l):r&&(a=a.replace(Fm,"")),aT.test(a)||~e.indexOf(".")||s.slice(-1)==="/"||e.slice(-1)==="/"||a.slice(-1)!=="/"||(a=a.slice(0,-1)),r&&(a=r+(a[0]==="/"?a.substr(1):a)),a}function bo(){}function xo(s,e,t){if(e===void 0&&(e=!1),t===void 0&&(t=!1),s&&typeof s=="object"&&s instanceof bo)return s;var i=(s=s.trim()).match(lT);s=i?i[1].replace(/\\/g,"/")+i[2]:s.replace(/\\/g,"/"),mT.test(s)&&s.slice(-1)!=="/"&&(s+="/");var r=!/(^javascript)/.test(s)&&s.match(uT),o=cT.test(s),n="";r&&(Am.test(r[1])||(n=r[1].toLowerCase(),s=""+r[2]+r[3]),r[2]||(o=!1,Am.test(r[1])?(n=r[1],s=""+r[3]):s="//"+r[3]),r[2].length!==3&&r[2].length!==1||(n=r[1],s="/"+r[3]));var a,l=(i?i[1]:s).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),u=l&&l[1],c=new bo,p="",m="";try{a=new URL(s)}catch(b){p=b,n||t||!/^\/\//.test(s)||/^\/\/.+[@.]/.test(s)||(m="/",s=s.substr(1));try{a=new URL(s,Om)}catch(y){return c.protocol=n,c.href=n,c}}c.slashes=o&&!m,c.host=a.host===Sm?"":a.host,c.hostname=a.hostname===Sm?"":a.hostname.replace(/(\[|\])/g,""),c.protocol=p?n||null:a.protocol,c.search=a.search.replace(/\\/g,"%5C"),c.hash=a.hash.replace(/\\/g,"%5C");var d=s.split("#");!c.search&&~d[0].indexOf("?")&&(c.search="?"),c.hash||d[1]!==""||(c.hash="#"),c.query=e?Em.default.decode(a.search.substr(1)):c.search.substr(1),c.pathname=m+(r?function(b){return b.replace(/['^|`]/g,function(y){return"%"+y.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(y,g){try{return decodeURIComponent(g).split("").map(function(C){var x=C.charCodeAt();return x>256||/^[a-z0-9]$/i.test(C)?C:"%"+x.toString(16).toUpperCase()}).join("")}catch(C){return g}})}(a.pathname):a.pathname),c.protocol==="about:"&&c.pathname==="blank"&&(c.protocol="",c.pathname=""),p&&s[0]!=="/"&&(c.pathname=c.pathname.substr(1)),n&&!Am.test(n)&&s.slice(-1)!=="/"&&c.pathname==="/"&&(c.pathname=""),c.path=c.pathname+c.search,c.auth=[a.username,a.password].map(decodeURIComponent).filter(Boolean).join(":"),c.port=a.port,u&&!c.host.endsWith(u)&&(c.host+=u,c.port=u.slice(1)),c.href=m?""+c.pathname+c.search+c.hash:Bn(c);var f=/^(file)/.test(c.href)?["host","hostname"]:[];return Object.keys(c).forEach(function(b){~f.indexOf(b)||(c[b]=c[b]||null)}),c}var Em,oT,Fm,Sm,Om,nT,aT,Am,lT,uT,cT,mT,jg=_(()=>{Em=Ur(Wg()),oT=/https?|ftp|gopher|file/;Fm="http://",Sm="w.w",Om=Fm+Sm,nT=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,aT=/https?|ftp|gopher|file/;bo.prototype.parse=xo,bo.prototype.format=Bn,bo.prototype.resolve=Vg,bo.prototype.resolveObject=Vg;Am=/^https?|ftp|gopher|file/,lT=/^(.*?)([#?].*)/,uT=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,cT=/^([a-z0-9.+-]*:)?\/\/\/*/i,mT=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i});var dT,Ln,Gt,vo=_(()=>{jg();dT=5e3,Ln=typeof window!="undefined"?window:global,Gt=class{constructor(e){this._url=e,this._parsedUrl=xo(this._url,!0)}_isJSONPRequest(){let{query:e}=this._parsedUrl;for(let t in e)if(e[t]==="?")return!0;return!1}load(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()}_loadJSON(){return new Promise((e,t)=>{let i;Ln.XDomainRequest?(i=new Ln.XDomainRequest,i.onload=function(){let r=JSON.parse(i.responseText);e(r)},i.onerror=function(r){t(r)},i.open("GET",this._url,!0),i.send()):Ln.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(r){if(i.readyState===4)if(i.status===200){let o=JSON.parse(i.responseText);e(o)}else t(new Error(`HTTP Status ${i.status}`))},i.open("GET",this._url,!0),i.send())})}_loadJSONP(){let e=!1,t=!1,i=`pesdk${Math.round(Math.random()*99999999999999)}`;return new Promise((r,o)=>{let n=this._createJSONPNode(i);Ln[i]=a=>{this._removeJSONPNode(n),e||(t=!0,r(a))},Ln.setTimeout(()=>{t||(this._removeJSONPNode(n),e=!0,o(new Error("Timeout of 5 seconds exceeded.")))},dT)})}_createJSONPNode(e){let t=this._buildJSONPUrl(e),i=document.querySelector("head"),r=document.createElement("script");return r.src=t,i.appendChild(r),r}_removeJSONPNode(e){e.parentNode.removeChild(e)}_buildJSONPUrl(e){let{query:t}=this._parsedUrl,i=null;for(let r in t)if(t[r]==="?"){i=r;break}return delete this._parsedUrl.search,t[i]=e,Bn(this._parsedUrl)}}});var Im={};Ne(Im,{ImageLoader:()=>mt,JSONLoader:()=>Gt});var Hg=_(()=>{yo();vo()});var xt,S,wo=_(()=>{xt=class{constructor(e,t,i,r=1){this.r=e,this.g=t,this.b=i,this.a=r}toRGBA(){return`rgba(${[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a.toFixed(2)].join(",")})`}set(e,t,i,r=this.a){return this.r=e,this.g=t,this.b=i,this.a=r,this}toRGB(){return[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)]}toHex(){return`#${[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))].join("")}`}toGLColor(){return[this.r,this.g,this.b,this.a]}toArray(){return this.toGLColor()}toRGBGLColor(){return[this.r,this.g,this.b]}toHSV(){let e=Math.max(this.r,this.g,this.b),t=Math.min(this.r,this.g,this.b),i,r,o=e,n=e-t;if(r=e===0?0:n/e,e===t)i=0;else{switch(e){case this.r:i=(this.g-this.b)/n,this.g<this.b&&(i+=6);break;case this.g:i=(this.b-this.r)/n+2;break;case this.b:i=(this.r-this.g)/n+4;break}i/=6}return[i,r,o]}fromHSV(e,t,i){return this.copy(xt.fromHSV(e,t,i)),this}static fromHSV(e,t,i,r=1){let[o,n,a]=[],l=Math.floor(e*6),u=e*6-l,c=i*(1-t),p=i*(1-u*t),m=i*(1-(1-u)*t);switch(l%6){case 0:o=i,n=m,a=c;break;case 1:o=p,n=i,a=c;break;case 2:o=c,n=i,a=m;break;case 3:o=c,n=p,a=i;break;case 4:o=m,n=c,a=i;break;case 5:o=i,n=c,a=p;break}return new xt(o,n,a,r)}static fromArray(e){return new xt(e[0],e[1],e[2],e[3])}static fromHex(e){let[t,i,r]=e.match(/[0-9A-fa-f]{1,2}/g);return new xt(parseInt(t,16)/255,parseInt(i,16)/255,parseInt(r,16)/255,1)}clone(){return new xt(this.r,this.g,this.b,this.a)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}minus(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this.a-=e.a,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}divideScalar(e){return this.r/=e,this.g/=e,this.b/=e,this.a/=e,this}clamp(e,t){return this.r=Math.min(Math.max(this.r,e),t),this.g=Math.min(Math.max(this.g,e),t),this.b=Math.min(Math.max(this.b,e),t),this.a=Math.min(Math.max(this.a,e),t),this}mix(e,t){return this.r=(1-t)*this.r+t*e.r,this.g=(1-t)*this.g+t*e.g,this.b=(1-t)*this.b+t*e.b,this.a=(1-t)*this.a+t*e.a,this}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}_componentToHex(e){let t=e.toString(16);return t.length===1?`0${t}`:t}toString(){return`Color(${this.r}, ${this.g}, ${this.b}, ${this.a})`}static get TRANSPARENT(){return new xt(0,0,0,0)}static get WHITE(){return new xt(1,1,1,1)}static get BLACK(){return new xt(0,0,0,1)}static get RED(){return new xt(1,0,0,1)}static get BLUE(){return new xt(0,0,1,1)}static get GREEN(){return new xt(0,1,0,1)}},S=xt});var hT,qg,dt,Co=_(()=>{ii();hT=12,qg=class{constructor(){this._maxListeners=hT,this._events={},this._pipeDestinations=[]}pipeEvents(e){this._pipeDestinations.push(e)}unpipeEvents(e){let t=this._pipeDestinations.indexOf(e);t!==-1&&this._pipeDestinations.splice(t,1)}on(e,t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);if(typeof t!="function")throw new TypeError;let i=this._events[e]||(this._events[e]=[]);return i.indexOf(t)!==-1?this:(i.push(t),this._maxListeners&&i.length>this._maxListeners&&(B.warn("EventEmitter",`Possible memory leak detected, added ${i.length} \`${e}\` listeners (current limit is ${this._maxListeners})`),typeof console!="undefined"&&console.trace()),this)}once(e,t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);let i=this;function r(){i.off(e,r),t.apply(null,arguments)}return this.on(e,r)}off(e,...t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);if(t.length===0)return this._events[e]=null,this;let i=t[0];if(typeof i!="function")throw new TypeError;let r=this._events[e];if(!r||!r.length)return this;let o=r.indexOf(i);return o===-1?this:(r.splice(o,1),this)}emit(e,...t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);this._pipeDestinations.forEach(r=>{r.emit(e,...t)});let i=this._events[e];return!i||!i.length?!1:(i.slice(0).forEach(r=>r.apply(null,t)),!0)}setMaxListeners(e){if(parseInt(e,10)!==e)throw new TypeError;this._maxListeners=e}},dt=qg});var ts,Pm=_(()=>{ii();ts={checkFramebufferStatus(s,e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER),i={[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Incomplete attachment",[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"Missing attachment",[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]:"Incomplete dimensions",[e.FRAMEBUFFER_UNSUPPORTED]:"Framebuffer unsupported"};t!==e.FRAMEBUFFER_COMPLETE&&B.warn(s,`Framebuffer incomplete: ${i[t]}`)},determineGPUName(s){let e=null,t=null;s||(t=document.createElement("canvas"),s=t.getContext("experimental-webgl")||t.getContext("webgl"));let i=s&&s.getExtension("WEBGL_debug_renderer_info");return i&&(e=s.getParameter(i.UNMASKED_RENDERER_WEBGL),t&&t.remove()),e},isGPUBlacklisted(s,e=null){return!1}}});var dl,Kg=_(()=>{dl=s=>typeof s=="number"});var pT,is,hl,z,Ni=_(()=>{Kg();pT=s=>s instanceof z,is=(s,e)=>pT(s)?{x:s.x,y:s.y}:{x:s,y:dl(e)?e:s},hl=(s,e)=>(t,i)=>{let{x:r,y:o}=is(t,i);return s.x=e(s.x,r),s.y=e(s.y,o),s},z=class{constructor(e=0,t=0){this.add=hl(this,(e,t)=>e+t);this.subtract=hl(this,(e,t)=>e-t);this.divide=hl(this,(e,t)=>e/t);this.multiply=hl(this,(e,t)=>e*t);this.x=e,this.y=t}set(e,t){let{x:i,y:r}=is(e,t);return this.x=i,this.y=r,this}clone(){return new z(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}clamp(e,t){return dl(e)&&(e=new z(e,e)),dl(t)&&(t=new z(t,t)),e&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y)),t&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y)),this}dot(e,t){let{x:i,y:r}=is(e,t);return this.x*i+this.y*r}equals(e,t){let{x:i,y:r}=is(e,t);return i===this.x&&r===this.y}flip(){let e=this.x;return this.x=this.y,this.y=e,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}floor(){return this.x|=0,this.y|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toString(){return`Vector2({ x: ${this.x}, y: ${this.y} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this}asArray(e=!1){return e?[this.y,this.x]:[this.x,this.y]}static fromObject(e){return new z(e.x,e.y)}static get NULL(){return new z(0,0)}}});var vt,Mm=_(()=>{Ni();vt=class{constructor(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;this.reset()}multiply(e){let t,i,r,o,n,a;return t=this.a*e.a+this.b*e.c,i=this.a*e.b+this.b*e.d,r=this.c*e.a+this.d*e.c,o=this.c*e.b+this.d*e.d,n=this.tx*e.a+this.ty*e.c+e.tx,a=this.tx*e.b+this.ty*e.d+e.ty,this.a=t,this.b=i,this.c=r,this.d=o,this.tx=n,this.ty=a,this}applyToVector(e){let{x:t,y:i}=e;return e=e.clone(),e.x=this.a*t+this.c*i+this.tx,e.y=this.b*t+this.d*i+this.tx,e}applyInverseToVector(e){let t=1/(this.a*this.d+this.c*-this.b),{x:i,y:r}=e;return e=e.clone(),e.x=this.d*t*i+-this.c*t*r+(this.ty*this.c-this.tx*this.d)*t,e.y=this.a*t*r+-this.b*t*i+(-this.ty*this.a+this.tx*this.b)*t,e}rectangleToCoordinates(e,t=new z(0,0)){let i=e.width*(1-t.x),r=e.width*-t.x,o=e.height*(1-t.y),n=e.height*-t.y,a=[];return a.push(new z(this.a*r+this.c*n+this.tx,this.d*n+this.b*r+this.ty)),a.push(new z(this.a*i+this.c*n+this.tx,this.d*n+this.b*i+this.ty)),a.push(new z(this.a*i+this.c*o+this.tx,this.d*o+this.b*i+this.ty)),a.push(new z(this.a*r+this.c*o+this.tx,this.d*o+this.b*r+this.ty)),a}reset(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}toArray(){let e=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];return typeof Float32Array=="undefined"?e:new Float32Array(e)}toString(){return`Matrix({ a: ${this.a}, b: ${this.b}, c: ${this.c}, d: ${this.d}, tx: ${this.tx}, ty: ${this.ty} })`}static get IDENTITY(){return new vt}}});var ve,Bm=_(()=>{Ni();ve=class{constructor(e=0,t=0,i=0,r=0){this.x=0;this.y=0;this.width=0;this.height=0;this.x=e,this.y=t,this.width=i,this.height=r}set(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this}clone(){return new ve(this.x,this.y,this.width,this.height)}copy(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}equals(e,t,i,r){return e instanceof ve?e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height:e===this.x&&t===this.y&&i===this.width&&r===this.height}translate(e,t){let{x:i,y:r}=is(e,t);return this.x+=i,this.y+=r,this}scale(e,t){let{x:i,y:r}=is(e,t);return this.width*=i,this.height*=r,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this}getPosition(){return new z(this.x,this.y)}getSize(){return new z(this.width,this.height)}insetBy(e,t){return this.x+=e,this.y+=t,this.width-=2*e,this.height-=2*t,this}intersects(e){let t=new z(this.x,this.y),i=new z(this.x+this.width,this.y+this.height),r=new z(e.x,e.y),o=new z(e.x+e.width,e.y+e.height);return!(r.x>i.x||t.x>o.x||o.y<t.y||i.y<r.y)}toString(){return`Rectangle({ x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height} })`}static FromDiagonalPoints(e,t){let i=!1;t.x-e.x<0&&(i=!0);let r=i?t:e,o=i?e:t,n=o.x-r.x,a=o.y-r.y;return new ve(r.x,r.y,n,a)}}});var Do,fT,gr,Ue=_(()=>{ii();Ot();wo();Co();Pm();Mm();Bm();Ni();hi();Do=2e3,fT=5,gr=fT*4});var rs,pl=_(()=>{Ue();rs=class{constructor(){this._position=new z(0,0),this._scale=new z(1,1),this._pivot=new z(0,0),this._rotation=0,this._lastRotation=null,this._alpha=1,this._visible=!0,this._worldTransform=new vt,this._parent=null,this._shaders=[],this._boundsNeedUpdate=!0,this._bounds=new ve(0,0,1,1),this._localBoundsNeedUpdate=!0,this._localBounds=new ve(0,0,1,1),this._filterRectangle=new ve(0,0,0,0)}renderWebGL(e){B.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")}renderCanvas(e){B.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")}updateTransform(){let e=this._parent?this._parent.getWorldTransform():vt.IDENTITY,t=this._worldTransform,i=Math.sin(this._rotation),r=Math.cos(this._rotation);t.a=r*this._scale.x,t.b=i*this._scale.x,t.c=-i*this._scale.y,t.d=r*this._scale.y,t.tx=this._position.x,t.ty=this._position.y,(this._pivot.x||this._pivot.y)&&(t.tx-=this._pivot.x*t.a+this._pivot.y*t.c,t.ty-=this._pivot.x*t.b+this._pivot.y*t.d),t.multiply(e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}addShader(e){this._shaders.push(e)}removeShader(e){let t=this._shaders.indexOf(e);return t!==-1?(this._shaders.splice(t,1),!0):!1}removeShaderAt(e){return this._shaders[e]?(this._shaders.splice(e,1),!0):!1}getBounds(){return this._bounds.clone()}getPosition(){return this._position}setPosition(e,t){this._position.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getScale(){return this._scale}setScale(e,t){this._scale.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getPivot(){return this._pivot}setPivot(e,t){this._pivot.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getRotation(){return this._rotation}setRotation(e){this._rotation=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getAlpha(){return this._alpha}setAlpha(e){this._alpha=e}getWorldAlpha(){return this._parent?this._parent.getAlpha()*this._alpha:this._alpha}getWorldTransform(){return this._worldTransform}getParent(){return this._parent}setParent(e){this._parent=e}getFilterRectangle(){return this._filterRectangle}setFilterRectangle(e){this._filterRectangle.copy(e)}isVisible(){return this._visible}setVisible(e){this._visible=e}}});var pi,fl=_(()=>{Ue();pl();pi=class extends rs{constructor(){super();this._children=[],this._filters=[]}addFilter(e){this._filters.push(e)}removeFilter(e){let t=this._filters.indexOf(e);return t!==-1?(this._filters.splice(t,1),!0):!1}setFilters(e){this._filters=e}addChild(e){let t=e.getParent();t instanceof pi&&t.removeChild(e),e.setParent(this),this._children.push(e)}prependChild(e){let t=e.getParent();t instanceof pi&&t.removeChild(e),e.setParent(this),this._children.unshift(e)}hasChild(e){return this._children.indexOf(e)!==-1}removeChild(e){let t=this._children.indexOf(e);t!==-1?(this._children.splice(t,1),e.setParent(null)):B.info(this.constructor.name,"Tried to remove a child that does not exist")}clearChildren(){this._children=[]}renderWebGL(e){if(!this._visible)return;let t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),e.getCurrentObjectRenderer().start(),this._renderWebGL(e),this._children.forEach(i=>{i.renderWebGL(e)}),e.getCurrentObjectRenderer().flush(),this._filters&&this._filters.length&&t.popFilters(),e.getCurrentObjectRenderer().start()}_renderWebGL(e){}renderCanvas(e){if(!this._visible)return;let t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),this._renderCanvas(e),this._children.forEach(i=>{i.renderCanvas(e)}),this._filters&&this._filters.length&&t.popFilters()}_renderCanvas(e){}updateTransform(){super.updateTransform(),this._children.forEach(e=>{e.updateTransform()})}getLocalBounds(){return this._localBoundsNeedUpdate&&(this._localBoundsNeedUpdate=!1),this._localBounds.clone()}getBounds(){return this._boundsNeedUpdate&&(this._boundsNeedUpdate=!1),this._bounds.clone()}getChildren(){return this._children}getFilters(){return this._filters}dispose(){}}});function Xg(s,e,t,i,r,o){if(!(isNaN(o)||o<1)){o|=0;var n=s.data,a,l,u,c,p,m,d,f,b,y,g,C,x,v,M,w,k,q,j,Z,re,te,Y,xe,ct=o+o+1,Qe=i-1,ni=r-1,se=o+1,Me=se*(se+1)/2,ke=new Yg,Ce,ue=ke;for(u=1;u<ct;u++)ue=ue.next=new Yg,u==se&&(Ce=ue);ue.next=ke;var Oe=null,ot=null;d=m=0;var ir=gT[o],rr=_T[o];for(l=0;l<r;l++){for(w=k=q=j=f=b=y=g=0,C=se*(Z=n[m]),x=se*(re=n[m+1]),v=se*(te=n[m+2]),M=se*(Y=n[m+3]),f+=Me*Z,b+=Me*re,y+=Me*te,g+=Me*Y,ue=ke,u=0;u<se;u++)ue.r=Z,ue.g=re,ue.b=te,ue.a=Y,ue=ue.next;for(u=1;u<se;u++)c=m+((Qe<u?Qe:u)<<2),f+=(ue.r=Z=n[c])*(xe=se-u),b+=(ue.g=re=n[c+1])*xe,y+=(ue.b=te=n[c+2])*xe,g+=(ue.a=Y=n[c+3])*xe,w+=Z,k+=re,q+=te,j+=Y,ue=ue.next;for(Oe=ke,ot=Ce,a=0;a<i;a++)n[m+3]=Y=g*ir>>rr,Y!==0?(Y=255/Y,n[m]=(f*ir>>rr)*Y,n[m+1]=(b*ir>>rr)*Y,n[m+2]=(y*ir>>rr)*Y):n[m]=n[m+1]=n[m+2]=0,f-=C,b-=x,y-=v,g-=M,C-=Oe.r,x-=Oe.g,v-=Oe.b,M-=Oe.a,c=d+((c=a+o+1)<Qe?c:Qe)<<2,w+=Oe.r=n[c],k+=Oe.g=n[c+1],q+=Oe.b=n[c+2],j+=Oe.a=n[c+3],f+=w,b+=k,y+=q,g+=j,Oe=Oe.next,C+=Z=ot.r,x+=re=ot.g,v+=te=ot.b,M+=Y=ot.a,w-=Z,k-=re,q-=te,j-=Y,ot=ot.next,m+=4;d+=i}for(a=0;a<i;a++){for(k=q=j=w=b=y=g=f=0,m=a<<2,C=se*(Z=n[m]),x=se*(re=n[m+1]),v=se*(te=n[m+2]),M=se*(Y=n[m+3]),f+=Me*Z,b+=Me*re,y+=Me*te,g+=Me*Y,ue=ke,u=0;u<se;u++)ue.r=Z,ue.g=re,ue.b=te,ue.a=Y,ue=ue.next;for(p=i,u=1;u<=o;u++)m=p+a<<2,f+=(ue.r=Z=n[m])*(xe=se-u),b+=(ue.g=re=n[m+1])*xe,y+=(ue.b=te=n[m+2])*xe,g+=(ue.a=Y=n[m+3])*xe,w+=Z,k+=re,q+=te,j+=Y,ue=ue.next,u<ni&&(p+=i);for(m=a,Oe=ke,ot=Ce,l=0;l<r;l++)c=m<<2,n[c+3]=Y=g*ir>>rr,Y>0?(Y=255/Y,n[c]=f*ir>>rr,n[c+1]=b*ir>>rr,n[c+2]=y*ir>>rr):n[c]=n[c+1]=n[c+2]=0,f-=C,b-=x,y-=v,g-=M,C-=Oe.r,x-=Oe.g,v-=Oe.b,M-=Oe.a,c=a+((c=l+se)<ni?c:ni)*i<<2,f+=w+=Oe.r=n[c],b+=k+=Oe.g=n[c+1],y+=q+=Oe.b=n[c+2],g+=j+=Oe.a=n[c+3],Oe=Oe.next,C+=Z=ot.r,x+=re=ot.g,v+=te=ot.b,M+=Y=ot.a,w-=Z,k-=re,q-=te,j-=Y,ot=ot.next,m+=i}}}function Yg(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var gT,_T,Jg=_(()=>{"use strict";gT=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],_T=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]});var fi,zn,Lm=_(()=>{wo();fi=class{constructor(e=1,t=0,i=0,r=0,o=0,n=0,a=1,l=0,u=0,c=0,p=0,m=0,d=1,f=0,b=0,y=0,g=0,C=0,x=1,v=0){this.set(e,t,i,r,o,n,a,l,u,c,p,m,d,f,b,y,g,C,x,v)}set(e,t,i,r,o,n,a,l,u,c,p,m,d,f,b,y,g,C,x,v){this.a=e,this.b=t,this.c=i,this.d=r,this.e=o,this.f=n,this.g=a,this.h=l,this.i=u,this.j=c,this.k=p,this.l=m,this.m=d,this.n=f,this.o=b,this.p=y,this.q=g,this.r=C,this.s=x,this.t=v}reset(){this.a=1,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=1,this.h=0,this.i=0,this.j=0,this.k=0,this.l=0,this.m=1,this.n=0,this.o=0,this.p=0,this.q=0,this.r=0,this.s=1,this.t=0}apply(e){let t=this.a*e.r+this.b*e.g+this.c*e.b+this.d*e.a+this.e,i=this.f*e.r+this.g*e.g+this.h*e.b+this.i*e.a+this.j,r=this.k*e.r+this.l*e.g+this.m*e.b+this.n*e.a+this.o,o=this.p*e.r+this.q*e.g+this.r*e.b+this.s*e.a+this.t;return new S(t,i,r,o)}multiply(e){let t,i,r,o,n,a,l,u,c,p,m,d,f,b,y,g,C,x,v,M,w=e,k=this;return t=w.a*k.a+w.b*k.f+w.c*k.k+w.d*k.p,i=w.a*k.b+w.b*k.g+w.c*k.l+w.d*k.q,r=w.a*k.c+w.b*k.h+w.c*k.m+w.d*k.r,o=w.a*k.d+w.b*k.i+w.c*k.n+w.d*k.s,a=w.f*k.a+w.g*k.f+w.h*k.k+w.i*k.p,l=w.f*k.b+w.g*k.g+w.h*k.l+w.i*k.q,u=w.f*k.c+w.g*k.h+w.h*k.m+w.i*k.r,c=w.f*k.d+w.g*k.i+w.h*k.n+w.i*k.s,m=w.k*k.a+w.l*k.f+w.m*k.k+w.n*k.p,d=w.k*k.b+w.l*k.g+w.m*k.l+w.n*k.q,f=w.k*k.c+w.l*k.h+w.m*k.m+w.n*k.r,b=w.k*k.d+w.l*k.i+w.m*k.n+w.n*k.s,g=w.p*k.a+w.q*k.f+w.r*k.k+w.s*k.p,C=w.p*k.b+w.q*k.g+w.r*k.l+w.s*k.q,x=w.p*k.c+w.q*k.h+w.r*k.m+w.s*k.r,v=w.p*k.d+w.q*k.i+w.r*k.n+w.s*k.s,n=w.a*k.e+w.b*k.j+w.c*k.o+w.d*k.t+w.e,p=w.f*k.e+w.g*k.j+w.h*k.o+w.i*k.t+w.j,y=w.k*k.e+w.l*k.j+w.m*k.o+w.n*k.t+w.o,M=w.p*k.e+w.q*k.j+w.r*k.o+w.s*k.t+w.t,this.a=t,this.b=i,this.c=r,this.d=o,this.e=n,this.f=a,this.g=l,this.h=u,this.i=c,this.j=p,this.k=m,this.l=d,this.m=f,this.n=b,this.o=y,this.p=g,this.q=C,this.r=x,this.s=v,this.t=M,this}clone(){let e=new fi;return e.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t),e}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f&&this.g===e.g&&this.h===e.h&&this.i===e.i&&this.j===e.j&&this.k===e.k&&this.l===e.l&&this.m===e.m&&this.n===e.n&&this.o===e.o&&this.p===e.p&&this.q===e.q&&this.r===e.r&&this.s===e.s&&this.t===e.t}getOffsets(){return[this.e,this.j,this.o,this.t]}toString(){return`ColorMatrix( ${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e},
      ${this.f}, ${this.g}, ${this.h}, ${this.i}, ${this.j},
      ${this.k}, ${this.l}, ${this.m}, ${this.n}, ${this.o},
      ${this.p}, ${this.q}, ${this.r}, ${this.s}, ${this.t} )`}toArray(){return"abcdefghijklmnopqrst".split("").map(e=>this[e])}static get IDENTITY(){return new fi}static createBrightnessMatrix(e){let t=new fi;return t.e=e,t.j=e,t.o=e,t}static createContrastMatrix(e){let t=new fi,i=(1-e)/2;return t.a=t.g=t.m=e,t.e=t.j=t.o=i,t}static createSaturationMatrix(e=1){let t=new fi,i=1-e,r=.213*i,o=.715*i,n=.072*i;return t.a=r+e,t.b=o,t.c=n,t.f=r,t.g=o+e,t.h=n,t.k=r,t.l=o,t.m=n+e,t}static createExposureMatrix(e=0){let t=Math.pow(2,e);return new fi(t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0)}static createLinearMatrix(e=1,t=0){let i=new fi;return i.a=i.g=i.m=e,i.e=i.j=i.o=t,i}},zn=fi});var ko,J,To=_(()=>{Ot();di();wo();Co();Lm();Ni();hi();ko=class extends dt{constructor(e={},t={}){super();this.availableOptions=D(D({},Object.getPrototypeOf(this).availableOptions),t),this._onConfigurableUpdate=this._onConfigurableUpdate.bind(this),this._initOptions(e)}_buildConfigError(e){let t="";return this.constructor.name&&(t=`${this.constructor.name}: `),t+=e,new Error(t)}_onOptionsChange(){}validateSettings(){return new Promise((e,t)=>{for(let i in this.availableOptions)if(this.availableOptions[i].required&&typeof this._options[i]=="undefined")return t(this._buildConfigError(`Option \`${i}\` is required.`));e()})}_initOptions(e={}){this._options={};let t,i,r,o=this;for(t in this.availableOptions){if(r=t.charAt(0).toUpperCase()+t.slice(1),i=this.availableOptions[t],[h.STRING,h.NUMBER,h.BOOLEAN,h.OBJECT,h.VECTOR2,h.COLOR,h.CONFIGURABLE,h.COLOR_MATRIX,h.ARRAY,h.IMAGE,h.FUNCTION,h.ALL].indexOf(i.type)===-1)throw this._buildConfigError(`Unknown option type: \`${i.type}\``);if(function(l){o[`set${r}`]=function(u,c,p){o.setOption(l,u,c,p)},o[`get${r}`]=function(){return o.getOption(l)}}(t),i.type===h.CONFIGURABLE&&(this._options[t]=new ko(void 0,i.structure||{}),this._options[t].on("update",this._onConfigurableUpdate)),!(t in e)||typeof e[t]=="undefined")if(typeof i.default!="undefined"){let a=i.default;typeof i.default=="function"&&(a=i.default()),this[`set${r}`](a,!1,!0)}else i.type!==h.CONFIGURABLE&&(this._options[t]=void 0)}for(t in e){if(typeof this.availableOptions[t]=="undefined")throw new Error(`Invalid option: ${t}`);typeof e[t]!="undefined"&&(r=t.charAt(0).toUpperCase()+t.slice(1),this[`set${r}`](e[t],!1,!0))}}set(e,t=!0){Object.keys(e).forEach(i=>{this.setOption(i,e[i],!1)}),this._onOptionsChange(),t&&this.emit("update",this,e)}getOption(e){return this._options[e]}hasOption(e){return!!this.availableOptions[e]}getOptionDefault(e){let t=this.availableOptions[e];if(!t)throw new Error(`Invalid option: ${e}`);return t.default}resetOptions(){this.set(this.getDefaultOptions())}getDefaultOptions(){let e={};for(let t in this.availableOptions){let i=this.availableOptions[t].default;typeof i!="undefined"&&(e[t]=i)}return e}getOptions(){return D({},this._options)}equals(e){let t=e.getOptions();return this.optionsEqual(t)}optionsEqual(e){for(let t in e){let i=e[t];if(!this._optionEquals(t,i))return!1}return!0}_optionEquals(e,t){if(typeof this.availableOptions[e]=="undefined")throw new Error(`Invalid option: ${e}`);let r=this.availableOptions[e].type,o=this._options[e];if(o===t)return!0;if(typeof t=="undefined"||typeof o=="undefined")return!1;switch(r){case h.OBJECT:return typeof o.optionsEqual=="function"?o.optionsEqual(t._options):o===t;case h.STRING:case h.NUMBER:case h.BOOLEAN:case h.FUNCTION:case"*":return o===t;case h.VECTOR2:return o.equals(t);case h.COLOR:case h.COLOR_MATRIX:return t.equals(o);case h.CONFIGURABLE:return o.optionsEqual(t);case h.ARRAY:return this._arrayOptionEquals(e,t);case h.IMAGE:return o.src===t.src}}_arrayOptionEquals(e,t){let i=this._options[e];if(t.length!==i.length)return!1;let r=!0;for(let o=0;o<i.length;o++){let n=i[o],a=t[o];if(n instanceof ko){if(typeof a=="undefined"||!n.optionsEqual(a)){r=!1;break}}else if(a!==n){r=!1;break}}return r}serializeOptions(e=Object.keys(this._options),t=!1){let i={};return e.forEach(r=>{if(typeof this.availableOptions[r]=="undefined")return Log.warn(`Trying to serialize a key that does not exist: ${r}`);this.availableOptions[r].serializable!==!1&&(i[r]=this.serializeOption(r,t))}),i}serializeOption(e,t=!1){let i=this.availableOptions[e],r=i.type,o=this._options[e];if(!o)return o;if(i.serializable===!1)throw new Error(`Option \`${e}\` is not serializable.`);switch(r){case h.STRING:case h.NUMBER:case h.BOOLEAN:case h.OBJECT:case h.FUNCTION:case h.ALL:return o;case h.VECTOR2:return t?o.toObject():o.clone();case h.COLOR:case h.COLOR_MATRIX:return t?o.toArray():o.clone();case h.CONFIGURABLE:return o.serializeOptions(void 0,t);case h.ARRAY:return o.slice(0);case h.IMAGE:return t?o.src:o}}setOption(e,t,i=!0,r=!1){let o=this.availableOptions[e];if(!o)throw new Error(`Invalid option: ${e}`);if(typeof o.setter!="undefined"&&(t=o.setter.call(this,t,r)),typeof o.validation!="undefined"&&o.validation(t),t===null||typeof t=="undefined"){if(o.required)throw this._buildConfigError(`Option \`${e}\` is required.`);this._options[e]=t}else switch(o.type){case h.STRING:{if(typeof t!==h.STRING)throw this._buildConfigError(`Option \`${e}\` has to be a string.`);let{available:n}=o;if(typeof n!="undefined"&&n.indexOf(t)===-1)throw this._buildConfigError(`Invalid value for \`${e}\` (valid values are: ${o.available.join(", ")})`);this._options[e]=t;break}case h.NUMBER:if(typeof t!==h.NUMBER)throw this._buildConfigError(`Option \`${e}\` has to be a number.`);this._options[e]=t;break;case h.BOOLEAN:if(typeof t!==h.BOOLEAN)throw this._buildConfigError(`Option \`${e}\` has to be a boolean.`);this._options[e]=t;break;case h.VECTOR2:if(!(t instanceof z)&&!(typeof t=="object"&&"x"in t&&"y"in t))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Vector2 or an Object holding x and y values.`);t instanceof z?this._options[e]=t.clone():this._options[e]=z.fromObject(t);break;case h.COLOR:if(!(t instanceof S))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Color.`);this._options[e]=t;break;case h.COLOR_MATRIX:if(!(t instanceof zn))throw this._buildConfigError(`Option \`${e}\` has to be an instance of ColorMatrix.`);this._options[e]=t.clone();break;case h.FUNCTION:if(typeof t!="function")throw this._buildConfigError(`Option \`${e}\` has to be a function.`);this._options[e]=t;break;case h.OBJECT:case"*":this._options[e]=t;break;case h.IMAGE:{let{Image:n}=$e;if(typeof t=="string"){let a=new n;Ig(a)&&(a.crossOrigin=E.getCrossOriginValue(o.crossOrigin)),a.src=t,this._options[e]=a}else if(t instanceof n||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement)this._options[e]=t;else throw this._buildConfigError(`Option \`${e}\` has to be an Image, Canvas or String.`);break}case h.CONFIGURABLE:t instanceof ko?this._options[e]=t:this._options[e].set(t);break;case h.ARRAY:if(!(t instanceof Array))throw this._buildConfigError(`Option \`${e}\` has to be an Array.`);this._options[e]=t.slice(0);break;default:throw this._buildConfigError(`Unknown option type: \`${o.type}\``)}i&&(this._onOptionsChange(),this.emit("update",this,{[e]:t}))}_onConfigurableUpdate(...e){this.emit("update",...e)}hasChanges(){let e=this.getDefaultOptions();return!this.optionsEqual(e)}},J=ko});var Nn,zm=_(()=>{Ot();Ue();Ue();Nn=class{constructor(e,t,i,r={},o=[]){this._program=null;this._renderer=e,this._vertexSource=t,this._fragmentSource=i,this._uniforms=r,this._uniformLocations={},this._attributes=o,this._attributeLocations={},this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._init()}_init(){this._compile(),this._renderer.getContext().useProgram(this._program),this._cacheUniformLocations(),this._cacheAttributeLocations()}_onContextChange(){this._init()}setupBuffers(e,t){let i=this._renderer.getContext();i.bindBuffer(i.ARRAY_BUFFER,e),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),i.vertexAttribPointer(this._attributeLocations.a_position,2,i.FLOAT,!1,gr,0),i.vertexAttribPointer(this._attributeLocations.a_texCoord,2,i.FLOAT,!1,gr,2*4),i.vertexAttribPointer(this._attributeLocations.a_color,4,i.UNSIGNED_BYTE,!0,gr,4*4)}syncUniforms(){Object.keys(this._uniforms).forEach(e=>{this.syncUniform(e)})}syncUniform(e){let t=this._renderer.getContext(),i=this._uniforms[e],r=this._uniformLocations[e];switch(i.type){case A.SAMPLER2D:t.uniform1i(r,i.value);break;case A.INT:case A.INT1:t.uniform1i(r,i.value);break;case A.INT2:t.uniform2i(r,i.value[0],i.value[1]);break;case A.INT3:t.uniform3i(r,i.value[0],i.value[1],i.value[2]);break;case A.INT4:t.uniform4i(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case A.FLOAT:case A.FLOAT1:t.uniform1f(r,i.value);break;case A.FLOAT2:t.uniform2f(r,i.value[0],i.value[1]);break;case A.FLOAT3:t.uniform3f(r,i.value[0],i.value[1],i.value[2]);break;case A.FLOAT4:t.uniform4f(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case A.FLOAT_VECTOR2:t.uniform2fv(r,i.value);break;case A.MAT3:case A.MAT3FV:t.uniformMatrix3fv(r,!1,i.value);break;case A.MAT4:t.uniformMatrix4fv(r,!1,i.value);break;default:B.warn(this.constructor.name,`Unknown uniform type: ${i.type}`)}}_cacheAttributeLocations(){let e=this._renderer.getContext();this._attributes.forEach(t=>{this._program&&(this._attributeLocations[t]=e.getAttribLocation(this._program,t))})}_cacheUniformLocations(){let e=this._renderer.getContext();Object.keys(this._uniforms).forEach(i=>{if(this._program){let r=e.getUniformLocation(this._program,i);r&&(this._uniformLocations[i]=r)}})}_addPrecisionToSource(e){let t=this._renderer.getMaxFloatPrecision(),i=Ut.Medium;return E.isMobile()&&t===Ut.High&&(i=Ut.High),`precision ${i} float;
${e}`}_compile(){let e=this._renderer.getContext(),t=this._compileShader(e.VERTEX_SHADER,this._vertexSource);this._vertexShader=t;let i=this._addPrecisionToSource(this._fragmentSource),r=this._compileShader(e.FRAGMENT_SHADER,i);this._fragmentShader=r;let o=e.createProgram();if(!o)return;if(e.attachShader(o,t),e.attachShader(o,r),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS))this._program=o;else{let a=e.getProgramInfoLog(o);e.isContextLost()&&(a="WebGL context lost"),e.deleteProgram(o),B.error(this.constructor.name,`WebGL program linking error: ${a}`)}}_compileShader(e,t){let i=this._renderer.getContext(),r=i.createShader(e);if(!r)throw new Error(`Cannot create shared: ${JSON.stringify(e)}`);if(i.shaderSource(r,t),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS)){let n=i.getShaderInfoLog(r);i.isContextLost()&&(n="WebGL context lost"),i.deleteShader(r),B.error(this.constructor.name,`WebGL shader compilation error: ${n}`)}return r}setUniform(e,t,i=!1){this._uniforms[e].value=t,i&&this.syncUniform(e)}setUniforms(e,t=!1){Object.keys(e).forEach(i=>{this._uniforms[i].value=e[i],t&&this.syncUniform(i)})}getUniforms(){return this._uniforms}getAttributes(){return this._attributes}getAttributeLocations(){return this._attributeLocations}getProgram(){return this._program}dispose(){let e=this._renderer.getContext();e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader),this._renderer.off("context",this._onContextChange)}}});var Zg,$g=_(()=>{Zg=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;
}
`});var e_,Qg=_(()=>{e_=`attribute vec2 a_position;
attribute vec2 a_texCoord;
attribute vec4 a_color;
varying vec2 v_texCoord;
varying vec4 v_color;
uniform mat3 u_projMatrix;

void main() {
  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);
  v_texCoord = a_texCoord;
  v_color = vec4(a_color.rgb * a_color.a, a_color.a);
}
`});var xT,Ui,Nm,t_=_(()=>{Ot();Ue();zm();$g();Qg();xT=new vt,Ui={vertexSource:e_,fragmentSource:Zg,uniforms:{u_image:{type:A.SAMPLER2D,value:0},u_projMatrix:{type:A.MAT3,value:xT.toArray()}},attributes:["a_position","a_texCoord","a_color"]},Nm=class extends Nn{constructor(e,t=Ui.vertexSource,i=Ui.fragmentSource){super(e,t,i,Ui.uniforms,Ui.attributes)}}});var Um=_(()=>{zm();t_()});var ri,Ro=_(()=>{Jg();Ot();To();Ue();Um();di();ri=class extends J{constructor(e={},t={}){super(e,t);this._initOptions(e)}_initOptions(e={}){this._shaders=[],this._availableUniforms=Ui.uniforms,this._attributes=Ui.attributes,this._vertexSource=Ui.vertexSource,this._fragmentSource=Ui.fragmentSource,this._initUniforms(),super._initOptions(e)}_initUniforms(){this._uniforms={};for(let e in this._availableUniforms){let t=this._availableUniforms[e];this._uniforms[e]={type:t.type,value:t.default||null}}for(let e in this.availableOptions){let t=this.availableOptions[e];t.uniformType?this._uniforms[`u_${e}`]={type:t.uniformType,value:t.default||null}:B.trace(this.constructor.name,`Option \`${e}\` is missing a \`uniformType\`!`)}}setOption(e,t,i=!0){super.setOption(e,t,i);let r=t,o=this.availableOptions[e];if(!o.uniformType)return;let n=`u_${e}`;switch(o.type){case h.COLOR:o.uniformType===A.FLOAT4?r=t.toGLColor():o.uniformType===A.FLOAT3&&(r=t.toRGBGLColor());break;case h.VECTOR2:r=[t.x,t.y];break;case h.COLOR_MATRIX:{r=[t.a,t.b,t.c,t.d,t.f,t.g,t.h,t.i,t.k,t.l,t.m,t.n,t.p,t.q,t.r,t.s];let a=[t.e,t.j,t.o,t.t];this._uniforms[`${n}_vec`]={value:a,type:A.FLOAT4}}}this.setUniform(n,r)}setUniform(e,t,i=!1){this._uniforms[e].value=t}setUniforms(e,t=!1){Object.entries(e).forEach(([i,r])=>{this._uniforms[i].value=r,t&&this.syncUniform(i)})}syncUniform(e){this._shaders.forEach(t=>{t.syncUniform(e)})}syncUniforms(){this._shaders.forEach(e=>{e.syncUniforms()})}getShaderForRenderer(e){let{id:t}=e;this._shaders||(this._shaders=[]);let i=this._shaders[t];return i||(i=new Nn(e,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes),this._shaders[t]=i),i}apply(e,t,i,r=!1){go(e)?this._applyWebGL(e,t,i,r):this._applyCanvas(e,t,i,r)}_applyWebGL(e,t,i,r=!1){let o=e.getContext(),n=this.getShaderForRenderer(e);e.setRenderTarget(i),r&&i.clear(),e.setShader(n);let a=e.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",a),n.syncUniforms(),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0)}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=i.getContext();B.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`."),n.clearRect(0,0,o.width,o.height),n.drawImage(o,0,0)}dispose(){this._shaders.forEach(e=>e.dispose()),this._shaders=[]}_blurImage(e,t,i){let r=10,o=e.getCanvas(),n=Math.min(1,r/(i*Math.min(o.width,o.height))),a=E.createCanvas();a.width=Math.round(o.width*n),a.height=Math.round(o.height*n);let l=a.getContext("2d");l.drawImage(o,0,0,o.width,o.height,0,0,a.width,a.height);let u=i*Math.min(a.width,a.height),c=l.getImageData(0,0,a.width,a.height);Xg(c,0,0,a.width,a.height,u),l.putImageData(c,0,0),t.getContext().drawImage(a,0,0,a.width,a.height,0,0,o.width,o.height)}}});var r_,i_=_(()=>{r_=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);
}
`});var gl,s_=_(()=>{Ro();i_();gl=class extends ri{constructor(){super();this._fragmentSource=r_}}});var n_,o_=_(()=>{n_=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
}
`});var CT,DT,Gm,a_,l_=_(()=>{Ue();Ro();o_();({OptionType:CT,UniformType:DT}=bt),Gm=class extends ri{constructor(...e){super(...e);this._fragmentSource=n_}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),{color:l}=this._options,u=n.getImageData(0,0,o.width,o.height),c=a.getImageData(0,0,o.width,o.height),p=o.width*o.height,m=new S,d=new S;for(let f=0;f<p*4;f+=4){m.set(u.data[f]/255,u.data[f+1]/255,u.data[f+2]/255,u.data[f+3]/255),d.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255);let b=d.r+m.a*(m.r-d.r);c.data[f]=(b+m.a*(l.r-b))*255;let y=d.g+m.a*(m.g-d.g);c.data[f+1]=(y+m.a*(l.g-y))*255;let g=d.b+m.a*(m.b-d.b);c.data[f+2]=(g+m.a*(l.b-g))*255}a.putImageData(c,0,0)}};Gm.prototype.availableOptions={color:{type:CT.COLOR,default:S.WHITE,uniformType:DT.FLOAT4}};a_=Gm});var c_,u_=_(()=>{c_=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;
uniform int u_mode;
vec3 W = vec3(0.2125, 0.7154, 0.0721);
const float EPSILON = 0.0000001;
void main() {
    vec4 color = texture2D(u_image, v_texCoord); // Is premultiplied.
    color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha.
    vec4 newColor;
    if (u_mode == 0) {
        newColor = vec4(color.rgb, 1.0); // We use alpha 1.0 becaue color is not premultiplied.
        newColor *= color.a; // Premultiply the result
    } else if (u_mode == 1) {
        newColor = vec4(u_color.rgb, 1.0); // Use alpha 1.0 because it is not premultiplied.
        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.
    } else if (u_mode == 2) {
        float luminance = dot(color.rgb, W); // Convert to color to gray value.
        newColor = vec4(vec3(luminance) * u_color.rgb, 1.0); // Colorize and with alpha 1.0 because it is not premultiplied.
        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.
    }
    gl_FragColor = newColor;
}`});var m_,d_,_r,h_,p_=_(()=>{Ue();Ro();u_();({OptionType:m_,UniformType:d_}=bt),_r=class extends ri{constructor(...e){super(...e);this._fragmentSource=c_}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{mode:u,color:c}=this._options,{r:p,g:m,b:d,a:f}=c,b=[.2125,.7154,.0721];switch(u){case _r.MODES.SOLID:for(let y=0;y<o.width*o.height;y++){let g=y*4;l.data[g]+=(p*255-l.data[g])*f,l.data[g+1]+=(m*255-l.data[g+1])*f,l.data[g+2]+=(d*255-l.data[g+2])*f}break;case _r.MODES.COLORIZED:for(let y=0;y<o.width*o.height;y++){let g=y*4,C=l.data[g]/255*b[0]+l.data[g+1]/255*b[1]+l.data[g+2]/255*b[2],x=new S(C*p,C*m,C*d);l.data[g]+=(x.r*255-l.data[g])*f,l.data[g+1]+=(x.g*255-l.data[g+1])*f,l.data[g+2]+=(x.b*255-l.data[g+2])*f}break}a.putImageData(l,0,0)}};_r.MODES={NONE:0,SOLID:1,COLORIZED:2};_r.prototype.availableOptions={color:{type:m_.COLOR,default:S.WHITE,uniformType:d_.FLOAT4},mode:{type:m_.NUMBER,default:_r.MODES.NONE,uniformType:d_.INT}};h_=_r});var g_,f_=_(()=>{g_=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform sampler2D u_overlayImage;
uniform int u_blendMode;
uniform float u_alpha;

const float EPSILON = 0.000001;

vec4 overlay(vec4 a, vec4 b) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 hardLight(vec4 b, vec4 a) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(b, vec4(result, b.a), u_alpha * a.a);
}

vec4 softLight(vec4 a, vec4 b) {
    vec3 result = mix(
          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),
          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),
          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 multiply(vec4 a, vec4 b) {
    vec3 result = a.rgb * b.rgb;
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 darken(vec4 a, vec4 b) {
    vec3 result = min(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 lighten(vec4 a, vec4 b) {
    vec3 result = max(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 screen(vec4 a, vec4 b) {
    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 colorBurn(vec4 a, vec4 b) {
    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 normal(vec4 a, vec4 b) {
    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);
}

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);

  vec4 resultColor;
  if (u_blendMode == 0) {
    resultColor = normal(color, overlayColor);
  } else if (u_blendMode == 1) {
    resultColor = overlay(color, overlayColor);
  } else if (u_blendMode == 2) {
    resultColor = hardLight(color, overlayColor);
  } else if (u_blendMode == 3) {
    resultColor = softLight(color, overlayColor);
  } else if (u_blendMode == 4) {
    resultColor = multiply(color, overlayColor);
  } else if (u_blendMode == 5) {
    resultColor = darken(color, overlayColor);
  } else if (u_blendMode == 6) {
    resultColor = lighten(color, overlayColor);
  } else if (u_blendMode == 7) {
    resultColor = screen(color, overlayColor);
  } else if (u_blendMode == 8) {
    resultColor = colorBurn(color, overlayColor);
  }
  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);
}
`});var _l,Wm,Vm,ht,__,y_=_(()=>{Ue();Ro();f_();({OptionType:_l,UniformType:Wm}=bt),Vm=1e-6,ht=class extends ri{constructor(...e){super(...e);this._fragmentSource=g_,this._lastImage=null}_applyCanvas(e,t,i,r=!1){let o=this._options.overlayTexture.getRenderTarget().getContext(),n=t.getCanvas(),a=t.getContext(),l=i.getContext(),u=a.getImageData(0,0,n.width,n.height),c=o.getImageData(0,0,n.width,n.height),{blendMode:p,alpha:m}=this._options,d=new S,f=new S,b=new S;for(let y=0;y<n.width*n.height*4;y+=4){d.set(u.data[y]/255,u.data[y+1]/255,u.data[y+2]/255,u.data[y+3]/255),f.set(c.data[y]/255,c.data[y+1]/255,c.data[y+2]/255,c.data[y+3]/255);let g,C,x,v,M,w,k,q,j;switch(p){case ht.BLEND_MODES.NORMAL:b.set(d.r+f.a*m*(f.r-d.r),d.g+f.a*m*(f.g-d.g),d.b+f.a*m*(f.b-d.b),d.a);break;case ht.BLEND_MODES.OVERLAY:g=1-2*(1-d.r)*(1-f.r),C=2*d.r*f.r,x=g+(d.r<.5?1:0)*(C-g),v=1-2*(1-d.g)*(1-f.g),M=2*d.g*f.g,w=v+(d.g<.5?1:0)*(M-v),k=1-2*(1-d.b)*(1-f.b),q=2*d.b*f.b,j=k+(d.b<.5?1:0)*(q-k),b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break;case ht.BLEND_MODES.HARD_LIGHT:g=1-2*(1-f.r)*(1-d.r),C=2*f.r*d.r,x=g+(f.r<.5?1:0)*(C-g),v=1-2*(1-f.g)*(1-d.g),M=2*f.g*d.g,w=v+(f.g<.5?1:0)*(M-v),k=1-2*(1-f.b)*(1-d.b),q=2*f.b*d.b,j=k+(f.b<.5?1:0)*(q-k),b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break;case ht.BLEND_MODES.SOFT_LIGHT:g=2*d.r*(1-f.r)+(2*f.r-1)*Math.sqrt(d.r),C=2*d.r*f.r+d.r*d.r*(1-2*f.r),x=g+(f.r<.5?1:0)*(C-g),v=2*d.g*(1-f.g)+(2*f.g-1)*Math.sqrt(d.g),M=2*d.g*f.g+d.g*d.g*(1-2*f.g),w=v+(f.g<.5?1:0)*(M-v),k=2*d.b*(1-f.b)+(2*f.b-1)*Math.sqrt(d.b),q=2*d.b*f.b+d.b*d.b*(1-2*f.b),j=k+(f.b<.5?1:0)*(q-k),b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break;case ht.BLEND_MODES.MULTIPLY:x=d.r*f.r,w=d.g*f.g,j=d.b*f.b,b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break;case ht.BLEND_MODES.DARKEN:x=Math.min(d.r,f.r),w=Math.min(d.g,f.g),j=Math.min(d.b,f.b),b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break;case ht.BLEND_MODES.LIGHTEN:x=Math.max(d.r,f.r),w=Math.max(d.g,f.g),j=Math.max(d.b,f.b),b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break;case ht.BLEND_MODES.SCREEN:x=1-(1-d.r)*(1-f.r),w=1-(1-d.g)*(1-f.g),j=1-(1-d.b)*(1-f.b),b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break;case ht.BLEND_MODES.COLOR_BURN:x=Math.max(0,Math.min(1,1-(1-d.r)/Math.max(f.r,Vm))),w=Math.max(0,Math.min(1,1-(1-d.g)/Math.max(f.g,Vm))),j=Math.max(0,Math.min(1,1-(1-d.b)/Math.max(f.b,Vm))),b.set(d.r+f.a*m*(x-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(j-d.b),d.a);break}u.data[y]=b.r*255,u.data[y+1]=b.g*255,u.data[y+2]=b.b*255,u.data[y+3]=b.a*255}l.putImageData(u,0,0)}};ht.BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8};ht.prototype.availableOptions={blendMode:{type:_l.NUMBER,default:ht.BLEND_MODES.NORMAL,uniformType:Wm.INT},overlayImage:{type:_l.NUMBER,required:!0,uniformType:Wm.SAMPLER2D},overlayTexture:{type:_l.OBJECT,required:!0},alpha:{type:_l.NUMBER,default:1,uniformType:Wm.FLOAT}};__=ht});var jm={};Ne(jm,{ColorOverlayFilter:()=>a_,OverlayFilter:()=>__,TintFilter:()=>h_,UnpremultiplyFilter:()=>gl});var b_=_(()=>{s_();l_();p_();y_()});var Wt,yr,x_,Eo,Le,Fo=_(()=>{Ue();di();(function(r){r[r.Nearest=0]="Nearest",r[r.Linear=1]="Linear",r[r.Bilinear=2]="Bilinear",r[r.Trilinear=3]="Trilinear"})(Wt||(Wt={}));(function(i){i[i.ClampToEdge=0]="ClampToEdge",i[i.Repeat=1]="Repeat",i[i.MirroredRepeat=2]="MirroredRepeat"})(yr||(yr={}));x_={[1]:"LINEAR",[0]:"NEAREST",[2]:"LINEAR_MIPMAP_NEAREST",[3]:"LINEAR_MIPMAP_LINEAR"},Eo=class extends dt{constructor(e){super();this._renderers=[];this._glTextures={};this._dirty=!0;this._mipMapping=!1;this._glUnit=0;this._magFilter=Eo.DefaultMagFilter;this._minFilter=Eo.DefaultMinFilter;this._repeatX=0;this._repeatY=0;this._pixelRatio=1;this._loaded=!1;this._frame=new ve(0,0,100,100);this._onSourceLoaded=this._onSourceLoaded.bind(this),this._source=e,this._loadSource()}resizeTo(e){this._frame.width===e.x&&this._frame.height===e.y||(this._frame.width=e.x,this._frame.height=e.y,this._dirty=!0)}_loadSource(){let e=this._source;if(!!e){if($e.isCanvas(e))return this._onSourceLoaded();if(e.complete)return this._onSourceLoaded();e.addEventListener&&e.addEventListener("load",this._onSourceLoaded)}}_onSourceLoaded(){this._loaded=!0,this.emit("loaded"),this.update()}_updateGLFilters(){if(!this._source)return;let e=new z(this._source.width,this._source.height);E.isPowerOfTwo(e)?(B.info(this.constructor.name,"Mip-mapping enabled"),this._minFilter=Eo.TrilinearFilter,this._mipMapping=!0):(this._minFilter=Eo.LinearFilter,this._mipMapping=!1)}update(){!this._source||((this._frame.width!==this._source.width||this._frame.height!==this._source.height)&&(this._frame=new ve(0,0,this._source.width,this._source.height),this._dirty=!0),this._updateGLFilters(),this.emit("update"))}getRenderers(){return[...this._renderers]}getGLFilter(e,t){switch(t){case"min":return e[x_[this._minFilter]];case"mag":return e[x_[this._magFilter]]}}isLoaded(){return this._loaded}setLoaded(e){this._loaded=e}getSource(){return this._source}setSource(e){this._source=e}getGLTextureForRenderer(e){return this._glTextures[e.id]}setGLTextureForRenderer(e,t){this._renderers[t.id]=t,this._glTextures[t.id]=e}getFrame(){return this._frame}setFrame(e){this._frame=e}getDimensions(){return new z(this._frame.width,this._frame.height)}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getGLUnit(){return this._glUnit}setGLUnit(e){this._glUnit=e}setMinFilter(e){this._minFilter=e}getMinFilter(){return this._minFilter}setMagFilter(e){this._magFilter=e}getMagFilter(){return this._magFilter}setRepeatX(e){this._repeatX=e}getRepeatX(){return this._repeatX}setRepeatY(e){this._repeatY=e}getRepeatY(){return this._repeatY}getGLRepeat(e,t){switch(t==="x"?this.getRepeatX():this.getRepeatY()){case 0:return e.CLAMP_TO_EDGE;case 1:return e.REPEAT;case 2:return e.MIRRORED_REPEAT;default:return 0}}isDirty(){return this._dirty}setDirty(e){this._dirty=e}disposeGLTextures(){this._renderers.forEach(e=>{go(e)&&this.disposeGLTexturesForRenderer(e)})}disposeGLTexturesForRenderer(e){if(!this._glTextures[e.id])return;e.getContext().deleteTexture(this._glTextures[e.id]),delete this._glTextures[e.id],this._renderers[e.id]||delete this._renderers[e.id]}isMipMappingEnabled(){return this._mipMapping}setMipMappingEnabled(e){this._mipMapping=e}dispose(){this.disposeGLTextures(),this._source=void 0}},Le=Eo;Le.NearestFilter=0,Le.LinearFilter=1,Le.BilinearFilter=2,Le.TrilinearFilter=3,Le.DefaultMagFilter=0,Le.DefaultMinFilter=1,Le.Repeat=1,Le._id=0});var Gi,Un=_(()=>{Ue();Fo();di();Gi=class{constructor(e,t,i,r=$e.createCanvas(),o){this._width=e,this._height=t,this._pixelRatio=i,this._baseTexture=new Le,this._canvas=r;let n=o||this._canvas.getContext("2d");if(!n)throw new Error("Cannot get canvas context");this._context=n,this._baseTexture.setSource(this._canvas),this._canvas.width=this._width*this._pixelRatio,this._canvas.height=this._height*this._pixelRatio,this._filterStack=[{renderTarget:this,filters:[]}]}clear(){let e=this._context;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}resizeTo(e){this._baseTexture.resizeTo(e),this._width!==e.x&&(this._width=e.x,this._canvas.width=this._width*this._pixelRatio),this._height!==e.y&&(this._height=e.y,this._canvas.height=this._height*this._pixelRatio)}getCanvas(){return this._canvas}getContext(){return this._context}getFilterStack(){return this._filterStack}getWidth(){return this._width}getHeight(){return this._height}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getDimensions(){return new z(this._width,this._height)}getBaseTexture(){return this._baseTexture}dispose(){delete this._canvas,delete this._context,this._baseTexture.dispose()}}});var ss,yl=_(()=>{Ue();Un();ss=class{constructor(e){this._renderer=e,this._filterStack=[{renderTarget:e.getCurrentRenderTarget(),filters:[]}],this._textures=[],this._textureFrame=new ve(0,0,e.getWidth(),e.getHeight())}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._textures.forEach(t=>t.resizeTo(e))}pushFilters(e,t){this._currentFrame=e.getBounds();let i=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(i),this._filterStack.push({renderTarget:i,filters:t}),i.clear()}popFilters(){let e=this._filterStack.pop();if(!e)return;let{filters:t,renderTarget:i}=e,r=this._filterStack[this._filterStack.length-1],o=i,n=r.renderTarget;return t.length===1?(t[0].apply(this._renderer,o,n),this._textures.push(o)):this._applyFilters(t,o,n),t}_applyFilters(e,t,i){let r=t,o=this._getOrCreateRenderTarget(!0),n=e[e.length-1];e.forEach(a=>{if(a===n)a.apply(this._renderer,r,i);else{a.apply(this._renderer,r,o);let u=r;r=o,o=u}}),this._textures.push(r),this._textures.push(o)}_getOrCreateRenderTarget(e=!1){let t=this._textures.pop();return t||(t=new Gi(this._textureFrame.width,this._textureFrame.height,1)),e&&t.clear(),t}setFilterStack(e){this._filterStack=e}dispose(){}}});var Wn=De((v_,Gn)=>{(function(){var s,e,t,i,r,o;typeof performance!="undefined"&&performance!==null&&performance.now?Gn.exports=function(){return performance.now()}:typeof process!="undefined"&&process!==null&&process.hrtime?(Gn.exports=function(){return(s()-r)/1e6},e=process.hrtime,s=function(){var n;return n=e(),n[0]*1e9+n[1]},i=s(),o=process.uptime()*1e9,r=i-o):Date.now?(Gn.exports=function(){return Date.now()-t},t=Date.now()):(Gn.exports=function(){return new Date().getTime()-t},t=new Date().getTime())}).call(v_)});var w_,C_,bl,Hm=_(()=>{Ue();w_=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Wn(),C_=class{constructor(e){this._context=e,this._tracking=!1;let t=this;for(let i in e)typeof e[i]=="function"?this[i]=function(...o){let n=e[i];if(!t._tracking)return n.apply(e,o);let a=w_(),l=n.apply(e,o),u=w_()-a,c={functionName:i,arguments:o,duration:u};return t._trackedCalls.push(c),l}:this._makePropertyWrapper(i)}_makePropertyWrapper(e){if(["_context","_trackedCalls","_tracking"].indexOf(e)!==-1)return;let i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}startFrame(){this._tracking=!0,this._trackedCalls=[]}endFrame(){let e="Rendering";B.log(e,"Frame rendering results:"),B.log(e,`Context calls: ${this._trackedCalls.length}`);let t={};this._trackedCalls.forEach(({functionName:r,duration:o})=>{t[r]=t[r]||{totalDuration:0,calls:0},t[r].totalDuration+=o,t[r].calls++});let i=[];for(let r in t){let o=t[r];o.averageDuration=o.totalDuration/o.calls,i.push({functionName:r,data:o})}i.sort((r,o)=>o.data.totalDuration-r.data.totalDuration),i=i.slice(0,3),i.forEach(r=>{B.log(e,`${r.functionName}: ${r.data.calls} calls, ${r.data.totalDuration.toFixed(2)}ms`)})}},bl=C_});var Vn,qm=_(()=>{Ue();Vn=class extends dt{constructor(e=800,t=600,i){super();this._maxTextureSize=null;this._options=N(D({debug:!1,transparent:!1,clearColor:S.TRANSPARENT},i),{pixelRatio:1}),this.setMaxListeners(0),this._width=e,this._height=t,this._dimensions=new z(this._width,this._height),this._maxTextureSize=null,this._pixelRatio=this._options.pixelRatio,this._canvas=this._options.canvas,this._clearColor=this._options.transparent?S.TRANSPARENT:this._options.clearColor||S.BLACK}setCanvas(e){let t=this._canvas;this._canvas=e,t!==e&&(this._createContext(),this._onBeforeContext(),this._setupContext()),this.resizeTo(new z(this._width,this._height))}getCanvas(){return this._canvas}_onBeforeContext(){}resizeTo(e,t=!0){this._width=e.x*this._pixelRatio,this._height=e.y*this._pixelRatio,t&&this._canvas&&(this._canvas.width=this._width,this._canvas.height=this._height,"style"in this._canvas&&(this._canvas.style.width=`${this._width/this._pixelRatio}px`,this._canvas.style.height=`${this._height/this._pixelRatio}px`)),this._dimensions=e.clone()}_createContext(){B.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")}_setupContext(){B.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")}render(e){B.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")}getMaxDimensions(){return null}getContext(){return this._context}getWidth(){return this._dimensions.x}getHeight(){return this._dimensions.y}getDimensions(){return this._dimensions}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._defaultRenderTarget&&this._defaultRenderTarget.setPixelRatio(e)}getMaxTextureSize(){return this._maxTextureSize}getFilterManager(){return this._filterManager}setFilterManager(e){this._filterManager=e}isOfType(e){return this._type===e}dispose(){B.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")}}});var D_,Km,So,k_=_(()=>{pl();Ue();yl();Un();Hm();di();qm();({RendererType:D_}=bt),Km=class extends Vn{constructor(e=800,t=600,i){super(e,t,D({},i));this.id=0;this.setCanvas((i==null?void 0:i.canvas)||$e.createCanvas()),this._type=D_.CANVAS}_createContext(){let t=this._canvas.getContext("2d");if(!!t)return this._options.debug&&(t=new bl(t)),this.id=Km.contextId++,this._context=t,this.emit("context",t),t}_setupContext(){let e=this._context;"imageSmoothingEnabled"in e?e.imageSmoothingEnabled=!0:["moz","webkit","ms"].forEach(t=>{e[t]&&(e[t]=!0)}),this._defaultRenderTarget=new Gi(this._width,this._height,this._pixelRatio,this._canvas,this._context),this.setRenderTarget(this._defaultRenderTarget),this._filterManager=new ss(this)}render(e){let t=this._renderTarget.getContext(),i=e.getParent();e.setParent(new rs),e.updateTransform(),i&&e.setParent(i),t.setTransform(1,0,0,1,0,0),t.globalAlpha=1;let{width:r,height:o}=this._canvas;t.clearRect(0,0,r,o),this._clearColor.a!==0&&(t.save(),t.fillStyle=this._clearColor.toRGBA(),t.fillRect(0,0,r,o),t.restore()),this.renderDisplayObject(e,this._renderTarget)}renderDisplayObject(e,t){let i=this._renderTarget;this._filterManager.setFilterStack(t.getFilterStack()),this.setRenderTarget(t),e.renderCanvas(this),this.setRenderTarget(i)}getCurrentRenderTarget(){return this._renderTarget}setRenderTarget(e){this._renderTarget=e}getContext(){return this._renderTarget.getContext()}dispose(){this._filterManager.dispose()}},So=Km;So.contextId=0,So.type=D_.CANVAS});var T_,R_=_(()=>{T_=s=>{if(typeof window!="undefined"){let{WebGLDebugUtils:e}=window;if(e){let t=(i,r)=>{console.error(`gl.${i}(${e.glFunctionArgsToString(i,r)})`)};s=e.makeDebugContext(s,null,t)}}return s}});var Xm,E_=_(()=>{Xm=class{constructor(e){this.vertices=new Float32Array([0,0,100,0,100,100,0,100]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.indices=new Uint16Array([0,1,2,0,3,2]);this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);this.vertexBuffer=null;this.indexBuffer=null;this.gl=e,this.initBuffers(),this.uploadBuffers()}map(e,t){let{x:i,y:r}=t;this.uvs[2]=t.width/e.width,this.uvs[4]=this.uvs[2],this.uvs[5]=t.height/e.height,this.uvs[7]=this.uvs[5],this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+t.width,this.vertices[3]=r,this.vertices[4]=this.vertices[2],this.vertices[5]=r+t.height,this.vertices[6]=i,this.vertices[7]=this.vertices[5],this.uploadBuffers()}getVertexBuffer(){return this.vertexBuffer}getIndexBuffer(){return this.indexBuffer}dispose(){this.cleanBuffer()}initBuffers(){let{gl:e}=this;this.cleanBuffer(),this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,(8+8+16)*4,e.DYNAMIC_DRAW),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)}uploadBuffers(){let{gl:e}=this;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices),e.bufferSubData(e.ARRAY_BUFFER,8*4,this.uvs),e.bufferSubData(e.ARRAY_BUFFER,(8+8)*4,this.colors)}cleanBuffer(){let{gl:e}=this;e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer)}}});var Wi,jn=_(()=>{Ue();Fo();Wi=class{constructor(e,t,i,r,o=!1){this._renderer=e,this._gl=e.getContext(),this._width=t,this._height=i,this._frame=null,this._pixelRatio=r,this._projectionMatrix=new vt,this._mipMapping=!1,this._baseTexture=new Le;let n=this._baseTexture.getFrame();n.width=t,n.height=i,this._baseTexture.setPixelRatio(r),this._baseTexture.setLoaded(!0),this._framebuffer=null,this._isRoot=o,this._filterStack=[{renderTarget:this,filters:[]}],o||this._initFrameBuffer()}resizeTo(e){this._width=e.x|0,this._height=e.y|0,this._baseTexture.resizeTo(e),this._isRoot||this._resizeTexture(),this._baseTexture.setMinFilter(this._getMinFilter()),this._baseTexture.setMagFilter(this._getMagFilter()),this._calculateProjectionMatrix()}_getMinFilter(){let e=Le.DefaultMinFilter;return this._mipMapping&&(e=Le.TrilinearFilter),e}_getMagFilter(){return Le.DefaultMagFilter}_resizeTexture(){let e=this._gl,t=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this._renderer._options.debug&&ts.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e);let r=new z(this._width,this._height);E.isPowerOfTwo(r)?(B.info("WebGLRenderTarget","Mip-mapping enabled"),this._mipMapping=!0):this._mipMapping=!1,this._baseTexture.setMipMappingEnabled(this._mipMapping)}activate(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._calculateProjectionMatrix(),e.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),e.disable(e.STENCIL_TEST)}clear(e=S.TRANSPARENT){let t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),this._renderer._options.debug&&ts.checkFramebufferStatus("WebGLRenderTarget#clear",t),t.clearColor.apply(t,e.toGLColor()),t.clear(t.COLOR_BUFFER_BIT)}_calculateProjectionMatrix(){let e=this._projectionMatrix;e.reset();let t=this._frame||new ve(0,0,this._width,this._height),{x:i,y:r}=t;this._isRoot?(e.a=1/this._width*2,e.d=-1/this._height*2,e.tx=-1-i*e.a,e.ty=1-r*e.d):(e.a=1/this._width*2,e.d=1/this._height*2,e.tx=-1-i*e.a,e.ty=-1-r*e.d)}_initFrameBuffer(){let e=this._gl;this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._framebuffer=e.createFramebuffer(),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this.resizeTo(new z(this._width,this._height)),this._renderer._options.debug&&ts.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e)}getProjectionMatrix(){return this._projectionMatrix}getTexture(){return this._texture}getFrame(){return this._frame}setFrame(e){this._frame=e}getFilterStack(){return this._filterStack}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._isRoot||this._resizeTexture()}getBaseTexture(){return this._baseTexture}dispose(){let e=this._gl;this._baseTexture.dispose(),this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null)}}});var Hn,Ym=_(()=>{Ue();E_();di();jn();Hn=class{constructor(e){this._renderer=e,this._filterStack=[],this._currentFrame=null,this._renderTargets=[],this._textureFrame=new ve(0,0,e.getWidth(),e.getHeight()),this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._onContextChange()}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._renderTargets.forEach(t=>t.resizeTo(e))}getFilterStack(){return this._filterStack}setFilterStack(e){this._filterStack=e}_getOrCreateRenderTarget(e=!1){let t=this._renderTargets.pop();return t||(t=new Wi(this._renderer,this._textureFrame.width,this._textureFrame.height,1)),this._currentFrame&&t.setFrame(this._currentFrame),e&&t.clear(),t}pushFilters(e,t){let i=e.getBounds();this._currentFrame=i;let r=e.getFilterRectangle();r.width>0&&r.height>0&&(this._currentFrame=r);let o=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(o),o.clear(),this._filterStack.push({renderTarget:o,filters:t})}popFilters(){let e=this._filterStack.pop();if(!e)return;let{filters:t,renderTarget:i}=e,r=this._filterStack[this._filterStack.length-1],o=i,n=r.renderTarget,a=o.getFrame();a&&this._quad.map(this._textureFrame,a);let l=t[0].getShaderForRenderer(this._renderer),u=this._quad.getVertexBuffer(),c=this._quad.getIndexBuffer(),p=this._renderer.getContext();p.bindBuffer(p.ARRAY_BUFFER,u),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,c);let m=l.getAttributeLocations();return p.vertexAttribPointer(m.a_position,2,p.FLOAT,!1,0,0),p.vertexAttribPointer(m.a_texCoord,2,p.FLOAT,!1,0,2*4*4),p.vertexAttribPointer(m.a_color,4,p.FLOAT,!1,0,4*4*4),this._renderer.updateTexture(o.getBaseTexture(),!1),t.length===1?(t[0].apply(this._renderer,o,n),this._renderTargets.push(o)):this._applyFilters(t,o,n),t}_applyFilters(e,t,i){let r=t,o=this._getOrCreateRenderTarget(!0);this._renderer.updateTexture(o.getBaseTexture(),!1);let n=e[e.length-1];e.forEach(a=>{if(a===n)a.apply(this._renderer,r,i,!0);else{a.apply(this._renderer,r,o,!0);let u=r;r=o,o=u}}),this._renderTargets.push(r),this._renderTargets.push(o)}_onContextChange(){this._renderTargets.length=0,go(this._renderer)&&(this._quad&&this._quad.dispose(),this._quad=new Xm(this._renderer.getContext()))}dispose(){this._renderer.off("context",this._onContextChange),this._quad&&this._quad.dispose(),this._renderTargets.forEach(e=>{e.dispose()})}}});var F_=De((Rz,Jm)=>{var qn=function(){function s(c){return i.appendChild(c.dom),c}function e(c){for(var p=0;p<i.children.length;p++)i.children[p].style.display=p===c?"block":"none";t=c}var t=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(c){c.preventDefault(),e(++t%i.children.length)},!1);var r=(performance||Date).now(),o=r,n=0,a=s(new qn.Panel("FPS","#0ff","#002")),l=s(new qn.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=s(new qn.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:i,addPanel:s,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){n++;var c=(performance||Date).now();if(l.update(c-r,200),c>o+1e3&&(a.update(1e3*n/(c-o),100),o=c,n=0,u)){var p=performance.memory;u.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return c},update:function(){r=this.end()},domElement:i,setMode:e}};qn.Panel=function(s,e,t){var i=1/0,r=0,o=Math.round,n=o(window.devicePixelRatio||1),a=80*n,l=48*n,u=3*n,c=2*n,p=3*n,m=15*n,d=74*n,f=30*n,b=document.createElement("canvas");b.width=a,b.height=l,b.style.cssText="width:80px;height:48px";var y=b.getContext("2d");return y.font="bold "+9*n+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=t,y.fillRect(0,0,a,l),y.fillStyle=e,y.fillText(s,u,c),y.fillRect(p,m,d,f),y.fillStyle=t,y.globalAlpha=.9,y.fillRect(p,m,d,f),{dom:b,update:function(g,C){i=Math.min(i,g),r=Math.max(r,g),y.fillStyle=t,y.globalAlpha=1,y.fillRect(0,0,a,m),y.fillStyle=e,y.fillText(o(g)+" "+s+" ("+o(i)+"-"+o(r)+")",u,c),y.drawImage(b,p+n,m,d-n,f,p,m,d-n,f),y.fillRect(p+d-n,m,n,f),y.fillStyle=t,y.globalAlpha=.9,y.fillRect(p+d-n,m,n,o((1-g/C)*f))}}};typeof Jm=="object"&&(Jm.exports=qn)});var br,xl,S_=_(()=>{br=Ur(F_()),xl=class{constructor(e){this._context=e,this._domAvailable=typeof document!="undefined",this._hookIntoContext(),this._textures={},this._framebuffers={},this._programs={},this._shaders={},this._buffers={},this._boundTexture=null,this._id=0,this._enums={},this._setupStats(),this._createEnumMap(),this._updateMemoryStats=this._updateMemoryStats.bind(this),this._updateMemoryStats()}_createEnumMap(){for(let e in this._context){let t=this._context[e];typeof t=="number"&&(this._enums[t]=e)}}_enumValueToString(e){let t=this._enums[e];return typeof t=="undefined"?e:t}_setupStats(){!this._domAvailable||(this._stats=new br.default,this._stats.showPanel(3),this._memPanel=this._stats.addPanel(new br.default.Panel("MB [WebGL]","#43ADEB","#282828")),this._texPanel=this._stats.addPanel(new br.default.Panel("Textures","#43ADEB","#282828")),this._bufPanel=this._stats.addPanel(new br.default.Panel("Buffers","#43ADEB","#282828")),this._fboPanel=this._stats.addPanel(new br.default.Panel("FBOs","#43ADEB","#282828")),this._prgPanel=this._stats.addPanel(new br.default.Panel("Programs","#43ADEB","#282828")),this._shdPanel=this._stats.addPanel(new br.default.Panel("Shaders","#43ADEB","#282828")))}_updatePanel(e){if(!!this._domAvailable){switch(this._stats.begin(),e){case"tex":this._texPanel.update(this.getTexturesCount(),50);break;case"buf":this._bufPanel.update(this.getBuffersCount(),50);break;case"fbo":this._fboPanel.update(this.getFBOCount(),50);break;case"prg":this._prgPanel.update(this.getProgramCount(),50);break;case"shd":this._shdPanel.update(this.getShaderCount(),50);break}this._stats.end()}}getTexturesCount(){return Object.keys(this._textures).length}getBuffersCount(){return Object.keys(this._buffers).length}getFBOCount(){return Object.keys(this._framebuffers).length}getProgramCount(){return Object.keys(this._programs).length}getShaderCount(){return Object.keys(this._shaders).length}_updateMemoryStats(){if(!this._domAvailable)return;let e=this._getMemoryUsage()/1e3/1e3;this._memPanel.update(e,400),setTimeout(this._updateMemoryStats,1e3)}_getMemoryUsage(){let e=0;for(let t in this._textures)e+=this._textures[t].memory;for(let t in this._buffers)e+=this._buffers[t].memory;return e}_hookIntoContext(){for(let e in this._context)typeof this._context[e]=="function"?this[e]=function(...i){let r=this._context[e];return this._trackGLCall(r,e,i)}:this._makePropertyWrapper(e)}_makePropertyWrapper(e){if(["_context"].indexOf(e)!==-1)return;let i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}_trackGLCall(e,t,i){let r=["texImage2D","bindTexture","createTexture","deleteTexture","createBuffer","bindBuffer","bufferData","deleteBuffer","createFramebuffer","deleteFramebuffer","createProgram","deleteProgram","createShader","deleteShader"],o;r.indexOf(t)!==-1?o=this[`_${t}`](i):o=e.apply(this._context,i);let n=this._context.getError();if(n!==0){let a=i.join(", ");a.length>100&&(a=`${a.substr(0,100)}...`),console.error(new Error(`WebGL Error ${this._enumValueToString(n)} in ${t}(${a})`))}return o}_createProgram(){let e=this._context.createProgram();return e._wmmId=this._id++,this._programs[e._wmmId]=e,this._updatePanel("prg"),e}_deleteProgram([e]){!e||!this._programs[e._wmmId]||(delete this._programs[e._wmmId],this._context.deleteProgram(e),this._updatePanel("prg"))}_createShader([e]){let t=this._context.createShader(e);return t._wmmId=this._id++,this._shaders[t._wmmId]=t,this._updatePanel("shd"),t}_deleteShader([e]){!e||!this._shaders[e._wmmId]||(delete this._shaders[e._wmmId],this._context.deleteShader(e),this._updatePanel("shd"))}_createFramebuffer(){let e=this._context.createFramebuffer();return e._wmmId=this._id++,this._framebuffers[e._wmmId]=e,this._updatePanel("fbo"),e}_deleteFramebuffer([e]){!e||!this._framebuffers[e._wmmId]||(delete this._framebuffers[e._wmmId],this._context.deleteFramebuffer(e),this._updatePanel("fbo"))}_createBuffer(){let e=this._context.createBuffer();return e._wmmId=this._id++,this._buffers[e._wmmId]={buffer:e,memory:0},this._updatePanel("buf"),e}_bindBuffer([e,t]){this._context.bindBuffer(e,t),this._boundBuffer=t._wmmId}_bufferData([e,t,i]){this._context.bufferData(e,t,i);let r;typeof t=="number"?r=t:"byteLength"in t?r=t.byteLength:"length"in t&&(r=t.length),this._buffers[this._boundBuffer].memory=r}_deleteBuffer([e]){!e||!this._buffers[e._wmmId]||(delete this._buffers[e._wmmId],this._context.deleteBuffer(e),this._updatePanel("buf"))}_createTexture(){let e=this._context.createTexture();return e._wmmId=this._id++,this._textures[e._wmmId]={texture:e,memory:0},this._updatePanel("tex"),e}_deleteTexture([e]){!e||!this._textures[e._wmmId]||(delete this._textures[e._wmmId],this._context.deleteTexture(e),this._updatePanel("tex"))}_bindTexture([e,t]){this._context.bindTexture(e,t),this._boundTexture=t._wmmId}_texImage2D(e){let[,,t,i,r,o,,,n]=e;typeof n=="undefined"&&(n=o),this._context.texImage2D.apply(this._context,e);let a=this._calculateByteCountForTexture(t,i,r,n);this._textures[this._boundTexture].memory=a}_calculateByteCountForTexture(e,t,i,r){if(r!==null)if("width"in r)t=r.width,i=r.height;else return r.length;let o=1;switch(e){case this._context.ALPHA:o=1;break;case this._context.RGB:o=3;break;case this._context.RGBA:o=4;break}return t*i*o}}});var Kn,$m=_(()=>{Kn=class{constructor(e){this._renderer=e,this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange)}_onContextChange(){}start(){}stop(){this.flush()}flush(){}dispose(){this._renderer.off("context",this._onContextChange),delete this._renderer}}});var Zm,O_=_(()=>{Ue();$m();Zm=class extends Kn{constructor(e){super(e);this._vertexBuffer=null;this._indexBuffer=null;this._maxBatchSize=Do,this._vertices=new ArrayBuffer(Do*4*gr),this._positions=new Float32Array(this._vertices),this._colors=new Uint32Array(this._vertices),this._indices=new Uint16Array(Do*6);for(let t=0,i=0;t<Do*6;t+=6,i+=4)this._indices[t+0]=i+0,this._indices[t+1]=i+1,this._indices[t+2]=i+2,this._indices[t+3]=i+0,this._indices[t+4]=i+2,this._indices[t+5]=i+3;this._sprites=[],this._currentBatchSize=0,this._onContextChange()}render(e){let t=e.getTexture();if(!t)return;let i=t.getFrame(),r=t.getBaseTexture();this._currentBatchSize>=this._maxBatchSize&&this.flush();let o=t.getUVs();if(!o)return;let n=this._currentBatchSize*gr;this._addVertexCoordinates(e,n,i),this._addTextureUVs(e,n,o),this._addColors(e,n),this._sprites[this._currentBatchSize]=e,this._currentBatchSize++}_addColors(e,t){let i=this._colors,r=16777215,o=(r>>16)+(r&65280)+((r&255)<<16)+(e.getWorldAlpha()*255<<24);i[t+4]=i[t+9]=i[t+14]=i[t+19]=o}_addTextureUVs(e,t,i){let r=this._positions,[o,n,a,l]=i;r[t+2]=o.x,r[t+3]=o.y,r[t+7]=n.x,r[t+8]=n.y,r[t+12]=a.x,r[t+13]=a.y,r[t+17]=l.x,r[t+18]=l.y}_addVertexCoordinates(e,t,i){let r=this._positions,o=e.getWorldTransform(),n=e.getAnchor(),a=o.rectangleToCoordinates(i,n),l=5;for(let u=0;u<4;u++)r[t+u*l]=a[u].x,r[t+u*l+1]=a[u].y}_onContextChange(){let e=this._renderer.getContext();this._shader=this._renderer.shaders.default,this._vertexBuffer&&(this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer=null),this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW)}start(){this._vertexBuffer&&this._indexBuffer&&this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)}flush(){var m;let e=this._renderer,t=e.getContext();if(this._currentBatchSize===0)return;if(this._currentBatchSize>Do*.5)t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices);else{let d=this._positions.subarray(0,this._currentBatchSize*gr);t.bufferSubData(t.ARRAY_BUFFER,0,d)}let i=0,r=null,o=null,n=null,a=null,l=!1,u=!1,c=null,p=0;for(let d=0,f=this._currentBatchSize;d<f;d++){if(c=this._sprites[d],o=(m=c.getTexture())==null?void 0:m.getBaseTexture(),a=c.getShader()||this._shader,l=n!==a,u=r!==o,(u||l)&&(r&&this._renderBatch(r,i,p),p=d,i=0,r=o,l)){n=a,e.setShader(n);let y=e.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",y),n.syncUniforms(),t.activeTexture(t.TEXTURE0)}i++}r&&this._renderBatch(r,i,p),this._currentBatchSize=0,this._sprites=[]}_renderBatch(e,t,i){if(t===0)return;let r=this._renderer,o=r.getContext(),n=e.getGLTextureForRenderer(r);n||(n=r.getOrCreateGLTexture(e)),e.isDirty()&&(r.updateTexture(e),e.setDirty(!1)),o.activeTexture(o.TEXTURE0+e.getGLUnit()),o.bindTexture(o.TEXTURE_2D,n);let a=t*6,l=i*6*2;o.drawElements(o.TRIANGLES,a,o.UNSIGNED_SHORT,l)}dispose(){let t=this._renderer.getContext();this._sprites.forEach(i=>{i.dispose()}),this._vertexBuffer&&(t.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(t.deleteBuffer(this._indexBuffer),this._indexBuffer=null),delete this._vertices,delete this._positions,delete this._colors,delete this._indices,super.dispose()}}});var Qm,vl,A_=_(()=>{R_();Ot();pl();Ue();Ym();Um();Hm();di();jn();S_();qm();$m();O_();Qm=class extends Vn{constructor(e=800,t=600,i){super(e,t,i);this.type=K.WEBGL;this.maxTextureDimensions=null;this._type=K.WEBGL,this._onContextLost=this._onContextLost.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.setCanvas(this._options.canvas||$e.createCanvas()),this.shaders={default:new Nm(this,void 0,void 0)},this.renderers={sprite:new Zm(this)}}_onContextLost(e){e.preventDefault(),B.warn(this.constructor.name,"WebGL context has been lost - trying to restore."),this.emit("context-lost")}_onContextCreationError(e){e.preventDefault(),B.warn(this.constructor.name,`Failed to create WebGL context: ${e.statusMessage||"Unknown error"}`)}_onContextRestored(){B.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures."),this._createContext(),this._setupContext(),this.emit("context-restored")}_onBeforeContext(){this._filterManager&&this._filterManager.dispose(),this._filterManager=new Hn(this),this._currentObjectRenderer=new Kn(this)}setShader(e){this._currentShader=e,this._context.useProgram(e.getProgram()),this._setAttributesForShader(e)}setCanvas(e){this._canvas&&this._removeContextEventListeners(),super.setCanvas(e),this._addContextEventListeners()}_addContextEventListeners(){km(this._canvas)&&(this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError))}_removeContextEventListeners(){km(this._canvas)&&(this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError))}_setAttributesForShader(e){if(!this._canvas)return;let t=this._context,i=e.getAttributes(),r=e.getAttributeLocations();i.forEach(o=>{let n=r[o];t.enableVertexAttribArray(n)})}_createContext(){if(!this._canvas)return;let e=$e.glGet(this._canvas);return this._options.debug&&T_(e),this._options.debug&&(e=new bl(e),e=new xl(e)),this.id=Qm.contextId++,this._context=e,this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.emit("context",e),e}_setupContext(){let e=this._context;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._defaultRenderTarget=new Wi(this,this._width,this._height,this._pixelRatio,!0),this.setRenderTarget(this._defaultRenderTarget),this._getMaxPrecision()}getContext(){return this._context}_getMaxPrecision(){let e=this._context,t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);this._maxFloatPrecision=(t==null?void 0:t.precision)!==0?Ut.High:Ut.Medium;let i=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT);this._maxIntPrecision=(i==null?void 0:i.rangeMax)!==0?Ut.High:Ut.Low}resizeTo(e,t=!0){super.resizeTo(e,t),this._currentRenderTarget&&this._currentRenderTarget.resizeTo(e),this._context=$e.glResize(this._context,e)}setRenderTarget(e=this._defaultRenderTarget){this._currentRenderTarget=e,this._currentRenderTarget.activate()}setObjectRenderer(e){this._currentObjectRenderer.stop(),this._currentObjectRenderer=e,this._currentObjectRenderer.start()}render(e){this.setRenderTarget(this._defaultRenderTarget),this._defaultRenderTarget.clear(this._clearColor);let t=e.getParent();e.setParent(new rs),e.updateTransform(),t&&e.setParent(t),this.renderDisplayObject(e,this._defaultRenderTarget)}renderDisplayObject(e,t){this.setRenderTarget(t),this._filterManager.setFilterStack(t.getFilterStack()),e.renderWebGL(this),this._currentObjectRenderer.flush()}clear(){let e=this._context;e.clearColor.apply(e,this._clearColor.toGLColor),e.clear(e.COLOR_BUFFER_BIT)}save(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}}restore(e){this.setRenderTarget(e.renderTarget),this._filterManager.setFilterStack(e.filterStack),this._currentObjectRenderer=e.objectRenderer}getOrCreateGLTexture(e){let t=this._context,i=e.getGLTextureForRenderer(this);return i||(i=t.createTexture(),e.setGLTextureForRenderer(i,this)),i}updateTexture(e,t=!0){let i=e.getSource(),r=this._context,o=e.getGLUnit(),n=this.getOrCreateGLTexture(e);r.activeTexture(r.TEXTURE0+o),r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t&&i&&$e.glTexImage(r,i),e.isMipMappingEnabled()?r.generateMipmap(r.TEXTURE_2D):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e.getGLRepeat(r,"x")),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e.getGLRepeat(r,"y"))),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e.getGLFilter(r,"min")),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e.getGLFilter(r,"mag")),r.activeTexture(r.TEXTURE0)}getMaxDimensions(){return this.maxTextureDimensions||(this.maxTextureDimensions=$e.glMaxTexture(this._context)),this.maxTextureDimensions}getCurrentRenderTarget(){return this._currentRenderTarget}getCurrentObjectRenderer(){return this._currentObjectRenderer}getMaxFloatPrecision(){return this._maxFloatPrecision}getMaxIntPrecision(){return this._maxIntPrecision}dispose(){this._filterManager.dispose(),this._currentObjectRenderer.dispose(),this._defaultRenderTarget.dispose();for(let i in this.shaders)this.shaders[i].dispose(),delete this.shaders[i];this._removeContextEventListeners();let t=this._context.getExtension("WEBGL_lose_context");t&&t.loseContext()}},vl=Qm;vl.contextId=0});var RT,ET,ed,I_=_(()=>{Ni();RT=()=>[new z(0,0),new z(1,0),new z(1,1),new z(0,1)],ET=(s,e,t)=>{let[i,r,o,n]=s;return i.x=e.x/t.width,i.y=e.y/t.height,r.x=(e.x+e.width)/t.width,r.y=e.y/t.height,o.x=(e.x+e.width)/t.width,o.y=(e.y+e.height)/t.height,n.x=e.x/t.width,n.y=(e.y+e.height)/t.height,s},ed={create:RT,updateViaFrames:ET}});var xr,td=_(()=>{I_();Ue();Fo();xr=class extends dt{constructor(e,t){super();if(!(e instanceof Le))throw new Error("`baseTexture` should be an instance of BaseTexture");this._uvs=ed.create(),this._frame=t?t.clone():new ve(0,0,1,1),this._frameLocked=Boolean(t),this._onBaseTextureLoaded=this._onBaseTextureLoaded.bind(this),this._onBaseTextureUpdated=this._onBaseTextureUpdated.bind(this),this.setBaseTexture(e)}static fromImage(e){let t=new Le(e);return new xr(t)}static fromCanvas(e){let t=new Le(e);return new xr(t)}_onBaseTextureLoaded(){if(!this._frameLocked){let e=this._baseTexture.getFrame().clone();this.setFrame(e)}this._baseTexture.on("update",this._onBaseTextureUpdated)}_onBaseTextureUpdated(){let{width:e,height:t}=this._baseTexture.getFrame();this._frame.width=e,this._frame.height=t,this.emit("update")}_updateUVs(){this._uvs=ed.updateViaFrames(this._uvs,this._frame,this._baseTexture.getFrame())}getBaseTexture(){return this._baseTexture}setBaseTexture(e){if(this._baseTexture=e,!this._baseTexture.isLoaded())this._baseTexture.once("loaded",this._onBaseTextureLoaded);else{let{width:t,height:i}=e.getFrame();this._frameLocked||(this._frame=new ve(0,0,t,i)),this._onBaseTextureLoaded()}}getFrame(){return this._frame}setFrame(e){this._frame=e,this._updateUVs()}getWidth(){return this._frame.width}getHeight(){return this._frame.height}getUVs(){return this._uvs}getDimensions(){return new z(this._frame.width,this._frame.height)}dispose(e=!0){e&&this._baseTexture.dispose()}}});var Xn,Yn,id=_(()=>{Ot();Ue();yl();Ym();Un();jn();Fo();td();Xn=s=>s._type===K.WEBGL,Yn=class extends xr{constructor(e,t=100,i=100,r=1){super(new Le,new ve(0,0,t,i));this._loaded=!0,this._width=t,this._height=i,this._pixelRatio=r,this._renderer=e,this._setupFilterManager(),this._setupBuffer(),this.setBaseTexture(this._renderTarget.getBaseTexture()),this._updateUVs()}_setupFilterManager(){this._filterManager&&this._filterManager.dispose(),Xn(this._renderer)?this._filterManager=new Hn(this._renderer):this._filterManager=new ss(this._renderer),this._filterManager.resizeTo(new z(this._width,this._height))}_setupBuffer(){this._renderTarget&&this._renderTarget.dispose(),Xn(this._renderer)?this._renderTarget=new Wi(this._renderer,this._width,this._height,this._pixelRatio):this._renderTarget=new Gi(this._width,this._height,this._pixelRatio)}clear(e){this._renderTarget.clear(e)}resizeTo(e){this._width===e.x&&this._height===e.y||(this._width=e.x,this._height=e.y,this._frame.width=e.x,this._frame.height=e.y,this._renderTarget.resizeTo(e),this._filterManager.resizeTo(e))}render(e){Xn(this._renderer)?this._renderWebGL(e):this._renderCanvas(e)}_renderWebGL(e){if(!Xn(this._renderer))return;this._renderTarget.activate(),e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});let t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}_renderCanvas(e){if(Xn(this._renderer))return;e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});let t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}getRenderTarget(){return this._renderTarget}dispose(){this._renderTarget.dispose(),this._filterManager.dispose(),super.dispose()}}});var Oo,Vi,Jn=_(()=>{Oo={EXPORT:"export",CLOSE:"close",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",EDITOR_READY:"editor:ready",WINDOW_RESIZE:"window:resize",ZOOM_DONE:"editor:zoom_done",HISTORY_UNDO:"history:undo",HISTORY_UPDATED:"history:update",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"},Vi={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_duotone",defaultName:"DuoTone",assetFileName:"duotone",filters:[{identifier:"imgly_duotone_desert",defaultName:"Desert",lightColor:"#e1de9a",darkColor:"#cb2129"},{identifier:"imgly_duotone_peach",defaultName:"Peach",lightColor:"#e9abb8",darkColor:"#0040ff"},{identifier:"imgly_duotone_clash",defaultName:"Clash",lightColor:"#f41a0f",darkColor:"#23007c"},{identifier:"imgly_duotone_plum",defaultName:"Plum",lightColor:"#74d7ff",darkColor:"#23007c"},{identifier:"imgly_duotone_breezy",defaultName:"Breezy",lightColor:"#68fdff",darkColor:"#c20000"},{identifier:"imgly_duotone_deepblue",defaultName:"Deep Blue",lightColor:"#2de9eb",darkColor:"#58007c"},{identifier:"imgly_duotone_frog",defaultName:"Frog",lightColor:"#5bff60",darkColor:"#7f23a9"},{identifier:"imgly_duotone_sunset",defaultName:"Sunset",lightColor:"#f8ea46",darkColor:"#c400be"}]},{identifier:"imgly_filters_bw",assetFileName:"b&w",defaultName:"Black & White",filters:[{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"Greyed",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"Dusty",lutImage:"filters/imgly_lut_dusty_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia",lutImage:"filters/imgly_lut_sepia_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Weathered",lutImage:"filters/imgly_lut_weathered_5_5_128.png"},{identifier:"imgly_lut_sin",defaultName:"Hard Stuff",lutImage:"filters/imgly_lut_hard_stuff_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filters_retro",assetFileName:"vintage",defaultName:"Vintage",filters:[{identifier:"imgly_lut_blues",defaultName:"Polaroid",lutImage:"filters/imgly_lut_polaroid_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Sunny 70s",lutImage:"filters/imgly_lut_sunny_70s_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",defaultName:"Oldtimer",lutImage:"filters/imgly_lut_oldtimer_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",defaultName:"Inferno",lutImage:"filters/imgly_lut_inferno_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",defaultName:"Snappy",lutImage:"filters/imgly_lut_snappy_5_5_128.png"}]},{identifier:"imgly_filters_analog",assetFileName:"smooth",defaultName:"Smooth",filters:[{identifier:"imgly_lut_chest",defaultName:"Chestnut",lutImage:"filters/imgly_lut_chestnut_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",defaultName:"Softly",lutImage:"filters/imgly_lut_softly_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"Pebble",lutImage:"filters/imgly_lut_pebble_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Moss",lutImage:"filters/imgly_lut_moss_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lemon",lutImage:"filters/imgly_lut_lemon_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Green Gap",lutImage:"filters/imgly_lut_green_gap_5_5_128.png"}]},{identifier:"imgly_filters_winter",assetFileName:"cold",defaultName:"Cold",filters:[{identifier:"imgly_lut_elder",defaultName:"Colla",lutImage:"filters/imgly_lut_colla_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Solanus",lutImage:"filters/imgly_lut_solanus_5_5_128.png"},{identifier:"imgly_lut_bleached",defaultName:"Kalmen",lutImage:"filters/imgly_lut_kalmen_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Joran",lutImage:"filters/imgly_lut_joran_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Levante",lutImage:"filters/imgly_lut_levante_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Zephyr",lutImage:"filters/imgly_lut_zephyr_5_5_128.png"}]},{identifier:"imgly_filters_summer",assetFileName:"warm",defaultName:"Warm",filters:[{identifier:"imgly_lut_sunset",defaultName:"Golden",lutImage:"filters/imgly_lut_golden_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Low Fire",lutImage:"filters/imgly_lut_low_fire_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Sunrise",lutImage:"filters/imgly_lut_sunrise_5_5_128.png"},{identifier:"imgly_lut_k2",defaultName:"Flat Black",lutImage:"filters/imgly_lut_flat_black_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",defaultName:"Pumpkin",lutImage:"filters/imgly_lut_pumpkin_5_5_128.png"}]},{identifier:"imgly_filters_legacy",defaultName:"Legacy",assetFileName:"legacy",filters:[{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"Hicon",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_lomo",defaultName:"Lomo",lutImage:"filters/imgly_lut_lomo_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}}});function I(s,e,t){s!=null&&(typeof s=="number"?this.fromNumber(s,e,t):e==null&&typeof s!="string"?this.fromString(s,256):this.fromString(s,e))}function me(){return new I(null)}function ST(s,e,t,i,r,o){for(;--o>=0;){var n=e*this[s++]+t[i]+r;r=Math.floor(n/67108864),t[i++]=n&67108863}return r}function OT(s,e,t,i,r,o){for(var n=e&32767,a=e>>15;--o>=0;){var l=this[s]&32767,u=this[s++]>>15,c=a*l+u*n;l=n*l+((c&32767)<<15)+t[i]+(r&1073741823),r=(l>>>30)+(c>>>15)+a*u+(r>>>30),t[i++]=l&1073741823}return r}function AT(s,e,t,i,r,o){for(var n=e&16383,a=e>>14;--o>=0;){var l=this[s]&16383,u=this[s++]>>14,c=a*l+u*n;l=n*l+((c&16383)<<14)+t[i]+r,r=(l>>28)+(c>>14)+a*u,t[i++]=l&268435455}return r}function M_(s){return IT.charAt(s)}function B_(s,e){var t=wl[s.charCodeAt(e)];return t==null?-1:t}function PT(s){for(var e=this.t-1;e>=0;--e)s[e]=this[e];s.t=this.t,s.s=this.s}function MT(s){this.t=1,this.s=s<0?-1:0,s>0?this[0]=s:s<-1?this[0]=s+this.DV:this.t=0}function wr(s){var e=me();return e.fromInt(s),e}function BT(s,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(s,e);return}this.t=0,this.s=0;for(var i=s.length,r=!1,o=0;--i>=0;){var n=t==8?s[i]&255:B_(s,i);if(n<0){s.charAt(i)=="-"&&(r=!0);continue}r=!1,o==0?this[this.t++]=n:o+t>this.DB?(this[this.t-1]|=(n&(1<<this.DB-o)-1)<<o,this[this.t++]=n>>this.DB-o):this[this.t-1]|=n<<o,o+=t,o>=this.DB&&(o-=this.DB)}t==8&&(s[0]&128)!=0&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),r&&I.ZERO.subTo(this,this)}function LT(){for(var s=this.s&this.DM;this.t>0&&this[this.t-1]==s;)--this.t}function zT(s){if(this.s<0)return"-"+this.negate().toString(s);var e;if(s==16)e=4;else if(s==8)e=3;else if(s==2)e=1;else if(s==32)e=5;else if(s==4)e=2;else return this.toRadix(s);var t=(1<<e)-1,i,r=!1,o="",n=this.t,a=this.DB-n*this.DB%e;if(n-- >0)for(a<this.DB&&(i=this[n]>>a)>0&&(r=!0,o=M_(i));n>=0;)a<e?(i=(this[n]&(1<<a)-1)<<e-a,i|=this[--n]>>(a+=this.DB-e)):(i=this[n]>>(a-=e)&t,a<=0&&(a+=this.DB,--n)),i>0&&(r=!0),r&&(o+=M_(i));return r?o:"0"}function NT(){var s=me();return I.ZERO.subTo(this,s),s}function UT(){return this.s<0?this.negate():this}function GT(s){var e=this.s-s.s;if(e!=0)return e;var t=this.t;if(e=t-s.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this[t]-s[t])!=0)return e;return 0}function Cl(s){var e=1,t;return(t=s>>>16)!=0&&(s=t,e+=16),(t=s>>8)!=0&&(s=t,e+=8),(t=s>>4)!=0&&(s=t,e+=4),(t=s>>2)!=0&&(s=t,e+=2),(t=s>>1)!=0&&(s=t,e+=1),e}function WT(){return this.t<=0?0:this.DB*(this.t-1)+Cl(this[this.t-1]^this.s&this.DM)}function VT(s,e){var t;for(t=this.t-1;t>=0;--t)e[t+s]=this[t];for(t=s-1;t>=0;--t)e[t]=0;e.t=this.t+s,e.s=this.s}function jT(s,e){for(var t=s;t<this.t;++t)e[t-s]=this[t];e.t=Math.max(this.t-s,0),e.s=this.s}function HT(s,e){var t=s%this.DB,i=this.DB-t,r=(1<<i)-1,o=Math.floor(s/this.DB),n=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e[a+o+1]=this[a]>>i|n,n=(this[a]&r)<<t;for(a=o-1;a>=0;--a)e[a]=0;e[o]=n,e.t=this.t+o+1,e.s=this.s,e.clamp()}function qT(s,e){e.s=this.s;var t=Math.floor(s/this.DB);if(t>=this.t){e.t=0;return}var i=s%this.DB,r=this.DB-i,o=(1<<i)-1;e[0]=this[t]>>i;for(var n=t+1;n<this.t;++n)e[n-t-1]|=(this[n]&o)<<r,e[n-t]=this[n]>>i;i>0&&(e[this.t-t-1]|=(this.s&o)<<r),e.t=this.t-t,e.clamp()}function KT(s,e){for(var t=0,i=0,r=Math.min(s.t,this.t);t<r;)i+=this[t]-s[t],e[t++]=i&this.DM,i>>=this.DB;if(s.t<this.t){for(i-=s.s;t<this.t;)i+=this[t],e[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<s.t;)i-=s[t],e[t++]=i&this.DM,i>>=this.DB;i-=s.s}e.s=i<0?-1:0,i<-1?e[t++]=this.DV+i:i>0&&(e[t++]=i),e.t=t,e.clamp()}function XT(s,e){var t=this.abs(),i=s.abs(),r=t.t;for(e.t=r+i.t;--r>=0;)e[r]=0;for(r=0;r<i.t;++r)e[r+t.t]=t.am(0,i[r],e,r,0,t.t);e.s=0,e.clamp(),this.s!=s.s&&I.ZERO.subTo(e,e)}function YT(s){for(var e=this.abs(),t=s.t=2*e.t;--t>=0;)s[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e[t],s,2*t,0,1);(s[t+e.t]+=e.am(t+1,2*e[t],s,2*t+1,i,e.t-t-1))>=e.DV&&(s[t+e.t]-=e.DV,s[t+e.t+1]=1)}s.t>0&&(s[s.t-1]+=e.am(t,e[t],s,2*t,0,1)),s.s=0,s.clamp()}function JT(s,e,t){var i=s.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=me());var o=me(),n=this.s,a=s.s,l=this.DB-Cl(i[i.t-1]);l>0?(i.lShiftTo(l,o),r.lShiftTo(l,t)):(i.copyTo(o),r.copyTo(t));var u=o.t,c=o[u-1];if(c!=0){var p=c*(1<<this.F1)+(u>1?o[u-2]>>this.F2:0),m=this.FV/p,d=(1<<this.F1)/p,f=1<<this.F2,b=t.t,y=b-u,g=e==null?me():e;for(o.dlShiftTo(y,g),t.compareTo(g)>=0&&(t[t.t++]=1,t.subTo(g,t)),I.ONE.dlShiftTo(u,g),g.subTo(o,o);o.t<u;)o[o.t++]=0;for(;--y>=0;){var C=t[--b]==c?this.DM:Math.floor(t[b]*m+(t[b-1]+f)*d);if((t[b]+=o.am(0,C,t,y,0,u))<C)for(o.dlShiftTo(y,g),t.subTo(g,t);t[b]<--C;)t.subTo(g,t)}e!=null&&(t.drShiftTo(u,e),n!=a&&I.ZERO.subTo(e,e)),t.t=u,t.clamp(),l>0&&t.rShiftTo(l,t),n<0&&I.ZERO.subTo(t,t)}}}function $T(s){var e=me();return this.abs().divRemTo(s,null,e),this.s<0&&e.compareTo(I.ZERO)>0&&s.subTo(e,e),e}function os(s){this.m=s}function ZT(s){return s.s<0||s.compareTo(this.m)>=0?s.mod(this.m):s}function QT(s){return s}function eR(s){s.divRemTo(this.m,null,s)}function tR(s,e,t){s.multiplyTo(e,t),this.reduce(t)}function iR(s,e){s.squareTo(e),this.reduce(e)}function rR(){if(this.t<1)return 0;var s=this[0];if((s&1)==0)return 0;var e=s&3;return e=e*(2-(s&15)*e)&15,e=e*(2-(s&255)*e)&255,e=e*(2-((s&65535)*e&65535))&65535,e=e*(2-s*e%this.DV)%this.DV,e>0?this.DV-e:-e}function ns(s){this.m=s,this.mp=s.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<s.DB-15)-1,this.mt2=2*s.t}function sR(s){var e=me();return s.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),s.s<0&&e.compareTo(I.ZERO)>0&&this.m.subTo(e,e),e}function oR(s){var e=me();return s.copyTo(e),this.reduce(e),e}function nR(s){for(;s.t<=this.mt2;)s[s.t++]=0;for(var e=0;e<this.m.t;++e){var t=s[e]&32767,i=t*this.mpl+((t*this.mph+(s[e]>>15)*this.mpl&this.um)<<15)&s.DM;for(t=e+this.m.t,s[t]+=this.m.am(0,i,s,e,0,this.m.t);s[t]>=s.DV;)s[t]-=s.DV,s[++t]++}s.clamp(),s.drShiftTo(this.m.t,s),s.compareTo(this.m)>=0&&s.subTo(this.m,s)}function aR(s,e){s.squareTo(e),this.reduce(e)}function lR(s,e,t){s.multiplyTo(e,t),this.reduce(t)}function uR(){return(this.t>0?this[0]&1:this.s)==0}function cR(s,e){if(s>4294967295||s<1)return I.ONE;var t=me(),i=me(),r=e.convert(this),o=Cl(s)-1;for(r.copyTo(t);--o>=0;)if(e.sqrTo(t,i),(s&1<<o)>0)e.mulTo(i,r,t);else{var n=t;t=i,i=n}return e.revert(t)}function mR(s,e){var t;return s<256||e.isEven()?t=new os(e):t=new ns(e),this.exp(s,t)}function dR(){var s=me();return this.copyTo(s),s}function hR(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function pR(){return this.t==0?this.s:this[0]<<24>>24}function fR(){return this.t==0?this.s:this[0]<<16>>16}function gR(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function _R(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function yR(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var e=this.chunkSize(s),t=Math.pow(s,e),i=wr(t),r=me(),o=me(),n="";for(this.divRemTo(i,r,o);r.signum()>0;)n=(t+o.intValue()).toString(s).substr(1)+n,r.divRemTo(i,r,o);return o.intValue().toString(s)+n}function bR(s,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),r=!1,o=0,n=0,a=0;a<s.length;++a){var l=B_(s,a);if(l<0){s.charAt(a)=="-"&&this.signum()==0&&(r=!0);continue}n=e*n+l,++o>=t&&(this.dMultiply(i),this.dAddOffset(n,0),o=0,n=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(n,0)),r&&I.ZERO.subTo(this,this)}function xR(s,e,t){if(typeof e=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,t),this.testBit(s-1)||this.bitwiseTo(I.ONE.shiftLeft(s-1),od,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(I.ONE.shiftLeft(s-1),this);else{var i=new Array,r=s&7;i.length=(s>>3)+1,e.nextBytes(i),r>0?i[0]&=(1<<r)-1:i[0]=0,this.fromString(i,256)}}function vR(){var s=this.t,e=new Array;e[0]=this.s;var t=this.DB-s*this.DB%8,i,r=0;if(s-- >0)for(t<this.DB&&(i=this[s]>>t)!=(this.s&this.DM)>>t&&(e[r++]=i|this.s<<this.DB-t);s>=0;)t<8?(i=(this[s]&(1<<t)-1)<<8-t,i|=this[--s]>>(t+=this.DB-8)):(i=this[s]>>(t-=8)&255,t<=0&&(t+=this.DB,--s)),(i&128)!=0&&(i|=-256),r==0&&(this.s&128)!=(i&128)&&++r,(r>0||i!=this.s)&&(e[r++]=i);return e}function wR(s){return this.compareTo(s)==0}function CR(s){return this.compareTo(s)<0?this:s}function DR(s){return this.compareTo(s)>0?this:s}function kR(s,e,t){var i,r,o=Math.min(s.t,this.t);for(i=0;i<o;++i)t[i]=e(this[i],s[i]);if(s.t<this.t){for(r=s.s&this.DM,i=o;i<this.t;++i)t[i]=e(this[i],r);t.t=this.t}else{for(r=this.s&this.DM,i=o;i<s.t;++i)t[i]=e(r,s[i]);t.t=s.t}t.s=e(this.s,s.s),t.clamp()}function TR(s,e){return s&e}function RR(s){var e=me();return this.bitwiseTo(s,TR,e),e}function od(s,e){return s|e}function ER(s){var e=me();return this.bitwiseTo(s,od,e),e}function L_(s,e){return s^e}function FR(s){var e=me();return this.bitwiseTo(s,L_,e),e}function z_(s,e){return s&~e}function SR(s){var e=me();return this.bitwiseTo(s,z_,e),e}function OR(){for(var s=me(),e=0;e<this.t;++e)s[e]=this.DM&~this[e];return s.t=this.t,s.s=~this.s,s}function AR(s){var e=me();return s<0?this.rShiftTo(-s,e):this.lShiftTo(s,e),e}function IR(s){var e=me();return s<0?this.lShiftTo(-s,e):this.rShiftTo(s,e),e}function PR(s){if(s==0)return-1;var e=0;return(s&65535)==0&&(s>>=16,e+=16),(s&255)==0&&(s>>=8,e+=8),(s&15)==0&&(s>>=4,e+=4),(s&3)==0&&(s>>=2,e+=2),(s&1)==0&&++e,e}function MR(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+PR(this[s]);return this.s<0?this.t*this.DB:-1}function BR(s){for(var e=0;s!=0;)s&=s-1,++e;return e}function LR(){for(var s=0,e=this.s&this.DM,t=0;t<this.t;++t)s+=BR(this[t]^e);return s}function zR(s){var e=Math.floor(s/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<s%this.DB)!=0}function NR(s,e){var t=I.ONE.shiftLeft(s);return this.bitwiseTo(t,e,t),t}function UR(s){return this.changeBit(s,od)}function GR(s){return this.changeBit(s,z_)}function WR(s){return this.changeBit(s,L_)}function VR(s,e){for(var t=0,i=0,r=Math.min(s.t,this.t);t<r;)i+=this[t]+s[t],e[t++]=i&this.DM,i>>=this.DB;if(s.t<this.t){for(i+=s.s;t<this.t;)i+=this[t],e[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<s.t;)i+=s[t],e[t++]=i&this.DM,i>>=this.DB;i+=s.s}e.s=i<0?-1:0,i>0?e[t++]=i:i<-1&&(e[t++]=this.DV+i),e.t=t,e.clamp()}function jR(s){var e=me();return this.addTo(s,e),e}function HR(s){var e=me();return this.subTo(s,e),e}function qR(s){var e=me();return this.multiplyTo(s,e),e}function KR(){var s=me();return this.squareTo(s),s}function XR(s){var e=me();return this.divRemTo(s,e,null),e}function YR(s){var e=me();return this.divRemTo(s,null,e),e}function JR(s){var e=me(),t=me();return this.divRemTo(s,e,t),new Array(e,t)}function $R(s){this[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function ZR(s,e){if(s!=0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=s;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function $n(){}function N_(s){return s}function QR(s,e,t){s.multiplyTo(e,t)}function eE(s,e){s.squareTo(e)}function tE(s){return this.exp(s,new $n)}function iE(s,e,t){var i=Math.min(this.t+s.t,e);for(t.s=0,t.t=i;i>0;)t[--i]=0;var r;for(r=t.t-this.t;i<r;++i)t[i+this.t]=this.am(0,s[i],t,i,0,this.t);for(r=Math.min(s.t,e);i<r;++i)this.am(0,s[i],t,i,0,e-i);t.clamp()}function rE(s,e,t){--e;var i=t.t=this.t+s.t-e;for(t.s=0;--i>=0;)t[i]=0;for(i=Math.max(e-this.t,0);i<s.t;++i)t[this.t+i-e]=this.am(e-i,s[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function Io(s){this.r2=me(),this.q3=me(),I.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function sE(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var e=me();return s.copyTo(e),this.reduce(e),e}function oE(s){return s}function nE(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function aE(s,e){s.squareTo(e),this.reduce(e)}function lE(s,e,t){s.multiplyTo(e,t),this.reduce(t)}function uE(s,e){var t=s.bitLength(),i,r=wr(1),o;if(t<=0)return r;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?o=new os(e):e.isEven()?o=new Io(e):o=new ns(e);var n=new Array,a=3,l=i-1,u=(1<<i)-1;if(n[1]=o.convert(this),i>1){var c=me();for(o.sqrTo(n[1],c);a<=u;)n[a]=me(),o.mulTo(c,n[a-2],n[a]),a+=2}var p=s.t-1,m,d=!0,f=me(),b;for(t=Cl(s[p])-1;p>=0;){for(t>=l?m=s[p]>>t-l&u:(m=(s[p]&(1<<t+1)-1)<<l-t,p>0&&(m|=s[p-1]>>this.DB+t-l)),a=i;(m&1)==0;)m>>=1,--a;if((t-=a)<0&&(t+=this.DB,--p),d)n[m].copyTo(r),d=!1;else{for(;a>1;)o.sqrTo(r,f),o.sqrTo(f,r),a-=2;a>0?o.sqrTo(r,f):(b=r,r=f,f=b),o.mulTo(f,n[m],r)}for(;p>=0&&(s[p]&1<<t)==0;)o.sqrTo(r,f),b=r,r=f,f=b,--t<0&&(t=this.DB-1,--p)}return o.revert(r)}function cE(s){var e=this.s<0?this.negate():this.clone(),t=s.s<0?s.negate():s.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var r=e.getLowestSetBit(),o=t.getLowestSetBit();if(o<0)return e;for(r<o&&(o=r),o>0&&(e.rShiftTo(o,e),t.rShiftTo(o,t));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=t.getLowestSetBit())>0&&t.rShiftTo(r,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return o>0&&t.lShiftTo(o,t),t}function mE(s){if(s<=0)return 0;var e=this.DV%s,t=this.s<0?s-1:0;if(this.t>0)if(e==0)t=this[0]%s;else for(var i=this.t-1;i>=0;--i)t=(e*t+this[i])%s;return t}function dE(s){var e=s.isEven();if(this.isEven()&&e||s.signum()==0)return I.ZERO;for(var t=s.clone(),i=this.clone(),r=wr(1),o=wr(0),n=wr(0),a=wr(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!r.isEven()||!o.isEven())&&(r.addTo(this,r),o.subTo(s,o)),r.rShiftTo(1,r)):o.isEven()||o.subTo(s,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),e?((!n.isEven()||!a.isEven())&&(n.addTo(this,n),a.subTo(s,a)),n.rShiftTo(1,n)):a.isEven()||a.subTo(s,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&r.subTo(n,r),o.subTo(a,o)):(i.subTo(t,i),e&&n.subTo(r,n),a.subTo(o,a))}if(i.compareTo(I.ONE)!=0)return I.ZERO;if(a.compareTo(s)>=0)return a.subtract(s);if(a.signum()<0)a.addTo(s,a);else return a;return a.signum()<0?a.add(s):a}function pE(s){var e,t=this.abs();if(t.t==1&&t[0]<=pt[pt.length-1]){for(e=0;e<pt.length;++e)if(t[0]==pt[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<pt.length;){for(var i=pt[e],r=e+1;r<pt.length&&i<hE;)i*=pt[r++];for(i=t.modInt(i);e<r;)if(i%pt[e++]==0)return!1}return t.millerRabin(s)}function fE(s){var e=this.subtract(I.ONE),t=e.getLowestSetBit();if(t<=0)return!1;var i=e.shiftRight(t);s=s+1>>1,s>pt.length&&(s=pt.length);for(var r=me(),o=0;o<s;++o){r.fromInt(pt[Math.floor(Math.random()*pt.length)]);var n=r.modPow(i,this);if(n.compareTo(I.ONE)!=0&&n.compareTo(e)!=0){for(var a=1;a++<t&&n.compareTo(e)!=0;)if(n=n.modPowInt(2,this),n.compareTo(I.ONE)==0)return!1;if(n.compareTo(e)!=0)return!1}}return!0}var rd,vr,FT,P_,sd,IT,wl,Ao,Vt,pt,hE,U_,G_=_(()=>{rd={};rd=typeof window!="undefined"?window.navigator:{};FT=244837814094590,P_=(FT&16777215)==15715070;P_&&rd.appName=="Microsoft Internet Explorer"?(I.prototype.am=OT,vr=30):P_&&rd.appName!="Netscape"?(I.prototype.am=ST,vr=26):(I.prototype.am=AT,vr=28);I.prototype.DB=vr;I.prototype.DM=(1<<vr)-1;I.prototype.DV=1<<vr;sd=52;I.prototype.FV=Math.pow(2,sd);I.prototype.F1=sd-vr;I.prototype.F2=2*vr-sd;IT="0123456789abcdefghijklmnopqrstuvwxyz",wl=new Array;Ao="0".charCodeAt(0);for(Vt=0;Vt<=9;++Vt)wl[Ao++]=Vt;Ao="a".charCodeAt(0);for(Vt=10;Vt<36;++Vt)wl[Ao++]=Vt;Ao="A".charCodeAt(0);for(Vt=10;Vt<36;++Vt)wl[Ao++]=Vt;os.prototype.convert=ZT;os.prototype.revert=QT;os.prototype.reduce=eR;os.prototype.mulTo=tR;os.prototype.sqrTo=iR;ns.prototype.convert=sR;ns.prototype.revert=oR;ns.prototype.reduce=nR;ns.prototype.mulTo=lR;ns.prototype.sqrTo=aR;I.prototype.copyTo=PT;I.prototype.fromInt=MT;I.prototype.fromString=BT;I.prototype.clamp=LT;I.prototype.dlShiftTo=VT;I.prototype.drShiftTo=jT;I.prototype.lShiftTo=HT;I.prototype.rShiftTo=qT;I.prototype.subTo=KT;I.prototype.multiplyTo=XT;I.prototype.squareTo=YT;I.prototype.divRemTo=JT;I.prototype.invDigit=rR;I.prototype.isEven=uR;I.prototype.exp=cR;I.prototype.toString=zT;I.prototype.negate=NT;I.prototype.abs=UT;I.prototype.compareTo=GT;I.prototype.bitLength=WT;I.prototype.mod=$T;I.prototype.modPowInt=mR;I.ZERO=wr(0);I.ONE=wr(1);$n.prototype.convert=N_;$n.prototype.revert=N_;$n.prototype.mulTo=QR;$n.prototype.sqrTo=eE;Io.prototype.convert=sE;Io.prototype.revert=oE;Io.prototype.reduce=nE;Io.prototype.mulTo=lE;Io.prototype.sqrTo=aE;pt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],hE=(1<<26)/pt[pt.length-1];I.prototype.chunkSize=gR;I.prototype.toRadix=yR;I.prototype.fromRadix=bR;I.prototype.fromNumber=xR;I.prototype.bitwiseTo=kR;I.prototype.changeBit=NR;I.prototype.addTo=VR;I.prototype.dMultiply=$R;I.prototype.dAddOffset=ZR;I.prototype.multiplyLowerTo=iE;I.prototype.multiplyUpperTo=rE;I.prototype.modInt=mE;I.prototype.millerRabin=fE;I.prototype.clone=dR;I.prototype.intValue=hR;I.prototype.byteValue=pR;I.prototype.shortValue=fR;I.prototype.signum=_R;I.prototype.toByteArray=vR;I.prototype.equals=wR;I.prototype.min=CR;I.prototype.max=DR;I.prototype.and=RR;I.prototype.or=ER;I.prototype.xor=FR;I.prototype.andNot=SR;I.prototype.not=OR;I.prototype.shiftLeft=AR;I.prototype.shiftRight=IR;I.prototype.getLowestSetBit=MR;I.prototype.bitCount=LR;I.prototype.testBit=zR;I.prototype.setBit=UR;I.prototype.clearBit=GR;I.prototype.flipBit=WR;I.prototype.add=jR;I.prototype.subtract=HR;I.prototype.multiply=qR;I.prototype.divide=XR;I.prototype.remainder=YR;I.prototype.divideAndRemainder=JR;I.prototype.modPow=uE;I.prototype.modInverse=dE;I.prototype.pow=tE;I.prototype.gcd=cE;I.prototype.isProbablePrime=pE;I.prototype.square=KR;U_=I});function W_(s){var e=8,t=0;function i(y,g){var C=(y&65535)+(g&65535),x=(y>>16)+(g>>16)+(C>>16);return x<<16|C&65535}function r(y,g){return y>>>g|y<<32-g}function o(y,g){return y>>>g}function n(y,g,C){return y&g^~y&C}function a(y,g,C){return y&g^y&C^g&C}function l(y){return r(y,2)^r(y,13)^r(y,22)}function u(y){return r(y,6)^r(y,11)^r(y,25)}function c(y){return r(y,7)^r(y,18)^o(y,3)}function p(y){return r(y,17)^r(y,19)^o(y,10)}function m(y,g){var C=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),x=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),v=new Array(64),M,w,k,q,j,Z,re,te,Y,xe,ct,Qe;y[g>>5]|=128<<24-g%32,y[(g+64>>9<<4)+15]=g;for(var Y=0;Y<y.length;Y+=16){M=x[0],w=x[1],k=x[2],q=x[3],j=x[4],Z=x[5],re=x[6],te=x[7];for(var xe=0;xe<64;xe++)xe<16?v[xe]=y[xe+Y]:v[xe]=i(i(i(p(v[xe-2]),v[xe-7]),c(v[xe-15])),v[xe-16]),ct=i(i(i(i(te,u(j)),n(j,Z,re)),C[xe]),v[xe]),Qe=i(l(M),a(M,w,k)),te=re,re=Z,Z=j,j=i(q,ct),q=k,k=w,w=M,M=i(ct,Qe);x[0]=i(M,x[0]),x[1]=i(w,x[1]),x[2]=i(k,x[2]),x[3]=i(q,x[3]),x[4]=i(j,x[4]),x[5]=i(Z,x[5]),x[6]=i(re,x[6]),x[7]=i(te,x[7])}return x}function d(y){for(var g=Array(),C=(1<<e)-1,x=0;x<y.length*e;x+=e)g[x>>5]|=(y.charCodeAt(x/e)&C)<<24-x%32;return g}function f(y){y=y.replace(/\r\n/g,`
`);for(var g="",C=0;C<y.length;C++){var x=y.charCodeAt(C);x<128?g+=String.fromCharCode(x):x>127&&x<2048?(g+=String.fromCharCode(x>>6|192),g+=String.fromCharCode(x&63|128)):(g+=String.fromCharCode(x>>12|224),g+=String.fromCharCode(x>>6&63|128),g+=String.fromCharCode(x&63|128))}return g}function b(y){for(var g=t?"0123456789ABCDEF":"0123456789abcdef",C="",x=0;x<y.length*4;x++)C+=g.charAt(y[x>>2]>>(3-x%4)*8+4&15)+g.charAt(y[x>>2]>>(3-x%4)*8&15);return C}return s=f(s),b(m(d(s),s.length*e))}var V_=_(()=>{});var gE,_E,as,j_=_(()=>{gE=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,_E=/^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,as=class{get major(){return this._major}get minor(){return this._minor}get patch(){return this._patch}constructor(e,t=!1){let i=t?_E:gE,r=i.exec(e);i.lastIndex=0,this._major=r[1],this._minor=r[2],this._patch=r[3]||0}equals(e){return this._major===e._major&&this._minor===e._minor&&this._patch===e._patch}isMoreRecentThan(e){if(this._major<e.major)return!1;if(this._major>e.major)return!0;if(this._minor<e.minor)return!1;if(this._minor>e.minor)return!0;if(this._patch<=e.patch)return!1;if(this._patch>e.patch)return!0}}});function yE(s){return s.map(e=>`0${(e&255).toString(16)}`.slice(-2)).join("")}var it,bE,xE,H_,vE,q_,nd,wE,CE,ad,DE,K_,ld,Dl,ud=_(()=>{vo();G_();V_();_o();j_();hi();it=s=>E.byteArrayToString(ti.decode(s));bE="TDNSeVlXTnJQMkZ3YVV0bGVUMD0=",xE="ZW50ZXJwcmlzZV9saWNlbnNl",H_="YXBwX2lkZW50aWZpZXJz",vE="cGxhdGZvcm0=",q_="ZmVhdHVyZXM=",nd="ZXhwaXJlc19hdA==",wE="ZG9tYWlucw==",CE="YXBpX3Rva2Vu",ad="c2lnbmF0dXJl",DE="dmVyc2lvbg==",K_=class{constructor(e){this._version="2.4",this._l=typeof e=="string"?e.trim():e,this._e=this._parseBigInt("65537",10),this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10),this._parseLicense()}v(){return this._sigValid()&&!this.isExp()}_jsonValid(){try{this._decLic=JSON.parse(this._l)}catch(e){return this._decLic={},!1}return!0}_hostnameValid(){if(typeof window=="undefined"||!this._decLic[it(H_)].length)return!0;let{hostname:e}=window.location,t=!1;return this._decLic[it(H_)].forEach(i=>{E.wildCardMatch(e,i)&&(t=!0)}),t}_platformValid(){let e=this._decLic[it(vE)];return"HTML5"===e}c(){return new Promise((e,t)=>{let i=this._validateError();i!==null&&t(i),e()})}validate(){return this._validateError()===null}_validateError(){if(typeof this._l!=="string"||!this._jsonValid()){let t=new Error;return t.code="ELICINVFMT",t}if(!this._sigValid()){let t=new Error;return t.code="ELICINV",t}if(!this._hostnameValid()){let t=new Error;return t.code="ELICINVHOST",t}if(!this._platformValid()){let t=new Error;return t.code="ELICINVPLAT",t}if(this.isExp()){let t=new Error;return t.code="ELICEXP",t}return null}isToolAllowed(e){return this._includesFeature(e)}isWhiteLabel(){return this._includesFeature("whitelabel",new as("2.4",!0))}areCustomAssetsAllowed(){return this._includesFeature("customassets",new as("2.4",!0))}t(){if(this._decLic.enterprise_license||this._includesFeature("noexporttracking",new as("2.4",!0)))return Promise.resolve();let e=this._decLic[it(wE)][0]+it(it(bE))+this._decLic[it(CE)];return new Gt(e).load().catch(()=>{})}isENT(){return this._decLic?this._decLic[it(xE)]:!1}_sigValid(){return this._verify(this._message,this._sig)}exp(){return!!this._decLic[it(nd)]}dl(){return Math.ceil((this._expAt()-Date.now())/(60*60*24*1e3))}isExp(e=Date.now()){return this._decLic[it(nd)]===null?!1:e>this._expAt()}_expAt(){return this._decLic[it(nd)]*1e3}_verify(e,t){let i,r;return r=this._encodeMessage(e),i=this._decodeSignature(t),i=i.substr(-64),r===i}_encodeMessage(e){return W_(e)}_decodeSignature(e){let t;return e=ti.decode(e),e=yE(e),e=this._parseBigInt(e,16),t=e.modPowInt(this._e,this._n),t=t.toString(16),t}_parseBigInt(e,t){return new U_(e,t)}_parseLicense(){typeof this._l=="string"&&(!this._jsonValid()||(this._sig=this._decLic[it(ad)]||"",delete this._decLic[it(ad)],this._sig=this._sig.replace(/[^A-Za-z0-9+/=]/g,""),this._message=this._l.replace(new RegExp(`,"${it(ad)}":"([^"]*)"`),"")))}_includesFeature(e,t=new as("1.0",!0)){let i=new as(this._decLic[it(DE)],!0);return t.isMoreRecentThan(i)?!0:this._decLic[it(q_)]&&this._decLic[it(q_)].indexOf(e)!==-1}},ld=class{v(){return!0}c(){return Promise.resolve()}isToolAllowed(e){return!0}isWhiteLabel(){return!1}areCustomAssetsAllowed(){return!0}t(){return Promise.resolve()}isENT(){return!1}exp(){return!1}dl(){return 0}isExp(e=Date.now()){return!1}},Dl=K_});var ls,ji,Cr,X_,kl,Y_=_(()=>{ls=typeof window=="undefined"?global:window,ji=ls.requestAnimationFrame,Cr=ls.cancelAnimationFrame,X_=0,kl=["ms","moz","webkit","o"];for(let s=0;s<kl.length&&!ji;++s)ji=ls[`${kl[s]}RequestAnimationFrame`],Cr=ls[`${kl[s]}CancelAnimationFrame`]||ls[`${kl[s]}CancelRequestAnimationFrame`];ji&&(ji=ji.bind(ls));Cr&&(Cr=Cr.bind(ls));ji||(ji=function(s,e){let t=new Date().getTime(),i=Math.max(0,16-(t-X_)),r=setTimeout(function(){s(t+i)},i);return X_=t+i,r});Cr||(Cr=function(s){clearTimeout(s)})});var J_,cd,$_=_(()=>{ii();Ni();J_=class{constructor(e=new z(0,0),t=new z(1,1),i=new z(2,-1),r=new z(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone(),this._segments=[],this._length=-1,this._sample=[]}set(e=new z(0,0),t=new z(1,1),i=new z(2,1),r=new z(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone()}getLength(){return this._length}calculateSegments(e=100){let t=0,i=0,r=[],o=1/e,n=this._p0.clone();for(let a=1;a<=e;a++){let l=[];l.push({t,s:i,point:n}),t+=o,t=Math.min(t,1);let u=this.evalAt(t);i+=u.clone().subtract(n).len(),l.push({t,s:i,point:u}),r.push(l),n=u}return this._segments=r,this._length=i,i}evalAt(e){e=this.normalizeParameter(e);let t=this._p0.clone().multiply((1-e)**3),i=this._p1.clone().multiply(3*(1-e)*(1-e)*e),r=this._p2.clone().multiply(3*(1-e)*e*e),o=this._p3.clone().multiply(e*e*e);return t.add(i).add(r).add(o)}isInSegment(e,t){return e=this.normalizeArcLength(e),e>=t[0].s&&e<=t[1].s}getArcLengthSegment(e){e=this.normalizeArcLength(e);for(let t=0;t<this._segments.length;t++){let i=this._segments[t];if(this.isInSegment(e,i))return i}return null}normalizeArcLength(e){return Math.max(Math.min(this._length,e),0)}normalizeParameter(e){return Math.max(Math.min(1,e),0)}getParameterForArcLength(e){let t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return B.warn("CubicBezierCurve#getParameterForArcLength","Segment not found."),-1;let r=(t-i[1].s)/(i[0].s-i[1].s);return r*i[0].t+(1-r)*i[1].t}evalAtArcLength(e){return this.evalAt(this.getParameterForArcLength(e))}approximateAtArcLength(e){let t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return-1;let r=(t-i[1].s)/(i[0].s-i[1].s);return i[0].point.clone().multiply(r).add(i[1].point.clone().multiply(1-r))}parameterSample(e=100){let t=1/e,i=[],r=0;for(let o=0;o<=e+1;o++)i.push(this.evalAt(r)),r+=t;return this._sample=i,[...i]}arcLengthApproxSample(e=100,t=!1,i=!1){let r=this._length/e,o=[],n=0;for(let a=t?1:0;a<e+1;a++)o.push(this.approximateAtArcLength(n)),n+=r;return i&&o.pop(),this._sample=o,[...o]}},cd=J_});var Z_,md,Q_=_(()=>{Z_=class{constructor(e,t){this.min=e,this.max=t}getMin(){return this.min}getMax(){return this.max}getLength(){return this.max-this.min}contains(e){return this.min<=e&&e<=this.max}},md=Z_});var ft,dd,ey=_(()=>{ft=class{constructor(e,t,i){this.x=e,this.y=t,this.z=i,typeof this.x=="undefined"&&(this.x=0),typeof this.y=="undefined"&&(this.y=0),typeof this.z=="undefined"&&(this.z=0)}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}clone(){return new ft(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}clamp(e,t){let i=e!==null&&typeof e!="undefined",r=t!==null&&typeof t!="undefined";return!(e instanceof ft)&&i&&(e=new ft(e,e,e)),!(t instanceof ft)&&r&&(t=new ft(t,t,t)),i&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y),this.z=Math.max(e.z,this.z)),r&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y),this.z=Math.min(t.z,this.z)),this}divide(e){return e instanceof ft?(this.x/=e.x,this.y/=e.y,this.z/=e.z):(this.x/=e,this.y/=e,this.z/=e),this}subtract(e){return e instanceof ft?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=e,this.z-=e),this}multiply(e){return e instanceof ft?(this.x*=e.x,this.y*=e.y,this.z*=e.z):(this.x*=e,this.y*=e,this.z*=e),this}add(e){return e instanceof ft?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=e,this.z+=e),this}equals(e){return e instanceof ft?e.x===this.x&&e.y===this.y&&e.z===this.z:e===this.x&&e===this.y&&e===this.z}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}fract(){return this.x%=1,this.y%=1,this.z%=1,this}toInt(){return this.x|=0,this.y|=0,this.z|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3({ x: ${this.x}, y: ${this.y}, z: ${this.z} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this.z=parseFloat(this.z.toFixed(e)),this}static fromObject(e){return new ft(e.x,e.y,e.z)}static get NULL(){return new ft(0,0,0)}},dd=ft});var L={};Ne(L,{ColorMatrix:()=>zn,CubicBezierCurve:()=>cd,Matrix:()=>vt,Range:()=>md,Rectangle:()=>ve,Vector2:()=>z,Vector3:()=>dd});var hd=_(()=>{Lm();$_();Mm();Q_();Bm();Ni();ey()});var Zn={};Ne(Zn,{Base64:()=>ti,Color:()=>S,ColorMatrix:()=>zn,Configurable:()=>J,Constants:()=>bt,CubicBezierCurve:()=>cd,Engine:()=>R,EventEmitter:()=>dt,Events:()=>Oo,FreeLicenseChecker:()=>ld,GLUtils:()=>ts,LicenseChecker:()=>Dl,Log:()=>B,Matrix:()=>vt,Range:()=>md,Rectangle:()=>ve,Utils:()=>E,Vector2:()=>z,Vector3:()=>dd,cancelAnimationFrame:()=>Cr,requestAnimationFrame:()=>ji});var us=_(()=>{ii();Jn();Ot();Qn();_o();wo();To();Co();Pm();ud();hi();Y_();hd()});var pd,ty=_(()=>{fl();fd();id();us();pd=class{constructor(){this._container=new pi;this._sprite=new ea;this._container.addChild(this._sprite)}render(e,t,i){let r=i.getDimensions(),o=this._getNextHighestPOT(r);this._renderTexture?this._renderTexture.resizeTo(o):this._renderTexture=new Yn(e,o.x,o.y);let n=this._renderTexture.getDimensions();this._sprite.setTexture(i),this._sprite.updateTransform(),this._renderTexture.clear(),this._renderTexture.render(this._container),this._updateSprite(e,t,r,n)}_updateSprite(e,t,i,r){t.setTexture(this._renderTexture),this._renderTexture.setFrame(new ve(0,0,i.x,i.y))}_getNextHighestPOT(e){return new z(E.nextHighestPOT(e.x),E.nextHighestPOT(e.y))}getRenderTexture(){return this._renderTexture}dispose(){!this._renderTexture||(this._renderTexture.dispose(),delete this._renderTexture)}}});var ea,fd=_(()=>{ty();fl();Ue();ea=class extends pi{constructor(e){super();this._shader=null;this._width=0;this._height=0;this._anchor=new z(0,0);this._canvasSmoothingEnabled=!0;this._smoothDownscaling=!1;this._onTextureUpdate=this._onTextureUpdate.bind(this),this.setTexture(e)}_onTextureUpdate(){this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}_renderWebGL(e){let t=e.save();this._smoothDownscaling&&(this._potRenderer||(this._potRenderer=new pd),this._texture&&this._potRenderer.render(e,this,this._texture)),e.restore(t),e.setObjectRenderer(e.renderers.sprite),e.renderers.sprite.render(this)}_renderCanvas(e){if(!this._texture)return;let t=this._worldTransform,i=this._texture.getFrame(),{width:r,height:o}=i,n=e.getCurrentRenderTarget().getPixelRatio(),a=this._anchor.x*-r|0,l=this._anchor.y*-o|0,u=e.getContext();if(u.setTransform(t.a,t.b,t.c,t.d,t.tx*n,t.ty*n),u.globalAlpha=this.getWorldAlpha(),!this._texture)return;let c=this._texture.getBaseTexture(),p=c.getPixelRatio(),m=c.getSource();u.imageSmoothingEnabled=this._canvasSmoothingEnabled,"beforeDraw"in e&&e.beforeDraw(u),u.drawImage(m,0,0,(m.naturalWidth||r)*p,(m.naturalHeight||o)*p,a*n,l*n,r*n,o*n)}isAtPosition(e){if(!this._texture)return;let t=this._worldTransform.applyInverseToVector(e),i=this._texture.getFrame(),{width:r,height:o}=i,n=new z(-r,-o);n.multiply(this._anchor);let a=n.clone().add(r,o);return!(t.x<n.x||t.x>a.x||t.y<n.y||t.y>a.y)}getLocalBounds(){if(this._localBoundsNeedUpdate&&this._texture){let e=this._localBounds,t=this._texture.getFrame();e.x=-t.width*this._anchor.x,e.y=-t.height*this._anchor.y,e.width=t.width,e.height=t.height,this._localBoundsNeedUpdate=!1}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate&&this._texture){let e=this._bounds,t=this._texture.getFrame(),i=this._worldTransform,r=this._anchor,o=i.rectangleToCoordinates(t,r),n=o[0].x,a=o[0].y,l=n,u=a;o.forEach(({x:c,y:p})=>{n=Math.min(n,c),a=Math.min(a,p),l=Math.max(l,c),u=Math.max(u,p)}),e.x=n,e.width=Math.abs(l-n),e.y=a,e.height=Math.abs(u-a),this._boundsNeedUpdate=!1}return this._bounds.clone()}getTexture(){return this._texture}clearTexture(e=!0){!this._texture||(this._texture.off("update",this._onTextureUpdate),e&&this._texture.dispose(),this._texture=null,this._potRenderer&&(e&&this._potRenderer.dispose(),delete this._potRenderer))}setTexture(e){!e||(this._texture&&this._texture.off("update",this._onTextureUpdate),this._potRenderer&&this._potRenderer.getRenderTexture().getBaseTexture().setDirty(!0),this._texture=e,e.getBaseTexture().isLoaded()&&this._onTextureUpdate(),e.on("update",this._onTextureUpdate))}getShader(){return this._shader}setShader(e){this._shader=e}getWidth(){return this._width}setWidth(e){!this._texture||(this._scale.x=e/this._texture.getFrame().width,this._width=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getHeight(){return this._height}setHeight(e){!this._texture||(this._scale.y=e/this._texture.getFrame().height,this._height=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getDimensions(){return new z(this._width,this._height)}getAnchor(){return this._anchor}setAnchor(e,t){this._anchor.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}isSmoothDownscaling(){return this._smoothDownscaling}setSmoothDownscaling(e){this._smoothDownscaling=e}dispose(e=!1,t=!1){this._texture&&this._texture.off("update",this._onTextureUpdate),(e||t)&&this._texture&&this._texture.dispose(t),this._potRenderer&&this._potRenderer.dispose()}}});var kE,R,Qn=_(()=>{fl();b_();Ro();yl();k_();A_();fd();Fo();id();td();Un();Dm();di();jn();kE={CanvasFilterManager:ss,Container:pi,BaseTexture:Le,Texture:xr,RenderTexture:Yn,WebGLRenderTarget:Wi,CanvasRenderTarget:Gi,Sprite:ea,Filter:ri,Filters:jm,PixelArrayImage:fo,autoDetectRenderer(s,e,t={}){return $e.isSupported()?new vl(s,e,t):new So(s,e,t)},canvasRenderer(s,e,t={}){return new So(s,e,t)}},R=kE});var iy,ry,sy=_(()=>{iy=class{static current(){return process.env.ENV}static isTest(){return process.env.ENV==="test"}static isDevelopment(){return process.env.ENV==="development"}static isProduction(){return process.env.ENV==="production"||!this.isTest()&&!this.isDevelopment()}},ry=iy});var oy,cs,Tl=_(()=>{oy=class{constructor(e){this._head=0,this._buf=e}peekInt8(){return this._buf[this._head]}peekInt16(e=!1){let t=this._buf[this._head],i=this._buf[this._head+1];return e?(i<<8)+t:(t<<8)+i}peekInt24(e=!1){let t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2];return e?(r<<16)+(i<<8)+t:(t<<16)+(i<<8)+r}peekInt32(e=!1){let t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2],o=this._buf[this._head+3];return e?(o<<32)+(r<<16)+(i<<8)+t:(t<<32)+(i<<16)+(r<<8)+o}writeInt8(e){this._buf[this._head]=e&255}writeInt16(e){this._buf[this._head]=e>>8,this._buf[this._head+1]=e&255}readInt8(){let e=this.peekInt8();return this._head+=1,e}readInt16(e=!1){let t=this.peekInt16(e);return this._head+=2,t}readInt24(e=!1){let t=this.peekInt24(e);return this._head+=3,t}readInt32(e=!1){let t=this.peekInt32(e);return this._head+=4,t}readString(e){let t="";for(let i=0;i<e;i++){let r=this.readInt8();t+=String.fromCharCode(r)}return t}getHead(){return this._head}setHead(e){this._head=e}},cs=oy});var TE,RE,Po,Rl=_(()=>{TE={SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505},RE={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},Po={MARKERS:TE,EXIF_TAGS:RE}});var gd,EE,ny,ay,ly,uy=_(()=>{Tl();hi();Rl();({invariant:gd}=E),{MARKERS:EE,EXIF_TAGS:ny}=Po,ay=class{constructor(e){this._buf=e,this._stream=new cs(this._buf),this._stream.setHead(0),this._parse(),this._bigEndian=!1}isValid(){return this._stream.setHead(0),!(this._stream.readInt16()!==EE.EXIF||!(this._stream.readInt16()>0)||this._stream.readString(4)!=="Exif")}_parse(){if(!this.isValid())return;this._stream.setHead(10);let e=this._stream.getHead();this._bigEndian=!1;let t=this._stream.readInt16();t===18761?this._bigEndian=!1:t===19789?this._bigEndian=!0:gd(!1,"Invalid TIFF data: No endian type found"),gd(this._stream.readInt16(!this._bigEndian)===42,"Invalid TIFF data: No 0x002A");let i=this._stream.readInt32(!this._bigEndian);gd(i>=8,"Invalid TIFF data: First IFD offset < 8");let r=e+i,o=this._readTags(this._stream,e,r,this._bigEndian);this._tags=o.tags,this._tagData=o.tagData}getTags(){return this._tags}getTagData(){return this._tagData}setOrientation(e){if(this._tagData.Orientation){let{entryOffset:t}=this._tagData.Orientation;this._stream.setHead(t+8),this._stream.writeInt16(this._bigEndian?e:(e&255)<<8|e>>8&255)}}_readTags(e,t,i,r){e.setHead(i);let o=e.readInt16(!r),n={},a=[];for(let l=0;l<o;l++){let u=i+l*12+2;e.setHead(u);let c=e.readInt16(!r),p,m,d;if(ny[c]){c=ny[c],p=e.readInt16(!r),m=e.readInt32(!r),d=e.readInt32(!r)+t;let f=null;switch(p){case 1:case 7:if(m===1)f=e.readInt8(!r);else{f=[];for(let b=0;b<m;b++)f.push(e.readInt8(!r))}break;case 2:e.setHead(m>4?d:u+8),f=e.readString(m);break;case 3:if(e.setHead(m>2?d:u+8),m===1)f=e.readInt16(!r);else{f=[];for(let b=0;b<m;b++)f.push(e.readInt16(!r))}break;case 4:case 9:if(e.setHead(m>1?d:u+8),m===1)f=e.readInt32(!r);else{f=[];for(let b=0;b<m;b++)f.push(e.readInt32(!r))}break;case 5:case 10:if(e.setHead(d),m===1){let b=e.readInt32(!r),y=e.readInt32(!r);f=b/y}else{f=[];for(let b=0;b<m;b++){let y=e.readInt32(!r),g=e.readInt32(!r),C=y/g;f.push(C)}}break}n[c]=f,a[c]={value:f,numValues:m,entryOffset:u,valueOffset:d,type:p}}}return{tags:n,tagData:a}}getBuffer(){return this._buf}},ly=ay});var FE,cy,_d,my=_(()=>{Tl();Rl();({MARKERS:FE}=Po),cy=class{constructor(e){this._buf=e,this._stream=new cs(this._buf),this._stream.setHead(0)}isValid(){if(this._stream.setHead(0),this._stream.readInt16()!==FE.APP0||!(this._stream.readInt16()>=16))return!1;let i=this._stream.readString(4),r=this._stream.readInt8();return!(i!=="JFIF"||r!==0)}setUnitDensity(e){this._stream.setHead(11),this._stream.writeInt8(e)}setDensityX(e){this._stream.setHead(12),this._stream.writeInt16(e)}setDensityY(e){this._stream.setHead(14),this._stream.writeInt16(e)}getUnitDensity(){return this._stream.setHead(11),this._stream.readInt8()}getDensityX(){return this._stream.setHead(12),this._stream.readInt16()}getDensityY(){return this._stream.setHead(14),this._stream.readInt16()}getBuffer(){return this._buf}},_d=cy});var ta,El,SE,gi,ia,Fl=_(()=>{Tl();_o();Rl();uy();my();hi();({MARKERS:ta}=Po),El="data:image/jpeg;base64,",SE=new RegExp(`^${El}`,"i"),gi=class{constructor(e){this._buf=e,this._stream=new cs(this._buf),this._stream.setHead(0),this._segments=this._sliceIntoSegments(this._buf),this._exifData=new ly(this._getMarkerBuffer(ta.EXIF)),this._jfifData=new _d(this._getMarkerBuffer(ta.JFIF))}static toDataURL(e){return El+ti.encode(e)}static fromDataURL(e){let t=e.replace(El,"");return ti.decode(t)}restoreSegmentsInArray(e){return e=this.restoreExifTagsToImageData(e),this.restoreJfifSegmentToImageData(e)}restoreSegments(e){let t=gi.fromDataURL(e);return t=this.restoreSegmentsInArray(t),gi.toDataURL(t)}restoreExifTagsToImageData(e){if(!this._exifData.isValid())return e;let i=this._sliceIntoSegments(e)[1][0],r=e.slice(0,i),o=e.slice(i),n=r.concat(this._exifData.getBuffer());return n=n.concat(o),n}restoreJfifSegmentToImageData(e){if(!this._jfifData.isValid())return e;let t=this._sliceIntoSegments(e),i=this._findSegment(ta.JFIF,t),r=[];if(i){let o=i[0],n=i[1],a=e.slice(0,o),l=e.slice(o,n),u=e.slice(n),c=new _d(l);c.setDensityX(this._jfifData.getDensityX()),c.setDensityY(this._jfifData.getDensityY()),c.setUnitDensity(this._jfifData.getUnitDensity()),r=a.concat(l).concat(u)}else return e;return r}restoreExifTags(e){let t=gi.fromDataURL(e),i=this.restoreExifTagsToImageData(t);return gi.toDataURL(i)}restoreJfifSegment(e){if(!this._jfifData.isValid())return e;let t=gi.fromDataURL(e),i=this.restoreJfifSegmentToImageData(t);return gi.toDataURL(i)}setOrientation(e){return this._exifData.setOrientation(e)}static isJPEG(e){return SE.test(e)}static bufferIsJPEG(e){return e[0]===255&&e[1]===216&&e[2]===255}static fromBase64String(e){let t=e.replace(El,""),i=ti.decode(t);return new gi(i)}_findSegment(e,t=this._segments){for(let i=0;i<t.length;i++){let r=t[i][0],o=t[i][1];if(this._stream.setHead(r),this._stream.peekInt16()===e)return[r,o]}return!1}_getLastSegment(e=this._segments){return e[e.length-1]}_getMarkerBuffer(e,t=this._segments){let i=this._findSegment(e,t);if(i){let r=i[0],o=i[1];return this._buf.slice(r,o)}return!1}_sliceIntoSegments(e){let t=new cs(e),i=[];for(;t.getHead()<e.length;){let r=t.readInt16();if(r!==ta.SOI){if(r===ta.SOS)break;if(r>=65280&&r<=65535){let o=t.readInt16(),n=t.getHead()+o-2;i.push([t.getHead()-4,n]),t.setHead(n)}else throw new Error(`Invalid marker: 0x${r.toString(16)}`)}}return this._stream.setHead(0),i}getTags(){return this._exifData.getTags()}getTagData(){return this._exifData.getTagData()}dispose(){this._buf=[],this._segments=[]}},ia=gi});var dy,wt,Sl=_(()=>{dy=typeof window!="undefined"&&window.Image;wt=dy});var Ol,Al,yd=_(()=>{us();Co();Ol=class extends dt{constructor(e=[]){super();this._onOperationUpdate=this._onOperationUpdate.bind(this),this._cacheEnabled=!0,this._stack=e,this._stack.forEach(t=>{t.on("update",this._onOperationUpdate)})}clear(){this.forEach(e=>this.remove(e)),this._stack=[]}hasChanges(){return this._stack.filter(e=>!!e).some(e=>e.hasChanges())}_onOperationUpdate(e,t){this.emit(Oo.OPERATION_UPDATED,e,t)}enableCache(){this._cacheEnabled=!0}disableCache(){this._cacheEnabled=!1}forEach(e){return this._stack.filter(t=>!!t).forEach(e)}render(e,t){let i=t,r=this._stack.filter(u=>!!u).filter(u=>u.getEnabled());r.reverse();let o=r.filter(u=>!u.isDirtyForRenderer(e.getRenderer()))[0],n=r.indexOf(o);r.reverse();let a=0;n!==-1&&(a=r.length-n-1);for(let u=0;u<a;u++)B.info(this.constructor.name,`Skipping ${r[u].constructor.name}`);let l=Promise.resolve(i);for(let u=a;u<r.length;u++){let c=r[u],p,m;l=l.then(d=>c.render(d).then(f=>(p&&f!==p&&!this._cacheEnabled&&m.disposeRenderTextures(),p=f,m=c,f)))}return l.then(u=>{let c=!r.some(p=>p.isDirtyForRenderer(e.getRenderer()));return{outputTexture:u,renderDone:c}})}validateSettings(){return Promise.all(this._stack.filter(e=>!!e).map(e=>e.validateSettings()))}setAllToDirty(e=!1){this.forEach(t=>t.setDirty(!0,e))}updateDirtinessForRenderer(e){let t=!1;for(let i=0;i<this._stack.length;i++){let r=this._stack[i];!r||(r.isDirtyForRenderer(e)&&(t=!0),t&&r.setDirtyForRenderer(!0,e))}}push(e){this._stack.push(e),e.on("update",this._onOperationUpdate)}pop(){let e=this._stack.pop();e&&(e.off("update",this._onOperationUpdate),e.dispose())}unshift(e){this._stack.unshift(e),e.on("update",this._onOperationUpdate)}clone(){return new Ol(this._stack.slice(0))}get(e){return this._stack[e]}getByIdentifier(e){return E.Array.find(this._stack,t=>t&&t.constructor.identifier===e)}getIndexByIdentifier(e){return E.Array.findIndex(this._stack,t=>t&&t.constructor.identifier===e)}moveToTop(e){let t=E.Array.findIndex(this._stack,r=>r&&r.constructor.identifier===e);if(t<0||t===this._stack.length-1)return;let i=this.getByIdentifier(e);this._stack.splice(t,1),this._stack[this._stack.length]=i}set(e,t){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),this._stack[e]=t,t.on("update",this._onOperationUpdate)}remove(e){let t=this._stack.indexOf(e);t!==-1&&(this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),this._stack.splice(t,1))}removeAt(e){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),delete this._stack[e]}getStack(){return this._stack}dispose(){this.forEach(e=>{e.dispose()})}},Al=Ol});var hy,py,Il,bd=_(()=>{us();hy=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Wn(),py=class{constructor(e,t){this._tag=e,this._name=t,this._start=hy()}stop(){let t=hy()-this._start,i=Math.round(1e3/t);B.info(this._tag,`${this._name} took ${t.toFixed(2)}ms (${i} FPS)`)}},Il=py});var xd,ce,vd=_(()=>{ii();Ot();Qn();To();bd();xd=class extends J{constructor(e,t={}){super(t,{enabled:{type:h.BOOLEAN,default:!0,serializable:!1}});this._sdk=e,this._cacheEnabled=!1,this._dirtiness={},this._sprite=new R.Sprite,this._container=new R.Container,this._container.addChild(this._sprite)}_onOptionsChange(){this.setDirty(!0)}render(e){if(!this.getEnabled())return B.info(this.constructor.name,"Disabled - skipping"),Promise.resolve(e);if(!this._renderTexture){let o=e.getDimensions().floor();this._renderTexture=new R.RenderTexture(this._sdk.getRenderer(),o.x,o.y)}let t=this._sdk.getRenderer(),i,r;if(B.canLog("info")&&(r=new Il(this.constructor.name,"Rendering")),this.isDirtyForRenderer(t)){this._sprite.setTexture(e);let o=this.getNewDimensions(e.getDimensions()).floor();this._renderTexture.resizeTo(o),this._renderTexture.clear(),i=this._render(e).then((n=!1)=>(this.setDirtyForRenderer(n,t),this._renderTexture))}else B.info(this.constructor.name,"Rendering from cache"),i=Promise.resolve(this._renderTexture);return i.then(o=>(r&&r.stop(),o))}_render(e){let t;return this._sdk.getRenderer().isOfType(K.WEBGL)?t=this._renderWebGL.bind(this):t=this._renderCanvas.bind(this),t(e)}_renderWebGL(e){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}_renderCanvas(e){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}getNewDimensions(e){return e.clone()}onBeforeExport(){this.transform&&this._tempTransformChange&&this.transform(this._tempTransformChange),this._onBeforeExport()}onAfterExport(){this.transform&&this._tempInverseTransformChange&&this.transform(this._tempInverseTransformChange),this._onAfterExport()}_onBeforeExport(){}_onAfterExport(){}setTemporaryTransformChange(e,t){this._tempTransformChange=e,this._tempInverseTransformChange=t}reset(){this._dirty=!0,this._glslPrograms={}}isDirtyForRenderer(e){let t=this._dirtiness[e.id];return typeof t=="undefined"?!0:t}setDirtyForRenderer(e,t,i=!1){this._dirtiness[t.id]=e}setDirty(e,t=!1){for(let i in this._dirtiness)this.setDirtyForRenderer(e,{id:i},t)}getSDK(){return this._sdk}getInputDimensions(e=!0){let t=this._sdk.getInputDimensions();e&&t.multiply(this._sdk.getZoom()).floor();let i;return this._sdk.getOperationsStack().forEach(r=>{if(!i){if(r===this){i=!0;return}t=r.getNewDimensions(t)}}),t.floor()}clone(){let e=this.constructor;return new e(this._sdk,this.serializeOptions())}disposeRenderTextures(){this._renderTexture&&this._renderTexture.dispose(),this._renderTexture=null}dispose(){this.disposeRenderTextures(),this._sprite.dispose()}};xd.identifier=null;ce=xd});var OE,Pl,fy,gy=_(()=>{us();Ni();vd();({OptionType:OE}=bt),Pl=class extends ce{getRotation(){let e=0;switch(this.getTags().Orientation){case 7:case 8:e=-90;break;case 3:case 4:e=-180;break;case 5:case 6:e=90;break}return e}_getFlipVertically(){let{Orientation:e}=this.getTags();return[5,7].indexOf(e)!==-1}_getFlipHorizontally(){let{Orientation:e}=this.getTags();return[2,4].indexOf(e)!==-1}_getFinalOptions(){return{rotation:this.getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}}_render(e){let t=this._getFinalOptions(),r=t.rotation%360*(Math.PI/180);this._sprite.setScale(t.flipHorizontally?-1:1,t.flipVertically?-1:1),this._sprite.setRotation(r),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();let o=this._sprite.getBounds();return this._renderTexture.resizeTo(new z(o.width,o.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2)),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(e){let t=this._getFinalOptions();return e=e.clone(),t.rotation%180&&e.flip(),e}applyTo(e){let t=this._getFinalOptions(),i=E.createCanvas();Math.abs(t.rotation%180)===90?(i.width=e.height,i.height=e.width):(i.width=e.width,i.height=e.height);let r=i.getContext("2d"),o=t.rotation*Math.PI/180,n=.5*(i.width-e.width),a=.5*(i.height-e.height);return r.translate(n,a),r.translate(.5*e.width,.5*e.height),r.rotate(o),r.translate(-.5*e.width,-.5*e.height),t.flipVertically&&(r.translate(0,e.height),r.scale(1,-1)),t.flipHorizontally&&(r.translate(e.width,0),r.scale(-1,1)),r.drawImage(e,0,0),i}};Pl.identifier="exif-orientation";Pl.prototype.availableOptions={tags:{type:OE.OBJECT,default:{}}};fy=Pl});var Mo={};Ne(Mo,{ExifOrientationOperation:()=>fy});var wd=_(()=>{gy()});var Cd,_y,yy=_(()=>{Ot();Qn();To();Fl();Sl();hi();Cd=class extends J{constructor(e,t={}){super(t);this._sdk=e}export(){let{imageFormat:e}=this._options,t=i=>i.renderDone?i:this._sdk.render().then(r=>t(r));return this.validateSettings().then(()=>this._prepareSDK().then(i=>t(i))).then(i=>{let{outputTexture:r,renderDone:o}=i,n=this._sdk.getRenderer(),a=n.getCanvas();return n.isOfType(K.WEBGL)&&(a=this._createCanvasFromTexture(r)),this._encodeImageFormat(a)}).then(i=>this._restoreExifMetadata(i,e)).then(i=>this._restoreSDK().then(()=>i))}_restoreExifMetadata(e,t,i){if(t===Qr.JPEG){let r=this._sdk.getExif();r&&typeof e=="string"&&(e=r.restoreSegments(e))}return Promise.resolve(e)}_encodeAsDataURL(e,t,i){return E.isBrowser?Promise.resolve(e.toDataURL(t,i)):new Promise((r,o)=>{e.toDataURL(t,i,(n,a)=>{n?o(n):r(a)})})}_encodeAsHTMLImage(e,t,i){return this._encodeAsDataURL(e,t,i).then(r=>{let o=new wt;return o.src=r,Promise.resolve(o)})}_encodeAsBuffer(e,t,i){return Promise.reject(new Error("Unsupported platform for RenderType"))}_encodeAsMSBlob(e,t,i){return Promise.resolve(e.msToBlob())}_encodeAsBLOB(e,t,i){return new Promise((r,o)=>{e.toBlob(n=>{r(n)},t,i)})}_encodeImageFormat(e){let{imageFormat:t,quality:i}=this._options,{renderType:r}=this._options;switch(r===St.BLOB&&e.msToBlob&&!e.toBlob&&(r=St.MSBLOB),r){case St.IMAGE:return this._encodeAsHTMLImage(e,t,i);case St.DATAURL:return this._encodeAsDataURL(e,t,i);case St.BUFFER:return this._encodeAsBuffer(e,t,i);case St.MSBLOB:return this._encodeAsMSBlob(e,t,i);case St.BLOB:return this._encodeAsBLOB(e,t,i)}return Promise.reject(new Error(`Unsupported RenderType: ${r}!`))}_prepareSDK(){let e=this._sdk.getRenderer();this._sdkSettings={dimensions:e.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),rendererPixelRatio:e.getPixelRatio(),renderMode:this._sdk.getRenderMode()},this._sdk.setRenderMode("export"),this._sdk.setTextureQuality(1);let t=e.isOfType(K.CANVAS);e.setPixelRatio(1),e.resizeTo(this._sdk.getFinalDimensions(),t),this._sdk.setAllOperationsToDirty(!0);let i=this._sdk.getOperationsStack();return i.forEach(r=>{r.disposeRenderTextures()}),i.disableCache(),this._sdk.render()}_restoreSDK(){this._sdk.getOperationsStack().enableCache(),this._sdk.setRenderMode(this._sdkSettings.renderMode);let t=this._sdk.getRenderer(),i=t.isOfType(K.CANVAS);return t.setPixelRatio(this._sdkSettings.rendererPixelRatio),t.resizeTo(this._sdkSettings.dimensions,i),this._sdk.setTextureQuality(this._sdkSettings.textureQuality),this._sdk.setAllOperationsToDirty(!0),this._sdk.render()}_createCanvasFromTexture(e){let t=this._sdk.getRenderer(),i=this._sdk.getFinalDimensions(),r=this._sdk.getRenderer().getContext(),o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o);let n=e.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);let a=new Uint8Array(i.x*i.y*4);r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,a);let l=this._checkPixelsForTransparency(a),u;if(l){let d=new R.Sprite(e);d.setFilters([new R.Filters.UnpremultiplyFilter]);let f=new R.Container;f.addChild(d),u=new R.RenderTexture(t,i.x,i.y),u.render(f);let b=u.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,b,0),r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,a),t.setRenderTarget(),u.dispose()}let c=E.createCanvas();c.width=i.x,c.height=i.y;let p=c.getContext("2d"),m=p.createImageData(i.x,i.y);return m.data.set(a),p.putImageData(m,0,0),r.deleteFramebuffer(o),c}_checkPixelsForTransparency(e){let t=this._sdk.getFinalDimensions(),i=t.x*t.y*4,r;for(let o=3;o<i;o+=4)if(r=e[o],r!==255)return!0;return!1}};Cd.prototype.availableOptions={renderType:{type:h.STRING,available:E.values(St),default:St.IMAGE},imageFormat:{type:h.STRING,available:E.values(Qr),default:Qr.PNG},quality:{type:h.NUMBER,default:.8}};_y=Cd});var AE,IE,jt,by,PE,Dd,kd,Hi,ME,BE,Fe,LE,zE,xy,vy,Ie,wy=_(()=>{us();Fl();Sl();yy();yd();bd();wd();({Rectangle:AE,Constants:IE,Engine:jt,Utils:by,EventEmitter:PE,Events:Dd,Vector2:kd,Log:Hi,Base64:ME,Color:BE}=Zn),Fe=s=>by.byteArrayToString(ME.decode(s)),{RenderType:LE,ImageFormat:zE,RendererType:xy}=IE,vy=class extends PE{constructor(e,t={}){super();P(this,"_onContextLost",()=>{this.emit("context-lost")});P(this,"_initWatermark",()=>{this._options.watermark&&this._options.watermark.watermarkURI&&(this._watermarkOperation=this.createOperation("watermark",{watermarkURI:this._options.watermark.watermarkURI,alignment:this._options.watermark.alignment,inset:this._options.watermark.inset,size:this._options.watermark.size,crossOrigin:this._options.crossOrigin}))});if(this._onOperationUpdate=this._onOperationUpdate.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.version="3.9.0",this[Fe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!0,this._preferredRenderer=e,this._options=N(D({},t),{extensions:{},renderMode:"dynamic",versionCheck:!0,displayWelcomeMessage:!0,image:null,canvas:null,transparent:!1,clearColor:BE.TRANSPARENT,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:!1,smoothUpscaling:!1,crossOrigin:"anonymous",logLevel:"warn",pixelRatio:Math.max(typeof window!="undefined"&&window.devicePixelRatio||1,1)}),this._options.smoothUpscaling&&(jt.BaseTexture.DefaultMagFilter=jt.BaseTexture.LinearFilter),this._options.extensions=Object.assign(this._options.extensions,{operations:[],controls:[],languages:[]}),Hi.setLevel(this._options.logLevel),this[Fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!1,!this[Fe("X29wdGlvbnM=")][Fe("bGljZW5zZQ==")])this[Fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!0,this._l=new Zn[Fe("RnJlZUxpY2Vuc2VDaGVja2Vy")];else{let r=Zn[Fe("TGljZW5zZUNoZWNrZXI=")];this._l=new r(this[Fe("X29wdGlvbnM=")][Fe("bGljZW5zZQ==")]),this._cv(!0).then(()=>{this._ct()}).catch(o=>{Hi.error(Fe("TGljZW5zaW5n"),o.message)})}this._defaultRenderMode=this._options.renderMode,this._renderMode=this._options.renderMode,this._textureQuality=this._options.textureQuality,this._offset=new kd,this._zoom=this._options.zoom,this._spriteScale=this._options.spriteScale,this._rotation=this._options.rotation,this._operations={},this._operationsStack=null,this.setOperationsStack(new Al),this._container=new jt.Container,this._sprite=new jt.Sprite,this._container.addChild(this._sprite),this._inputTexture=this._options.inputTexture,this._currentInputTexture=null,this._currentTexture=null,this._resizedTexture=null,this._resizedContainer=new jt.Container,this._resizedSprite=new jt.Sprite,this._resizedContainer.addChild(this._resizedSprite),this._texturesToDispose=[],this.setSmoothDownscaling(this._options.smoothDownscaling),this._registerOperations(),this._initRenderer();let i=this._renderer.constructor.type;this._options.displayWelcomeMessage,this[Fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]&&Hi.log(Fe("VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmVmb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIHlvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuIFlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5zZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LmltZy5seS9zaWdudXAgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LmltZy5seS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGEgd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbGF5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgdG8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2ltZy5seS9kb2NzL3Blc2RrL3dlYi9pbnRyb2R1Y3Rpb24vZ2V0dGluZ19zdGFydGVkLg==")),this._options.image&&this.setImage(this._options.image,this._options.exif)}_ct(){this._l.exp()&&(this._l.isExp()?Hi.error(Fe("TGljZW5zaW5n"),Fe("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg==")):Hi.warn(Fe("TGljZW5zaW5n"),Fe("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl())))}_cv(e=!1){return this._l.c().catch(t=>{this[Fe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!1;let i=Fe("SW52YWxpZCBsaWNlbnNlLg==");throw e&&(t.code==="ELICEXP"?i=Fe("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg=="):t.code==="ELICINVHOST"?i=Fe("VGhlIGJ1bmRsZSBpZGVudGlmaWVycyB0aGF0IHlvdSBzcGVjaWZpZWQgaW4geW91ciBsaWNlbnNlIGZpbGUgZG8gbm90IG1hdGNoIHRoZSBhcHAncyBidW5kbGUgaWRlbnRpZmllci4gUGxlYXNlIHVwZGF0ZSBhbmQgcmVkb3dubG9hZCB5b3VyIGxpY2Vuc2UgZnJvbSB5b3VyIGN1c3RvbWVyIGRhc2hib2FyZCBhdCBodHRwczovL3d3dy5pbWcubHkvbG9naW4u"):t.code==="ELICINVPLAT"?i=Fe("VGhlIGxpY2Vuc2UgdGhhdCB5b3Ugc3BlY2lmaWVkIGlzIGZvciBhbm90aGVyIHBsYXRmb3JtLiBQbGVhc2UgZG93bmxvYWQgeW91ciBsaWNlbnNlIGZvciB0aGUgd2ViIHBsYXRmb3JtIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg=="):t.code==="ELICINVFMT"?i=Fe("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",typeof this._options.license):t.code==="ELICINV"?i=Fe("VGhlIHNpZ25hdHVyZSBvZiB5b3VyIGxpY2Vuc2UgaXMgbm90IHZhbGlkLiBQbGVhc2UgdHJ5IHRvIHJlZG93bmxvYWQgeW91ciBsaWNlbnNlIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg=="):i=Fe("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5IHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),t.message=i,new Error(t)})}_t(){this._l.t()}_fl(){return this[Fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]}_onOperationUpdate(...e){this.emit(Dd.OPERATION_UPDATED,...e)}_onContextRestored(){Hi.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored."),this.setAllOperationsToDirty(),this._operationsStack.forEach(e=>{e.disposeRenderTextures()}),this.render()}export(e=LE.DATAURL,t=zE.PNG,i=.8){return this._cv(!0).then(()=>(this.hasChanges()&&this._t(),this._operationsStack.forEach(o=>{o.onBeforeExport()}),new _y(this,{renderType:e,imageFormat:t,quality:i}).export().then(o=>(this._operationsStack.forEach(n=>{n.onAfterExport()}),Promise.resolve(o)))))}render(e=!0){if(!this._inputTexture)throw new Error("You need to set an image before calling PhotoEditorSDK#render.");let t=this._renderer.getContext();t.startFrame&&t.startFrame();let i;Hi.canLog("info")&&(i=new Il("\u26A1\u26A1\u26A1","Frame rendering")),Hi.info("\u26A1\u26A1\u26A1","Rendering starts");let r=this._operationsStack;return r.updateDirtinessForRenderer(this._renderer),this._prepareTexture().then(o=>{this._renderMode==="export"&&(o=this._inputTexture),this._currentTexture=o,this._sprite.setTexture(o),this._container.updateTransform()}).then(()=>r.validateSettings()).then(()=>((this._fl()||!this[Fe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")])&&(r.getByIdentifier("license-watermark")?r.moveToTop("license-watermark"):this.createOperation("license-watermark")),r.getByIdentifier("watermark")?r.moveToTop("watermark"):this._initWatermark(),r.render(this,this._currentTexture))).then(o=>{let{outputTexture:n}=o;switch(this._currentTexture=n,this._sprite.setTexture(this._currentTexture),this._renderMode){case"dynamic":{let a=this._renderer.getDimensions().clone().divide(2).add(this._offset);this._container.setScale(this._zoom/this.getTextureScale(),this._zoom/this.getTextureScale()),this._container.setPosition(a),this._sprite.setAnchor(.5,.5),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(this._rotation);break}case"export":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(0);break;case"adapter":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(1,1),this._sprite.setRotation(0);break}return e&&this._renderer.render(this._container),o}).then(o=>(i&&i.stop(),t.endFrame&&t.endFrame(),this._disposeTextures(),o))}getTextureScale(){return Math.min(1,this._textureQuality*this._options.pixelRatio)}_prepareTexture(){return new Promise((e,t)=>{let i=this.getTextureScale();if(this._textureQuality===1)return e(this._inputTexture);let r=this.getInputDimensions().multiply(i).floor(),o;this._resizedTexture?this._resizedTexture.getDimensions().equals(r)||(this._resizedTexture.resizeTo(r),o=!0):(this._resizedTexture=new jt.RenderTexture(this._renderer,r.x,r.y),o=!0),o&&(this._resizedSprite.setScale(i,i),this._resizedSprite.setTexture(this._inputTexture),this._resizedTexture.render(this._resizedContainer)),e(this._resizedTexture)})}_registerOperations(){this._operations={};for(let e in Mo){let t=Mo[e];this._operations[t.identifier]=t}this._operations=D(D({},this._operations),this._options.extensions.operations)}registerOperations(e){e.forEach(t=>{this._operations[t.identifier]=t})}setAllOperationsToDirty(e=!1){this._operationsStack.setAllToDirty(e)}createOperation(e,t={},i=!0){let r=this._operations[e];if(!r)throw new Error(`No operation with identifier \`${e}\` found.`);let o=new r(this,t);return i&&this.addOperation(o),o}addOperation(e){this._operationsStack.push(e)}removeOperation(e){this._operationsStack.remove(e)}getInputDimensions(){let e=this._inputTexture.getFrame();return new kd(e.width,e.height)}getFinalDimensions(e=!1){let t=this.getInputDimensions();return this._operationsStack.forEach(r=>{!r.getEnabled()||(t=r.getNewDimensions(t))}),e&&t.multiply(this._spriteScale),t.floor()}getOutputDimensions(e=!1){return this.getFinalDimensions(e).clone().multiply(this._zoom).floor()}getOutputTextureDimensions(e=!1){let t=this.getTextureScale(),i=this.getInputDimensions().multiply(t).floor();return this._operationsStack.forEach(r=>{i=r.getNewDimensions(i)}),i}getCrossOrigin(){return by.getCrossOrigin(this._options.crossOrigin||"Anonymous")}_initRenderer(){let e={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent,clearColor:this._options.clearColor},t,i;if(this._renderMode!=="export"&&this._options.canvas){let{canvas:r}=this._options;t=r.width,i=r.height}else if(this._inputTexture){let r=this.getFinalDimensions();t=r.x,i=r.y}else t=1,i=1;switch(this._preferredRenderer){case xy.WEBGL:this._renderer=jt.autoDetectRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored),this._renderer.on("context-lost",this._onContextLost);break;case xy.CANVAS:this._renderer=jt.canvasRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored);break;default:Hi.warn("PhotoEditorSDK",`PhotoEditorSDK Error: Renderer \`${this._preferredRenderer}\` not supported. Falling back to automatically detected renderer.`),this._renderer=jt.autoDetectRenderer(t,i,e)}}resizeTo(e){this._renderer.resizeTo(e,!0)}reset(){this._operationsStack.clear()}parseExif(e){if(!e)return;let{src:t}=e,i=!1,r=null;if(i=ia.isJPEG(t),r=t,i){let o=null;try{o=ia.fromBase64String(r)}catch(n){}return o||void 0}}_handleExifOrientation(){let e=this._exif.getTags();if(e&&e.Orientation){let t=e.Orientation!==1&&e.Orientation!==2,i=[2,4,5,7].indexOf(e.Orientation)!==-1;if(t||i){if(typeof navigator=="undefined")this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e);else{let r=window&&window.navigator&&window.navigator.userAgent||"";(!!r.match(/msie|trident/i)||r.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image"))&&(this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e))}this._exif.setOrientation(1)}}}correctExifOrientation(e){let t=this.parseExif(e);if(!t)return e;let i=t.getTags();if(i&&i.Orientation){let r=i.Orientation!==1&&i.Orientation!==2,o=[2,4,5,7].indexOf(i.Orientation)!==-1;if(r||o){if(typeof navigator=="undefined"){let n=this.createOperation("exif-orientation",{},!1);n.setTags(i),e=n.applyTo(e)}else{let n=window&&window.navigator&&window.navigator.userAgent||"";if(!!n.match(/msie|trident/i)||n.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image")){let a=this.createOperation("exif-orientation",{},!1);a.setTags(i),e=a.applyTo(e)}}return t.setOrientation(1),i.Orientation=1,e}}return e}hasImage(){return this._image!==null&&typeof this._image!="undefined"}getImage(){return this._image}disposeTexture(e){this._texturesToDispose.push(e)}_disposeTextures(){for(let e=0;e<this._texturesToDispose.length;e++)this._texturesToDispose[e].dispose();this._texturesToDispose=[]}setImage(e,t=null,i=null){this._disposeTextures(),this._exifOperation&&(this.removeOperation(this._exifOperation),this._exifOperation=null),this._options.image=e,this._image=e,this._exif=t||this.parseExif(e),this._exif&&this._handleExifOrientation();let r=new jt.BaseTexture(this._image),o=new AE(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);i&&(o.width=i.x,o.height=i.y),this._resizedTexture&&this._resizedTexture.dispose(),this._resizedTexture=null,this._inputTexture&&this.disposeTexture(this._inputTexture.getBaseTexture()),this._inputTexture=new jt.Texture(r,o),this._currentTexture=this._inputTexture,this._sprite.clearTexture(!1),this._sprite.setTexture(this._inputTexture),this.emit("new-image"),this.setAllOperationsToDirty(!0)}setInputTexture(e){this._inputTexture=e}getCanvas(){return this._renderer.getCanvas()}setCanvas(e){this._renderer.setCanvas(e)}getSprite(){return this._sprite}getContainer(){return this._container}getOperationsStack(){return this._operationsStack}setOperationsStack(e){this._operationsStack&&this._operationsStack.off(Dd.OPERATION_UPDATED,this._onOperationUpdate),this._operationsStack=e,this._operationsStack.on(Dd.OPERATION_UPDATED,this._onOperationUpdate)}getOperations(){return this._operations}getRenderer(){return this._renderer}getOffset(){return this._offset}setOffset(e,t){e instanceof kd?this._offset.copy(e):this._offset.set(e,t)}getRenderMode(){return this._renderMode}setRenderMode(e){this._renderMode=e}getZoom(){return this._zoom}setZoom(e){this._zoom=e,this._container.setScale(this._zoom,this._zoom),this._container.updateTransform()}getTextureQuality(){return this._renderMode==="export"?1:this._textureQuality}setTextureQuality(e){e!==this._textureQuality&&this.setAllOperationsToDirty(!0),this._textureQuality=Math.min(1,e),this._textureQuality===1&&this._resizedTexture&&(this._resizedTexture.dispose(),this._resizedTexture=null)}getSpriteScale(){return this._spriteScale}setSpriteScale(e){this._spriteScale=e,this._sprite.setScale(e,e),this._sprite.updateTransform()}getPixelRatio(){return this._options.pixelRatio}getExif(){return this._exif}getOptions(){return this._options}getInputTexture(){return this._inputTexture}setSmoothDownscaling(e){this._options.smoothDownscaling=e,this._sprite.setSmoothDownscaling(e),this._resizedSprite.setSmoothDownscaling(e)}setRotation(e){this._rotation=e}getRotation(){return this._rotation}hasChanges(){return this.getOperationsStack().hasChanges()}dispose(){this._operationsStack.dispose(),this._renderer.dispose(),this._exif&&this._exif.dispose(),this._resizedTexture&&this._resizedTexture.dispose()}},Ie=vy});var NE,X,ra=_(()=>{ii();Hg();Ot();Qn();_o();wo();To();sy();Co();Fl();Sl();ud();hd();yd();hi();wd();vd();wy();Ie.version="3.9.0";Ie.Math=L;Ie.Operations=Mo;Ie.Engine=R;Ie.Color=S;Ie.LicenseChecker=Dl;Ie.Operation=ce;Ie.EventEmitter=dt;Ie.Utils=E;Ie.Env=ry;Ie.OperationsStack=Al;Ie.EXIF=ia;Ie.Image=wt;Ie.Configurable=J;Ie.Log=B;Ie.Loaders=Im;Ie.RenderType=St;Ie.ImageFormat=Qr;Ie.OptionType=h;Ie.RendererType=K;Ie.UniformType=A;Ie.Base64=ti;NE={};Ie.UI=NE;X=Ie});var O=_(()=>{ra();ra()});var Dy,Cy=_(()=>{Dy=`precision highp float;

varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform float u_gamma;
uniform float u_shadows;
uniform float u_highlights;
uniform float u_whites;
uniform float u_blacks;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.0000001;

float calculateLuminance(vec3 rgb) {
    // This is the luminance calculation part of the RGB to HSL formular.
    vec4 p = mix(
        vec4(rgb.gb, 0.0, -1.0 / 3.0),
        vec4(rgb.bg, -1.0, 2.0 / 3.0),
        vec4(rgb.g < rgb.b)
    );

    vec4 q = mix(
        vec4(rgb.r, p.yzx),
        vec4(p.xyw, rgb.r),
        vec4(rgb.r < p.x)
    );

    float croma = q.x - min(q.w, q.y);
    float luminance = q.x - croma * 0.5;
    return luminance;
}

vec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
}

void main() {

  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha

  // Apply gamma
  if (u_gamma != 1.0) {
    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));
  }

  // Apply shadows and highlights
  float luminance = calculateLuminance(color.rgb);

  float shadow = u_shadows >= 0.0
    ? clamp(
          pow(luminance, 1.0 / (u_shadows + 1.0))
          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(u_shadows, 1.0))
    : -clamp(
          pow(luminance, 1.0 / (-u_shadows + 1.0))
          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(-u_shadows, 1.0));

  float highlight = u_highlights < 0.0
    ? clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0)
    : -clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0);

  // Bright color need more contrast and dark color need more brightness.
  // This is to keep saturatation because the color information of a dark colors is lost.
  float shadowContrast   = shadow * luminance * luminance;
  float shadowBrightness = shadow - shadowContrast;

  float offset = luminance + shadowContrast + highlight;
  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);
  
  // Apply Color Matrix
  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;
  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);
  color = clamp(color, 0.0, 1.0);
  color.rgb *= color.a; // Reset premultiplied alpha

  gl_FragColor = color;
}
`});function Td(s,e,t,i,r){return(s-e)*(r-i)/(t-e)+i}var GE,Bo,WE,Rd,Ml,Ed=_(()=>{O();Cy();({ColorMatrix:GE}=L),Bo=1e-7;WE=s=>{let e=Math.max(s.r,s.g,s.b),t=Math.min(s.r,s.g,s.b);return(e+t)/2},Rd=class extends R.Filter{constructor(){super();this._fragmentSource=Dy}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{colorMatrix:u,gamma:c,shadows:p,highlights:m,whites:d,blacks:f}=this._options,b=c!==1,y=p!==0||m!==0,g=new S(0,0,0,0);for(let C=0;C<o.width*o.height;C++){let x=C*4;if(g.r=l.data[x]/255,g.g=l.data[x+1]/255,g.b=l.data[x+2]/255,b&&(g.r=Math.pow(g.r,1/Math.max(c,Bo)),g.g=Math.pow(g.g,1/Math.max(c,Bo)),g.b=Math.pow(g.b,1/Math.max(c,Bo))),y){let v=WE(g),M=p>=0?E.clamp(Math.pow(v,1/(p+1))+Math.pow(v,2/(p+1))*-.76-v,0,Math.max(p,1)):-E.clamp(Math.pow(v,1/(-p+1))+Math.pow(v,2/(-p+1))*-.76-v,0,Math.max(-p,1)),w=m<0?E.clamp(1-Math.pow(1-v,1/(1-m))-Math.pow(1-v,2/(1-m))*-.8-v,-1,0):-E.clamp(1-Math.pow(1-v,1/(1+m))-Math.pow(1-v,2/(1+m))*-.8-v,-1,0),k=M*v*v,q=M-k,j=v+k+w;g.r=E.clamp(j*((g.r+q)/Math.max(v,Bo)),0,1),g.g=E.clamp(j*((g.g+q)/Math.max(v,Bo)),0,1),g.b=E.clamp(j*((g.b+q)/Math.max(v,Bo)),0,1)}g=u.apply(g).clamp(0,1),g.r=Td(g.r,0,1,f/2,1+d/2),g.g=Td(g.g,0,1,f/2,1+d/2),g.b=Td(g.b,0,1,f/2,1+d/2),l.data[x]=g.r*255,l.data[x+1]=g.g*255,l.data[x+2]=g.b*255}a.putImageData(l,0,0)}};Rd.prototype.availableOptions={gamma:{type:h.NUMBER,default:1,uniformType:A.FLOAT},shadows:{type:h.NUMBER,default:0,uniformType:A.FLOAT},highlights:{type:h.NUMBER,default:1,uniformType:A.FLOAT},whites:{type:h.NUMBER,default:0,uniformType:A.FLOAT},blacks:{type:h.NUMBER,default:0,uniformType:A.FLOAT},colorMatrix:{type:h.COLOR_MATRIX,default:new GE,uniformType:A.MAT4},colorOffset:{type:h.ARRAY,default:[],uniformType:A.FLOAT4}};Ml=Rd});var Ty,ky=_(()=>{Ty=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)
uniform vec2 u_pixelDimension;

// Range (-1.0 - 1.0)
uniform float u_clarity;

varying vec2 v_texCoord;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.000001;

vec4 unpremultiply(vec4 col) {
    col.rgb /= max(col.a, EPSILON);
    return col;
}

void main() {
    vec4 color = texture2D(u_image, v_texCoord);
    color = unpremultiply(color);

    // L = Left, R = Right, C = Center, T = Top, B = Bottom
    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));
    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));

    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));
    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));
    
    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));
    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));

    vec4 mergedColor = color;
    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;
    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;
    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;

    mergedColor /= 9.0;

    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);
    // 1.0 and 0.0 result in white not black, therefore we clamp

    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,
    // and for values between 0.1 and 0.2 it will produce a gradient.
    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.
    // And values above 0.9 will be mapped to 0.
    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));

    // here we apply the high pass filter. Its strength is determined by the uniform ,
    // and the frequence factor. That means the only the mid tones are affected by this filter.
    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.
    // Therefore we see this little magic number '3.7'.
    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;

    // apply exposure but only to the mid tones.
    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);

    // apply contrast and desaturation matrix
    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;

    color.rgb *= color.a; // Premultiply alpha

    gl_FragColor = clamp(color, 0.0, 1.0);
}
`});var jE,HE,Fd,Ry,Ey=_(()=>{O();ky();({Vector2:jE,ColorMatrix:HE}=L),Fd=class extends R.Filter{constructor(){super();this._fragmentSource=Ty}_applyCanvas(e,t,i,r=!1){let o=i.getContext(),n=t.getCanvas(),a=t.getContext(),{clarity:l}=this._options,{colorMatrix:u}=this._options,c=new S(this._options.colorOffset[0],this._options.colorOffset[1],this._options.colorOffset[2],this._options.colorOffset[3]),{width:p}=n,{height:m}=n,d=a.getImageData(0,0,p,m),f=o.createImageData(p,m);this.canvasShader(d,f,l,u,c),o.putImageData(f,0,0)}canvasShader(e,t,i,r,o){let n=(g,C,x)=>Math.min(Math.max(g,C),x),a=(g,C,x)=>{let v=n((x-g)/(C-g),0,1);return v*v*(3-2*v)},l=e.width*4,{length:u}=e.data,c=u-1,p=0,m=e.data,d=t.data,f=new S,b=255*9,y=g=>(g=g<p?p:g,g=g>c?c:g,m[g]);for(let g=0;g<u;g+=4){let C=y(g+0),x=y(g+1),v=y(g+2),M=y(g+3),w=(C+y(g-4-l+0)+y(g-4+0)+y(g-4+l+0)+y(g-l+0)+y(g+l+0)+y(g+4-l+0)+y(g+4+0)+y(g+4+l))/b,k=(x+y(g-4-l+1)+y(g-4+1)+y(g-4+l+1)+y(g-l+1)+y(g+l+1)+y(g+4-l+1)+y(g+4+1)+y(g+4+l+1))/b,q=(v+y(g-4-l+2)+y(g-4+2)+y(g-4+l+2)+y(g-l+2)+y(g+l+2)+y(g+4-l+2)+y(g+4+2)+y(g+4+l+2))/b,j=(M+y(g-4-l+3)+y(g-4+3)+y(g-4+l+3)+y(g-l+3)+y(g+l+3)+y(g+4-l+3)+y(g+4+3)+y(g+4+l+3))/b;C/=255,x/=255,v/=255,M/=255;let Z=n(C*.3+x*.59+v*.1,.111111,.999999),re=Math.min(a(1-Z,0,.11),a(Z,0,.11)),te=i*3.7*re,Y=Math.pow(2,i*.27*re),xe=n(C+n((C-w)*te,0,10),0,1)*Y,ct=n(x+n((x-k)*te,0,10),0,1)*Y,Qe=n(v+n((v-q)*te,0,10),0,1)*Y,ni=n(M+n((M-j)*te,0,10),0,1);f.set(xe,ct,Qe,ni);let se=r.apply(f).clamp(0,1);d[g+0]=se.r*255,d[g+1]=se.g*255,d[g+2]=se.b*255,d[g+3]=se.a*255}}};Fd.prototype.availableOptions={clarity:{type:h.NUMBER,default:0,uniformType:A.FLOAT},pixelDimension:{type:h.VECTOR2,default:new jE(100,100),uniformType:A.FLOAT2},colorMatrix:{type:h.COLOR_MATRIX,default:new HE,uniformType:A.MAT4},colorOffset:{type:h.ARRAY,default:[],uniformType:A.FLOAT4}};Ry=Fd});var Sy,Fy=_(()=>{Sy=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec2 u_pixelDimension;
uniform float u_sharpness;
 
const float EPSILON = 0.000001;
 
void main() {
    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);

    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));
    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;
 
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);
 
    color.rgb /= max(color.a, EPSILON); // unpremultiply
    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply
 
    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);
 
    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);
      
    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply
}`});var KE,Sd,Oy,Ay=_(()=>{O();Fy();({Vector2:KE}=L),Sd=class extends R.Filter{constructor(){super();this._fragmentSource=Sy}_applyCanvas(e,t,i,r=!1){let o=i.getContext(),n=t.getCanvas(),a=t.getContext(),{sharpness:l}=this._options,{width:u}=n,{height:c}=n,p=a.getImageData(0,0,u,c),m=o.createImageData(u,c);this.canvasShader(p,m,l),o.putImageData(m,0,0)}canvasShader(e,t,i){let r=(v,M,w)=>Math.min(Math.max(v,M),w),o=1e-6,{width:n}=e,{height:a}=e,l=e.data,u=t.data,c=(v,M,w)=>v*(1-w)+M*w,p=v=>r(l[v]/255,0,1),m=(v,M)=>{let w=r(v,0,n-1),k=r(M,0,a-1);return 4*(w+n*k)},d=[],f=[],b=[-1,0,0,1],y=[0,-1,1,0],g=i>0?-1:.2,C=i>0?5:.2,x=Math.abs(i);for(let v=0;v<n;v++)for(let M=0;M<a;M++){let w=m(v,M);d[0]=p(w+0),d[1]=p(w+1),d[2]=p(w+2),d[3]=p(w+3),f[0]=C*d[0]*d[3],f[1]=C*d[1]*d[3],f[2]=C*d[2]*d[3],f[3]=C*d[3];for(let k=0;k<4;k++){let q=b[k],j=y[k],Z=m(v+q,M+j),re=p(Z+3);f[3]+=g*re;for(let te=0;te<3;te++)f[te]+=g*p(Z+te)*re}for(let k=0;k<3;k++)f[k]/=Math.max(f[3],o),f[k]=r(f[k],0,1);f[3]=r(f[3],0,1);for(let k=0;k<4;k++)d[k]=r(c(d[k],f[k],x),0,1),u[w+k]=d[k]*255}}};Sd.prototype.availableOptions={sharpness:{type:h.NUMBER,default:0,uniformType:A.FLOAT},pixelDimension:{type:h.VECTOR2,default:new KE(100,100),uniformType:A.FLOAT2}};Oy=Sd});var Py,Iy=_(()=>{Py=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Range (-1.0 - 1.0)
uniform float u_temperature;

const lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);

const mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);
const mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);

const float EPSILON = 0.0000001;

varying vec2 v_texCoord;
void main() {
  float temperature = u_temperature;
  const float tint = 0.0;
  vec4 source = texture2D(u_image, v_texCoord);

  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha

  vec3 yiq = RGBtoYIQ * source.rgb;
  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);
  vec3 rgb = YIQtoRGB * yiq;

  vec3 processed = mix(
    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),
    (2.0 * rgb * warmFilter),
    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)
  );

  vec4 color = vec4(mix(rgb, processed, temperature), source.a);

  color.rgb *= color.a;   // Premultiply alpha again

  gl_FragColor = color;
}
`});var Od,My,By=_(()=>{O();Iy();Od=class extends R.Filter{constructor(){super();this._fragmentSource=Py}_applyCanvas(e,t,i,r=!1){let o=i.getContext(),n=t.getCanvas(),a=t.getContext(),{temperature:l}=this._options,{width:u}=n,{height:c}=n,p=a.getImageData(0,0,u,c),m=o.createImageData(u,c);this.canvasShader(p,m,l),o.putImageData(m,0,0)}canvasShader(e,t,i){let r=(g,C,x)=>Math.min(Math.max(g,C),x),o=(g,C,x)=>g*(1-x)+C*x,n=(g,C)=>{let x=g[0]*C[0]+g[3]*C[1]+g[6]*C[2],v=g[1]*C[0]+g[4]*C[1]+g[7]*C[2],M=g[2]*C[0]+g[5]*C[1]+g[8]*C[2];return[x,v,M]},{length:a}=e.data,l=a-1,u=0,c=e.data,p=t.data,m=g=>(g=g<u?u:g,g=g>l?l:g,c[g]),d=[.93,.54,0],f=[.299,.587,.114,.596,-.274,-.322,.212,-.523,.311],b=[1,.956,.621,1,-.272,-.647,1,-1.105,1.702],y=0;for(let g=0;g<a;g+=4){let C=m(g+0)/255,x=m(g+1)/255,v=m(g+2)/255,M=m(g+3)/255,k=n(f,[C,x,v]);k.z=r(k.z+y*.5226*.1,-.5226,.5226);let q=n(b,k),j=[q[0]<.5?2*q[0]*d[0]:1-2*(1-q[0])*(1-d[0]),q[1]<.5?2*q[1]*d[1]:1-2*(1-q[1])*(1-d[1]),q[2]<.5?2*q[2]*d[2]:1-2*(1-q[2])*(1-d[2])];p[g+0]=o(q[0],j[0],i)*255,p[g+1]=o(q[1],j[1],i)*255,p[g+2]=o(q[2],j[2],i)*255,p[g+3]=M*255}}};Od.prototype.availableOptions={temperature:{type:h.NUMBER,default:0,uniformType:A.FLOAT}};My=Od});var Dr,sa,Ly,zy=_(()=>{O();Ed();Ey();Ay();By();({ColorMatrix:Dr}=L),sa=class extends ce{constructor(...e){super(...e);this._clarityFilter=new Ry,this._temperatureFilter=new My,this._sharpnessFilter=new Oy,this._filter=new Ml,this._sprite.setFilters([this._clarityFilter,this._temperatureFilter,this._filter])}_render(e){let t=e.getDimensions();t.x=1/t.x,t.y=1/t.y;let i=new Dr;i.multiply(Dr.createSaturationMatrix(-.3*this._options.clarity+1)),i.multiply(Dr.createContrastMatrix(.1*this._options.clarity+1)),this._clarityFilter.set({clarity:this._options.clarity,pixelDimension:t,colorMatrix:i,colorOffset:i.getOffsets()}),this._temperatureFilter.set({temperature:this._options.temperature}),this._sharpnessFilter.set({sharpness:this._options.sharpness,pixelDimension:t});let r=new Dr;r.multiply(Dr.createExposureMatrix(this._options.exposure)),r.multiply(Dr.createSaturationMatrix(this._options.saturation+1)),r.multiply(Dr.createContrastMatrix((this._options.contrast>0?this._options.contrast*2:this._options.contrast)+1)),r.multiply(Dr.createBrightnessMatrix(this._options.brightness)),this._filter.set({gamma:this._options.gamma,shadows:this._options.shadows,highlights:this._options.highlights,whites:this._options.whites,blacks:this._options.blacks,colorMatrix:r,colorOffset:r.getOffsets()});let o=[];return this._options.clarity!==0&&o.push(this._clarityFilter),this._options.sharpness!==0&&o.push(this._sharpnessFilter),this._options.temperature!==0&&o.push(this._temperatureFilter),o.push(this._filter),this._sprite.setFilters(o),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._clarityFilter.dispose(),this._temperatureFilter.dispose(),this._sharpnessFilter.dispose()}};sa.identifier="adjustments";sa.prototype.availableOptions={brightness:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},saturation:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},contrast:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},gamma:{type:h.NUMBER,default:1,minValue:.5,midValue:1,maxValue:2},exposure:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},shadows:{type:h.NUMBER,default:0,minValue:-2,midValue:0,maxValue:2},highlights:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},clarity:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},whites:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},blacks:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},temperature:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},sharpness:{type:h.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1}};X.Operations.AdjustmentsOperation=sa;Ly=sa});var Uy,Ny=_(()=>{Uy=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);
    float radius = u_blurRadius;

    const float steps = 30.0;

    for (float t = -steps; t <= steps; t++) {
        float percent = (t + offset - 0.5) / steps;
        float weight = 1.0 - abs(percent);

        // Somehow \`sample\` is a keyword in headless-gl
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`});var Bl,Ad,Ct,Lo=_(()=>{O();Ny();({Vector2:Bl}=L),Ad=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=Uy,this._lastBlurRadius=null,this._lastDimensions=new Bl(0,0),this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1,o=null){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let n=t.getCanvas(),a=t.getContext(),l=i.getContext();this._lastBlurRadius===this._options.blurRadius&&l.drawImage(n,0,0);let u=a.getImageData(0,0,n.width,n.height),c=l.getImageData(0,0,n.width,n.height),p=this._options.blurRadius,{delta:m}=this._options,d=30;for(let f=0;f<n.width;f++)for(let b=0;b<n.height;b++){let g=(f+b*n.width)*4,C=0,x=0,v=0,M=0,w=0;o&&(p=o(f/n.width,b/n.height));let k=this._random(f,1-b/n.height);for(let q=-d;q<=d;q++){let j=(q+k-.5)/d,Z=1-Math.abs(j),re=m.x*j*p,te=m.y*j*p,Y=Math.max(Math.min(f+re,n.width-1),0),xe=Math.max(Math.min(b+te,n.height-1),0),ct=(Math.round(xe)*n.width+Math.round(Y))*4,Qe=u.data[ct+3],ni=Qe*u.data[ct],se=Qe*u.data[ct+1],Me=Qe*u.data[ct+2];C+=ni*Z,x+=se*Z,v+=Me*Z,M+=Qe*Z,w+=Z}C/=w,x/=w,v/=w,M/=w,c.data[g]=C/M,c.data[g+1]=x/M,c.data[g+2]=v/M,c.data[g+3]=M}l.putImageData(c,0,0),this._lastDimensions.copy(new Bl(n.width,n.height))}_renderLQBlur(e,t,i,r){let o=t.getDimensions(),n=!this._lastDimensions.equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),i.setPixelRatio(t.getPixelRatio()),i.resizeTo(t.getDimensions()),(this._lastBlurRadius!==this._options.blurRadius||n)&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),i.getContext().drawImage(this._blurredRenderTarget.getCanvas(),0,0),this._lastDimensions.copy(o)}_random(e,t){let i=12.9898,r=78.233,o=43758.5453,n=e*i+t*r,a=n-3.14*Math.floor(n/3.14),l=Math.sin(a)*o;return l-Math.floor(l)}};Ad.prototype.availableOptions={blurRadius:{type:h.NUMBER,default:30,uniformType:A.FLOAT},delta:{type:h.VECTOR2,default:new Bl(1,1),uniformType:A.FLOAT2},texSize:{type:h.VECTOR2,default:new Bl(100,100),uniformType:A.FLOAT2},blurQuality:{type:h.STRING,default:"low"}};Ct=Ad});var Gy,oa,Wy,Vy=_(()=>{O();Lo();({Vector2:Gy}=L),oa=class extends ce{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;let t={blurQuality:{type:h.STRING}};this._horizontalFilter=new Ct({},t),this._verticalFilter=new Ct({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Gy(.5,.5)),this._verticalFilter.setDelta(new Gy(-.5,.5)),this._filter=new Ct({},t)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),{blurRadius:r}=this._options,o={blurRadius:r*i,texSize:t,blurQuality:"high"};return this._horizontalFilter.set(o),this._verticalFilter.set(o),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let{blurRadius:t}=this._options,i=e.getDimensions();return this._filter.set({blurRadius:t,texSize:i,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}transform(e){let t=this.getBlurRadius(),i=e.applyToRelativeSize(t);this.set({blurRadius:i},!1)}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};oa.identifier="blur";oa.prototype.availableOptions={blurRadius:{type:h.NUMBER,default:.025},highQualityCanvasBlur:{type:h.BOOLEAN,default:!1}};X.Operations.BlurOperation=oa;Wy=oa});var Hy,jy=_(()=>{Hy=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filteredImage;
uniform float u_intensity;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filteredImage, v_texCoord);
  gl_FragColor = mix(color0, color1, u_intensity);
}
`});var Id,qy,Pd,Ky=_(()=>{O();jy();Id=class extends R.Filter{constructor(){super();this._fragmentSource=Hy}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=i.getContext(),{filteredCanvas:a}=this._options;n.save(),n.drawImage(o,0,0),n.globalAlpha=this._options.intensity,n.drawImage(a,0,0),n.restore()}};Id.prototype.availableOptions={filteredImage:{type:h.NUMBER,default:1,uniformType:A.INT},filteredCanvas:{type:h.OBJECT,default:null},intensity:{type:h.NUMBER,default:1,uniformType:A.FLOAT}};qy=class{constructor(e=1){this._intensity=e,this._stack=[],this._dirtiness={},this._renderTextures={},this._container=new R.Container,this._sprite=new R.Sprite,this._container.addChild(this._sprite),this._blendFilter=new Id}push(e){this._stack.push(e)}clear(){this._stack=[]}render(e,t,i){if(this.isEmpty())return Promise.resolve();let r=e.getRenderer();this._sprite.setTexture(t);let o=this._renderTextures[r.id];if(!o){let l=e.getSprite().getTexture().getFrame();o=new R.RenderTexture(e.getRenderer(),l.width,l.height),this._renderTextures[r.id]=o}let n=i.getDimensions();o.resizeTo(n);let a=this.isDirtyForRenderer(r);if(a){this._stack.forEach(u=>{u.update(e)});let l=this._stack.map(u=>u.getFilter());this._sprite.setFilters(l),o.render(this._container),this.setDirtyForRenderer(!1,r)}if(this._blendFilter.setIntensity(this._intensity),r.isOfType(K.CANVAS))this._blendFilter.setFilteredCanvas(o.getRenderTarget().getCanvas());else if(r.isOfType(K.WEBGL)){let l=o.getBaseTexture();l.setGLUnit(this._blendFilter.getFilteredImage()),r.updateTexture(l,!1)}return this._sprite.setFilters([this._blendFilter]),i.clear(S.TRANSPARENT),i.render(this._container),a&&this.disposeRenderTextures(),Promise.resolve()}setIntensity(e){this._intensity=e}isEmpty(){return this._stack.length===0}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._dirtiness[t.id]=e}setDirty(e){for(let t in this._dirtiness)this._dirtiness[t]=e}disposeRenderTextures(){for(let e in this._renderTextures)this._renderTextures[e].dispose(),delete this._renderTextures[e]}dispose(){this.disposeRenderTextures(),this._stack.forEach(e=>e.dispose()),this._stack=[],this._blendFilter.dispose(),this._sprite.dispose()}},Pd=qy});var zo,V,de=_(()=>{O();Ky();zo=class extends J{constructor(e={},t={}){super(e,D({intensity:{type:h.NUMBER,default:1,setter(i){return this._stack&&this._stack.setIntensity(i),i}},dirty:{type:h.BOOLEAN,default:!0}},t));this._stack=new Pd(this._options.intensity)}render(e,t,i){return this._stack.render(e,t,i).then(r=>(this.setDirty(!1),r))}setDirtyForRenderer(e,t){this._stack.setDirtyForRenderer(e,t)}disposeRenderTextures(){this._stack.disposeRenderTextures()}dispose(){this._stack.dispose()}};zo.identifier=null;zo.isIdentity=!1;zo.displayName=null;zo.PrimitivesStack=Pd;V=zo});var Yy,Xy=_(()=>{Yy=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_brightness;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;
}
`});var Jy,ye,at=_(()=>{O();Jy=class extends J{update(){}getFilter(){return this._filter}dispose(){this._filter&&(this._filter.dispose(),this._filter=null)}},ye=Jy});var Ll,Md,ms,$y=_(()=>{O();Xy();at();Ll=class extends R.Filter{constructor(){super();this._fragmentSource=Yy}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{brightness:u}=this._options;if(u===0){a.putImageData(l,0,0);return}u*=255;for(let c=0;c<o.width*o.height;c++){let p=c*4;l.data[p]+=u,l.data[p+1]+=u,l.data[p+2]+=u}a.putImageData(l,0,0)}};Ll.prototype.availableOptions={brightness:{type:h.NUMBER,default:0,uniformType:A.FLOAT}};Md=class extends ye{constructor(...e){super(...e);this._filter=new Ll}update(){this._filter.setBrightness(this._options.brightness)}};Md.prototype.availableOptions=Ll.prototype.availableOptions;ms=Md});var Qy,Zy=_(()=>{Qy=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_contrast;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);
}
`});var zl,Bd,Dt,eb=_(()=>{O();Zy();at();zl=class extends R.Filter{constructor(){super();this._fragmentSource=Qy}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{contrast:u}=this._options;if(u!==1){for(let c=0;c<o.width*o.height;c++){let p=c*4;l.data[p]=(l.data[p]-127)*u+127,l.data[p+1]=(l.data[p+1]-127)*u+127,l.data[p+2]=(l.data[p+2]-127)*u+127}a.putImageData(l,0,0)}}};zl.prototype.availableOptions={contrast:{type:h.NUMBER,default:1,uniformType:A.FLOAT}};Bd=class extends ye{constructor(...e){super(...e);this._filter=new zl}update(){this._filter.setContrast(this._options.contrast)}};Bd.prototype.availableOptions=zl.prototype.availableOptions;Dt=Bd});var ib,tb=_(()=>{ib=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform mat4 u_colorMatrix;
uniform vec4 u_colorMatrixOffset;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;
}
`});var e1,Nl,Ld,Ul,rb=_(()=>{O();tb();at();({ColorMatrix:e1}=L),Nl=class extends R.Filter{constructor(){super();this._fragmentSource=ib}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{colorMatrix:u}=this._options,c=new S(0,0,0,0);for(let p=0;p<o.width*o.height;p++){let m=p*4;c.r=l.data[m]/255,c.g=l.data[m+1]/255,c.b=l.data[m+2]/255,c=u.apply(c),l.data[m]=c.r*255,l.data[m+1]=c.g*255,l.data[m+2]=c.b*255}a.putImageData(l,0,0)}};Nl.prototype.availableOptions={colorMatrix:{type:h.COLOR_MATRIX,default:new e1,uniformType:A.MAT4},colorMatrixOffset:{type:h.ARRAY,default:[],uniformType:A.FLOAT4}};Ld=class extends ye{constructor(...e){super(...e);this._filter=new Nl}update(){this._filter.setColorMatrix(this._options.colorMatrix)}};Ld.prototype.availableOptions=Nl.prototype.availableOptions;Ul=Ld});var ob,sb=_(()=>{ob=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_desaturation;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 grayXfer = vec3(0.3, 0.59, 0.11);
  vec3 gray = vec3(dot(grayXfer, texColor.xyz));
  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);
}
`});var Gl,zd,_i,nb=_(()=>{O();sb();at();Gl=class extends R.Filter{constructor(){super();this._fragmentSource=ob}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),u=[.3,.59,.11],{desaturation:c}=this._options;for(let p=0;p<o.width*o.height;p++){let m=p*4,d=u[0]*l.data[m]/255+u[1]*l.data[m+1]/255+u[2]*l.data[m+2]/255;l.data[m]+=(d*255-l.data[m])*c,l.data[m+1]+=(d*255-l.data[m+1])*c,l.data[m+2]+=(d*255-l.data[m+2])*c}a.putImageData(l,0,0)}};Gl.prototype.availableOptions={desaturation:{type:h.NUMBER,default:1,uniformType:A.FLOAT}};zd=class extends ye{constructor(...e){super(...e);this._filter=new Gl}update(){this._filter.setDesaturation(this._options.desaturation)}};zd.prototype.availableOptions=Gl.prototype.availableOptions;_i=zd});var lb,ab=_(()=>{lb=`precision highp float;

uniform sampler2D u_image;
uniform vec4 u_lightColor;
uniform vec4 u_darkColor;
uniform float u_intensity;
varying vec2 v_texCoord;

const float EPSILON = 0.0000001;
const vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);

vec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {
  vec4 color = clamp(sampledCol, 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON);
  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES
 
  // Apply intensity as "symmetric gamma"
  if (intensity > 0.0) {
    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));
  } else {
    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));
  }
 
  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion
  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale
  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);
 
  // Apply DuoTone
  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));
  duotone.a *= color.a;
  
  duotone.rgb *= duotone.a;

  return duotone;
}

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);
}`});var Wl,Nd,Vl,ub=_(()=>{O();ab();at();Wl=class extends R.Filter{constructor(){super();this._fragmentSource=lb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{lightColor:u,darkColor:c,intensity:p}=this._options;for(let m=0;m<o.width*o.height;m++){let d=m*4,f=l.data[d]/255,b=l.data[d+1]/255,y=l.data[d+2]/255,g=l.data[d+3]/255,C=new S(f,b,y,g),x=this._duoToneKernel(C,u,c,p);l.data[d]=x.r*255,l.data[d+1]=x.g*255,l.data[d+2]=x.b*255,l.data[d+3]=x.a*255}a.putImageData(l,0,0)}_duoToneKernel(e,t,i,r){let o=1e-7;if(e.clone().clamp(0,1),r>0){let u=Math.max(r+1,o);e.r=1-Math.pow(1-e.r,u),e.g=1-Math.pow(1-e.g,u),e.b=1-Math.pow(1-e.b,u)}else{let u=Math.max(-r+1,o);e.r=Math.pow(e.r,u),e.g=Math.pow(e.g,u),e.b=Math.pow(e.b,u)}let n=.2126*e.r+.7152*e.g+.0722*e.b,a=Math.min(Math.max(n,0),1),l=i.clone().mix(t,a);return l.a*=e.a,l}};Wl.prototype.availableOptions={lightColor:{type:h.COLOR,default:S.RED,uniformType:A.FLOAT4},darkColor:{type:h.COLOR,default:S.BLACK,uniformType:A.FLOAT4},intensity:{type:h.NUMBER,default:.5,uniformType:A.FLOAT}};Nd=class extends ye{constructor(...e){super(...e);this._filter=new Wl}update(){this._filter.setLightColor(this._options.lightColor),this._filter.setDarkColor(this._options.darkColor);let e=2*this._options.intensity-1;this._filter.setIntensity(e)}};Nd.prototype.availableOptions=Wl.prototype.availableOptions;Vl=Nd});var mb,cb=_(()=>{mb=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_gamma;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);
  rgb = pow(rgb, u_gamma);
  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;
}
`});var jl,Ud,Hl,db=_(()=>{O();cb();at();jl=class extends R.Filter{constructor(){super();this._fragmentSource=mb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{gamma:u}=this._options,c=new Float32Array(256);for(let d=0;d<256;d++)c[d]=255*Math.pow(d/255,u.r);let p=new Float32Array(256);for(let d=0;d<256;d++)p[d]=255*Math.pow(d/255,u.g);let m=new Float32Array(256);for(let d=0;d<256;d++)m[d]=255*Math.pow(d/255,u.b);for(let d=0;d<o.width*o.height;d++){let f=d*4;l.data[f]=c[l.data[f]],l.data[f+1]=p[l.data[f+1]],l.data[f+2]=m[l.data[f+2]]}a.putImageData(l,0,0)}};jl.prototype.availableOptions={gamma:{type:h.COLOR,default:S.WHITE,uniformType:A.FLOAT3}};Ud=class extends ye{constructor(...e){super(...e);this._filter=new jl}update(){this._filter.setGamma(this._options.gamma)}};Ud.prototype.availableOptions=jl.prototype.availableOptions;Hl=Ud});var pb,hb=_(()=>{pb=`varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);

  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);
  textureCoord /= 0.75;

  float d = 1.0 - dot(textureCoord, textureCoord);
  d = clamp(d, 0.2, 1.0);
  vec3 newColor = texColor.rgb * d * u_color.rgb;
  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);
}
`});var ql,Gd,No,fb=_(()=>{O();hb();at();ql=class extends R.Filter{constructor(){super();this._fragmentSource=pb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{color:u}=this._options,c;for(let p=0;p<o.width;p++)for(let m=0;m<o.height;m++){let d=(o.width*m+p)*4,f=p/o.width,b=m/o.height,y=(f-.5)/.75,g=(b-.5)/.75,C=y*y,x=g*g;c=1-(C+x),c=Math.min(Math.max(c,.1),1),l.data[d]*=c*u.r,l.data[d+1]=l.data[d+1]*(c*u.g),l.data[d+2]=l.data[d+2]*(c*u.b),l.data[d+3]=255}a.putImageData(l,0,0)}};ql.prototype.availableOptions={color:{type:h.COLOR,default:S.WHITE,uniformType:A.FLOAT3}};Gd=class extends ye{constructor(...e){super(...e);this._filter=new ql}update(){this._filter.setColor(this._options.color)}};Gd.prototype.availableOptions=ql.prototype.availableOptions;No=Gd});var _b,gb=_(()=>{_b=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  texColor.b = texColor.g * 0.33;
  texColor.r = texColor.r * 0.6;
  texColor.b += texColor.r * 0.33;
  texColor.g = texColor.g * 0.7;
  gl_FragColor = texColor;
}
`});var yb,bb,Kl,xb=_(()=>{O();gb();at();yb=class extends R.Filter{constructor(){super();this._fragmentSource=_b}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++)for(let c=0;c<o.height;c++){let p=(o.width*c+u)*4;l.data[p+2]=l.data[p+1]*.33,l.data[p]*=.6,l.data[p+2]+=l.data[p]*.33,l.data[p+1]=l.data[p+1]*.7,l.data[p+3]=255}a.putImageData(l,0,0)}},bb=class extends ye{constructor(...e){super(...e);this._filter=new yb}},Kl=bb});var wb,vb=_(()=>{wb=`varying vec2 v_texCoord;
uniform sampler2D u_image;
vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, W);
  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);
}
`});var Cb,Db,Uo,kb=_(()=>{O();vb();at();Cb=class extends R.Filter{constructor(){super();this._fragmentSource=wb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++)for(let c=0;c<o.height;c++){let p=(o.width*c+u)*4,m=l.data[p]*.2125+l.data[p+1]*.7154+l.data[p+2]*.0721;l.data[p]=m,l.data[p+1]=m,l.data[p+2]=m}a.putImageData(l,0,0)}},Db=class extends ye{constructor(...e){super(...e);this._filter=new Cb}},Uo=Db});var Rb,Tb=_(()=>{Rb=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;
  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;
  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;

  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);
}
`});var Wd,Eb,Xl,Vd=_(()=>{O();Tb();at();Wd=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=Rb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),u=this._options.lookupTableData;for(let c=0;c<o.width*o.height;c++){let p=c*4,m=l.data[p];l.data[p]=u[m*4];let d=l.data[p+1];l.data[p+1]=u[1+d*4];let f=l.data[p+2];l.data[p+2]=u[2+f*4]}a.putImageData(l,0,0)}};Wd.prototype.availableOptions={lookupTable:{type:h.NUMBER,default:1,uniformType:A.INT},lookupTableData:{type:h.ARRAY,default:[]}};Eb=class extends ye{constructor(...e){super(...e);this._filter=new Wd({lookupTable:this._options.textureGLUnit}),this._textures={},this._renderers={}}update(e){let t=e.getRenderer();t.isOfType(K.WEBGL)?this._updateWebGLTexture(e):t.isOfType(K.CANVAS)&&this._filter.setLookupTableData(this._options.data)}_updateWebGLTexture(e){if(typeof this._options.data=="undefined")throw new Error("LookupTable: No data specified.");let t=new Uint8Array(this._options.data),i=e.getRenderer(),{id:r}=i;this._renderers[r]=i,this._textures[r]||(this._textures[r]=new R.BaseTexture);let o=this._textures[r],n=new R.PixelArrayImage(256,1,t);o.setSource(n),o.setGLUnit(this._options.textureGLUnit),i.isOfType(K.WEBGL)&&i.updateTexture(o)}dispose(){super.dispose();for(let e in this._textures)this._textures[e].dispose(),delete this._textures[e];delete this._options.data}},Xl=Eb});var Sb,Fb=_(()=>{Sb=`/**
 * Based off of GPUImage's LookupFilter:
 * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m
 */

varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float blueColor = texColor.b * 63.0;

  vec2 quad1;
  quad1.y = floor(floor(blueColor) / 8.0);
  quad1.x = floor(blueColor) - (quad1.y * 8.0);

  vec2 quad2;
  quad2.y = floor(ceil(blueColor) / 8.0);
  quad2.x = ceil(blueColor) - (quad2.y * 8.0);

  vec2 texCoord1;
  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec2 texCoord2;
  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);
  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);

  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);
}
`});var Ob,Ab,jd,Hd,Yl,Ib=_(()=>{O();Fb();at();({Vector2:Ob}=L),Ab=3,jd=class extends R.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=Sb}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){let t=e/255*63,i=new Ob;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=this._options.lookupTableImage,c=this._createImageCanvas(l).getContext("2d"),p=n.getImageData(0,0,o.width,o.height),m=c.getImageData(0,0,l.width,l.height),d=new Ob;for(let f=0;f<o.width*o.height*4;f+=4){let b=p.data[f],y=p.data[f+1],g=p.data[f+2],C=p.data[f+3]/255,x=this._quads[g],v=64;d.x=x.x*v,d.y=x.y*v,d.x+=Math.floor(b/4),d.y+=Math.floor(y/4);let M=(l.width*d.y+d.x)*4|0,w=m.data[M];w=b*(1-C)+w*C;let k=m.data[M+1];k=y*(1-C)+k*C;let q=m.data[M+2];q=g*(1-C)+q*C,p.data[f]=w,p.data[f+1]=k,p.data[f+2]=q}a.putImageData(p,0,0)}_createImageCanvas(e){let t=E.createCanvas();return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}};jd.prototype.availableOptions={lookupTable:{type:h.NUMBER,default:Ab,uniformType:A.INT},lookupTableImage:{type:h.IMAGE,uniformType:null}};Hd=class extends ye{constructor(...e){super(...e);this._filter=new jd,this._textures={}}update(e){let t=e.getRenderer();t.isOfType(K.WEBGL)?this._updateWebGLTexture(e):t.isOfType(K.CANVAS)&&this._filter.setLookupTableImage(this._options.image)}_updateWebGLTexture(e){let t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new R.BaseTexture);let r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(Ab),t.updateTexture(r)}dispose(){super.dispose();for(let e in this._textures)delete this._textures[e]}};Hd.prototype.availableOptions={image:{type:h.IMAGE}};Yl=Hd});var Mb,Pb=_(()=>{Mb=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_saturation;

const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, luminanceWeighting);

  vec3 greyScaleColor = vec3(luminance);

  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);
}
`});var Jl,qd,kt,Bb=_(()=>{O();Pb();at();Jl=class extends R.Filter{constructor(){super();this._fragmentSource=Mb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height),{saturation:u}=this._options;for(let c=0;c<o.width;c++)for(let p=0;p<o.height;p++){let m=(o.width*p+c)*4,d=l.data[m]*.2125+l.data[m+1]*.7154+l.data[m+2]*.0721;l.data[m]=d*(1-u)+l.data[m]*u,l.data[m+1]=d*(1-u)+l.data[m+1]*u,l.data[m+2]=d*(1-u)+l.data[m+2]*u}a.putImageData(l,0,0)}};Jl.prototype.availableOptions={saturation:{type:h.NUMBER,default:0,uniformType:A.FLOAT}};qd=class extends ye{constructor(...e){super(...e);this._filter=new Jl}update(){this._filter.setSaturation(this._options.saturation)}};qd.prototype.availableOptions=Jl.prototype.availableOptions;kt=qd});var zb,Lb=_(()=>{zb=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec4 overlayVec4 = vec4(u_color, texColor.a);
  gl_FragColor = max(overlayVec4 * texColor.a, texColor);
}
`});var $l,Kd,Zl,Nb=_(()=>{O();Lb();at();$l=class extends R.Filter{constructor(){super();this._fragmentSource=zb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++)for(let c=0;c<o.height;c++){let p=(o.width*c+u)*4;l.data[p]=Math.max(this._options.color.r*255,l.data[p]),l.data[p+1]=Math.max(this._options.color.g*255,l.data[p+1]),l.data[p+2]=Math.max(this._options.color.b*255,l.data[p+2])}a.putImageData(l,0,0)}};$l.prototype.availableOptions={color:{type:h.COLOR,default:S.WHITE,uniformType:A.FLOAT3}};Kd=class extends ye{constructor(...e){super(...e);this._filter=new $l}update(){this._filter.setColor(this._options.color)}};Kd.prototype.availableOptions=$l.prototype.availableOptions;Zl=Kd});var Xd,ee,Ub=_(()=>{O();Vd();Xd=class extends Xl{constructor(...e){super(...e);this._options.rgbControlPoints||(this._options.rgbControlPoints={red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}),this._updateLookupTable()}_updateLookupTable(){let e=this._calculateSplineCurve(this._options.rgbControlPoints.red),t=this._calculateSplineCurve(this._options.rgbControlPoints.green),i=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(e,t,i)}_buildLookupTable(e,t,i){let r=[];for(let o=0;o<256;o++)r.push(Math.min(Math.max(o+e[o],0),255)),r.push(Math.min(Math.max(o+t[o],0),255)),r.push(Math.min(Math.max(o+i[o],0),255)),r.push(255);return r}_calculateSplineCurve(e){e=e.sort(function(n,a){return n[0]>a[0]});let t=this._getSplineCurve(e),i=t[0],r;if(i[0]>0)for(r=0;r<i[0];r++)t.unshift([0,0]);let o=[];for(r=0;r<t.length;r++){let n=t[r],a=[n[0],n[0]],l=Math.sqrt(Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2));a[1]>n[1]&&(l=-l),o.push(l)}return o}_getSplineCurve(e){let t=this._secondDerivative(e),i=t.length,r=[],o;for(o=0;o<i;o++)r[o]=t[o];let n=[];for(o=0;o<i-1;o++){let a=e[o],l=e[o+1];for(let u=a[0];u<l[0];u++){let c=(u-a[0])/(l[0]-a[0]),p=1-c,m=c,d=l[0]-a[0],f=p*a[1]+m*l[1]+d*d/6*((p*p*p-p)*r[o]+(m*m*m-m)*r[o+1]);f>255?f=255:f<0&&(f=0),n.push([u,f])}}return n.length===255&&n.push(e[e.length-1]),n}_secondDerivative(e){let t=e.length;if(t<=0||t===1)return null;let i=[],r=[],o,n;for(i[0]=[0,1,0],o=1;o<t-1;o++){let l=e[o-1],u=e[o],c=e[o+1];i[o]=i[o]||[],i[o][0]=(u[0]-l[0])/6,i[o][1]=(c[0]-l[0])/3,i[o][2]=(c[0]-u[0])/6,r[o]=(c[1]-u[1])/(c[0]-u[0])-(u[1]-l[1])/(u[0]-l[0])}for(r[0]=0,r[t-1]=0,i[t-1]=[0,1,0],o=1;o<t;o++)n=i[1][0]/i[o-1][1],i[o][1]-=n*i[o-1][2],i[o][0]=0,r[o]-=n*r[o-1];for(o=t-2;o>0;o--)n=i[o][2]/i[o+1][1],i[o][1]-=n*i[o+1][0],i[o][2]=0,r[o]-=n*r[o+1];let a=[];for(o=0;o<t;o++)a[o]=r[o]/i[o][1];return a}};Xd.prototype.availableOptions={rgbControlPoints:{type:h.OBJECT},controlPoints:{type:h.ARRAY,default:[]},textureGLUnit:{type:h.NUMBER,default:1}};ee=Xd});var Wb,Gb=_(()=>{Wb=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;
  gray -= 0.2;
  gray = clamp(gray, 0.0, 1.0);
  gray += 0.15;
  gray *= 1.4;
  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);
}
`});var Vb,jb,Ql,Hb=_(()=>{O();Gb();at();Vb=class extends R.Filter{constructor(){super();this._fragmentSource=Wb}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++)for(let c=0;c<o.height;c++){let p=(o.width*c+u)*4,m=l.data[p]/255*.3+l.data[p+1]/255*.3+l.data[p+2]/255*.3;m-=.2,m=Math.max(0,Math.min(1,m)),m+=.15,m*=1.4,m*=255,l.data[p]=m,l.data[p+1]=m,l.data[p+2]=m}a.putImageData(l,0,0)}},jb=class extends ye{constructor(...e){super(...e);this._filter=new Vb}},Ql=jb});var Kb,qb=_(()=>{Kb=`precision highp float;

uniform sampler2D u_image;

uniform sampler2D u_lookupTable;

uniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096
uniform float u_horizontalTileCount; // Horizontal Blue Tiles
uniform float u_verticalTileCount; // Vertical Blue Tiles

varying vec2 v_texCoord;

const float EPSILON = 0.000001;

// Try to get the exact pixel of the lut map image
vec3 lutColor(int texPosX, int texPosY) {
    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;
}

vec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {
    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);
}

void main() {
    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);

    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); 

    vec3 ranges = vec3(
        floor(u_resolution / u_horizontalTileCount - 1.0),
        floor(u_resolution / u_verticalTileCount - 1.0),
        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)
    );
    
    vec3 tmp = sourceColor * ranges;
    ivec3 floors = ivec3(tmp);
    ivec3 ceils = ivec3(ceil(tmp));
    vec3 fracts = fract(tmp);

    // Map tile index to tile pixel pos.
    ivec2 pixelsPerTile = ivec2(
        u_resolution / u_horizontalTileCount, 
        u_resolution / u_verticalTileCount
      );

    ivec2 tileFloor; // Blue tile index
    tileFloor.y = floors.z / int(u_horizontalTileCount);
    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));

    ivec2 tileCeil; // Blue tile index
    tileCeil.y = ceils.z / int(u_horizontalTileCount);
    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));
    
    tileFloor *= pixelsPerTile;
    tileCeil *= pixelsPerTile; 
    
    
    // Interpolate between red and green
    vec3 lutColorFB = bilinearInterpolate(
        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),
        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),
        fracts.x, fracts.y
    );
    vec3 lutColorCB = bilinearInterpolate(
        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),
        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),
        fracts.x, fracts.y
    );

    // Interpolate between the blue values
    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);

    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;
    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);

    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);
}
`});var eu,Xb,Yb,Yd,Jd,tu,Jb=_(()=>{O();qb();at();({Vector2:eu,Vector3:Xb}=L),Yb=3,Yd=class extends R.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=Kb}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){let t=e/255*63,i=new eu;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){let{resolution:o,horizontalTileCount:n,verticalTileCount:a}=this._options,l=t.getCanvas(),u=t.getContext(),c=i.getContext(),p=this._options.lookupTableImage,d=this._createImageCanvas(p).getContext("2d"),f={width:128,height:128};o?f={width:o,height:o}:p.width&&p.height&&(f={width:p.width,height:p.height});let b=u.getImageData(0,0,l.width,l.height),y=d.getImageData(0,0,f.width,f.height),g=new Xb(f.width/n-1|0,f.height/a-1|0,n*a-1|0),C=new S,x=new S,v=new S,M=new S,w=new S,k=new S,q=new S,j=new S,Z=new eu,re=new eu,te=(se,Me,ke,Ce)=>{se.r=Me.r*(1-Ce)+ke.r*Ce,se.g=Me.g*(1-Ce)+ke.g*Ce,se.b=Me.b*(1-Ce)+ke.b*Ce},Y=(se,Me,ke)=>{Me=.5+Me|0,ke=.5+ke|0;let Ce=(ke*f.width+Me)*4;se.r=y.data[Ce]/255,se.g=y.data[Ce+1]/255,se.b=y.data[Ce+2]/255,se.a=y.data[Ce+3]/255},xe=new S,ct=new S,Qe=(se,Me,ke,Ce,ue,Oe,ot)=>{te(xe,Me,Ce,Oe),te(ct,ke,ue,Oe),te(se,xe,ct,ot)},ni=new eu(f.width,f.height).divide(n,a).floor();for(let se=0;se<l.width*l.height*4;se+=4){C.set(b.data[se]/255,b.data[se+1]/255,b.data[se+2]/255,b.data[se+3]/255);let Me=new Xb(C.r*g.x,C.g*g.y,C.b*g.z),ke=Me.clone().floor().toInt(),Ce=Me.clone().ceil().toInt(),ue=Me.clone().fract();Z.y=ke.z/n|0,Z.x=ke.z-Z.y*n|0,re.y=Ce.z/n|0,re.x=Ce.z-re.y*n|0,Z.multiply(ni),re.multiply(ni),Y(w,Z.x+ke.x,Z.y+ke.y),Y(k,Z.x+ke.x,Z.y+Ce.y),Y(q,Z.x+Ce.x,Z.y+ke.y),Y(j,Z.x+Ce.x,Z.y+Ce.y),Qe(v,w,k,q,j,ue.x,ue.y),Y(w,re.x+ke.x,re.y+ke.y),Y(k,re.x+ke.x,re.y+Ce.y),Y(q,re.x+Ce.x,re.y+ke.y),Y(j,re.x+Ce.x,re.y+Ce.y),Qe(M,w,k,q,j,ue.x,ue.y),te(x,v,M,ue.z),b.data[se]=Math.ceil(x.r*255),b.data[se+1]=Math.ceil(x.g*255),b.data[se+2]=Math.ceil(x.b*255)}c.putImageData(b,0,0)}_createImageCanvas(e){let t=E.createCanvas();return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}};Yd.prototype.availableOptions={lookupTable:{type:h.NUMBER,default:Yb,uniformType:A.INT},lookupTableImage:{type:h.IMAGE,uniformType:null},resolution:{type:h.NUMBER,uniformType:A.FLOAT},horizontalTileCount:{type:h.NUMBER,default:5,uniformType:A.FLOAT},verticalTileCount:{type:h.NUMBER,default:5,uniformType:A.FLOAT}};Jd=class extends ye{constructor(...e){super(...e);this._filter=new Yd,this._textures={}}update(e){let t=e.getRenderer();t.isOfType(K.WEBGL)?this._updateWebGLTexture(e):t.isOfType(K.CANVAS)&&this._filter.setLookupTableImage(this._options.image);let{resolution:i,verticalTileCount:r,horizontalTileCount:o,image:n}=this._options;this._filter.set({resolution:i||n.width,verticalTileCount:r,horizontalTileCount:o})}_updateWebGLTexture(e){let t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new R.BaseTexture);let r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(Yb),r.setMinFilter(R.BaseTexture.NearestFilter),t.updateTexture(r)}dispose(){super.dispose();for(let e in this._textures)delete this._textures[e]}};Jd.prototype.availableOptions={image:{type:h.IMAGE},resolution:{type:h.NUMBER},horizontalTileCount:{type:h.NUMBER,default:5},verticalTileCount:{type:h.NUMBER,default:5}};tu=Jd});var $d={};Ne($d,{Brightness:()=>ms,ColorMatrixPrimitive:()=>Ul,Contrast:()=>Dt,Desaturation:()=>_i,DuoTone:()=>Vl,Gamma:()=>Hl,Glow:()=>No,Gobblin:()=>Kl,Grayscale:()=>Uo,LookupTable:()=>Xl,LookupTableImage:()=>Yl,Saturation:()=>kt,SoftColorOverlay:()=>Zl,ThreeDLookupTableImage:()=>tu,ToneCurve:()=>ee,X400:()=>Ql});var he=_(()=>{$y();eb();rb();nb();ub();db();fb();xb();kb();Vd();Ib();Bb();Nb();Ub();Hb();Jb()});var iu,ru,Zd=_(()=>{de();he();iu=class extends V{constructor(...e){super(...e);this._stack.push(new ms({brightness:0}))}render(e,t,i){return this._stack.isEmpty()&&this._stack.push(new ms({brightness:0})),super.render(e,t,i)}};iu.isIdentity=!0;iu.identifier="identity";ru=iu});var Qd,$b,Zb=_(()=>{de();he();Qd=class extends V{constructor(...e){super(...e);this._stack.push(new Dt({contrast:.63})),this._stack.push(new ms({brightness:.12})),this._stack.push(new ee({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}))}};Qd.identifier="a15";$b=Qd});var eh,Qb,ex=_(()=>{de();he();eh=class extends V{constructor(...e){super(...e);this._stack.push(new _i({desaturation:.5})),this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}))}};eh.identifier="breeze";Qb=eh});var th,tx,ix=_(()=>{de();he();th=class extends V{constructor(...e){super(...e);this._stack.push(new Uo)}};th.identifier="bw";tx=th});var ih,rx,sx=_(()=>{de();he();ih=class extends V{constructor(...e){super(...e);this._stack.push(new Uo),this._stack.push(new Dt({contrast:1.5}))}};ih.identifier="bwhard";rx=ih});var rh,ox,nx=_(()=>{de();he();rh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}))}};rh.identifier="celsius";ox=rh});var sh,ax,lx=_(()=>{de();he();sh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}))}};sh.identifier="chest";ax=sh});var su,ux,cx=_(()=>{O();de();he();su=class extends V{constructor(...e){super(...e,{intensity:{type:h.NUMBER,default:.5,required:!0,setter(t){return this._filterPrimitive&&(this._filterPrimitive.setIntensity(t),this._stack.setIntensity(1)),this._dirty=!0,t}}});this._filterPrimitive=new Vl({lightColor:this._options.lightColor||S.WHITE,darkColor:this._options.darkColor||S.BLACK,intensity:this._options.intensity||.5}),this._stack.push(this._filterPrimitive)}};su.prototype.availableOptions={lightColor:{type:h.COLOR,default:S.WHITE,required:!0,setter(s){return this._filterPrimitive&&this._filterPrimitive.setLightColor(s),this.setDirty&&this.setDirty(!0),s}},darkColor:{type:h.COLOR,default:S.BLACK,required:!0,setter(s){return this._filterPrimitive&&this._filterPrimitive.setDarkColor(s),this.setDirty&&this.setDirty(!0),s}},intensity:{type:h.NUMBER,default:.5,required:!0}};su.identifier="duotone";ux=su});var oh,mx,dx=_(()=>{de();he();oh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}))}};oh.identifier="fixie";mx=oh});var nh,hx,px=_(()=>{de();he();nh=class extends V{constructor(...e){super(...e);this._stack.push(new kt({saturation:1.35})),this._stack.push(new Dt({contrast:1.1}))}};nh.identifier="food";hx=nh});var ah,fx,gx=_(()=>{de();he();ah=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}))}};ah.identifier="fridge";fx=ah});var lh,_x,yx=_(()=>{de();he();lh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}))}};lh.identifier="front";_x=lh});var uh,bx,xx=_(()=>{de();he();uh=class extends V{constructor(...e){super(...e);this._stack.push(new Dt({contrast:1.1})),this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}))}};uh.identifier="glam";bx=uh});var ch,vx,wx=_(()=>{de();he();ch=class extends V{constructor(...e){super(...e);this._stack.push(new Kl)}};ch.identifier="gobblin";vx=ch});var mh,Cx,Dx=_(()=>{de();he();mh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]})),this._stack.push(new kt({saturation:.9}))}};mh.identifier="k1";Cx=mh});var dh,kx,Tx=_(()=>{O();de();he();dh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]})),this._stack.push(new Zl({color:new S(40/255,40/255,40/255)}))}};dh.identifier="k2";kx=dh});var hh,Rx,Ex=_(()=>{de();he();hh=class extends V{constructor(...e){super(...e);this._stack.push(new kt({saturation:.5}))}};hh.identifier="k6";Rx=hh});var ph,Fx,Sx=_(()=>{de();he();ph=class extends V{constructor(...e){super(...e);this._stack.push(new ee({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]})),this._stack.push(new kt({saturation:.7}))}};ph.identifier="kdynamic";Fx=ph});var fh,Ox,Ax=_(()=>{de();he();fh=class extends V{constructor(...e){super(...e);this._stack.push(new _i({desaturation:.4})),this._stack.push(new ee({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}))}};fh.identifier="lenin";Ox=fh});var gh,Ix,Px=_(()=>{de();he();gh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}))}};gh.identifier="lomo";Ix=gh});var _h,Mx,Bx=_(()=>{de();he();_h=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}))}};_h.identifier="mellow";Mx=_h});var h1,yh,Lx,zx=_(()=>{O();de();he();({ColorMatrix:h1}=L),yh=class extends V{constructor(...e){super(...e);let t=new h1(.8158218291630716,0,0,0,-.01779810181190647,0,.8098360655737704,0,0,.0916393442622953,0,0,.4596336773932402,0,.12760574782432707,0,0,0,1,0);this._stack.push(new Ul({colorMatrix:t}));let i=new S(.8,.6,.9);this._stack.push(new Hl({gamma:i}))}};yh.identifier="metal";Lx=yh});var bh,Nx,Ux=_(()=>{de();he();bh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}})),this._stack.push(new No)}};bh.identifier="morning";Nx=bh});var xh,Gx,Wx=_(()=>{de();he();xh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]},textureGLUnit:2})),this._stack.push(new ee({controlPoints:[[0,0],[117,151],[189,217],[255,255]],textureGLUnit:3})),this._stack.push(new _i({desaturation:.65}))}};xh.identifier="orchid";Gx=xh});var vh,Vx,jx=_(()=>{de();he();vh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),this._stack.push(new kt({saturation:.8})),this._stack.push(new Dt({contrast:1.5}))}};vh.identifier="pola";Vx=vh});var wh,Hx,qx=_(()=>{de();he();wh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}})),this._stack.push(new kt({saturation:.8})),this._stack.push(new Dt({contrast:1.5}))}};wh.identifier="pola669";Hx=wh});var Ch,Kx,Xx=_(()=>{de();he();Ch=class extends V{constructor(...e){super(...e);this._stack.push(new _i({desaturation:.65})),this._stack.push(new ee({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}))}};Ch.identifier="quozi";Kx=Ch});var Dh,Yx,Jx=_(()=>{de();he();Dh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}})),this._stack.push(new No)}};Dh.identifier="semired";Yx=Dh});var kh,$x,Zx=_(()=>{de();he();kh=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]},textureGLUnit:2})),this._stack.push(new ee({controlPoints:[[0,0],[55,20],[158,191],[255,255]],textureGLUnit:3}))}};kh.identifier="sunny";$x=kh});var Th,Qx,e0=_(()=>{de();he();Th=class extends V{constructor(...e){super(...e);this._stack.push(new ee({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}))}};Th.identifier="texas";Qx=Th});var Rh,t0,i0=_(()=>{de();he();Rh=class extends V{constructor(...e){super(...e);this._stack.push(new Ql)}};Rh.identifier="x400";t0=Rh});var ou,r0,s0=_(()=>{O();de();he();ou=class extends V{constructor(...e){super(...e);this._lutPrimitive=new Yl({image:this._options.image}),this._stack.push(this._lutPrimitive)}};ou.prototype.availableOptions={image:{type:h.IMAGE,required:!0,setter(s){return this._lutPrimitive&&this._lutPrimitive.setImage(s),this.setDirty(!0),s}}};ou.identifier="lut";r0=ou});var nu,o0,n0=_(()=>{O();de();he();nu=class extends V{constructor(...e){super(...e);let{image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o}=this._options;this._lutPrimitive=new tu({image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o}),this._stack.push(this._lutPrimitive)}};nu.prototype.availableOptions={image:{type:h.IMAGE,required:!0,setter(s){return this._lutPrimitive&&this._lutPrimitive.setImage(s),this.setDirty(!0),s}},resolution:{type:h.NUMBER},horizontalTileCount:{type:h.NUMBER,default:5},verticalTileCount:{type:h.NUMBER,default:5}};nu.identifier="3d-lut";o0=nu});var Eh={};Ne(Eh,{A15Filter:()=>$b,BWFilter:()=>tx,BWHardFilter:()=>rx,BreezeFilter:()=>Qb,CelsiusFilter:()=>ox,ChestFilter:()=>ax,DuoToneFilter:()=>ux,FixieFilter:()=>mx,FoodFilter:()=>hx,FridgeFilter:()=>fx,FrontFilter:()=>_x,GlamFilter:()=>bx,GobblinFilter:()=>vx,IdentityFilter:()=>ru,K1Filter:()=>Cx,K2Filter:()=>kx,K6Filter:()=>Rx,KDynamicFilter:()=>Fx,LUTFilter:()=>r0,LeninFilter:()=>Ox,LomoFilter:()=>Ix,MellowFilter:()=>Mx,MetalFilter:()=>Lx,MorningFilter:()=>Nx,OrchidFilter:()=>Gx,Pola669Filter:()=>Hx,PolaFilter:()=>Vx,QuoziFilter:()=>Kx,SemiredFilter:()=>Yx,SunnyFilter:()=>$x,TexasFilter:()=>Qx,ThreeDLUTFilter:()=>o0,X400Filter:()=>t0});var a0=_(()=>{Zd();Zb();ex();ix();sx();nx();lx();cx();dx();px();gx();yx();xx();wx();Dx();Tx();Ex();Sx();Ax();Px();Bx();zx();Ux();Wx();jx();qx();Xx();Jx();Zx();e0();i0();s0();n0()});var kr,l0,u0=_(()=>{O();a0();de();Zd();he();kr=class extends ce{_render(e){return this._selectedFilter.render(this._sdk,e,this._renderTexture)}render(e){return this._selectedFilter.getDirty()&&this.setDirty(!0),this.getEnabled()?super.render(e):(this.setDirtyForRenderer(!1,this._sdk.getRenderer()),Promise.resolve(e))}setDirtyForRenderer(e,t){super.setDirtyForRenderer(e,t),this._selectedFilter.setDirtyForRenderer(e,t)}disposeRenderTextures(){super.disposeRenderTextures(),this._selectedFilter&&this._selectedFilter.disposeRenderTextures()}dispose(){super.dispose(),this._selectedFilter&&this._selectedFilter.dispose()}restoreSnapshot(e){let t=D({},e);if(delete t.filter,e.filter){let i=e.filter.constructor;i.identifier==="3d-lut"?this.setFilter(new i({image:e.filter.getImage(),resolution:e.filter.getResolution(),horizontalTileCount:e.filter.getHorizontalTileCount(),verticalTileCount:e.filter.getVerticalTileCount()})):i.identifier==="duotone"?this.setFilter(new i({lightColor:e.filter.getLightColor(),darkColor:e.filter.getDarkColor(),intensity:e.filter.getIntensity()})):this.setFilter(new i)}this.set(t)}resetToDefaultFilterIntensity(){let e=this._selectedFilter&&this._selectedFilter.availableOptions,t=e&&e.intensity.default;this.setIntensity(t||1)}};kr.identifier="filter";kr.prototype.availableOptions={identifier:{type:h.STRING,default:"identity"},intensity:{type:h.NUMBER,default:1,setter(s){return this._selectedFilter&&this._selectedFilter.setIntensity(s),s}},filter:{type:h.OBJECT,default:new ru,setter(s){return this._selectedFilter&&(this._selectedFilter.dispose(),this._selectedFilter=null),this._selectedFilter=s,typeof this._options.intensity!="undefined"&&this._selectedFilter.set({intensity:this._options.intensity}),s}}};kr.FilterPrimitives=$d;kr.Filters=Eh;kr.Filter=V;X.Operations.FilterOperation=kr;l0=kr});var na,c0,m0=_(()=>{O();na=class extends ce{constructor(...e){super(...e);this._flipContainer=new R.Container}_render(e){let{outputResolution:t,flipHorizontally:i,flipVertically:r}=this._options;if(i||r){let o=e.getDimensions();this._flipRenderTexture?this._flipRenderTexture.resizeTo(o):(this._flipRenderTexture=new R.RenderTexture(this._sdk.getRenderer(),o.x,o.y),this._flipSprite=new R.Sprite(this._flipRenderTexture),this._flipContainer.addChild(this._flipSprite));let n=i?-1:1,a=r?-1:1;this._flipSprite.setScale(n,a),this._flipSprite.setPivot(0,0),this._flipSprite.setPosition(o.x*(1-n)*.5,o.y*(1-a)*.5),this._flipRenderTexture.clear(),this._flipRenderTexture.render(this._container),this._renderTexture.render(this._flipContainer)}else this._renderTexture.render(this._container);return Promise.resolve()}};na.identifier="flip";na.prototype.availableOptions={flipHorizontally:{type:h.BOOLEAN,default:!1},flipVertically:{type:h.BOOLEAN,default:!1}};X.Operations.FlipOperation=na;c0=na});var Go,Wo,d0,h0=_(()=>{O();({Vector2:Go}=L),Wo=class extends ce{constructor(...e){super(...e);this._colorOverlayFilter=new R.Filters.ColorOverlayFilter({color:this.getTintColor()}),this._frameContainer=new R.Container,this._resetSprites(),this._options.frame&&this._createSpritesForFrame(this._options.frame)}_resetSprites(){this._spriteGroups={top:{},left:{},right:{},bottom:{}},this._sprites=[],this._repeatSprites={top:[],left:[],right:[],bottom:[]}}_createSpritesForFrame(e){if(!e)return this._disposeSprites();let{imageGroups:t,layoutMode:i}=e;this._layoutMode=i||"horizontal-inside",this._disposeSprites(),["top","left","right","bottom"].forEach(r=>{typeof t[r]!="undefined"&&["start","mid","end"].forEach(o=>{if(typeof t[r][o]=="undefined")return;let n=t[r][o];"image"in n&&(n=n.image);let a=R.Texture.fromImage(n),l=new R.Sprite(a);this._spriteGroups[r][o]=l,this._sprites.push(l),this._frameContainer.addChild(l)})})}_render(e){let t=this._renderTexture.getDimensions();return this._options.frame&&(this._colorOverlayFilter.setColor(this.getTintColor()),this._updateSprites(e)),this._frameRenderTexture?this._frameRenderTexture.resizeTo(t):(this._frameRenderTexture=new R.RenderTexture(this._sdk.getRenderer(),t.x,t.y),this._frameSprite=new R.Sprite(this._frameRenderTexture),this._container.addChild(this._frameSprite)),this._frameSprite.setAlpha(this._options.alpha),this._options.frame&&this._options.frame.tintable?this._frameSprite.setFilters([this._colorOverlayFilter]):this._frameSprite.setFilters([]),this._frameRenderTexture.clear(),this._frameRenderTexture.render(this._frameContainer),this._renderTexture.render(this._container),Promise.resolve()}_updateSprites(e){let t=e.getDimensions();this._frameWidth=Math.ceil(e.getDimensions().min()*this._options.scale),this._updateHorizontalSpriteGroup(e,"top",0),this._updateHorizontalSpriteGroup(e,"bottom",t.y-this._frameWidth),this._updateVerticalSpriteGroup(e,"left",0),this._updateVerticalSpriteGroup(e,"right",t.x-this._frameWidth)}_updateHorizontalSpriteGroup(e,t,i=0){let r=e.getDimensions(),o=this._layoutMode==="vertical-inside",n=this._spriteGroups[t].start,a=this._spriteGroups[t].mid,l=this._spriteGroups[t].end,u=0,c=0,p,m;if(n){p=n.getTexture().getDimensions(),m=p.y/p.x,u=Math.floor(this._frameWidth/m);let d=new Go(0,i);d.x=o?this._frameWidth:0,n.setPosition(d),n.setHeight(this._frameWidth),n.setWidth(u)}if(l){p=l.getTexture().getDimensions(),m=p.y/p.x,c=Math.floor(this._frameWidth*m);let d=new Go(r.x-c,i);d.x-=o?this._frameWidth:0,l.setPosition(d),l.setHeight(this._frameWidth),l.setWidth(c)}if(a){p=a.getTexture().getDimensions(),m=p.y/p.x;let d=new Go(u,i),f=r.x-u-c;if(o&&(d.x+=this._frameWidth,f-=this._frameWidth*2),a.setPosition(d),a.setWidth(f),a.setHeight(this._frameWidth),this._options.frame.imageGroups[t].mid.mode==="repeat"){let b=this._frameWidth/m,y=Math.ceil(f/b),g=0;if(y!==-1){let C=Math.round(f/y);a.setWidth(C),g+=C,this._ensureRepeatSpritesExist(y-1,t,a);for(let x=0;x<y-1;x++){C=Math.round((f-g)/(y-x-1));let v=this._repeatSprites[t][x],M=d.clone().add(g,0).floor();v.setPosition(M),v.setWidth(C),v.setHeight(this._frameWidth),g+=C}}}}}_ensureRepeatSpritesExist(e,t,i){i.getTexture().setMaxListeners(e+1);let r=this._repeatSprites[t].length;if(e>r){let o=e-r;for(let n=0;n<o;n++){let a=new R.Sprite(i.getTexture());this._repeatSprites[t].push(a),this._frameContainer.addChild(a),this._sprites.push(a)}}else e<r&&this._repeatSprites[t].splice(e).forEach(n=>{let a=this._sprites.indexOf(n);a!==-1&&(this._sprites.splice(a,1),this._frameContainer.removeChild(n),n.dispose())})}_updateVerticalSpriteGroup(e,t,i=0){let r=e.getDimensions(),o=this._layoutMode==="horizontal-inside",n=this._spriteGroups[t].start,a=this._spriteGroups[t].mid,l=this._spriteGroups[t].end,u=0,c=0,p,m;if(n){p=n.getTexture().getDimensions(),m=p.y/p.x,u=Math.floor(this._frameWidth*m);let d=new Go(i,0);d.y=o?this._frameWidth:0,n.setPosition(d),n.setWidth(this._frameWidth),n.setHeight(u)}if(l){p=l.getTexture().getDimensions(),m=p.y/p.x,c=Math.floor(this._frameWidth*m);let d=new Go(i,r.y-c);d.y-=o?this._frameWidth:0,l.setPosition(d),l.setWidth(this._frameWidth),l.setHeight(c)}if(a){p=a.getTexture().getDimensions(),m=p.y/p.x;let d=new Go(i,u),f=r.y-u-c;if(o&&(d.y+=this._frameWidth,f-=this._frameWidth*2),a.setPosition(d),a.setHeight(f),a.setWidth(this._frameWidth),this._options.frame.imageGroups[t].mid.mode==="repeat"){let b=this._frameWidth*m,y=Math.ceil(f/b),g=0;if(y!==-1){let C=Math.round(f/y);a.setHeight(C),g+=C,this._ensureRepeatSpritesExist(y-1,t,a);for(let x=0;x<y-1;x++){C=Math.round((f-g)/(y-x-1));let v=this._repeatSprites[t][x],M=d.clone().add(0,g).floor();v.setPosition(M),v.setHeight(C),v.setWidth(this._frameWidth),g+=C}}}}}_disposeSprites(){this._sprites.forEach(e=>{this._frameContainer.removeChild(e),e.getTexture().dispose(),e.dispose()}),this._resetSprites()}dispose(){super.dispose(),this._disposeSprites(),this._colorOverlayFilter&&this._colorOverlayFilter.dispose(),this._frameRenderTexture&&this._frameRenderTexture.dispose()}static validateFrame(e){if(!e)return;let{imageGroups:t,layoutMode:i}=e;if(typeof e.identifier!="string")throw new Error("Frame needs a property `identifier` of type String.");if(typeof e.imageGroups!="object")throw new Error("Frame needs a property `imageGroups` of type Object.");let r=o=>{let{start:n,end:a,mid:l}=t[o];if(typeof t[o]!="undefined"){if(typeof t[o]!="object")throw new Error(`Frame: \`imageGroups.${o}\` needs to be of type Object.`);if(typeof n!="undefined"&&!(n instanceof wt||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${o}.start\` needs to be of type Image.`);if(typeof l!="undefined"&&!(n instanceof wt||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement)&&typeof l!="object")throw new Error(`Frame: \`imageGroups.${o}.mid\` needs to be of type Image or Object.`);if(typeof a!="undefined"&&!(a instanceof wt||typeof HTMLImageElement!="undefined"&&a instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${o}.end\` needs to be of type Image.`)}};if(typeof i!="undefined"&&["vertical-inside","horizontal-inside"].indexOf(i)===-1)throw new Error("Frame: `layoutMode` must be one of vertical-inside, horizontal-inside");if(typeof tintable!="undefined"&&typeof tintable!="boolean")throw new Error("Frame: `tintable` needs to be of type Boolean.");r("top"),r("left"),r("right"),r("bottom")}};Wo.identifier="frame";Wo.prototype.availableOptions={frame:{type:h.OBJECT,validation:Wo.validateFrame,setter(s,e){return e||this._createSpritesForFrame(s),s},default:null},alpha:{type:h.NUMBER,default:1},tintColor:{type:h.COLOR,default:new S(1,1,1,0)},scale:{type:h.NUMBER,default:.1}};X.Operations.FrameOperation=Wo;d0=Wo});var p0,f0=_(()=>{p0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAAAAADRE4smAAAsTElEQVR4Ae1d4bHjOM5ECAgBISgEZLDOwMrAysDMwMpAzkCTAUNQCAyBIfCr2ifI1DNh+c1tfTMg3b9udtZXC7tJdgMgCP8foJAUBIJx92eoEy5puAKkHH1jX0AchqoJcLwGlv1fDVAnyKtfQMoB1WLQKBBCyuCgVvQhvQGoF3RPb2Bs/AsgEDS6BqbGvwACaHsT+AV1AK/4W18AQy3gCxTAR2vAQxW4xHSD3/kC/qlI9NK7hqg6H8SLspiPv4C+kv0v6ouZQuUEEMfndUtcOQH6qJ9nR2sg1kD+FSdQ4GLS4MA82B+uZvJJRQXkFwT8uRp2VQl99xuGiOyTX4//+AuYqtj/BBGPiVITATjtEel4pdRFAJ/2uP08K9KBYXwPaT5OC9Vlg/kneQ0cUwHcQvz6F7BAXVuA/3GNsG8ofqBQmw3uUg7dCglcZQSgJHizvO1qy4OM3wPCH64BV1fnR8QfdkqAcWD86Q86KP9+o/EjGMfwrhVSpPPUWvy9YoMbsEIqAVrSgXBSCFC3FdK/sV+txc/Kv93OEpgrawiYfybsSWkIaMcK3SurB1P8Ufyk2OB2rNCoEKCV+BW2tGOFXG2N0RiUkkgZUfmumrFCfW0EgNOPKlxB6YtvQAcqRrix+BfFBjdjhVgnQL3xk+cyWwYQVG6FLjOs6PTjotaSCF5T8iUXJLSo3gqxT4kLPig6BKheB1/+/dvzEwGi/KParSDN+arAtMFTA/Gz3+8KTiF/tVZoaxx034zwwlAPvsc/7cifx+8U8tdqhfqwXxVihOMAgnp1sJA/lzu9Tv4KrRD7fFVki2VE+IuB3anvT0z/Y/x9KBRKexPkJ+77njv835YA3kvuaPm79z+6zDGtiP5Mv1sSObMv7gr8l5MfkMclCZaJf9sK0TUWd4U58N8b/NWnb5jo9+KPShM4EvzN4DGmPcL5p1ZIgVghhr8VNBZjuP4P8Rsr/fReGW72UyukIKDJeRYz/rQkoiAYHWkSTz+2QgrOVq657bG8xYAlHWBEQzcdf+OH43SAcPp7o3/N3un34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQV8iu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6P3wT5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvJT0y5+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1Wp5DfxAqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD5ZIL8gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mhfyaTOQKZl7e9RWg1ggnVO4D/TJ+q5UV8mstLX0Fjz/E1wW/Uo/EoGb9gu1O5vhWgTzqBGAwAER9C3RKj4SqlIO5sacEpPNfJ38OBstHAIdJlwD/vDXk3wNYPQLwFmHO/6wE9rKwPWilv2DkcRNWy9esng45olr9PhuYbQ+JtQ3Qq4VdTSo6S+FvZ5pXNSC/1+NL2ZdkpuNXDjTI42f9BNPj90ohMRh42UyYqhRuemUJ6GJ3MLMC5ECDlAaFAPG9MnEoN9IFMvCymaxUhQCjniXL0ZeXiTPR8Qqi449nNnL5ik8oCqURDb1l7RQCeM0kRX2jGIKBxP8lJgHk8XdpB1eO32F8ofV49H6+oKWXfVIkpRkCi0sgcP/qpOhn7ye2sfmlBLmKobK8FbB0RATbo037qCazx9dL4L4WtXtrCS/dzcLuN4yvbcy4bmzRMgHQv0hmDOoSEB044pMaYMvsh10I/nUqE4fCRjFazfaWWNwdXF7tu8JGgXbHdwkBgvK3DgowvQFq15WGstWLeFw0DaYn14DEf/zwn1ozNoZRKWm8//Bfb3i0JZYJIPHHN24BX5NxDfjqzdrhjQkGFCxvgaFIgHRTVsd01DR5tj7OX0D7M0CXeLiYrvneiwSQ0h0fzoK4Ku0AhhBfpbTno1kQtNh+7HZQCOA1hRToVUnU2Z/jK2BtpsFVSaLZ1ECsEECPP02kNgQGsj/NXxBUkxDOek+UA2NAjQABdZPkXX/qR68PSrG8BjYM+t+G+XLq+zEqrDGFRSFAcppE0jGBRWAqI6JmE3WQ9Unu8BS/SwewpADZB3p/eNdNqXtbHXOHt3Q9ssHwvJ6X9CYCWah7BDq+AK1YoUO4v7/j5Xpgg+FZB1Os4/cXyRo6RQWqVnCs4fdnr031jBoBJH6u4vfvo+bks5KPL2d9vPXfP/frE2rFkCWmBCVR36djeAQ7Qx4HbXKRi0VVg0s6RBysdLwspKjA6FKCoqrrjZ9+eE97XBUn5IdyXMcMCJ2dmn8gpSDIIUH5dz2F4zlxpobcXpU1AF6p/45mh9yyks0tqMChT6DUfynYnHCqXuCasOiEmLXUxhBNDrnFosWJXdEG/wIPapf/EEwOeew0AbdQcQ08VQb4cFh6OMNfC3XC97lUDInAcNfiB3IFCsSRrOV5BYEKTsg/uV5/MC7cn420O+mH4JAnPlCLv/BcQvQXNFbvVhiQrQFwL9YK3UPKEUa2NOFBYQDv7JF7md1EdrMPIYRlujDaerNSV+5Z0AwYXia4u370SwghzGNPxjL9Snsb7u4vY1B0sFW4N6a8nnK+99YrvDr/leaeZdf3zjXEj1d+a9bt9fsa8HJwmn6+mafCAa8L4fu++uHtlzgvMS1lHagwIORrgBUrZAXkc/EejvP3w/7A72zHL2p9KEhh9SS857ZHt0I2Nr+9cuHjCk73Le0xWo4faM7Fi8SnY8anNaBbIRObn3bFWU8JbfFGoEL8wRT/47a2VSnsn05CzoTwgRUyUvSKqPW9h+fhlz4JYJAzwaYO7PPgOk0KB/d9H8QkiGDXCtFccHmFzMY+umu+QmASX2AvfmVqcYnRw/CNAVnEnS0rpBe9WOV/950BfRJALAoHYZOxtJcqhSP2307CMd/ubVohWf7H/Hffyts3SgJYI/UmdeC91KWqMLqLiiz4VSSTN8j/k6YDI+KeLXNGgKHUCBjPNtNeuhRm9SnIWBSOHu2lfXX+T2qNBNJUEA4zGU376lLY6z0O3TOZ4mCc/4Uit1MIEOX/TG93MPTEmS6FWWOAeL7BzstmgkGb51AocisMgE3uDAr5jZX/dSmMGgN+fSuReDJ3zUsw61ZQYUA2KNIL+U3Bvy+FtUeR445Mgc3zX81suCIBpJDEOvkrkcLajLDu8YE41ML/U0kf9CUCxE04LDr565DCYh2VxC/FEcEWKCqxKEVujs8E2HIeevD1SOHiPvgL7H4Dig9Si9xdeCZADzoqk8JlBkQQVMN/vchL4YkAE+ioTAorDOgq4n8ijRsLFBgAevW3Vil8XP21rwOVMAsMAL32V6UUVh74a4v/uRkG/U3LOqWwMCPqN32sTz0LKjduz6MOQc/7ViqFV3RRz/tWy//0/DAC6KhZCstJeFz3qq0kJhiVza8RKSwMsL//6SUxhf8Cp2x+DUhhAS0D1IGT4mtf9vs6ZfNrRQofo9KSmIrWpDA0wf/3+30blMI6Ki6JKfxvUwq/j6q6IxW0I4W7tvgfj940b0wK+w5qRFAHeTtlvGGbUjgw6KjUB0VlvF2DUjg6bJD/vbL5tSeFp5r5T/pkOK9sfo1JYc/N8l/Z/JqSwvHcMP/vyubXkBRmhHpx3B3JoKANHdgAlO5IDQ1JYQUf/rcmhQUf/rcqhVsAxWb5r0hhT9AU3NGzNm1J4cAN8l/J+zYohaOD9tD/DZvfnyUe/3n+I8Ifg//jmx/58Oel8B/N+/Z/cu/hP7z54e2Pdx5STOEEfwzs/2zn3f3PHv7zX9B5ODj80zJs+pPzY/nPZ2Ju0CrEifEn/laBsc0cHLYXv/IN9E3m4Pp43WViTtAY8Ba3aWON5aBlbvuMz/ETNIJrfFxG4awdA7GJ6LNHqfL4Ox8RWgCG3ZNU960d4xKnlkpwgTIrSHhrxw/E7DaK6KD5a2PklhLQoXsUJZfYkB9Y8iepxAr5NmryMq81PMSvU14eqBf37QsI9O2emkeoFnilx0Ocp7AdgxhaqUjy7WF9fP9gADexAK4xzY8dcKAHA06///KAwSc7ZQ/E/nEO+tpvIsmUJd52QL/NXcKv+MOp+txHSml57IH/iBgaVkZ4qt/6+G0HjCgMWAi4bvLnfn/Y9sARoM+e5lu4kfhlB2S4xM0O9tRKE27ETQUC3pMwAIdm4pcdcPZJMEETkNKnJMBvMQn+qTrvG1OcSF7rcPtGvFC/9cOrT2m5kGTAut3LJUvlhz/N35+gpWz06Ii01H74c5CDLit94sP29YFrJn9MgnMW/yC2r3p0Pr90MmzZzlCr7dMf645Z/Czjh6ov+n67f71I6fMuJ38D5J8uX0d+v/I+rDtggMohNic697Xgs9LnIJaoWuD2sJ4YgCmLP3z54KpB4FehIwWvTqzQ15dT+eE/SLCS650yK3iv/hoe+Yji+0T2sjBhAqxXAIjyjbj6PiHAmFnhE9du/f4N8+H7vPwP6YJ1VP3hL/HTVgeQ+CO1cfh3m+85i+hZrdDYgvL14vtWLzjRGn/1RV8vJn/1PYPPHtzoK099bQl+3l++li9gEPdfd+pLCL8kwfbizFz34S+hFudwTQSC6lNfJymBtTSD4ZYEAfP4fWil4yskgcvvX8dx/Yula2XulNuXAF1sYgOA8fvYPfF9dK99A5D4w2nO4xcrTN5zI1f9PIv4391+7MOI9ccfHK6kn9+4/VkhJYaFt6CPbz8i16J888O9EP8vRS8PUAl4waf+t+Xw9ieHiJUo3/Acv89aoEnRyxGrSX255/dIhk0HRYdKwuxWS9F3F3+/i39hvVTsqkl9RVL6/4DTiHrCrKsj7RUH0OLHF59yWE3qy3dPfkiWd/fiU1xH3nfCkh90x58yD17KGR6pg+gJsypsYU5jhAx3PX4RhvHfT3FXw0VXh/IFvDf6xT0WAF7R8JAT9+hz9f4p/tAdTQbqvOXZGLj7nS9xeIpx1oLbbMIlJmdV+fot/q9N/Vv8+gEvNgFvpnXgJQ6yBZwK8/5C8nx0TYa9yEeTh/9Z6n1TfJr3h8W0FxLhI/5oeEjc+ovLiJv5WfTwAOVvQGSyIJ6sKt8t/jcFbf81lvUs8RuWwXSXXzyvf+BhxiSk9HVNhvRP2VK+nBf7jz8ldyS6/FNosugr7L2r87aVT8k1GfmUtS+A/I6582O0Q3c7/pQwYFTkowWcQj5imzJPc+GDTwmmVT4tIiYMYc74fpL4py9ZwMfk37eLiZiwBIyZ9esyT8OKpxHJkGOQazIiJuyAokg39om3+C9Rv+zRxfV37/u7XBTL5WNAm/Nt8RrD5mlo1j2NNMdF11+CXJRaFPloJf5/A172I45id5j56cQ5B7ONUlLs4vBlfk+Zp5mV/f9pKNgAbPCRenfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK88OKdURvy4Bb+uxIuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs2QjE60giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOloBkfkwhT10PUv8BD8BBL9/KtoEwbicF4GIsfKV5fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYC3zozWvbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgvhhge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSsxu/fo/7JfjRJDz0KSWULJB5DBLIYfzrybeElDxYjl8J7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxtwtxfk3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaCBw98KPvjggw8++OCDDz744IMPPvjggw8++OCDDz744IMP8NZD22APDeMaU9sEIN9w+4k81dAu8CpjdxqAPoqpVcgYcmyY/A01oOlz+Klh8rdLAJqTgNokv+AXtAH9AT5ul/zN3kAKSdDiDaQh5QjQHkLK0TfH/+YJsKQcAzSGLuWIrd6/EbRnhCntAO1hVAZWt4KYchBA2yqoPSMcWifAqXECzClHB82hS40ZYTzrGqiNPAjvosSUY2kh7xsIHnAt2WCpe11VFRQaKPru3W7fFAGk7hVIUUGxhaJvyq/dc8rhWql7hbOigmonvyB0xUSAa6bulW5YVEFYPfkFcg4244Kk7iUIVFJBVD/5BQs9H4FTE0VfwbWggromyJ+fg0vK4Nso+u6kUFe/ERbyP+EmR2DlBOh8KiMwANXvgygkBYFgbMEGu6ThCqAQoI0vIA6DToAm1sBCoYWGAPLqF9CIDR40CoTQhhHuQ3oDUC/ont7A2PgXQCBodA1MjX8BBND2JvCrmrwHvvsFVGqD+aJUw17DV5P3vcHvfAH/VCR66V1DVJ0P4kVZzMdfQF9R3tfrjlBHqMfxedUS106APurn2dEaiBUVPU6gwMWkwdVU9wov14iCCsgvCPhzNTxWJfTdbxgiqqjo637uCKeqir4RD4hSGQE47RHpYKVURwBfKHf+cA10NdzyEMwHaaHqbDD/JK+BYyqAW4hf/wIWqGsL8D+uEfYtxK9/AaGqez5ihXS4yghA6RuGHzYKhLou++pWSF0Drq7Oj4g/7JQA48D40x900P/9FuNHMI7hXSukSOeptfh73QY3YIV0ArSiA+GkEKBuK6R/Y79ai5/1f7uRJTBX1hAw/0zYk94Q0IgVuldWD6b4o/hJt8GNWKFRJ0AT8etsacQKudoaozHoJZECov5dtWGF+toIAKcfVbiC3hDQhg7UjXAb8S+6DW7DCrFCgKrjJ89ltgwgqNwKXWZlXK4QoNaSiEyL8SUXJLSo3gqxT4kLPig6BKhcB8u0mPMTAaL8o9qtIM35qsC0wVMD8bPf7wpOIX+1VmhrHHTfjPDCFc4AFkw5+XfxO4X8tVqhPuxXhRjhOICgXh0s5M/lTq+Qv04rxD5fFdliGRH+YmB36vsT0/8Yfx8KhdLeBPmJ+77nDv+3JYD3kjta/u79jy5zTCuiP9PvlkTO7Iu7Av/l5AfkcUmCZeLftkJ0jcVdYQ789wZ/9YXZZr8Vf1SawJHgbwaPsTje7n0rpEKsEMPfChqLMVz/h/iNlX56rww3+6kVUhDQ5DyLGX9aElEQjI40iacfWyEFZ1OzTTcs+LMX0RSMaGm87c9/OE4HCKe/fbK/hun34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQJ8uu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6I3xL5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvsXoSR+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1WZ4L8ygqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD4J+S0gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mjfyKTOQKZl7e9RWg1ggnVO4D/TJ+q5U18istLX0Fjz9EreCnP4E5qFm/YLuTOb5VII86ARgMAFHfAp3aI6Eo5WBu7CkB6fzXyZ+DwfIRwGHSJcA/bw359wBWjwC8RZjzP2uBvSpsD1rpLxh53ITV8jWrp0OOqFa/zwZm20NibQP0emFXkYrOUvjbmeZVDcjv9fhS9iWZ6fiVAw3y+Fk/wfT4vVJIDAZeNhOmKoWbXlsCqtgdzKwAOdAgpUEhQHyvTBzKjXSBDLxsJitVIcCoZ8ly9OVl4kx0vILo+OOZjVy+4hOKQmlEQ29ZO4UAXjNJUd8ohmAg8X+JSQB5/F3awZXjdxhfaD0evZ8vaOllnxRJaYbA4hII3L86KfrZ+4ltbH4pQa5iqCxvBSwdEcH2aNM+qsns8fUSuK9F7d5gwktxs7D7DeNrGzOuG1u0TAD0L5IZg7oERAeO+KQG2DL7YReCf53KxKGwUYxWs70lFncHl1f7rrBRoN3xXUKAoPytgwIMb4D6daWhbPUiHhdNg+nJNSDxHz/8p9aMjWFUShrvP/zXGx5tiWUCSPzxjVvA12RcA756tHh4Y4IBBctbYCgSIN2U1TEdNU2erY/zF9D+DNAlHi6ma773IgGkdMeHsyCuSjuAIcRXKe35aBYELbYfux0UAnhNIQV6VRJ19uf4ClibaXBVkmg2NRArBNDjTxOpDYGB7E/zFwTVJISz3hPlwBhQI0BA3SR515/60WuDUmyvgQ2D/rdhvpz6fowKa0xhUQiQnC6RNExgEZjKiKjbRA1kfZI7PMXv0gEsKUD2gd4f3nXT694mx9zhLV2PbDA8r+clvYlAFuoegY4vQCtW6BDu7+94uR7YYHjWwRTr+P1FsoZOVYGKFRxr+P3Za1M9o0YAiZ+r+P37qDj5vOTjy1kfb/33z/36hFoxZIkpQUnU9+kYHsHOkMdBm1zkYlHV4JIOEQcrHS8LKSowupSgqOp646cf3tMeV8UJ+aEc1zEDQmen5h9IKQhySFD+XU/heE6cqSG3V2UNgFfqv6PZIbesZHMLKnDoEyj1XwomJ5zqF7gmLDohZi21MUSTQ26xaHFiV7TBv8CD2uU/BJNDHjtNwC1UXANPlQE+HJYezvDXQp3wfS4VQyIw3LX4gVyBAnEka3leQaCCE/JPrtcfjAv3ZyPtTvohOOSJDyzErz2XEP0FbdW7FQbkawDci7VC95ByhJEtTXhQGMA7e+ReZjeR3exDCGGZLozW3qxUlHseNAOGlwnurh/9EkII89iTsUy/0t6Gu/vLGBQdbBXujSmvp5zvvfUKr85/pbln2fW9cw3x45XfmnV7/b4GvBycpp9v5qlwwOtC+L6vfnj7Jc5LTEtZByoMCPkaYMUKWQH5XLyH4/z9sD/wO9vxi1ofClJYPQnvue1RrJCZzW+vXPi4gtN9S3uMluMHmnPxIvHpmPFpDShWyMjmp15x1lNCW7wRqBB/MMX/uK1tVQr7p5OQMyF8YIWMFL0ian3v4Xn4pU8CGORMsKkD+zy4TpPCwX3fBzEJIti1QjQXXF4hs7GP7pqvEJjEFxiLX59aXGL0MHxjQBZxZ84KKUUvVvnffWdAnwQQi8JB2GQs7aVK4Yj9t5NwzLZ7o1ZIlv8x/9238vaNkgDWSL1JHXgvdakqjO6iIgt+FcnkDfL/pOnAiLhny5wRYCg1AsazzbSXLoVZfQoyFoWjR3tpX53/k1ojgTQVhMNMRtO+uhT2eo9D90ymOBjnf6HI7RQCRPk/09odTD1xpkth1hggnm+w87KZYNDmORSK3AoDYJM7g0J+Y+V/XQqjxoBf30oknsxd8xLMuhVUGJANivRCflPw70th7VHkuCNTYPP8VzMbrkgAKSSxQv56pLA2I6x7fCAOtfD/VNIHfYkAcRMOi0L+aqSwWEcl8UtxRLAFikosSpGb4zMBtpyHEnxVUri4D/4C5Ruw7IOUIncXngnQg4L6pHCZAREENfFfKfJSeCLABDoqk8IKA7qK+J9I48YCBQaAXv2tVQofV3/t60AlzAIDQK/9VSuF9Qf+GuF/boZBf9OyTikszIjaTR/7U8+Cyo3b86hD0PO+lUrhFV1U8r418z89P4wAOqqVwnISHte9KiyJCUZl82tECgsD7O9/eklM4b/AKZtfA1JYQMsAdeCk+NqX/b5O2fxakcIHqLckpqI1KQxN8P/9ft/mpLCOqktiCv/blMLvo6ruSAXtSOGuLf7HozfNG5PCvoMaEdRB3k4Zb9imFA4MCur1QVEZb9egFI4OG+R/r2x+7UnhqWb+kz4ZziubX2NS2HOz/Fc2v6akcDw3zP+7svk1JIUZoWocdEcyKGhABzYAvTtSQ0NSWMGH/61J4Q//Bc1J4YZAsU3+61LYEzQFd/SsTVtSOHCD/Ffyvg1K4eigPfTK5tcQuG3++9Y2P+Ur8Nwy/6ODhkExhRM0i7tsfu1icNgy/2eGD+zDMhAaByI0DPIB2kbfsgbDmxSiWwV7aURoErNy/aSxXNwErYKU6yetpeP5E3/bW4BvL+724le+gb7JQmwfr7ty3Kk99Ru7PBcdsDXlm2Z8jp+gBci77UNejnINpQSu2cukefydb8QPYNi9S3rfenIvcWqpDytQZgUJb+34gZhdSRYdNH9tjNxSF0LoHp1pS2zIDyz5u6RihXwbjZkytD88xK/Tn5+qFPftCwj0bViBR6gWeKXHa+ynsB2DGFppS+Pbw/r4/sEAbmIBXGOaHzvgQA8GnH7/+SmD77bLHoj94xz0tV9Hl1GbvO2Afhu+iV/xh1P1uY+U0vLYA/8RMTSsjPBUv/Xx2w4YURiwEHDd5M/9/rDtgSNAn73PvHAj8csOyHCJmx3sqZX204ibCgS8J2EADs3ELzvg7JNgaqv0KQnwW0yCf6rO+8YUJ5In29z+Nkao3/rh1ae0XEgyYN3u+bql8sOfZtnlJH7K5s+PSEvthz8HOeiy0ic+bF8fuGbyxyQ4Z/EP1ds+Qefzm8fDlu0MVds+QR/SAzGLn2UGZQstjxscwCKlz7uc/A2Qf7p8Hfn9yvuw7oABKofYnOjc14LPSp+DWKJqgdvrymIApiz+8OWDqwaBX4WOFLw6sUJfX07lh/8gwUqud8qs4L3668jkI4rvE9nLwoQJsF4BIMo3ovi+lQBjZoVPXLv1+zfMh+/z8j+kC9ZR9Ye/xE9bHUDij9TG4d9tvucsome1QmMLyteL71u94ERr/NUXfb2Y/NX3DD57da2vPPW1Jfh5P4FHvoChbvcvqS8h/JI2yLODc92Hv4RaHMY6EQiqT32dpATW0iCuWxIEzOP3oZWOr5AELh/CE8f1L5auleGjbl8CdLGJDQDG77OXxffRvfYNQOIPpzmPX6wwec+NXPXzLOJ/d/uxDyPWH39wuJJ+fuP2Z4WUGBbegj6+/Yhci/LND/dC/L8UvTxAJeAFn/rflsPbnxwiVqJ8w3P8PmuBJkUvR6wm9eWeH6UbNh0UHSoJs1stRd9d/P0u/oX1UrGrJvUVSen/A04j6gmzro60VxxAix9ffMphNakv3z35IVne3YtPcR153wlLftAdf8o8eClneKQOoifMqrCFOY0RMtz1+EUYxn8/xV0NF10dyhfw3ugX91gAeEXDQ07co8/V+6f4Q3c0Gajzlmdj4O53vsThKcZZC26zCZeYnFXl67f4vzb1b/HrB7zYBLyZ1oGXOMgWcCrM+wvJ89E1GfYiH00e/mep903xad4fFtNeSISP+KMoJbsTHmXEzfwseniA8jcgMlkQT1aV7xb/m4K2/5rNf5b4Dctgussvntc/8DBjElL6uiZD+qdsKV/Oi/3Hn5I7El3+KTRZ9BX23oXK9Oan5JqMfMraF0B+x9z5Mdqhux1/ShgwavLRAE4hf2eFMk9z4YNPCaZVPi0iJgxhzvh+kvinL1nAx+Tft4uJmLAEjJn16zJPw+JpFMmQY5BrMvbGRVMU6cY+8Rb/JeqXPbq4/u59f5eLYrl8DGhzvi1eY9g8Dc26p5HmuOj6S5CLUosmH43E/2/Ay37EUewOMz+dOOdgtlFKil0cvszvKfM0s7L/Pw0FG3L56DuwAXfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK29PKtURvy4Bb+vFSuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs+QjE40giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOl4BkfiwhT10PUv8BD8BBL9/KtoEwbicF4GIpfL15fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYCvzozevbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgrhlge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSMx2/co/7JfjRJDz0KSWULJB5DIeBSPzrybeElDyYjV8P7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxNwtxfm3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaC5w/+DDz744IMPPvjggw8++OCDDz744IMPDABvPbQN9tAwrjG1TQDyDdceZU53u8CrzFxoAPocjlYhM2ixXfK31H2gD2GmhsnfLgFoTgJqk/yCX9AMlNeXuF3yN9t+HpKgxfbzIeUI0B5CytE3x//mCbCkHAM0hi7liK02XwvaM8KUdoD2MCrTSltBTDkIoG0V1J4RDq0T4NQ4AeaUo4Pm0KXGjDCeFQ3UTB6Ed1FiyrG0kPcNBA+4lmyw1L2uqgoKLRR9d263b4oAUvcKpKig2ELRN+V3LjnlcK3UvcJZUUG1k18QumIiwDVT90o3LKogrJ78AjkHm3FBUvcSBCqpIKqf/IKFno/AqYmir+BaUEFdE+TPz8ElZfBtFH13Uqir3wgL+Z9wkyOwcgJ0PpURGID+qA/6P9HpZtdg1QgHAAAAAElFTkSuQmCC"});var _0,g0=_(()=>{_0=`uniform sampler2D u_image;
uniform sampler2D u_watermarkTex;

varying vec2 v_texCoord;


void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);

  if (watermarkColor.r > 0.8) {
    gl_FragColor = mix(color, watermarkColor, 0.3);
  } else {
    gl_FragColor = color;
  }
}
`});var au,y0=_(()=>{O();g0();au=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=_0}_applyWebGL(e,t,i,r=!1){let o=e.getContext(),{canvas:n}=o,a=this.getShaderForRenderer(e),l=t.getFrame(),u=this._watermarkCanvas;(!u||l.width!==u.width||l.height!==u.height)&&this._createWatermarkCanvas(l.width,l.height);let c=R.Texture.fromCanvas(this._watermarkCanvas),p=c.getBaseTexture();e.updateTexture(p),p.setGLUnit(1),e.setRenderTarget(i),r&&i.clear(),e.setShader(a);let m=e.getCurrentRenderTarget().getProjectionMatrix().toArray();a.setUniform("u_projMatrix",m),a.syncUniforms(),o.uniform1i(o.getUniformLocation(a.getProgram(),"u_watermarkTex"),1),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,p.getGLTextureForRenderer(e)),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),c.dispose()}_createWatermarkCanvas(e,t){let i=this._options.watermarkImage,r=E.createCanvas();r.width=e,r.height=t;let o=r.getContext("2d"),n=o.createPattern(i,"repeat");o.fillStyle=n,o.fillRect(0,0,r.width,r.height),this._watermarkCanvas=r,this._watermarkContext=o}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=this._options.watermarkImage;this._createWatermarkCanvas(o.width,o.height);let u=n.getImageData(0,0,o.width,o.height),c=this._watermarkContext.getImageData(0,0,o.width,o.height),p=new S,m=new S,d=new S;for(let f=0;f<o.width*o.height*4;f+=4)p.set(u.data[f]/255,u.data[f+1]/255,u.data[f+2]/255,u.data[f+3]/255),m.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255),m.r>.8?d.copy(p.clone().mix(m,.3)):d.copy(p),u.data[f]=d.r*255,u.data[f+1]=d.g*255,u.data[f+2]=d.b*255,u.data[f+3]=d.a*255;a.putImageData(u,0,0)}};au.prototype.availableOptions={watermarkImage:{type:h.OBJECT,required:!0}}});var aa,b0,x0=_(()=>{O();f0();y0();aa=class extends ce{constructor(...e){super(...e);P(this,"_applyWatermarkFilter",()=>(this._watermarkFilter||(this._watermarkFilter=new au({watermarkImage:this._watermarkImage})),this._sprite.setFilters([this._watermarkFilter]),this._renderTexture.render(this._container),Promise.resolve()));P(this,"_loadWatermarkImage",()=>this._watermarkImage?Promise.resolve():new Promise((e,t)=>{this._watermarkImage=new wt,this._watermarkImage.onload=e,this._watermarkImage.src=p0}));this._watermarkFilter=null,this._watermarkImage=null}_render(e){return this._loadWatermarkImage().then(this._applyWatermarkFilter)}dispose(){this._watermarkFilter&&this._watermarkFilter.dispose(),super.dispose()}};aa.identifier="license-watermark";aa.prototype.availableOptions={};X.Operations.LicenseWatermarkOperation=aa;b0=aa});var w0,v0=_(()=>{w0=`/*!
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_controlPoint1;
uniform vec2 u_controlPoint2;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 vector = u_controlPoint2 - u_controlPoint1;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    float radius = smoothstep(0.0, 1.0,
      abs(
        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)
      )
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
      float percent = (t + offset - 0.5) / 30.0;
      float weight = 1.0 - abs(percent);
      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

      color += _sample * weight;
      total += weight;
    }

    gl_FragColor = color / total;
}
`});var qi,Fh,lu,C0=_(()=>{O();Lo();v0();({Vector2:qi}=L),Fh=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=w0,this._lastBlurRadius=null,this._lastControlPoint1=new qi,this._lastControlPoint2=new qi,this._blurFilter=new Ct,this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let o=t.getDimensions(),n=!i.getDimensions().equals(o);if(t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){let l=new qi(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);let u={blurRadius:this._options.blurRadius,texSize:o},c=(b,y,g)=>Math.min(Math.max(b,y),g),p=(b,y,g)=>{let C=c((g-b)/(y-b),0,1);return C*C*(3-2*C)},m=this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone()),{blurRadius:d}=this._options,f=(b,y)=>p(0,1,Math.abs(c(new qi(b,y).subtract(this._options.controlPoint1).dot(m)/m.dot(m),0,1)))*d;this._blurFilter.set(u),this._blurFilter._applyCanvas(e,t,i,r,f),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){let o=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());let a=!this._lastControlPoint1.equals(this._options.controlPoint1)||!this._lastControlPoint2.equals(this._options.controlPoint2)||n,l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone()),l&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){let e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new qi(e.width,e.height),r=this._options.controlPoint1.clone().multiply(i),o=this._options.controlPoint2.clone().multiply(i),n=t.createLinearGradient(r.x,r.y,o.x,o.y);n.addColorStop(0,"#FFFFFF"),n.addColorStop(1,"#000000"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){let i=t.getContext(),r=e.getCanvas(),o=e.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=o.getImageData(0,0,r.width,r.height),u=l.data,c=n.getImageData(0,0,r.width,r.height).data,p=a.getImageData(0,0,r.width,r.height).data,m;for(let d=0;d<r.width*r.height*4;d+=4)m=p[d]/255,u[d]=m*u[d]+(1-m)*c[d],u[d+1]=m*u[d+1]+(1-m)*c[d+1],u[d+2]=m*u[d+2]+(1-m)*c[d+2];i.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}};Fh.prototype.availableOptions={blurRadius:{type:h.NUMBER,default:30,uniformType:A.FLOAT},controlPoint1:{type:h.VECTOR2,default:new qi(0,.5),uniformType:A.FLOAT2},controlPoint2:{type:h.VECTOR2,default:new qi(1,.5),uniformType:A.FLOAT2},delta:{type:h.VECTOR2,default:new qi(1,1),uniformType:A.FLOAT2},texSize:{type:h.VECTOR2,default:new qi(100,100),uniformType:A.FLOAT2}};lu=Fh});var uu,la,D0,k0=_(()=>{O();C0();({Vector2:uu}=L),la=class extends ce{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone();let t={blurQuality:{type:h.STRING}};this._horizontalFilter=new lu({},t),this._verticalFilter=new lu({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new uu(.5,.5)),this._verticalFilter.setDelta(new uu(-.5,.5)),this._filter=new lu({},t)}rotate(e){let{controlPoint1:t}=this._options,{controlPoint2:i}=this._options;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({controlPoint1:t,controlPoint2:i})}flip(e){let{controlPoint1:t}=this._options,{controlPoint2:i}=this._options;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({controlPoint1:t,controlPoint2:i})}transform(e){let t={};["controlPoint1","controlPoint2"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),{blurRadius:r,controlPoint1:o,controlPoint2:n}=this._options,a={blurRadius:r*i,controlPoint1:o.clone(),controlPoint2:n.clone(),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(a),this._verticalFilter.set(a),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let t=e.getDimensions(),{blurRadius:i,controlPoint1:r,controlPoint2:o}=this._options;return this._filter.set({blurRadius:i,controlPoint1:r.clone(),controlPoint2:o.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};la.identifier="linear-focus";la.prototype.availableOptions={controlPoint1:{type:h.VECTOR2,default:new uu(0,.5)},controlPoint2:{type:h.VECTOR2,default:new uu(1,.5)},blurRadius:{type:h.NUMBER,default:.025},highQualityCanvasBlur:{type:h.BOOLEAN,default:!1}};X.Operations.LinearFocusOperation=la;D0=la});var R0,T0=_(()=>{R0=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform float u_gradientSize;
uniform float u_size;
uniform vec2 u_start;
uniform vec2 u_end;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));
    float radius = smoothstep(0.0, 1.0,
      (abs(
        dot(v_texCoord * u_texSize - u_start, normal)
      ) - u_size) / u_gradientSize
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`});var Ki,Sh,cu,E0=_(()=>{O();Lo();T0();({Vector2:Ki}=L),Sh=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=R0,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastStart=new Ki,this._lastEnd=new Ki,this._blurFilter=new Ct,this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let o=t.getDimensions(),n=!i.getDimensions().equals(o);if(t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){let l=new Ki(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);let u={blurRadius:this._options.blurRadius,texSize:o},c=(v,M,w)=>Math.min(Math.max(v,M),w),p=(v,M,w)=>{let k=c((w-v)/(M-v),0,1);return k*k*(3-2*k)},{blurRadius:m,gradientSize:d,size:f,start:b,end:y,texSize:g}=this._options,C=new Ki(b.y-y.y,y.x-b.x);C.divide(C.len());let x=(v,M)=>p(0,1,(Math.abs(g.clone().multiply(v,M).subtract(b).dot(C))-f)/d)*m;this._blurFilter.set(u),this._blurFilter._applyCanvas(e,t,i,r,x),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){let o=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());let a=!this._lastStart.equals(this._options.start)||!this._lastEnd.equals(this._options.end)||this._lastGradientRadius!==this._options.size||n,l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastStart=this._options.start.clone(),this._lastEnd=this._options.end.clone(),this._lastGradientRadius=this._options.size),l&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){let e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=this._maskRenderTarget.getPixelRatio(),r=new Ki(e.width,e.height),o=this._options.size*r.min()*i,n=this._options.gradientSize*r.min()*i,a=this._options.start.clone().multiply(r),u=this._options.end.clone().multiply(r).clone().subtract(a),c=a.clone().add(u.clone().divide(2)),p=u.len(),m=u.clone().divide(p),d=c.clone().add((o+n)*m.y,-(o+n)*m.x),f=c.clone().add(-(o+n)*m.y,(o+n)*m.x),b=t.createLinearGradient(d.x,d.y,f.x,f.y),y=f.clone().subtract(d).len();b.addColorStop(0,"#000000"),b.addColorStop(n/2/y,"#FFFFFF"),b.addColorStop(1-n/2/y,"#FFFFFF"),b.addColorStop(1,"#000000"),t.fillStyle=b,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){let i=t.getContext(),r=e.getCanvas(),o=e.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=o.getImageData(0,0,r.width,r.height),u=l.data,c=n.getImageData(0,0,r.width,r.height).data,p=a.getImageData(0,0,r.width,r.height).data,m;for(let d=0;d<r.width*r.height*4;d+=4)m=p[d]/255,u[d]=m*u[d]+(1-m)*c[d],u[d+1]=m*u[d+1]+(1-m)*c[d+1],u[d+2]=m*u[d+2]+(1-m)*c[d+2];i.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose()}};Sh.prototype.availableOptions={blurRadius:{type:h.NUMBER,default:30,uniformType:A.FLOAT},size:{type:h.NUMBER,default:50,uniformType:A.FLOAT},gradientSize:{type:h.NUMBER,default:50,uniformType:A.FLOAT},start:{type:h.VECTOR2,default:new Ki(0,.5),uniformType:A.FLOAT2},end:{type:h.VECTOR2,default:new Ki(1,.5),uniformType:A.FLOAT2},delta:{type:h.VECTOR2,default:new Ki(1,1),uniformType:A.FLOAT2},texSize:{type:h.VECTOR2,default:new Ki(100,100),uniformType:A.FLOAT2}};cu=Sh});var mu,ua,F0,S0=_(()=>{O();E0();({Vector2:mu}=L),ua=class extends ce{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastSize=this._options.size,this._lastGradientSize=this._options.gradientSize;let t={blurQuality:{type:h.STRING}};this._horizontalFilter=new cu({},t),this._verticalFilter=new cu({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new mu(.5,.5)),this._verticalFilter.setDelta(new mu(-.5,.5)),this._filter=new cu({},t),this._renderBlur.bind(this)}rotate(e){let{start:t}=this._options,{end:i}=this._options;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({start:t,end:i})}flip(e){let{start:t}=this._options,{end:i}=this._options;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({start:t,end:i})}transform(e){let t={};["start","end"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius","size","gradientSize"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),r=this._options.start.clone(),o=this._options.end.clone(),{blurRadius:n,size:a,gradientSize:l}=this._options,u={blurRadius:n*i,size:a*i,gradientSize:l*i,start:r.clone().multiply(t),end:o.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(u),this._verticalFilter.set(u),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let t=e.getDimensions(),{blurRadius:i,size:r,gradientSize:o,start:n,end:a}=this._options;return this._filter.set({blurRadius:i,gradientSize:o,size:r,start:n.clone(),end:a.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};ua.identifier="mirrored-focus";ua.prototype.availableOptions={start:{type:h.VECTOR2,default:new mu(0,.5)},end:{type:h.VECTOR2,default:new mu(1,.5)},blurRadius:{type:h.NUMBER,default:.025},size:{type:h.NUMBER,default:.1},gradientSize:{type:h.NUMBER,default:.1},highQualityCanvasBlur:{type:h.BOOLEAN,default:!1}};X.Operations.MirroredFocusOperation=ua;F0=ua});var _1,ca,O0,A0=_(()=>{O();({Vector2:_1}=L),ca=class extends ce{_render(e){let t=this._options.rotation%360,i=t*(Math.PI/180),r=t===90||t===270,o=this._options.flipHorizontally!==this._options.flipVertically,n=r&&o?!this._options.flipVertically:this._options.flipVertically,a=r&&o?!this._options.flipHorizontally:this._options.flipHorizontally;this._sprite.setScale(a?-1:1,n?-1:1),this._sprite.setRotation(i),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();let l=this._sprite.getBounds();return this._renderTexture.resizeTo(new _1(l.width,l.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round()),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(e){return e=e.clone(),this._options.rotation%180&&e.flip(),e}flip(e){let{rotation:t}=this._options;switch((t===90||t===270)&&(e==="vertical"?e="horizontal":e="vertical"),e){case"vertical":this.setFlipVertically(!this.getFlipVertically());break;case"horizontal":this.setFlipHorizontally(!this.getFlipHorizontally());break}}};ca.identifier="orientation";ca.prototype.availableOptions={rotation:{type:h.NUMBER,default:0,validation(s){if(s%90!=0)throw new Error("OrientationOperation: `rotation` has to be a multiple of 90.")},setter:s=>(s+360)%360},flipVertically:{type:h.BOOLEAN,default:!1},flipHorizontally:{type:h.BOOLEAN,default:!1}};X.Operations.OrientationOperation=ca;O0=ca});var du,ma,I0,P0=_(()=>{O();({Vector2:du}=L),ma=class extends ce{constructor(...e){super(...e);this._flipContainer=new R.Container}_render(e){let{position:t,rotation:i,scale:r,pivot:o,outputResolution:n}=this._options,a=this._sdk.getTextureScale(),l=n.clone().multiply(a).ceil();return this._renderTexture.resizeTo(l),this._sprite.setRotation(i),this._sprite.setPosition(t),this._sprite.setPivot(o),this._sprite.setScale(r),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(e){let t=this._sdk.getTextureScale();return this._options.outputResolution.clone().multiply(t).ceil()}};ma.identifier="output";ma.prototype.availableOptions={position:{type:h.VECTOR2,default:new du(0,0)},rotation:{type:h.NUMBER,default:0},scale:{type:h.VECTOR2,default:new du(1,1)},pivot:{type:h.VECTOR2,default:new du(0,0)},outputResolution:{type:h.VECTOR2,default:new du(100,100)}};X.Operations.OutputOperation=ma;I0=ma});var hu,M0,y1,Vo,B0,L0=_(()=>{O();({OverlayFilter:hu}=R.Filters),{Vector2:M0}=L,y1=4,Vo=class extends ce{constructor(...e){super(...e);this._overlayTexture=R.Texture.fromImage(this._options.image),this._overlayContainer=new R.Container,this._overlaySprite=new R.Sprite,this._overlaySprite.setTexture(this._overlayTexture),this._overlaySprite.setAnchor(0,0),this._overlayContainer.addChild(this._overlaySprite),this._overlayFilter=new R.Filters.OverlayFilter({overlayImage:this._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayTexture}),this._sprite.setFilters([this._overlayFilter]),this._renderedOverlaySprite=new R.Sprite,this._renderedOverlayContainer=new R.Container,this._renderedOverlayContainer.addChild(this._renderedOverlaySprite),this._overlayRendered=!1,this._lastInputDimensions=new M0(0,0)}setOption(e,t){if(super.setOption(e,t),e==="image"&&t&&this._sdk){let i=this._sdk.getRenderer(),r=this._overlayTexture.getBaseTexture();r.setSource(t),i.isOfType(K.WEBGL)&&i.updateTexture(r),this._overlayRendered=!1}}_render(e){let t=e.getDimensions(),{image:i,alpha:r,blendMode:o}=this._options;return i?((!this._overlayRendered||!this._lastInputDimensions.equals(t))&&(this._renderOverlayToRenderTexture(e),this._overlayRendered=!0,this._lastInputDimensions.copy(t)),this._overlayFilter.set({blendMode:o,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:r}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),Promise.resolve()):(this._sprite.setFilters([]),this._renderTexture.render(this._container),Promise.resolve())}_renderOverlayToRenderTexture(e){let t=this._sdk.getRenderer(),i=e.getDimensions();this._overlayRenderTexture||(this._overlayRenderTexture=new R.RenderTexture(t,i.x,i.y),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture));let{width:r,height:o}=this._options.image,n=E.resizeVectorToFill(new M0(r,o),i),{flipHorizontally:a,flipVertically:l}=this._options,u=a?-1:1,c=l?-1:1;this._overlaySprite.setWidth(n.x*u),this._overlaySprite.setHeight(n.y*c),this._overlaySprite.setPosition(i.x*(1-u)*.5,i.y*(1-c)*.5);let p=this._overlayRenderTexture.getBaseTexture();this._overlayRenderTexture.resizeTo(i),t.isOfType(K.WEBGL)&&(p.setGLUnit(y1),t.updateTexture(p,!1)),this._overlayRenderTexture.render(this._overlayContainer)}dispose(){super.dispose(),this._overlaySprite&&this._overlaySprite.dispose(),this._overlayRenderTexture&&this._renderedOverlaySprite.dispose(),this._overlayFilter&&this._overlayFilter.dispose(),this._overlayTexture&&this._overlayTexture.dispose(),this._overlayRenderTexture&&this._overlayRenderTexture.dispose(),this._renderedOverlaySprite&&this._renderedOverlaySprite.dispose()}};Vo.identifier="overlay";Vo.BLEND_MODES=hu.BLEND_MODES;Vo.prototype.availableOptions={identifier:{type:h.STRING},image:{type:h.IMAGE},blendMode:{type:h.NUMBER,default:hu.BLEND_MODES.MULTIPLY,available:Object.keys(hu.BLEND_MODES).map(s=>hu.BLEND_MODES[s])},alpha:{type:h.NUMBER,default:1},flipHorizontally:{type:h.BOOLEAN,default:!1},flipVertically:{type:h.BOOLEAN,default:!1}};X.Operations.OverlayOperation=Vo;B0=Vo});var N0,z0=_(()=>{N0=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_radius;
uniform float u_blurRadius;
uniform float u_gradientRadius;
uniform vec2 u_position;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

const float blurSteps = 30.0;
const float EPSILON = 0.000000001;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 coord = v_texCoord * u_texSize;
    vec2 diff = coord - u_position;
    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);

    float blurPercentage = smoothstep( 
      0.0, 1.0,
      (abs(dist) - u_radius) / u_gradientRadius
    );

    float radius = blurPercentage * u_blurRadius;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    for (float t = -blurSteps; t <= blurSteps; t++) {
        float percent = (t + offset - 0.5) / blurSteps;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / max(total, EPSILON);
}
`});var jo,Oh,pu,U0=_(()=>{O();Lo();z0();({Vector2:jo}=L),Oh=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=N0,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastPosition=new jo,this._blurFilter=new Ct,this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let o=t.getDimensions(),n=!i.getDimensions().equals(o),{blurRadius:a,position:l,texSize:u,gradientRadius:c}=this._options;if(t.getBaseTexture().isDirty()||this._lastBlurRadius!==a||n){let m=new jo(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(m);let d={blurRadius:a,texSize:o},f=(g,C,x)=>Math.min(Math.max(g,C),x),b=(g,C,x)=>{let v=f((x-g)/(C-g),0,1);return v*v*(3-2*v)},y=(g,C)=>b(0,1,(Math.abs(u.clone().multiply(g,C).subtract(l).len())-this._options.radius)/(c*2))*a;this._blurFilter.set(d),this._blurFilter._applyCanvas(e,t,i,r,y),this._lastBlurRadius=a}}_renderLQBlur(e,t,i,r=!1){let o=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());let a=!this._lastPosition.equals(this._options.position)||this._lastGradientRadius!==this._options.gradientRadius||n,l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastPosition=this._options.position.clone(),this._lastGradientRadius=this._options.gradientRadius),l&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){let e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new jo(e.width,e.height),r=this._maskRenderTarget.getPixelRatio(),o=this._options.position.clone().multiply(i),{radius:n,gradientRadius:a}=this._options;n*=e.height,a*=e.height;let l=t.createRadialGradient(o.x,o.y,0,o.x,o.y,(n+a)*r);l.addColorStop(0,"#FFFFFF"),l.addColorStop(n/(n+a),"#FFFFFF"),l.addColorStop(1,"#000000"),t.fillStyle=l,t.fillRect(0,0,i.x,i.y)}_applyMask(e,t){let i=t.getContext(),r=e.getCanvas(),o=e.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=o.getImageData(0,0,r.width,r.height),u=l.data,c=n.getImageData(0,0,r.width,r.height).data,p=a.getImageData(0,0,r.width,r.height).data,m;for(let d=0;d<r.width*r.height*4;d+=4)m=p[d]/255,u[d]=m*u[d]+(1-m)*c[d],u[d+1]=m*u[d+1]+(1-m)*c[d+1],u[d+2]=m*u[d+2]+(1-m)*c[d+2];i.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}};Oh.prototype.availableOptions={blurRadius:{type:h.NUMBER,default:30,uniformType:A.FLOAT},radius:{type:h.NUMBER,default:50,uniformType:A.FLOAT},gradientRadius:{type:h.NUMBER,default:25,uniformType:A.FLOAT},position:{type:h.VECTOR2,default:new jo(.5,.5),uniformType:A.FLOAT2},delta:{type:h.VECTOR2,default:new jo(1,1),uniformType:A.FLOAT2},texSize:{type:h.VECTOR2,default:new jo(100,100),uniformType:A.FLOAT2}};pu=Oh});var Ah,da,G0,W0=_(()=>{O();U0();({Vector2:Ah}=L),da=class extends ce{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius;let t={blurQuality:{type:h.STRING}};this._horizontalFilter=new pu({},t),this._verticalFilter=new pu({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Ah(.5,.5)),this._verticalFilter.setDelta(new Ah(-.5,.5)),this._filter=new pu({},t)}rotate(e){let{position:t}=this._options;e===90?(t.flip(),t.x=1-t.x):e===-90&&(t.flip(),t.y=1-t.y),this.set({position:t})}flip(e){let{position:t}=this._options;switch(e){case"horizontal":t.x=1-t.x;break;case"vertical":t.y=1-t.y;break}this.set({position:t})}transform(e){let t={},i=this.getPosition();t.position=e.applyToRelativePoint(i),["radius","blurRadius","gradientRadius"].forEach(r=>{let o=this.getOption(r);t[r]=e.applyToRelativeSize(o)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),{position:r,blurRadius:o,radius:n,gradientRadius:a}=this._options,l={blurRadius:o*i,radius:n*i,gradientRadius:a*i,position:r.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(l),this._verticalFilter.set(l),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let{blurRadius:t,radius:i,gradientRadius:r,position:o}=this._options,n=e.getDimensions();return this._filter.set({blurRadius:t,radius:i,gradientRadius:r,position:o,texSize:n,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};da.identifier="radial-focus";da.prototype.availableOptions={position:{type:h.VECTOR2,default:new Ah(.5,.5)},radius:{type:h.NUMBER,default:.25},gradientRadius:{type:h.NUMBER,default:.125},blurRadius:{type:h.NUMBER,default:.025},highQualityCanvasBlur:{type:h.BOOLEAN,default:!1}};X.Operations.RadialFocusOperation=da;G0=da});var j0,V0=_(()=>{j0=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filterImage;
uniform sampler2D u_maskImage;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filterImage, v_texCoord);
  vec4 mask = texture2D(u_maskImage, v_texCoord);
  gl_FragColor = mix(color0, color1, mask);
}
`});var Ih,H0,q0=_(()=>{O();V0();Ih=class extends R.Filter{constructor(){super();this._fragmentSource=j0}_applyCanvas(e,t,i,r=!1){let o=t.getCanvas(),n=t.getContext(),a=i.getContext(),{maskCanvas:l,filterCanvas:u}=this._options,c=l.getContext("2d"),p=u.getContext("2d"),m=c.getImageData(0,0,o.width,o.height).data,d=n.getImageData(0,0,o.width,o.height),f=d.data,b=p.getImageData(0,0,o.width,o.height).data,y;for(let g=0;g<o.width*o.height*4;g+=4)y=m[g]/255,f[g]=y*b[g]+(1-y)*f[g],f[g+1]=y*b[g+1]+(1-y)*f[g+1],f[g+2]=y*b[g+2]+(1-y)*f[g+2];a.putImageData(d,0,0)}};Ih.prototype.availableOptions={maskImage:{type:h.NUMBER,default:1,uniformType:A.INT},maskCanvas:{type:h.OBJECT,default:null},filterImage:{type:h.NUMBER,default:2,uniformType:A.INT},filterCanvas:{type:h.OBJECT,default:null}};H0=Ih});var fu,K0,yi,Ho=_(()=>{O();({Vector2:fu}=L),K0=class extends J{constructor(e,t){super(t);this._isDisposed=!1,this._operation=e,this._dirtiness={},this.id=E.getUUID(),this._renderTextures={},this._identitySprite=new R.Sprite,this._sprite=new R.Sprite,this._hitTestSprite=new R.Sprite,this._renderers=[]}applyScale(e){}applyRotation(e){let t=this._operation.getInputDimensions(),i=this.getRotation()*180/Math.PI;i+=e,this.setRotation(i*Math.PI/180);let o=(e+360)%360*Math.PI/180,n=Math.cos(o),a=Math.sin(o),l=this._options.position.clone().subtract(.5).multiply(t),u=new fu(l.x*n-l.y*a,l.x*a+l.y*n).divide(t.clone().flip());this.setPosition(new fu(.5,.5).add(u))}applyFlip(e){let t=this.getPosition().clone();switch(e){case"horizontal":t.x=1-this._options.position.x;break;case"vertical":t.y=1-this._options.position.y;break}this.setPosition(t)}applyTransform(e){let t={};t.rotation=e.applyToRotation(this.getRotation()),t.position=e.applyToRelativePoint(this.getPosition()),this._options.dimensions&&(t.dimensions=e.applyToDimensions(this.getDimensions())),this.set(t,!1)}getDisplayObject(){return this._sprite}getHitTestDisplayObject(){return this._sprite}_getTexture(){throw new Error("Sprite#_getTexture is abstract and not implemented in child class.")}_prepareRenderTexture(e){if(this._renderTexture)this._renderTexture.clear();else{let t=this._getTexture();this._renderTextureContainer=new R.Container,this._renderTextureSprite=new R.Sprite(t),this._renderTextureContainer.addChild(this._renderTextureSprite),this._renderTexture=this._getRenderTexture(e.getRenderer(),t.getDimensions())}}_rendersToRenderTexture(e){return e.getOptions().smoothDownscaling&&e.getRenderer().isOfType(K.WEBGL)}_optionEquals(e,t){return e==="type"?!0:super._optionEquals(e,t)}update(e,t){this._isDisposed||(this._rendersToRenderTexture(e)&&(this._prepareRenderTexture(e),this._renderToRenderTexture(e)),this._updateSprite(t))}_updateSprite(e){[this._sprite,this._hitTestSprite].forEach(i=>{if(!i.getTexture())return;i.setAnchor(this._options.anchor),i.setPosition(this._options.position.clone().multiply(e)),typeof this._options.alpha!="undefined"&&i.setAlpha(this._options.alpha);let{dimensions:r}=this._options;r&&(r=r.clone().multiply(this._operation.getSDK().getTextureScale()),i.setWidth(r.x),i.setHeight(r.y)),i.updateTransform();let o=i.getTexture().getFrame(),n=new fu(o.width,o.height);i.setPivot(this._options.pivot.clone().multiply(n)),i.setRotation(this._options.rotation),i.updateTransform()})}_renderToRenderTexture(e){let t=this._getTexture().getDimensions(),i=this._getRenderTexture(e.getRenderer(),t),r=t.clone();if(this._options.smoothDownscaling&&(r.x=E.nextHighestPOT(r.x),r.y=E.nextHighestPOT(r.y)),this._renderTexture.resizeTo(r),this._renderTexture.render(this._renderTextureContainer),this._options.smoothDownscaling){let o=r.clone().subtract(t.x,t.y).divide(r),n=i.getUVs().getUVs();n[0].x=n[3].x=0,n[1].x=n[2].x=1-o.x,n[0].y=n[1].y=0,n[2].y=n[3].y=1-o.y}this._sprite.setTexture(i)}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._renderers[t.id]=t,this._dirtiness[t.id]=e}setDirty(e){for(let t in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[t])}_getRenderTexture(e,t=new fu(100,100)){return this._renderTextures[e.id]||(this._renderTextures[e.id]=new R.RenderTexture(e,t.x,t.y,1)),this._renderTextures[e.id]}dispose(){this._isDisposed=!0;for(let e in this._renderTextures)this._renderTextures[e].dispose()}canBeDuplicated(){return!0}canBeDeleted(){return!0}canMaskCanvas(){return!1}canAdjustPadding(){return!1}canBeTakenToFront(){return!0}canBeFlippedHorizontally(){return!0}},yi=K0});var v1,Tr,Ph=_(()=>{O();({Vector2:v1}=L),Tr=class extends J{constructor(...e){super(...e);this._lastOptions={},this._lastInputDimensions=new v1(0,0),this._brush=null}getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;let{image:t,size:i}=this._options;t.width=t.height=Math.ceil(i*e.min());let r=E.createCanvas();r.width=t.width,r.height=t.height;let o=r.getContext("2d");o.drawImage(t,0,0,r.width,r.height);let n=this._tintImageData(o.getImageData(0,0,r.width,r.height),r.width,r.height);return o.putImageData(n,0,0),this._lastOptions=this.serializeOptions(["size","color"]),this._brush=r,this._lastInputDimensions=e.clone(),r}_tintImageData(e){let{color:t}=this._options;for(let i=0;i<e.data.length;i+=4)e.data[i]+=(t.r*255-e.data[i])*t.a,e.data[i+1]+=(t.g*255-e.data[i+1])*t.a,e.data[i+2]+=(t.b*255-e.data[i+2])*t.a;return e}clone(){let e=this.constructor;return new e(this._options)}};Tr.prototype.availableOptions={identifier:{type:h.STRING},image:{type:h.IMAGE},size:{type:h.NUMBER,default:.05},color:{type:h.COLOR,default:S.RED}}});var ds,X0=_(()=>{O();Ph();ds=class extends Tr{getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;let{size:t,hardness:i,color:r}=this._options,o=E.createCanvas();o.width=o.height=Math.ceil(t*e.min());let n=o.getContext("2d");if(r=r.clone(),r.a=1,o.width===1)n.fillStyle=r.toRGBA(),n.fillRect(0,0,1,1);else{let a=n.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);a.addColorStop(0,r.toRGBA());let l=r.clone();l.a=0,a.addColorStop(1,l.toRGBA()),n.fillStyle=a,n.fillRect(0,0,o.width,o.height)}return this._lastOptions=this.serializeOptions(["size","color","hardness"]),this._brush=o,this._lastInputDimensions=e.clone(),o}};ds.identifier="imgly_brush_radial";ds.prototype.availableOptions=N(D({},Tr.prototype.availableOptions),{hardness:{type:h.NUMBER,default:1}})});var w1,C1,Y0,J0,$0=_(()=>{O();({Vector2:w1,CubicBezierCurve:C1}=L),Y0=class{constructor(e,t,i=3){this._path=e,this._drawnCanvases=[],this._position=t,this._smooth=i}getBezierCurve(e,t,i,r){if(!t)return null;let o,n;r?(o=(r.x-t.x)/this._smooth,n=(r.y-t.y)/this._smooth):(o=(i.x-t.x)/this._smooth,n=(i.y-t.y)/this._smooth);let a,l;e?(a=(i.x-e.x)/this._smooth,l=(i.y-e.y)/this._smooth):(a=(i.x-t.x)/this._smooth,l=(i.y-t.y)/this._smooth);let u=t.clone().add(a,l),c=i.clone().subtract(o,n);return new C1(t,u,c,i)}renderToCanvas(e,t,i,r,o,n=1){if(this._drawnCanvases.indexOf(t)!==-1)return;let a=new w1(t.width,t.height),l=t.getContext("2d"),u=this._position.clone().multiply(a),c=r?r.getPosition().clone().multiply(a):null,p=i?i.getPosition().clone().multiply(a):null,m=o?o.getPosition().clone().multiply(a):null,d=u.clone().subtract(c).len(),f=e.width/10,b=this.getBezierCurve(p,c,u,m),y;if(!b)y=[u];else{b.calculateSegments(20);let g=b.getLength();y=b.arcLengthApproxSample(Math.ceil(g/f))}for(let g=0;g<y.length;g++){let C=y[g],x=e.width*.5/(f*2);x*=1-n,x=1/(1+x),l.globalAlpha=x,l.drawImage(e,C.x-e.width/2,C.y-e.height/2,e.width,e.height)}l.globalAlpha=1,this._drawnCanvases.push(t)}setPosition(e){this._position=e}getPosition(){return this._position.clone()}setDirty(){this._drawnCanvases=[]}},J0=Y0});var Mh,ha,Z0=_(()=>{O();$0();Mh=class extends J{constructor(e,t,i){super(t);this._operation=e,this._canvas=i||E.createCanvas(),this._context=this._canvas.getContext("2d")}serializeOption(e,t=!1){return e==="controlPoints"?this._options.controlPoints.map(i=>{let r=i.getPosition();return t?r.toObject():r.clone()}):super.serializeOption(e,t)}_optionEquals(e,t){if(e==="controlPoints"){let{controlPoints:i}=this._options;for(let r=0,o=i.length;r<o;r++)if(!i[r].getPosition().equals(t[r]))return!1;return!0}return super._optionEquals(e,t)}render(e){let{controlPoints:t,size:i}=this._options;if(t.length<2)return;let r=this.getBrush(),o=r&&r.getHardness?r.getHardness():1;E.ensureCanvasDimensions(this._canvas,e),(!this._brush||this._lastBrushSize!==i||!e.equals(this._brushInputDimensions))&&(this._brushInputDimensions=e.clone(),this._lastBrushSize=i);let n,a,l,u;for(let c=0;c<t.length;c++)n=t[c-2],a=t[c-1],l=t[c],u=t[c+1],l.renderToCanvas(this._options.brush.getBrushImage(e),this._canvas,n,a,u,o)}_createBrush(e){let{size:t,hardness:i,color:r}=this._options,o=E.createCanvas();o.width=o.height=Math.ceil(t*e.min());let n=o.getContext("2d");if(r=r.clone(),r.a=1,o.width===1)n.fillStyle=r.toRGBA(),n.fillRect(0,0,1,1);else{let a=n.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);a.addColorStop(0,r.toRGBA());let l=r.clone();l.a=0,a.addColorStop(1,l.toRGBA()),n.fillStyle=a,n.fillRect(0,0,o.width,o.height)}return o}addControlPoint(e){let t=new J0(this,e);this._options.controlPoints.push(t),this.emit("update",this)}getCanvas(){return this._canvas}setCanvas(e){this._canvas=e,this._context=e.getContext("2d")}setDirty(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._options.controlPoints.forEach(e=>{e.setDirty()})}forEachControlPoint(e){this._options.controlPoints.forEach(e)}renderToCanvas(e){let t=e.getContext("2d");t.save(),t.globalAlpha=this._options.brush.getColor().a,t.drawImage(this._canvas,0,0),t.restore()}getCanvasDimensions(){return this._canvasDimensions}};Mh.prototype.availableOptions={id:{type:h.STRING,default:()=>E.getUUID()},brush:{type:h.OBJECT,required:!0},controlPoints:{type:h.ARRAY,default:[]},closed:{type:h.BOOLEAN,default:!1}};ha=Mh});var gu,hs,ps,Bh=_(()=>{O();Ho();Ph();X0();Z0();({Vector2:gu}=L),hs=class extends yi{constructor(...e){super(...e);this._persistedPaths=[],this._outputCanvasDirty=!0,this._outputCanvas=E.createCanvas(),this._outputContext=this._outputCanvas.getContext("2d"),this._persistCanvas=E.createCanvas(),this._persistContext=this._persistCanvas.getContext("2d"),this._nextCanvas=E.createCanvas(),this._texture=R.Texture.fromCanvas(this._outputCanvas),this._sprite.setTexture(this._texture),this._onPathUpdate=this._onPathUpdate.bind(this)}applyFlip(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{let r=i.getPosition().clone();switch(e){case"horizontal":r.x=1-r.x;break;case"vertical":r.y=1-r.y;break}i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyRotation(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{let r=i.getPosition().clone();e===90?(r.flip(),r.x=1-r.x):e===-90&&(r.flip(),r.y=1-r.y),i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyTransform(e){let t=null;this._options.paths.forEach(i=>{i.forEachControlPoint(o=>{o.setPosition(e.applyToRelativePoint(o.getPosition()))});let r=i.getBrush();r!==t&&(r.setSize(e.applyToRelativeSize(r.getSize())),t=r),i.setDirty(!0)}),this._reset()}clearCanvas(){if(!this._outputCanvas)return;this._outputCanvasDirty=!0;let{width:e,height:t}=this._outputCanvas;this._outputContext.clearRect(0,0,e,t)}clearPersistCanvas(){if(!this._persistCanvas)return;let{width:e,height:t}=this._persistCanvas;this._persistContext.clearRect(0,0,e,t)}serializeOptions(e,t=!1){let i=super.serializeOptions(e,t);return e||(i.type="brush"),i}serializeOption(e,t=!1){return e==="paths"?this._options.paths.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createPath(e){let t=new ha(this._operation,{brush:e},this._nextCanvas);return t.on("update",this._onPathUpdate),this._options.paths.push(t),this.setDirty(!0),t}_onPathUpdate(){this._operation.setDirty(!0),this.setDirty(!0)}_onPathPersist(e){e.renderToCanvas(this._persistCanvas),this._nextCanvas=e.getCanvas(),this._nextCanvas.getContext("2d").clearRect(0,0,this._nextCanvas.width,this._nextCanvas.height),this._persistedPaths.push(e)}_getTexture(){return this._texture}setDirtyForRenderer(e,t,i=!1){super.setDirtyForRenderer(e,t,i),e&&i&&(this._persistedPaths=[],this.clearPersistCanvas(),this._options.paths.forEach(r=>{r.setDirty(!0)}))}setDirty(e,t=!1){for(let i in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[i],t)}render(e){let t=this._operation.getSDK().getRenderer();!this.isDirtyForRenderer(t)||(E.ensureCanvasDimensions(this._outputCanvas,e),E.ensureCanvasDimensions(this._persistCanvas,e),this._options.paths.forEach(i=>{i.render(e),i.getClosed()&&this._persistedPaths.indexOf(i)===-1&&this._onPathPersist(i)}),this.clearCanvas(),this._outputContext.drawImage(this._persistCanvas,0,0),this._options.paths.forEach(i=>{i.getClosed()||i.renderToCanvas(this._outputCanvas)}),this.setDirtyForRenderer(!1,t))}update(e,t){t&&(E.ensureCanvasDimensions(this._outputCanvas,t),E.ensureCanvasDimensions(this._persistCanvas,t),this._texture.getBaseTexture().update()),this.render(t);let i=e.getRenderer();i.isOfType(K.WEBGL)&&i.updateTexture(this._texture.getBaseTexture()),super.update(e,t)}_reset(){this._persistedPaths=[],this._operation&&this._operation.setDirty(!0),this.setDirty(!0),this.clearCanvas(),this.clearPersistCanvas()}getCanvas(){return this._outputCanvas}_createRadialBrush(){return new ds}_getTempCanvas(){return this._nextCanvas}dispose(){super.dispose(),this._texture&&this._texture.getBaseTexture().dispose()}};hs.prototype.availableOptions={id:{type:h.STRING,default:()=>E.getUUID()},position:{type:h.VECTOR2,default:new gu(0,0)},scale:{type:h.VECTOR2,default:new gu(1,1)},anchor:{type:h.VECTOR2,default:new gu(0,0)},pivot:{type:h.VECTOR2,default:new gu(0,0)},rotation:{type:h.NUMBER,default:0},paths:{type:h.ARRAY,default:[],setter(s){return s=s.map(e=>{if(e instanceof ha)return e;let{brush:t,closed:i}=e,r=new ha(this._operation,{brush:t,closed:i},this._nextCanvas);return e.controlPoints.forEach(o=>{r.addControlPoint(o)}),r}),this._reset(),s}}};hs.type="brush";hs.Brush=Tr;hs.Path=ha;hs.Brushes={RadialBrush:ds};ps=hs});var Q0,pa,ev,tv=_(()=>{O();Lo();q0();Bh();({Vector2:Q0}=L),pa=class extends ce{constructor(...e){super(...e);let t=this._sdk.getRenderer();this._lastBlurRadius=null,this._blurredRenderTexture=new R.RenderTexture(t,100,100,1),this._maskRenderTexture=new R.RenderTexture(t,100,100,1),this._brushSprite=new ps(this),this._brushSpriteContainer=new R.Container;let i=this._brushSprite.getDisplayObject();if(this._brushSpriteContainer.addChild(i),this._outputSprite=new R.Sprite,this._outputContainer=new R.Container,this._outputContainer.addChild(this._outputSprite),this._maskFilter=new H0,t.isOfType(K.WEBGL)){this._horizontalFilter=new Ct,this._verticalFilter=new Ct,this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Q0(1,1)),this._verticalFilter.setDelta(new Q0(-1,1));let r=this._maskRenderTexture.getBaseTexture();r.setGLUnit(this._maskFilter.getMaskImage()),t.updateTexture(r,!1),r=this._blurredRenderTexture.getBaseTexture(),r.setGLUnit(this._maskFilter.getFilterImage()),t.updateTexture(r,!1)}else t.isOfType(K.CANVAS)&&(this._blurFilter=new Ct,this._sprite.setFilters([this._blurFilter]),this._maskFilter.setMaskCanvas(this._maskRenderTexture.getRenderTarget().getCanvas()),this._maskFilter.setFilterCanvas(this._blurredRenderTexture.getRenderTarget().getCanvas()));this._outputSprite.setFilters([this._maskFilter])}flip(e){this._brushSprite.applyFlip(e),this.setDirty(!0,!0),this._lastBlurRadius=null}rotate(e){this._brushSprite.applyRotation(e),this.setDirty(!0,!0),this._lastBlurRadius=null}transform(e,t){this._brushSprite.applyTransform(e,t),this.setDirty(!0,!0),this._lastBlurRadius=null}_render(e){return this._renderBlur(e),this._renderMask(e),this._outputSprite.setTexture(e),this._renderTexture.render(this._outputContainer),Promise.resolve()}_renderMask(e){let t=e.getDimensions();this._maskRenderTexture.getDimensions().equals(t)||this._maskRenderTexture.resizeTo(t),this._brushSprite.update(this._sdk,t),this._maskRenderTexture.clear(S.BLACK),this._maskRenderTexture.render(this._brushSpriteContainer);let r=this._sdk.getRenderer();r.isOfType(K.WEBGL)&&r.updateTexture(this._maskRenderTexture.getBaseTexture(),!1)}_renderBlur(e){let t=e.getDimensions(),i=this._blurredRenderTexture.getDimensions();i.equals(t)||this._blurredRenderTexture.resizeTo(t);let{blurRadius:r}=this._options;if(this._lastBlurRadius!==r||!i.equals(t)){let n=this._sdk.getRenderer(),a;if(n.isOfType(K.WEBGL)){let l=t.min();a={blurRadius:r*l,texSize:t},this._horizontalFilter.set(a),this._verticalFilter.set(a)}else n.isOfType(K.CANVAS)&&(a={blurRadius:r},this._blurFilter.set(a));this._blurredRenderTexture.render(this._container),this._lastBlurRadius=r}let o=this._sdk.getRenderer();o.isOfType(K.WEBGL)&&o.updateTexture(this._blurredRenderTexture.getBaseTexture(),!1)}getBrush(){return this._brushSprite}createPath(e,t=1){let i=new ps.Brushes.RadialBrush({size:e,hardness:t,color:S.WHITE}),r=this._brushSprite.createPath(i);return this._options.paths.push(r),this.setDirty(!0),r}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._brushSprite.setDirtyForRenderer(e,t,i)}dispose(){super.dispose(),this._sdk.getRenderer().isOfType(K.WEBGL)?(this._verticalFilter.dispose(),this._horizontalFilter.dispose()):this._blurFilter.dispose(),this._brushSprite.dispose(),this._maskFilter.dispose(),this._blurredRenderTexture.dispose(),this._maskRenderTexture.dispose()}hasChanges(){return!0}};pa.identifier="selective-blur";pa.prototype.availableOptions={blurRadius:{type:h.NUMBER,default:.05},paths:{type:h.ARRAY,default:[],setter(s){return this._brushSprite&&this._brushSprite.setPaths(s),s}}};X.Operations.SelectiveBlurOperation=pa;ev=pa});var fs,_u,yu,bu,iv=_(()=>{O();Ed();Ho();({Vector2:fs,ColorMatrix:_u}=L),yu=class extends yi{constructor(...e){super(...e);let{image:t}=this._options,i=t.src||t.filePath||t.toDataUrl&&t.toDataURL();this._isSVG=i&&(!!i.match(/\w+\.svg(?=\?|$)/i)||i.match(/data:image\/svg/i)),this._isSVG&&(this._canvas=E.createCanvas(),this._context=this._canvas.getContext("2d"),this._options.smoothDownscaling=!1),t&&this._onImageUpdate(),this._tintFilter=new R.Filters.TintFilter,this._adjustmentsFilter=new Ml,this._lastRenderedDimensions=fs.NULL,this._lastRenderedInputDimensions=fs.NULL,this._onOptionsChange=this._onOptionsChange.bind(this),this._options.adjustments.on("update",this._onOptionsChange)}applyScale(e){this.setDimensions(this.getDimensions().multiply(e))}serializeOptions(e,t=!1){let i=super.serializeOptions(e,t);return e||(i.type="sticker"),i}_rendersToRenderTexture(e){return this._options.smoothDownscaling&&!this._isSVG&&e.getRenderer().isOfType(K.WEBGL)||this._hasAdjustments()||this._options.tintMode!=="none"}_getTexture(){return this._inputTexture}update(e,t){let{dimensions:i,image:r}=this._options;if(i.equals(fs.NULL)&&i.set(r.width,r.height),this._sprite.setSmoothDownscaling(this._isSVG?!1:this.getSmoothDownscaling()),(!this._lastRenderedInputDimensions.equals(t)||!this._lastRenderedDimensions.equals(i)||this._lastRenderedImage!==r)&&this._isSVG&&e.getRenderer().isOfType(K.WEBGL)){r.width=Math.round(i.x),r.height=Math.round(i.y);let a=4096,l=r.width/r.height;r.width>a&&(r.width=a,r.height=Math.round(r.width/l)),r.height>a&&(r.height=a,r.width=Math.round(r.height*l)),this._canvas.width=r.width,this._canvas.height=r.height,this._context.clearRect(0,0,r.width,r.height),this._context.drawImage(r,0,0,r.width,r.height),this._inputTexture.getBaseTexture().update()}this._rendersToRenderTexture(e)&&this._prepareRenderTexture(e);let n=[];if(this._rendersToRenderTexture(e)){if(this._hasAdjustments()){n.push(this._adjustmentsFilter);let{adjustments:a}=this._options,l=new _u;l.multiply(_u.createBrightnessMatrix(a.getBrightness())),l.multiply(_u.createSaturationMatrix(a.getSaturation())),l.multiply(_u.createContrastMatrix(a.getContrast())),this._adjustmentsFilter.set({colorMatrix:l})}this._options.tintMode&&this._options.tintMode!=="none"&&(n.push(this._tintFilter),this._tintFilter.set({mode:R.Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],color:this._options.tintColor}),this._sprite.getTexture()&&this._sprite.getTexture()._baseTexture&&this._sprite.getTexture()._baseTexture.setDirty(!0)),this._renderTextureSprite.setFilters(n)}this._rendersToRenderTexture(e)?this._renderToRenderTexture(e):this._sprite.setTexture(this._inputTexture),this._updateSprite(t),this._applyFlip(),this._lastRenderedDimensions.copy(i),this._lastRenderedInputDimensions.copy(t),this._lastRenderedImage=r}_applyFlip(){let e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}applyFlip(e){super.applyFlip(e);let t={rotation:this._options.rotation},r=t.rotation/Math.PI*180*-1;switch(t.rotation=r*Math.PI/180,e){case"horizontal":t.flipHorizontally=!this._options.flipHorizontally,this.set(t);break;case"vertical":t.flipVertically=!this._options.flipVertically,this.set(t);break}}_hasAdjustments(){let{adjustments:e}=this._options;return e.getBrightness()!==0||e.getSaturation()!==1||e.getContrast()!==1}_onImageUpdate(){let e=this._options.image,t=this._operation.getSDK().getRenderer();this._isSVG&&t.isOfType(K.WEBGL)&&(e=this._canvas),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._inputTexture=R.Texture.fromImage(e),this._identitySprite.setTexture(this._inputTexture),this._sprite.setTexture(this._inputTexture),this._renderTexture&&(this._renderTextureSprite.setTexture(this._inputTexture),this._renderTexture.resizeTo(this._inputTexture.getDimensions())),this.setDirty(!0)}scalesUniformly(){return this._options.resizeMode==="keepAspect"}setOption(e,t,i=!0){super.setOption(e,t,i),e==="image"&&this._identitySprite&&this._onImageUpdate()}_onOptionsChange(){let e=this._dirtiness;for(let t in e)e[t]=!0}dispose(){super.dispose(),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._tintFilter.dispose(),this._adjustmentsFilter.dispose(),this._options.adjustments.off("updated",this._onOptionsChange)}};yu.prototype.availableOptions={id:{type:h.STRING,default:()=>E.getUUID()},identifier:{type:h.STRING,default:""},image:{type:h.IMAGE,required:!0},position:{type:h.VECTOR2,default:fs.NULL},dimensions:{type:h.VECTOR2,default:fs.NULL},anchor:{type:h.VECTOR2,default:new fs(0,0)},pivot:{type:h.VECTOR2,default:new fs(.5,.5)},rotation:{type:h.NUMBER,default:0},flipHorizontally:{type:h.BOOLEAN,default:!1},flipVertically:{type:h.BOOLEAN,default:!1},smoothDownscaling:{type:h.BOOLEAN,default:!1},tintColor:{type:h.COLOR,default:S.WHITE},tintMode:{type:h.STRING,default:"none",available:["none","solid","colorized"]},resizeMode:{type:h.STRING,default:"keepAspect",available:["keepAspect","unrestricted"]},alpha:{type:h.NUMBER,default:1},adjustments:{type:h.CONFIGURABLE,structure:{brightness:{type:h.NUMBER,default:0},saturation:{type:h.NUMBER,default:1},contrast:{type:h.NUMBER,default:1}}}};yu.type="sticker";bu=yu});var bi,ne,At=_(()=>{bi=class{constructor(e){this._seed=e===void 0?bi.TimeSeed():e}seed(e){this._seed=e===void 0?bi.TimeSeed():e}next(){let e=this._seed|0,t=e/bi.SEED_DIVIDER|0,i=e%bi.SEED_DIVIDER|0;return e=bi.SEED_LOW_MULTIPLY*i-bi.SEED_HIGH_MULTIPLY*t,e<=0&&(e+=bi.MAX),e===-1&&(e=bi.MAX-1),this._seed=e,e}nextInRange(e,t){return t===void 0&&(t=e,e=0),e+this.next()%(t-e+1)}nextBool(e=1,t=1){return this.nextInRange(e+t-1)>=e}static TimeSeed(){return Date.now()}pickNext(e){return Array.isArray(e)?e[this.next()%e.length]:null}},ne=bi;P(ne,"MAX",2147483647),P(ne,"SEED_DIVIDER",127773),P(ne,"SEED_LOW_MULTIPLY",16807),P(ne,"SEED_HIGH_MULTIPLY",2836)});var D1,Se,xi=_(()=>{O();({Rectangle:D1}=L),Se=class{constructor(e=0,t=0){this.width=e,this.height=t}set(e,t){this.width=e,this.height=t}aspect(){return this.width/this.height}rectangle(e,t){return new D1(e,t,this.width,this.height)}clone(){return new Se(this.width,this.height)}scale(e,t){return t===void 0&&(t=e),this.width*=e,this.height*=t,this}copy(e){return this.width=e.width,this.height=e.height,this}fitInWidthWithOther(e,t=new Se){return this.copy(Se.fitTwoInWidth(e,this,t)[0]),this}static fitTwoInWidth(e,t,i){let r=t.width*i.height+t.height*i.width,o=i.height*e/r,n=t.width*o,a=t.height*o;return[new Se(n,a),new Se(e-n,a)]}}});var rv,Lh,ge,Ht=_(()=>{O();rv=Ur(ol()),Lh=class extends J{loadImages(e){return Ge(this,null,function*(){return(0,rv.default)(e,t=>Ge(this,null,function*(){return this.addImage(t.path,t.fullPath,t.image)}))})}addImage(e,t,i,r="anonymous"){let o=this.getImages();return i?(o[e]={fullPath:t,image:i},Promise.resolve({fullPath:t,image:i})):new Promise((n,a)=>{i=new wt,i.onload=()=>{o[e]={fullPath:t,image:i},n({fullPath:t,image:i})},i.crossOrigin=E.getCrossOriginValue(r),i.onerror=a,i.src=t})}getImage(e){let i=this.getImages()[e];return i?i.image:null}getVariation(e){return this.getFonts()[e]}addFont(e,t){let i=this.getFonts();return i[e]=t,t}};Lh.prototype.availableOptions={images:{type:h.OBJECT,default:{}},fonts:{type:h.OBJECT,default:{}}};ge=new Lh});var k1,T1,sv,R1,E1,F1,S1,O1,gt,qo=_(()=>{O();xi();Ht();k1=(s,e,t,i)=>{let r=t*(i*4)+e*4;return{r:s[r],g:s[r+1],b:s[r+2],a:s[r+3]}},T1=s=>s.a<=254,sv=(s,e,t)=>{let i=!0;for(let r=0;r<t;r++){let o=k1(s,r,e,t);if(!T1(o)){i=!1;break}}return i},R1=(s,e,t,i,r=!1)=>{let o=0;for(let n=i+1;n<t;n++)if(!sv(s,n,e))o=n-i+1;else if(r)break;return o},E1=(s,e,t,i,r=!1)=>{let o=0;for(let n=i-1;n>=0;n--)if(!sv(s,n,e))o=i-n;else if(r)break;return o},F1=(s,e,t,i,r)=>{s.beginPath(),s.moveTo(e,t),s.lineTo(i,r),s.stroke()},S1=(s,e,t,i,r="red")=>{s.save(),s.strokeStyle=r,F1(s,t,e,i,e),s.restore()},O1=(s,e,t,i,r,o="blue")=>{s.save(),s.strokeStyle=o,s.strokeRect(e,t,i,r),s.restore()},gt=class extends J{constructor(e){super(e);let t=ge.getVariation(this.getFontIdentifier());t||B.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.set({fontVariation:t}),this._metrics=null,this._canvas=E.createCanvas(),this._context=this._canvas.getContext("2d"),this._isDirty=!0}_onOptionsChange(){this._isDirty=!0}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){let e=ge.getVariation(this.getFontIdentifier());return e||B.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}setOptions(e={}){this._options=D(D({},this._options),e),this._isDirty=!0}_applyTextOptions(e=this._context,t={}){let{fontSize:i,fontVariation:r,lineHeight:o,textColor:n,alignment:a}=D(D({},this._options),t),{fontStyle:l,fontWeight:u,fontFamily:c}=r.serializeOptions();e.font=`${l} ${u} ${i}px / ${o} ${c}`,e.fillStyle=n,e.textBaseline="alphabetic",e.textAlign=a||"left"}getTextMetrics(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),D({},this._metrics)}getSizeValue(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),new Se(this._metrics.width,this._metrics.height)}fitWidth(e){if(!this.getFontVariation()){B.warn("TextDesignFont#fitText: missing font variation");return}this._applyTextOptions(this._context,{fontSize:50});let i=this._context.measureText(this.getText()).width,r=e/i,o=Math.floor(r*50);return this.setFontSize(o),this._calculateTextMetrics(),this.getTextMetrics()}fitHeight(e){if(!this.getFontVariation()){B.warn("TextDesignFont#fitText: missing font variation");return}let i=this._calculateTextMetrics({fontSize:50}).height,r=e/i,o=Math.floor(r*50);return this.setFontSize(o),this._calculateTextMetrics(),this.getTextMetrics()}_calculateTextMetrics(e={}){let t=this._canvas,i=this._context,r=D(D({},this._options),e),o=this.getText();this._applyTextOptions(i,r);let n=Math.ceil(i.measureText(o).width),a=Math.floor(n+r.fontSize*2),l=Math.floor(r.fontSize*3);t.width=a,t.height=l;let u=Math.floor(r.fontSize),c=Math.floor(l*(3/5));this._applyTextOptions(i,r),i.fillText(o,u,c);let p=i.getImageData(0,0,t.width,t.height).data,m=E1(p,a,l,c,this._options.excludeAccents),d=R1(p,a,l,c,this._options.excludeAccents),f=n,b=m+d;return this._metrics={width:f,height:b,ascender:m,descender:d},this._isDirty=!1,D({},this._metrics)}draw(e=this._context,t=0,i=0,r,o=!1){e.save(),(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),this._applyTextOptions(e,r),e.fillText(this.getText(),t,i+this._metrics.ascender),o&&(O1(e,t,i,this._metrics.width,this._metrics.height),S1(e,i+this._metrics.ascender,t,t+this._metrics.width)),e.restore()}};gt.prototype.availableOptions={text:{type:h.STRING,default:""},fontIdentifier:{type:h.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:h.OBJECT,default:null},lineHeight:{type:h.NUMBER,default:1},fontSize:{type:h.NUMBER,default:22},textColor:{type:h.STRING,default:"black"},strokeStyle:{type:h.STRING,default:"black"},outlineWidth:{type:h.NUMBER,default:0},textBaseline:{type:h.STRING,default:"alphabetic"},excludeAccents:{type:h.BOOLEAN,default:!1}}});var _t,gs=_(()=>{O();_t=class extends J{};_t.prototype.availableOptions={text:{type:h.STRING,default:""},frame:{type:h.OBJECT,default:null},font:{type:h.OBJECT,default:null}}});var qt,Ko=_(()=>{O();qt=class extends J{};qt.prototype.availableOptions={tintColor:{type:h.COLOR,default:S.BLACK},textColor:{type:h.COLOR,default:S.BLACK},alignment:{type:h.STRING,default:"left",available:["left","center","right"]},lineSpacing:{type:h.NUMBER,default:1},fontIdentifier:{type:h.STRING,default:"imgly_font_open_sans_bold"}}});var A1,Tt,fa=_(()=>{O();xi();Ko();({Rectangle:A1}=L),Tt=class extends J{constructor(e){super(e);this.setSize(new Se(this.getWidth(),0)),this.serverImageSmoothingFix=!1}_getFrame(){let e=this.getSize();return new A1(0,0,e.width,e.height)}_getTextFrame(){return this._getFrame()}_getTextFrameForElement(e){return e.getFrame().clone()}_calculateLayoutElements(){B.warn("TextDesignRow is an abstract class.")}_getLayoutElements(){return this._options.elements.length<=0&&this.layout(),this.getElements()}_fontSize(e){return B.warn("TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?"),0}layout(){return this.setElements(this._calculateLayoutElements()),this}textFrame(e,t){return e.getFrame().clone()}willRender(e){}didRender(e){}render(e){e.save(),this._getLayoutElements().forEach(t=>{let{text:i,frame:r,font:o}=t.serializeOptions(),n=this.getAttributes();o.draw(e,r.x,r.y,{textColor:n.getTextColor().toRGBA(),alignment:n.getAlignment()})}),e.restore()}};Tt.prototype.availableOptions={words:{type:h.OBJECT,default:null},width:{type:h.NUMBER,default:100},attributes:{type:h.CONFIGURABLE,default:new qt},shearingAngle:{type:h.NUMBER,default:0},elements:{type:h.ARRAY,default:[]},size:{type:h.OBJECT,default:null}}});var I1,ga,si,ov=_(()=>{O();qo();gs();fa();({Rectangle:I1}=L),ga=class extends Tt{_calculateLayoutElements(){if(this.getWords().size()<=0)return[];let{orientation:e,width:t,size:i,relativeRowOffset:r,attributes:o}=this.serializeOptions(),{fontIdentifier:n}=o,a=this.getWords().joined(3),l=e===ga.Orientations.Left?[a[0],a[1],a[2]]:[a[1],a[2],a[0]],u=E.Array.range(0,2).map(te=>new gt({text:l[te],fontIdentifier:n,fontSize:60})),c=u.map(te=>te.getSizeValue()),p=c[0].width>c[1].width?0:1,m=(p+1)%2;u[m].fitWidth(c[p].width),c[m]=u[m].getSizeValue();let d=(c[m].height+c[p].height)/(1-r),f=new gt({text:l[2],fontIdentifier:n});f.fitHeight(d);let b=f.getSizeValue().width,y=c[p].width,g=t/(b+y),C=g*b,x=g*y,v=g*d,M=r*v;i.set(t,v);let w=E.Array.range(0,3).map(te=>new gt({text:l[te],fontIdentifier:n}));w[0].fitWidth(x),w[1].fitWidth(x),w[2].fitWidth(C);let k=e===ga.Orientations.Left?0:C,q=e===ga.Orientations.Left?x:0,j=[k,k,q],Z=[0,w[0].getSizeValue().height+M,0],re=w.map((te,Y)=>new I1(j[Y],Z[Y],te.getSizeValue().width,te.getSizeValue().height));return w.map((te,Y)=>new _t({text:l[Y],font:w[Y],frame:re[Y]}))}},si=ga;P(si,"Orientations",{Right:"RIGHT",Left:"LEFT"});si.prototype.availableOptions=N(D({},Tt.prototype.availableOptions),{orientation:{type:h.STRING,default:si.Orientations.Left,available:[si.Orientations.Right,si.Orientations.Left]},relativeRowOffset:{type:h.NUMBER,default:.05}})});var P1,Q,It=_(()=>{O();({Rectangle:P1}=L),Q=class{constructor(e=0,t=0,i=0,r=0){this.top=e,this.left=t,this.bottom=i,this.right=r}multiply(e){this.top*=e,this.left*=e,this.bottom*=e,this.right*=e}toObject(){return D({},this)}equals(e,t=0){return Math.abs(e.top-this.top)<=t&&Math.abs(e.left-this.left)<=t&&Math.abs(e.bottom-this.bottom)<=t&&Math.abs(e.right-this.right)<=t}scale(e=1,t){return t===void 0&&(t=e),this.top*=t,this.bottom*=t,this.left*=e,this.right*=e,this}clone(){return new Q(this.top,this.left,this.bottom,this.right)}applyToRectangle(e){return new P1(e.x+this.left,e.y+this.top,e.width-this.left-this.right,e.height-this.top-this.bottom)}static get ZERO(){return new Q(0,0,0,0)}}});var Pe,Kt=_(()=>{O();qo();It();gs();fa();Pe=class extends Tt{_calculateLayoutElements(){let{attributes:e,imageInsets:t,size:i,width:r}=this.serializeOptions(),o=this.getWords().joined(1)[0]||"",{fontIdentifier:n}=e,a=new gt({text:o,fontIdentifier:n});a.fitWidth(this._getTextFrame().width);let l=a.getTextMetrics().height+t.top+t.bottom;i.height=l;let u=this._getTextFrame();return[new _t({text:o,frame:u,font:a})]}};Pe.prototype.availableOptions=N(D({},Tt.prototype.availableOptions),{imageInsets:{type:h.OBJECT,default:new Q}})});var Xi,lt,zh,Xt,xu,Xo,Nh,nv,av,Yi,Rr=_(()=>{O();({Rectangle:Xi,Vector2:lt}=L),zh=(s,e,t,i)=>{s.drawImage(e,t.x,t.y,t.width,t.height,i.x,i.y,i.width,i.height)},Xt=(s,e,t,i="source-over",r=!1)=>{s.save(),s.fillStyle=t.toRGBA(),s.globalCompositeOperation=i,s.fillRect(e.x,e.y,e.width,e.height),r&&(s.strokeStyle=t.toRGBA(),s.strokeWith=1,s.strokeRect(e.x,e.y,e.width,e.height)),s.restore()},xu=(s,e,t,i,r="source-over",o=!1)=>{s.save(),s.fillStyle=i.toRGBA(),s.globalCompositeOperation=r,t=Math.min(Math.max(t,0),Math.min(e.height,e.width)*.5);let n=e.x,a=e.x+e.width,l=e.y,u=e.y+e.height;s.beginPath(),s.moveTo(n+t,l),s.arcTo(a,l,a,u,t),s.arcTo(a,u,n,u,t),s.arcTo(n,u,n,l,t),s.arcTo(n,l,a,l,t),s.closePath(),s.fill(),o&&s.stroke(),s.restore()},Xo=(s,e,t,i=4)=>{s.save(),s.strokeStyle=t.toRGBA(),s.lineWidth=i,s.strokeRect(e.x,e.y,e.width,e.height),s.restore()},Nh=(s,e,t,i="source-over")=>{s.save();let r=e.height/2,o=e.y+r,n=e.x+r,a=e.x+e.width;for(s.fillStyle=t.toRGBA(),s.globalCompositeOperation=i;n<a;)s.beginPath(),s.arc(n,o,r,0,2*Math.PI),s.fill(),n+=r*4;s.restore()},nv=(s,e)=>{let t=e.applyToRectangle(s),{x:i,y:r,width:o,height:n}=s,a=[Xi.FromDiagonalPoints(new lt(0,0),new lt(t.x,t.y)),Xi.FromDiagonalPoints(new lt(0,t.y+t.height),new lt(t.x,n)),Xi.FromDiagonalPoints(new lt(t.x+t.width,t.y+t.height),new lt(o,n)),Xi.FromDiagonalPoints(new lt(t.x+t.width,0),new lt(o,t.y))].map(u=>u.translate(i,r)),l=[Xi.FromDiagonalPoints(new lt(t.x,0),new lt(t.x+t.width,t.y)),Xi.FromDiagonalPoints(new lt(0,t.y),new lt(t.x,t.y+t.height)),Xi.FromDiagonalPoints(new lt(t.x,t.y+t.height),new lt(t.x+t.width,n)),Xi.FromDiagonalPoints(new lt(t.x+t.width,t.y),new lt(o,t.y+t.height))].map(u=>u.translate(i,r));return{corners:a,bars:l,center:t}},av=(s,e,t,i)=>{let r=e.naturalWidth||e.width,o=e.naturalHeight||e.height,n=nv(new Xi(0,0,r,o),i),a=nv(t,i);zh(s,e,n.center,a.center),E.Array.zip(n.corners,a.corners).forEach(([l,u])=>zh(s,e,l,u)),E.Array.zip(n.bars,a.bars).forEach(([l,u])=>zh(s,e,l,u))},Yi=(s,e,t,i,r="source-atop")=>{if(s.save(),i&&(s.globalAlpha=i.a),s.drawImage(e,t.x,t.y,t.width,t.height),i&&(s.globalAlpha=1),i){let o=i.clone();o.a=1,Xt(s,t,o,r)}s.restore()}});var Ji,vu=_(()=>{O();Rr();It();Kt();Ji=class extends Pe{_getTextColor(){return this.getAutoAdjustTextColor()&&!this.getIsMasked()?this.getBackgroundColor().equals(S.WHITE)?S.BLACK:S.WHITE:this.getAttributes().getTextColor().clone()}_getTextFrame(){return this.getImageInsets().applyToRectangle(this._getFrame())}_getTextFrameForElement(e){let t=super._getTextFrameForElement(e),i=this.getImageInsets();return(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&(t.y-=i.top),t}willRender(e){this.getAttributes().setTextColor(this._getTextColor());let i=this.getImage();if(i){let r=this.getCapInsets(),o=this._getFrame();r&&!r.equals(Q.ZERO)?av(e,i,o,r):e.drawImage(i,o.x,o.y,o.width,o.height),Xt(e,o,this.getBackgroundColor(),"source-atop",!0)}(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&i&&(e.save(),e.globalCompositeOperation="destination-out")}didRender(e){super.didRender(e),(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&e.restore()}};Ji.prototype.availableOptions=N(D({},Pe.prototype.availableOptions),{image:{type:h.IMAGE,default:null},capInsets:{type:h.OBJECT,default:new Q},backgroundColor:{type:h.COLOR,default:S.WHITE},autoAdjustTextColor:{type:h.BOOLEAN,default:!0},isMasked:{type:h.BOOLEAN,default:!0},isUsedInInvertedLayout:{type:h.BOOLEAN,default:!1}})});var Pt,wu=_(()=>{O();It();Pt=class extends J{insetsForWidth(e){return this.getRelativeInsets().clone().scale(e)}static get Small(){return new Pt({imagePath:"text-design/images/imgly_text_design_asset_banderole_small.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new Q(.05,.2,.05,.2)})}static get Rectangle(){return new Pt({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new Q(.05,.05,.05,.05),needsImageSmoothingFix:!0})}static get Celebrate1(){return new Pt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_01.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new Q(.05,.2,.05,.2)})}static get Celebrate2(){return new Pt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_02.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new Q(.05,.2,.05,.2)})}};Pt.prototype.availableOptions={image:{type:h.IMAGE,default:null},imagePath:{type:h.STRING,default:null},relativeInsets:{type:h.OBJECT,default:new Q},fontIdentifier:{type:h.STRING,default:"imgly_font_open_sans_bold"},needsImageSmoothingFix:{type:h.BOOLEAN,default:!1}}});var Cu,lv=_(()=>{O();It();xi();Cu=class extends J{getSize(){let e=this.getRows(),t=this.getWidth(),i=e.length-1,r=e.reduce((n,a)=>n+a.getSize().height,0);r+=(i+1)*this.getRelativeLineSpacing()*t;let o=this.getRelativeInsets().clone().scale(t);return r+=o.top+o.bottom,new Se(t,r)}};Cu.prototype.availableOptions={text:{type:h.STRING,default:""},lines:{type:h.ARRAY,default:[]},relativeInsets:{type:h.OBJECT,default:new Q},relativeLineSpacing:{type:h.NUMBER,default:0},rows:{type:h.OBJECT,default:[]},background:{type:h.OBJECT,default:null},width:{type:h.NUMBER,default:0}}});var rt,Er=_(()=>{O();rt=class{constructor(e){this.words=[],e&&this.splitIntoWords(e)}splitIntoWords(e){return this.words=e.match(/\S+/g)||[],[...this.words]}get(){return[...this.words]}getWord(e){return this.words[e]}set(e){return this.words=[...e],this}slice(e,t){return rt.fromWords(this.words.slice(e,t))}getLowerCase(){return this.words.map(e=>e.toLowerCase())}getUpperCase(){return this.words.map(e=>e.toUpperCase())}size(){return this.words.length}countNumberOfCharacters(){return this.words.reduce((e,t)=>e+t.length,0)}joined(e){let t=this.size(),i=Math.floor(t/e),r=t%e,o=0,n=0;return E.Array.range(0,e).map(a=>{o=n;let l=i+(a<r?1:0);return n=Math.min(o+l,t),E.Array.range(o,n).reduce((u,c)=>u+(c===o?"":" ")+this.words[c],"")})}static fromWords(e){let t=new rt;return t.words=[...e],t}}});var M1,B1,L1,qe,Yo=_(()=>{O();At();It();Kt();Ko();lv();Er();M1=10,B1=4,L1=.4,qe=class extends J{constructor(e){super(e);this._relativeInsets=new Q,this._background=null,this._fontRandomizer=new ne(0),this._lineNumberRandomizer=new ne(0),this._wordsPerLineRandomizer=new ne(0),this._seedPool=[this._fontRandomizer,this._lineNumberRandomizer,this._wordsPerLineRandomizer]}seed(e){this._seedPool.forEach(t=>t.seed(e))}getImagePaths(){return[]}onImagesLoaded(){}getMaximumNumberOfTries(){return M1}getMinLineCountOfRandom(){return B1}getRandomAdditionalLinePercentage(){return L1}_fontForRow(e,t){return this._fontRandomizer.pickNext(this.getFontIdentifiers())}_modifiedText(e){return e.replace(`
`," ").replace("	"," ")}_minimumNumberOfLines(e){return Math.ceil(Math.sqrt(e.size()))}_maximumNumberOfLines(e){return e.size()}_calculatedNumberOfLines(e){let t=this._minimumNumberOfLines(e);if(e.size()>=this.getMinLineCountOfRandom()){let i=Math.floor(Math.max(1,t*this.getRandomAdditionalLinePercentage()));t+=this._lineNumberRandomizer.nextInRange(0,i)}return Math.min(t,this._maximumNumberOfLines(e))}_randomizedNumberOfWordsPerLine(e,t){if(e>t)return B.warn("TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines"),t;let i=E.Array.repeat(1,e);return E.Array.range(e,t).forEach(r=>{let o=this._wordsPerLineRandomizer.nextInRange(0,e-1);i[o]+=1}),i}_textLines(e){let t=new rt(e),i=this._calculatedNumberOfLines(t);return this._randomizedNumberOfWordsPerLine(i,t.size()).reduce((o,n)=>({index:o.index+n,lines:[...o.lines,t.slice(o.index,Math.min(o.index+n,t.size()))]}),{index:0,lines:[]}).lines}_validTextLines(e){let t=this._textLines(e),i=0;do if(i=E.Array.findIndex(t,r=>r.countNumberOfCharacters()<3),i>=0){let r=t[i-1],o=t[i+1],n=r?r.countNumberOfCharacters():Number.MAX_SAFE_INTEGER,a=o?o.countNumberOfCharacters():Number.MAX_SAFE_INTEGER;n<a&&r?(r.words=[...r.words,...t[i].words],t=[...t.slice(0,i),...t.slice(i+1)]):o&&(o.words=[...t[i].words,...o.words],t=[...t.slice(0,i),...t.slice(i+1)])}while(i>-1&&t.length>1);return t}_modifiedLines(e){return e}_getBackground(){return this._background}generateLayoutData(e,t){let i=this._modifiedText(e),r=this._modifiedLines(this._validTextLines(i)),o=t*(1-this._relativeInsets.left-this._relativeInsets.right),n=this._layoutRows(r,o);return new Cu({text:i,relativeInsets:this._relativeInsets.clone(),relativeLineSpacing:this.getRelativeLineSpacing(),background:this._background||this._getBackground(),lines:r,rows:n,width:t})}_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new qt({fontIdentifier:this._fontForRow(r,i)})).layout())}_randomLayoutRow(e,t,i,r){return new Pe({words:e,width:i,attributes:r})}};P(qe,"defaultFontIdentifiers",[]),P(qe,"identifier","textdesign");qe.prototype.availableOptions={fontIdentifiers:{type:h.ARRAY,default:[]},relativeLineSpacing:{type:h.NUMBER,default:0}}});var Ze,Jo=_(()=>{O();At();ov();Kt();vu();Ko();wu();Ht();Yo();Ze=class extends qe{constructor(...e){super(...e);P(this,"getImagePaths",()=>{let e=this.getBanderoles();return e&&e.map(t=>t.getImagePath())||[]});P(this,"onImagesLoaded",()=>{let e=this.getBanderoles();e&&e.forEach(t=>{let i=ge.getImage(t.getImagePath());if(!i){B.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})});this._rowTypeLessThan3WordsRandomizer=new ne(0),this._rowTypeMoreThan3WordsRandomizer=new ne(0),this._banderolesRandomizer=new ne(0),this._seedPool=[...this._seedPool,this._rowTypeLessThan3WordsRandomizer,this._rowTypeMoreThan3WordsRandomizer,this._banderolesRandomizer]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}generateLayoutData(e,t){return this._options.hasMaskedText=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){if(e.size()<3){let n=this._rowTypeLessThan3WordsRandomizer.nextInRange(0,2)===0;return this._layoutRow(e,i,r,n)}let o=this._rowTypeMoreThan3WordsRandomizer.nextInRange(0,3);switch(o){case 0:return new si({words:e,width:i,attributes:r,orientation:si.Orientations.Left});case 1:return new si({words:e,width:i,attributes:r,orientation:si.Orientations.Right});case 2:return this._layoutRow(e,i,r,!0);case 3:return new Pe({words:e,width:i,attributes:r});default:throw new Error(`TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ${o}.`)}}_layoutRow(e,t,i,r){if(this.getHasMaskedText()&&(r=!1),r){this.setHasMaskedText(!0);let o=this._banderolesRandomizer.pickNext(this.getBanderoles()),n=new Ji({words:e,width:t,attributes:new qt({alignment:"left",fontIdentifier:o.getFontIdentifier()}),image:o.getImage(),imageInsets:o.insetsForWidth(t),capInsets:null,backgroundColor:S.WHITE});return o.getNeedsImageSmoothingFix()&&(n.serverImageSmoothingFix=!0),n}return new Pe({words:e,width:t,attributes:i})}};P(Ze,"defaultFontIdentifiers",["imgly_font_campton_bold"]),P(Ze,"identifier","imgly_text_design_blocks"),P(Ze,"defaultBanderoles",[Pt.Rectangle,Pt.Small]);Ze.prototype.availableOptions=N(D({},qe.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:Ze.defaultFontIdentifiers},relativeLineSpacing:{type:h.NUMBER,default:.025/3},hasMaskedText:{type:h.BOOLEAN,default:!1},banderoles:{type:h.ARRAY,default:Ze.defaultBanderoles}})});var _s,uv=_(()=>{O();Kt();Jo();_s=class extends Ze{constructor(...e){super(...e);this._exclusiveFont=null}generateLayoutData(e,t){return this._exclusiveFont=this._fontRandomizer.pickNext(this.getFontIdentifiers()),super.generateLayoutData(e,t)}_fontForRow(e,t){return this._exclusiveFont||super._fontForRow(e,t)}_layoutRow(e,t,i,r){return new Pe({words:e,width:t,attributes:i})}};P(_s,"defaultFontIdentifiers",["imgly_font_ostrich_sans_heavy","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_black"]),P(_s,"identifier","imgly_text_design_blocks_condensed");_s.prototype.availableOptions=N(D({},Ze.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:_s.defaultFontIdentifiers}})});var _a,Fr,Rt,Uh=_(()=>{O();Rr();xi();gs();fa();({Rectangle:_a}=L),Fr=class extends Tt{constructor(...e){super(...e);this.setSize(new Se(this.getWidth(),this.getHeight()))}_calculateLayoutElements(){return[new _t({frame:this._getTextFrame()})]}render(e){let t=this._getFrame(),i=this.getType(),o=this.getAttributes().getTextColor(),n=t.height/3,a=new _a(t.x,t.y,t.width,n),l=new _a(t.x,t.y+n*2,t.width,n);switch(i){case Fr.FormType.Rect:Xt(e,t,o);break;case Fr.FormType.DoubleRect:Xt(e,a,o),Xt(e,l,o);break;case Fr.FormType.DoubleRectFirstPunctuated:Nh(e,a,o),Xt(e,l,o);break;case Fr.FormType.DoubleRectSecondPunctuated:Xt(e,a,o),Nh(e,l,o);break;case Fr.FormType.LongLine:{let u=t.height/2,c=new _a(t.x,t.y,t.width,u);xu(e,c,c.height*.5,o);break}case Fr.FormType.LongAndShortLine:{let u=t.height*.2,c=u*.75;a=new _a(t.x,t.y+u,t.width,u);let p=t.x+t.width*.25,m=t.y+t.height-c;l=new _a(p,m,t.width*.5,c),xu(e,a,a.height*.5,o),xu(e,l,l.height*.5,o);break}default:break}}},Rt=Fr;P(Rt,"FormType",{Rect:"RECT",DoubleRect:"DOUBLE_RECT",DoubleRectFirstPunctuated:"DOUBLE_RECT_FIRST_PUNCTUATED",DoubleRectSecondPunctuated:"DOUBLE_RECT_SECOND_PUNCTUATED",LongLine:"LONG_LINE",LongAndShortLine:"LONG_AND_SHORT_LINE"});Rt.prototype.availableOptions=N(D({},Tt.prototype.availableOptions),{height:{type:h.NUMBER,default:100},type:{type:h.STRING,default:Rt.FormType.Rect,available:E.values(Rt.FormType)}})});var vi,Gh=_(()=>{O();Kt();Uh();Jo();vi=class extends Ze{_layoutRow(e,t,i,r){return new Pe({words:e,width:t,attributes:i})}_layoutRows(e,t){let i=super._layoutRows(e,t),r=.032*t,o=.08*t,n=new Rt({width:t,height:r,type:Rt.FormType.LongLine,shearingAngle:0}).layout(),a=new Rt({width:t,height:o,type:Rt.FormType.LongAndShortLine,shearingAngle:0}).layout();return[n,...i,a]}};P(vi,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),P(vi,"identifier","imgly_text_design_blocks_light");vi.prototype.availableOptions=N(D({},Ze.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:vi.defaultFontIdentifiers}})});var ys,cv=_(()=>{O();Kt();Ko();Gh();ys=class extends vi{_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new qt({fontIdentifier:this._fontForRow(r,i)})).layout())}_layoutRow(e,t,i,r){return new Pe({words:e,width:t,attributes:i})}};P(ys,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),P(ys,"identifier","imgly_text_design_blocks_light-v3_1_0");ys.prototype.availableOptions=N(D({},vi.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:ys.defaultFontIdentifiers}})});var z1,Du,wi,ku=_(()=>{O();qo();Rr();xi();gs();Kt();({Rectangle:z1}=L),Du=class extends Pe{getImageSize(){let e=this.getLeftImage(),t=this.getRightImage(),i=this.getWords(),o=this.getAttributes().getFontIdentifier(),n=e?new Se(e.width,e.height):new Se,a=i.joined(1)[0];if(!a)return n;let u=new gt({text:a,fontIdentifier:o,fontSize:50}).getSizeValue(),c=t?2:1;n.scale(c,1);let p=n.clone().fitInWidthWithOther(this._getFrame().width,u);return p.scale(1/c,1),p}_getTextFrame(){let e=super._getTextFrame().clone(),t=this.getImageSize(),i=this.getRightImage(),r=this.getImagePosition();return i?(e.x+=t.width,e.width-=2*t.width):r===Du.ImagePosition.Left&&(e.x+=t.width),e}_calculateLayoutElements(){let e=super._calculateLayoutElements(),t=this._getFrame(),i=this.getRightImage(),r=this.getImageSize(),o=this.getImagePosition(),n=this._getTextFrame(),l=this.getAttributes().getFontIdentifier(),u=new gt({text:"stickerClock",fontIdentifier:l});u.fitWidth(this._getTextFrame().width);let c=new z1().set(t.x,t.y,r.width,r.height);if(!i&&o===Du.ImagePosition.Right&&(c.x+=n.width),e.push(new _t({text:"stickerClock",frame:c,font:u})),i){let p=e[0];if(p){let m=c.clone();m.translate(p.getFrame().width+m.width,0),e.push(new _t({text:"stickerClock",frame:m,font:u}))}}return e}render(e){let t=this._getLayoutElements(),i=this.getAttributes(),r=i.getTextColor(),o=this.getLeftImage(),n=this.getRightImage(),a=t[0],l=t[1],{font:u}=a.serializeOptions(),c=this._getTextFrameForElement(a);if(u.draw(e,c.x,c.y,{textColor:i.getTextColor().toRGBA(),alignment:i.getAlignment()}),o){let p=l.getFrame();e.drawImage(o,p.x,p.y,p.width,p.height),Xt(e,p,r,"source-atop")}if(t.length>2){let m=t[2].getFrame().clone();e.drawImage(n,m.x,m.y,m.width,m.height),Xt(e,m,r,"source-atop")}}},wi=Du;P(wi,"ImagePosition",{Left:"LEFT",right:"RIGHT"});wi.prototype.availableOptions=N(D({},Pe.prototype.availableOptions),{leftImage:{type:h.IMAGE,default:null},rightImage:{type:h.IMAGE,default:null},imagePosition:{type:h.STRING,default:wi.ImagePosition.Left,available:[wi.ImagePosition.Left,wi.ImagePosition.Right]}})});var ya,Mt,Wh=_(()=>{O();Kt();ku();wu();Er();Jo();ya=class extends Ze{_fontForRow(e,t){let i=this.getFontIdentifiers();return i[e%i.length]}_minimumNumberOfLines(e){return Math.max(Math.floor(super._minimumNumberOfLines(e)*.7),1)}_maximumNumberOfLines(e){return Math.max(Math.floor(e.countNumberOfCharacters()/5),1)}_randomLayoutRow(e,t,i,r){return this._createSingleRow(ya.RowType.Single,e,i,r)}_createSingleRow(e,t,i,r){let o=r.getFontIdentifier(),n=o==="imgly_font_amberlight"||o==="imgly_font_handycheera_regular"?new rt().set(t.getLowerCase()):t;switch(e){case ya.RowType.Single:return new Pe({words:n,width:i,attributes:r});case ya.RowType.SingleImage:return new wi({words:n,width:i,attributes:r});default:return B.warn(`TextDesignCelebrate#_createSingleRow: Invalid row type '${e}'`),null}}},Mt=ya;P(Mt,"defaultFontIdentifiers",["imgly_font_handycheera_regular","imgly_font_rasa_regular"]),P(Mt,"defaultBanderoles",[Pt.Celebrate1,Pt.Celebrate2]),P(Mt,"identifier","imgly_text_design_celebrate"),P(Mt,"RowType",{Single:"SINGLE",SingleImage:"SINGLE_IMAGE"});Mt.prototype.availableOptions=N(D({},Ze.prototype.availableOptions),{relativeLineSpacing:{type:h.NUMBER,default:.01875},fontIdentifiers:{type:h.ARRAY,default:Mt.defaultFontIdentifiers},banderoles:{type:h.ARRAY,default:Mt.defaultBanderoles}})});var Ke,Tu=_(()=>{O();qo();Er();Rr();xi();Ko();gs();fa();Ke=class extends Tt{constructor(...e){super(...e);this.setSize(new Se(this.getWidth(),this.getHeight()))}_getImageFrame(){let e=this._getTextFrame().clone(),t=this.getImage();if(this.getDrawingModeAspectFit()&&t){let i=Math.min(e.width/t.width,e.height/t.height),r=t.width*i,o=t.height*i;e.x+=(e.width-r)/2,e.y+=(e.height-o)/2,e.width=r,e.height=o}return e}_calculateLayoutElements(){return[new _t({text:"",frame:this._getImageFrame(),font:new gt})]}render(e){let t=this.getImage(),i=this._getImageFrame(),o=this.getAttributes().getTextColor();Yi(e,t,i,o)}};P(Ke,"RowImages",{decorative1:"text-design/images/imgly_text_design_asset_decorative_01.png",decorative2:"text-design/images/imgly_text_design_asset_decorative_02.png",decorative3:"text-design/images/imgly_text_design_asset_decorative_05.png",decorative4:"text-design/images/imgly_text_design_asset_decorative_06.png",celebrate1:"text-design/images/imgly_text_design_asset_celebrate_03.png",celebrate2:"text-design/images/imgly_text_design_asset_celebrate_04.png",celebrate3:"text-design/images/imgly_text_design_asset_celebrate_05.png"});Ke.prototype.availableOptions=N(D({},Tt.prototype.availableOptions),{words:{type:h.OBJECT,default:new rt},height:{type:h.NUMBER,default:0},image:{type:h.IMAGE,default:null},imagePath:{type:h.STRING,default:Ke.RowImages.decorative1},drawingModeAspectFit:{type:h.BOOLEAN,default:!1},attributes:{type:h.CONFIGURABLE,default:new qt}})});var bs,mv=_(()=>{O();At();Kt();ku();Tu();wu();Ht();Er();Jo();Wh();bs=class extends Mt{constructor(...e){super(...e);P(this,"getImagePaths",()=>{let e=this.getBanderoles();return[...e&&e.map(t=>t.getImagePath())||[],...this._celebrateTypes]});P(this,"onImagesLoaded",()=>{let e=this.getBanderoles();e&&e.forEach(t=>{let i=ge.getImage(t.getImagePath());if(!i){B.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})});this._celebrateTypes=[Ke.RowImages.celebrate1,Ke.RowImages.celebrate2,Ke.RowImages.celebrate3],this._exclusiveFont=null,this._typeRandomizer=new ne(0),this._useMaskedRandomizer=new ne(0),this._seedPool.push(this._typeRandomizer),this._seedPool.push(this._useMaskedRandomizer)}_fontForRow(e,t){let i=this.getFontIdentifiers();return i[e%(i.length-1)]}_layoutRows(e,t){let i=this._typeRandomizer.pickNext(this._celebrateTypes),r=ge.getImage(i);r||B.warn(`TextDesignCelebrateSimple#_layoutRows: Image not fount '${i}'`);let o=new Ke({width:t,height:t*.5,drawingModeAspectFit:!0,image:r}).layout(),n=super._layoutRows(e,t);return[o,...n]}_randomLayoutRow(e,t,i,r){let o=e.countNumberOfCharacters(),n=13;o<4&&r.setFontIdentifier("imgly_font_rasa_regular");let l=this._useMaskedRandomizer.nextBool(2,1);return o<n&&l&&!this.getHasMaskedText()?this._layoutRow(e,i,r,!0):super._randomLayoutRow(e,t,i,r)}};P(bs,"identifier","imgly_text_design_celebrate_simple"),P(bs,"defaultFontIdentifiers",["imgly_font_amberlight","imgly_font_rasa_regular","imgly_font_rasa_500"]);bs.prototype.availableOptions=N(D({},Mt.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:bs.defaultFontIdentifiers}})});var xs,Vh=_(()=>{O();xs=class extends J{render(e,t,i,r,o){B.warn("TextDesignBackground#render: Abstract class")}};xs.prototype.availableOptions={}});var Ru,Ci,dv=_(()=>{O();Ht();Rr();Vh();({Rectangle:Ru}=L),Ci=class extends xs{getImagePaths(){let{topImagePath:e,bottomImagePath:t,leftImagePath:i,rightImagePath:r}=this._options;return[e,t,i,r].filter(o=>o!=="")}render(e,t,i,r,o){let n=i.clone().scale(t.width),a=t.rectangle(0,0),l=ge.getImage(this.getTopImagePath()),u=ge.getImage(this.getLeftImagePath()),c=ge.getImage(this.getRightImagePath()),p=ge.getImage(this.getBottomImagePath());if(l){let m=l.width/l.height,d=n.top*this.getTopImageFillRate(),f=d*m,y=a.width/2-f/2,g=new Ru(y,0,f,d);Yi(e,l,g,r)}if(p){let m=p.width/p.height,d=n.bottom*this.getBottomImageFillRate(),f=d*m,y=a.width/2-f/2,g=new Ru(y,a.height-d,f,d);Yi(e,p,g,r)}if(u){let m=u.width/u.height,d=n.left*this.getLeftImageFillRate(),f=d/m,y=a.height/2-f/2,g=new Ru(0,y,d,f);Yi(e,u,g,r)}if(c){let m=c.width/c.height,d=n.right*this.getRightImageFillRate(),f=d/m,y=a.height/2-f/2,g=new Ru(a.width-d,y,d,f);Yi(e,c,g,r)}}};Ci.prototype.availableOptions={topImagePath:{type:h.STRING,default:""},leftImagePath:{type:h.STRING,default:""},bottomImagePath:{type:h.STRING,default:""},rightImagePath:{type:h.STRING,default:""},topImageFillRate:{type:h.NUMBER,default:1},leftImageFillRate:{type:h.NUMBER,default:1},bottomImageFillRate:{type:h.NUMBER,default:1},rightImageFillRate:{type:h.NUMBER,default:1}};Ci.Backgrounds=[new Ci({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png",topImageFillRate:.8,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.8}),new Ci({leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png",leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6}),new Ci({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png",topImageFillRate:.6,bottomImageFillRate:.6}),new Ci({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png",topImageFillRate:.1,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6})]});var Di,jh=_(()=>{O();dv();At();It();Kt();Er();Yo();Di=class extends qe{constructor(...e){super(...e);this._relativeInsets=new Q(.1,.1,.1,.1),this._alreadyContainsARowWithScriptFont=!1,this._backgroundsRandomizer=new ne(0),this._seedPool.push(this._backgroundsRandomizer)}getImagePaths(){return E.Array.flatten(Ci.Backgrounds.map(e=>e.getImagePaths()))}_getBackground(){return this._backgroundsRandomizer.pickNext(Ci.Backgrounds)}generateLayoutData(e,t){return this._alreadyContainsARowWithScriptFont=!1,this._background=this._getBackground(),super.generateLayoutData(e,t)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_fontForRow(e,t){let i=super._fontForRow(e,t);return i==="imgly_font_petit_formal_script"&&(this._alreadyContainsARowWithScriptFont&&(i="imgly_font_bungee_inline"),this._alreadyContainsARowWithScriptFont=!0),i}_randomLayoutRow(e,t,i,r){let o=r.getFontIdentifier()==="imgly_font_petit_formal_script";return new Pe({words:o?new rt().set(e.getLowerCase()):e,width:i,attributes:r})}};P(Di,"identifier","imgly_text_design_equal_width"),P(Di,"defaultFontIdentifiers",["imgly_font_ultra","imgly_font_bungee_inline","imgly_font_petit_formal_script"]);Di.prototype.availableOptions=N(D({},qe.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:Di.defaultFontIdentifiers},relativeLineSpacing:{type:h.NUMBER,default:.025}})});var vs,hv=_(()=>{O();It();jh();vs=class extends Di{constructor(...e){super(...e);this._relativeInsets=new Q}_getBackground(){return null}};P(vs,"defaultFontIdentifiers",["imgly_font_ultra"]),P(vs,"identifier","imgly_text_design_equal_width_fat");vs.prototype.availableOptions=N(D({},Di.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:vs.defaultFontIdentifiers}})});var $,$o=_(()=>{O();It();$=class extends J{insetsForWidth(e){return this.getRelativeInsets().clone().scale(e)}};$.prototype.availableOptions={imagePath:{type:h.STRING,default:""},minimumHeightRatio:{type:h.NUMBER,default:0},sizeToFitContent:{type:h.BOOLEAN,default:!0},capInsets:{type:h.OBJECT,default:new Q},relativeInsets:{type:h.OBJECT,default:new Q}};$.Box=new $({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",relativeInsets:new Q(.1,.1,.1,.1)});$.Badge1=new $({imagePath:"text-design/images/imgly_text_design_asset_badge1.png",relativeInsets:new Q(.3,.18,.2,.18)});$.Badge2=new $({imagePath:"text-design/images/imgly_text_design_asset_badge2.png",relativeInsets:new Q(.3,.18,.2,.18)});$.Badge3=new $({imagePath:"text-design/images/imgly_text_design_asset_badge3.png",relativeInsets:new Q(.3,.18,.2,.18)});$.Badge4=new $({imagePath:"text-design/images/imgly_text_design_asset_badge4.png",relativeInsets:new Q(.3,.18,.2,.18)});$.SpeechBubble1=new $({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small2.png",relativeInsets:new Q(.04,.07,.12,.07),capInsets:new Q(19*3,57*3,41*3,17*3)});$.SpeechBubble2=new $({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble3.png",relativeInsets:new Q(.04,.07,.12,.07),capInsets:new Q(2*3,35*3,29*3,5*3)});$.SpeechBubble3=new $({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small.png",relativeInsets:new Q(.165664675,.2,.165664675,.2),minimumHeightRatio:.7});$.SpeechBubble4=new $({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble4.png",relativeInsets:new Q(.124800224,.2,.291200523,.2),minimumHeightRatio:.7});$.SpeechBubble5=new $({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble5.png",relativeInsets:new Q(.114892823,.27,.15984926,.27)});$.Watercolor1=new $({imagePath:"text-design/images/imgly_text_design_asset_watercolor_01.png",minimumHeightRatio:.7,relativeInsets:new Q(.2,.25,.2,.25)});$.Watercolor2=new $({imagePath:"text-design/images/imgly_text_design_asset_watercolor_02.png",minimumHeightRatio:.7,relativeInsets:new Q(.08,.25,.3,.25)});$.Watercolor3=new $({imagePath:"text-design/images/imgly_text_design_asset_watercolor_03.png",minimumHeightRatio:.7,relativeInsets:new Q(.1,.2,.15,.2)})});var pv=De(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});Eu.arabic=void 0;var N1="\u0620-\u064A\u066E-\u066F\u0671-\u06D5\u06EE-\u06EF\u06FA-\u06FF",U1="\u0750-\u077F",G1="[".concat(N1).concat(U1,"]"),W1="[\u064B-\u065F\u0670]",V1="".concat(G1).concat(W1,"*");Eu.arabic=V1});var gv=De(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.bengali=void 0;var fv="[\\u{0980}-\\u{09FF}]",j1="[\\u{0980}-\\u{0983}\\u{09BC}-\\u{09D7}\\u{09E2}\\u{09E3}\\u{09FE}]",H1="\\u{09CD}",q1="".concat(fv,"(").concat(H1).concat(fv,"|").concat(j1,")*");Fu.bengali=q1});var yv=De(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.devanagari=void 0;var _v="[\\u{0900}-\\u{097F}]",K1="[\\u{0900}-\\u{0903}\\u{093A}-\\u{0957}\\u{0962}\\u{0963}]",X1="\\u{094D}",Y1="".concat(_v,"(").concat(X1).concat(_v,"|").concat(K1,")*");Su.devanagari=Y1});var xv=De(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.gujarati=void 0;var bv="[\\u{0A80}-\\u{0AFF}]",J1="[\\u{0A81}-\\u{0A83}\\u{0ABC}\\u{0ABE}-\\u{0ACD}\\u{0AE2}\\u{0AE3}\\u{0AFA}-\\u{0AFF}]",$1="\\u{0ACD}",Z1="".concat(bv,"(").concat($1).concat(bv,"|").concat(J1,")*");Ou.gujarati=Z1});var vv=De(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});Au.hebrew=void 0;var Q1="[\u05D0-\u05EA]",e2="[\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7]",t2="".concat(Q1).concat(e2,"*");Au.hebrew=t2});var wv=De(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.japaneseKana=void 0;var i2="[\\u{3041}-\\u{3096}\\u{309D}-\\u{309F}]",r2="[\\u{30A0}-\\u{30FF}]",s2="[\\u{3099}-\\u{309A}]",o2="[\\u{309B}-\\u{309C}]",n2="((".concat(r2,"|").concat(i2,")").concat(s2,"?|").concat(o2,")");Iu.japaneseKana=n2});var Dv=De(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.kannada=void 0;var Cv="[\\u{0C80}-\\u{0CFF}]",a2="[\\u{0C81}-\\u{0C83}\\u{0CBC}\\u{0CBE}-\\u{0CCD}\\u{0CD5}\\u{0CD6}\\u{0CE2}\\u{0CE3}]",l2="\\u{0CCD}",u2="".concat(Cv,"(").concat(l2).concat(Cv,"|").concat(a2,")*");Pu.kannada=u2});var Tv=De(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.khmer=void 0;var kv="[\\u{1780}-\\u{17FF}]",c2="[\\u{17B6}-\\u{17D1}\\u{17D3}\\u{17DD}]",m2="\\u{17D2}",d2="".concat(kv,"(").concat(m2).concat(kv,"|").concat(c2,")*");Mu.khmer=d2});var Rv=De(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.lao=void 0;var h2="[\\u{0E80}-\\u{0EFF}]",p2="[\\u{0EB1}\\u{0EB4}-\\u{0EBC}\\u{0EC8}-\\u{0ECD}]",f2="".concat(h2).concat(p2,"*");Bu.lao=f2});var Fv=De(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.malayalam=void 0;var Ev="[\\u{0D00}-\\u{0D7F}]",g2="[\\u{0D00}-\\u{0D03}\\u{0D3B}\\u{0D3C}\\u{0D3E}-\\u{0D4D}\\u{0D57}\\u{0D62}-\\u{0D63}]",_2="\\u{0D4D}",y2="".concat(Ev,"(").concat(_2).concat(Ev,"|").concat(g2,")*");Lu.malayalam=y2});var Ov=De(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.myanmar=void 0;var Sv="[\\u{1000}-\\u{109F}]",b2=["\\u{102B}-\\u{1038}","\\u{103A}-\\u{103E}","\\u{1056}-\\u{1059}","\\u{105E}-\\u{1060}","\\u{1062}-\\u{1064}","\\u{1067}-\\u{106D}","\\u{1071}-\\u{1074}","\\u{1082}-\\u{108D}","\\u{108F}","\\u{109A}-\\u{109D}"],x2="[".concat(b2.join(""),"]"),v2="\\u{1039}",w2="".concat(Sv,"(").concat(v2).concat(Sv,"|").concat(x2,")*");zu.myanmar=w2});var Av=De(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.tamil=void 0;var C2="[\\u{0B80}-\\u{0BFF}]",D2="[\\u{0B82}-\\u{0B83}\\u{0BBE}-\\u{0BD7}\\u{0962}\\u{0963}]",k2="".concat(C2).concat(D2,"*");Nu.tamil=k2});var Pv=De(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.telugu=void 0;var Iv="[\\u{0C00}-\\u{0C7F}]",T2="[\\u{0C00}-\\u{0C04}\\u{0C3E}-\\u{0C56}\\u{0C62}\\u{0C63}]",R2="\\u{0C4D}",E2="".concat(Iv,"(").concat(R2).concat(Iv,"|").concat(T2,")*");Uu.telugu=E2});var Mv=De(Gu=>{"use strict";Object.defineProperty(Gu,"__esModule",{value:!0});Gu.thai=void 0;var F2="[\\u0E00-\\u0E7F]",S2="[\\u0E31\\u0E33-\\u0E3A\\u0E47-\\u0E4E]",O2="".concat(F2).concat(S2,"*");Gu.thai=O2});var Bv=De(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.tibetan=void 0;var A2="[\\u{0F00}-\\u{0FFF}]",I2="[\\0F18\\0F19\\0F35\\0F37\\0F39\\0F3E\\0F3F\\u{0F71}-\\u{0F87}\\u{0F8D}-\\u{0FBC}\\u{0FC6}]",P2="".concat(A2).concat(I2,"*");Wu.tibetan=P2});var zv=De(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.emojiVariation=Sr.keyCap=Sr.countryFlag=void 0;var M2="[\\u{1F1E6}-\\u{1F1FF}]{2}";Sr.countryFlag=M2;var B2="[0-9#\\*][\\u{FE0F}]?\\u{20E3}";Sr.keyCap=B2;var L2=["[\\u{2600}-\\u{26FF}]","[\\u{2700}-\\u{27BF}]","[\\u{1F300}-\\u{1F5FF}]","[\\u{1F600}-\\u{1F64F}]","[\\u{1F680}-\\u{1F6FF}]","[\\u{1F700}-\\u{1F77F}]","[\\u{1F900}-\\u{1F9FF}]"],Lv="(".concat(L2.join("|"),")"),z2="\\u{200D}",N2="[\\u{FE0E}\\u{FE0F}]",U2="[\\u{1F3FB}-\\u{1F3FF}]",G2="".concat(Lv,"(").concat(z2).concat(Lv,"|").concat(U2,"|").concat(N2,")*");Sr.emojiVariation=G2});var Uv=De((aH,Nv)=>{"use strict";var W2=pv(),V2=gv(),j2=yv(),H2=xv(),q2=vv(),K2=wv(),X2=Dv(),Y2=Tv(),J2=Rv(),$2=Fv(),Z2=Ov(),Q2=Av(),eF=Pv(),tF=Mv(),iF=Bv(),Hh=zv(),rF=[Hh.countryFlag,Hh.keyCap,Hh.emojiVariation,W2.arabic,V2.bengali,j2.devanagari,H2.gujarati,q2.hebrew,K2.japaneseKana,X2.kannada,Y2.khmer,J2.lao,$2.malayalam,Z2.myanmar,Q2.tamil,eF.telugu,tF.thai,iF.tibetan,"."],sF=new RegExp("(".concat(rF.join("|"),")"),"gu");function oF(s){return s.match(sF)||[]}Nv.exports={splitGraphemes:oF}});var Gv,Wv,Vu,qh=_(()=>{Gv=Ur(Uv()),Wv=class{constructor(e){this._context=e,this._lastFontStyle={}}getLines(){let e=[],t=[],i=this._lines.length;for(let r=0;r<i;r++){let o=this._lines[r],n=this._buildWords(o),a=n.length;for(let l=0;l<a;l++){let u=n[l],c=t.concat(u).join("").replace(/\s+$/i,"");if(this._getWidth(c)>this._maxWidth){t.length>0&&(e.push(t.join("")),t=[u]);let m=u.replace(/\s+$/i,"");if(this._getWidth(m)>this._maxWidth){let d=this._splitWord(u);e=e.concat(d.lines),d.rest&&(t=[d.rest])}}else t.push(u)}e.push(t.join("")),t=[]}return e.map(r=>this._trimLine(r,this._context.textAlign))}_trimLine(e,t){return e}_buildWords(e){let t=[],i="",r=e.length;for(let o=0;o<r;o++){let n=e[o];i+=n,(n===" "||n==="-"||o===r-1)&&(t.push(i),i="")}return t}_splitWord(e){let t={lines:[],rest:null},i=(0,Gv.splitGraphemes)(e),r=i.length,o=[];for(let n=0;n<r;n++){let a=i[n];this._getWidth(o.concat(a).join(""))>this._maxWidth?(o.length>0&&t.lines.push(o.join("")),o=[a]):o.push(a),n===r-1&&o.length>0&&(t.rest=o.join(""))}return t}_fontStyleChanged(){return this._context.font!==this._lastFontStyle?(this._lastFontStyle=this._context.font,!0):!1}_getWidth(e){return this._context.measureText(e).width}setText(e){this._text=e,this._lines=e.split(`
`)}setMaxWidth(e){this._maxWidth=e}},Vu=Wv});var Kh,Vv,jv,Xh=_(()=>{O();qh();({Vector2:Kh}=L),Vv=class{constructor(e,t){this._text=e,this._operation=t,this._textOptions={},this.rotation=0,this._createCanvas(),this._createTexture()}_createCanvas(){this._canvas=E.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new Vu(this._context),this._finalCanvas=E.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d")}_createTexture(){this._texture=R.Texture.fromCanvas(this._canvas),this._finalTexture=R.Texture.fromCanvas(this._finalCanvas)}_applyTextOptions(e,t){t.font=`${this._text.getFontStyle()} ${this._text.getFontWeight()} ${e.fontSize}px "${this._text.getFontFamily()}"`,this._text.getTextMetrics()?t.textBaseline="alphabetic":t.textBaseline="top",t.textAlign=this._text.getAlignment(),t.fillStyle=this._text.getColor().toRGBA(),t.strokeStyle=this._text.getOutlineColor().toRGBA();let i=this._text.getOutlineWidth();i>0&&(t.lineWidth=i)}_buildOutputLines(e){return this._textSplitter.setText(this._text.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines().map(t=>t.replace(/\s+$/i,""))}_renderTextLine(e,t,i){let r=this._text.getAlignment(),o=new Kh(0,t);switch(r){case"left":o.x=i;break;case"center":o.x=this._canvas.width/2;break;case"right":o.x=this._canvas.width-i;break}this._context.save(),this._context.translate(o.x,o.y),this._context.fillText(e,0,0),this._context.restore(),this._text.getOutlineWidth()>0&&(this._context.miterLimit=2,this._context.strokeText(e,o.x,o.y))}update(e,t){let i=this.calculateFontStyles(e,t);if(i){let{dimensions:r,lines:o}=this._calculateText(e,i,t);this._renderText(e,r,o,i,t),this._updateFinalTexture()}}_updateFinalTexture(){let{width:e,height:t}=this._canvas,{rotation:i}=this,r=Math.cos(i),o=Math.sin(i),n=new Kh(Math.abs(e*r)+Math.abs(t*o),Math.abs(e*o)+Math.abs(t*r));this._finalCanvas.width=n.x,this._finalCanvas.height=n.y,this._finalContext.save(),this._finalContext.translate(this._finalCanvas.width/2,this._finalCanvas.height/2),this._finalContext.rotate(i),this._finalContext.drawImage(this._canvas,-e/2,-t/2),this._finalContext.restore()}_renderText(e,t,i,r,o){this._canvas.width=t.x,this._canvas.height=t.y,this._text.getMaxHeight()&&(this._canvas.height=Math.min(this._text.getMaxHeight()*o.y,this._canvas.height)),this._context=this._canvas.getContext("2d"),this._context.fillStyle=this._text.getBackgroundColor().toRGBA(),this._context.fillRect(0,0,t.x,t.y),this._applyTextOptions(r,this._context);let n=this._padding(o),a=this._text.getTextMetrics(),l=this._text.getFontSize()*o.y,u=1/a.unitsPerEm*l,c=a.ascender*u;for(let p=0;p<i.length;p++){let m=i[p];this._renderTextLine(m,r.topPadding+r.lineHeight*p+n+c,n)}}calculateFontStyles(e,t){let i=this._text.getFontFamily(),r=this._text.getFontSize()*t.y,o=this._text.getAbsoluteTextHeight(t),n=o*this._text.getLineHeight(),a=o*(this._text.getLineHeight()-1)/2,l={fontFamily:i,fontSize:r,lineHeight:n,topPadding:a};return(this._textOptions.fontFamily!==i||this._textOptions.fontSize!==r||this._textOptions.lineHeight!==n)&&(this._textOptions=l),l}_calculateText(e,t,i){let r=this._text.getMaxWidth()*i.x;this._applyTextOptions(t,this._context);let o=new Kh,n=this._text.getText().split(`
`);typeof r!="undefined"&&(o.x=r,n=this._buildOutputLines(r));for(let u=0;u<n.length;u++){let c=n[u];o.x=Math.max(o.x,this._context.measureText(c).width)}let{lineHeight:a}=t;o.y=n.length*a;let l=this._padding(i);return o.y+=l*2,o.x+=l*2,{dimensions:o,lines:n}}_padding(e){return this._text.getAbsoluteTextHeight(e)*.2}getTexture(){return this._texture}getFinalTexture(){return this._finalTexture}getDimensions(e,t){let i=this.calculateFontStyles(e,t),{dimensions:r}=this._calculateText(e,i,t);return r}dispose(){this._measurementElement&&document.body.removeChild(this._measurementElement),this._texture&&(this._texture.dispose(),this._texture=null),this._finalTexture&&(this._finalTexture.dispose(),this._finalTexture=null)}},jv=Vv});var Hv,ba,qv=_(()=>{O();qh();xi();Ht();({Vector2:Hv}=L),ba=class extends J{constructor(e){super(e);this._textOptions={},this._createCanvas()}_createCanvas(){this._canvas=E.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new Vu(this._context),this._finalCanvas=E.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d"),this.updateFontVariation()}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){let e=ge.getVariation(this.getFontIdentifier());return e||B.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}_applyTextOptions(e={},t=this._context){let{fontSize:i,fontVariation:r,lineHeight:o,textColor:n,alignment:a}=D(D({},this._options),e),{fontStyle:l,fontWeight:u,fontFamily:c}=r.serializeOptions();t.font=`${l} ${u} ${i}px "${c}"`,t.fillStyle=n,t.textBaseline="top",t.textAlign=a||"left"}_buildOutputLines(e){return this._textSplitter.setText(this.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines()}_renderTextLine(e,t){let i=this.getAlignment(),r=new Hv(0,t);switch(i){case"center":r.x=this._canvas.width/2;break;case"right":r.x=this._canvas.width;break}this._context.fillText(e,r.x,r.y)}update(){let e=this.calculateFontStyles();if(e){let{dimensions:t,lines:i}=this._calculateText(e);this._dimensions=t,this._renderText(t,i,e)}}draw(e,t=0,i=0){this.update(),e.drawImage(this._canvas,t,i,this._dimensions.x,this._dimensions.y)}_renderText(e,t,i){this._canvas.width=e.x,this._canvas.height=e.y,this._context=this._canvas.getContext("2d"),this._applyTextOptions(i,this._context);for(let r=0;r<t.length;r++){let o=t[r];this._renderTextLine(o,i.topPadding+i.lineHeight*r)}}getFontFamily(){return this.getFontVariation().getFontFamily()}calculateFontStyles(){let e=this.getFontFamily(),t=this.getFontSize(),i=this.getAbsoluteTextHeight(),r=i*this.getLineHeight(),o=i*(this.getLineHeight()-1)/2,n={fontFamily:e,fontSize:t,textHeight:i,lineHeight:r,topPadding:o};return this._textOptions=D({},n),n}getTextMetrics(){return this.getFontVariation().getTextMetrics()}getAbsoluteTextHeight(){let e=this.getFontSize(),t=this.getTextMetrics();if(t){let i=1/t.unitsPerEm*e,r=t.ascender*i,o=t.descender*i;return r+Math.abs(o)}return e*this.getLineHeight()*1.1}_calculateText(e){this._applyTextOptions(e,this._context);let t=new Hv,i=this.getText().split(`
`),r;if(typeof r!="undefined")t.x=r,i=this._buildOutputLines(r);else for(let n=0;n<i.length;n++){let a=i[n];t.x=Math.max(t.x,this._context.measureText(a).width)}let{lineHeight:o}=e;return t.y=i.length*o,{dimensions:t,lines:i}}getDimensions(){let e=this.calculateFontStyles(),{dimensions:t}=this._calculateText(e);return t}fitMaxHeight(){this.update();let e=this.getDimensions(),t=this.getText().split(`
`),i=this.getMaxHeight()/e.y}fitMaxWidth(){let e=this.getDimensions().x,t=this.getMaxWidth()/e;this.setFontSize(this.getFontSize()*t),this._textOptions.fontSize=this.getFontSize()}fitInFrame(e){this.setMaxWidth(e.width),this.setMaxHeight(e.height),this.fitMaxWidth(),this.fitMaxHeight()}getSize(){let e=this.getDimensions();return new Se(e.x,e.y)}};ba.prototype.availableOptions={text:{type:h.STRING,default:""},fontIdentifier:{type:h.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:h.OBJECT,default:null},lineHeight:{type:h.NUMBER,default:1},fontSize:{type:h.NUMBER,default:22},textColor:{type:h.STRING,default:"black"},strokeStyle:{type:h.STRING,default:"black"},outlineWidth:{type:h.NUMBER,default:0},textBaseline:{type:h.STRING,default:"alphabetic"},excludeAccents:{type:h.BOOLEAN,default:!0},maxWidth:{type:h.NUMBER,default:100},maxHeight:{type:h.NUMBER,default:0},alignment:{type:h.STRING,default:"left",available:["left","center","right"]}}});var Or,ju=_(()=>{O();Xh();qo();qv();gs();vu();Or=class extends Ji{_calculateLayoutElements(){let e=this.getWords(),t=this._getTextFrame(),r=this.getAttributes().getFontIdentifier(),o=this.getImageInsets(),n=new gt({text:e.getWord(0),fontIdentifier:r});n.fitWidth(t.width);let a=new _t({text:e.getWord(0),frame:t,font:n});a.setFrame(this._getTextFrameForElement(a));let l=this.getSize();return(this.getSizeToFitContent()||l.height<=1)&&(l.height=o.top+a.getFrame().height+o.bottom),l.height=Math.max(l.height,this.getMinimumHeight()),[a]}_getTextFrameForElement(e){let i=this.getWords().getWord(0),r=this.getAttributes(),o=r.getFontIdentifier(),n=this.getImageInsets(),a=this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor()),l=new ba({text:i,fontIdentifier:o,alignment:r.getAlignment(),lineHeight:1});l.fitInFrame(a);let u=l.getSize();a.height=u.height;let c=u.height*this.getRowScaleFactor();this.getSizeToFitContent()&&(c+=n.top+n.bottom);let p=this._getFrame(),m=r.getAlignment();if(this.getCenteredVertically())a.y=p.height/2-c/2+n.top;else switch(m){case"left":a.y=p.height-c-n.bottom;break;case"center":a.y=p.height/2-c/2+c*this.getCenterOffset(),a.x=(p.width-a.width)/2;break;case"right":a.x=p.width-a.width-n.right;break;default:break}return a}render(e){e.save(),this._getLayoutElements().forEach(t=>{let{text:i,frame:r}=t.serializeOptions(),o=this.getAttributes(),n=o.getFontIdentifier(),a=new ba({text:i,fontIdentifier:n,alignment:o.getAlignment(),lineHeight:1,textColor:o.getTextColor().toRGBA()});r=this._getTextFrameForElement(t),a.fitInFrame(r),a.draw(e,r.x,r.y)}),e.restore()}};Or.prototype.availableOptions=N(D({},Ji.prototype.availableOptions),{centerOffset:{type:h.NUMBER,default:0},sizeToFitContent:{type:h.BOOLEAN,default:!1},textScaleFactor:{type:h.NUMBER,default:.95},rowScaleFactor:{type:h.NUMBER,default:1},minimumHeight:{type:h.NUMBER,default:0},centeredVertically:{type:h.BOOLEAN,default:!1}})});var Zo,ze,ws=_(()=>{O();$o();At();ju();Ht();Er();Yo();Zo=class extends qe{constructor(...e){super(...e);this._rowType=$.Box,this._alignmentRandomizer=new ne(0),this._isMaskedRandomizer=new ne(0),this._seedPool.push(this._alignmentRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return[$.Box.getImagePath()]}_modifiedText(e){return super._modifiedText(e).toLowerCase()}_modifiedLines(e){let t=new rt;return t.set([e.reduce((i,r)=>`${i}${i===""?"":`
`}${r.joined(1)[0]}`,"")]),[t]}_layoutRows(e,t){let i=super._layoutRows(e,t),r=i[0];if(r&&this.getSquareLayout()){let o=r.getSize();o.height=o.width}return i}getAlignment(){return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments||Zo.ValidAlignments)}_randomLayoutRow(e,t,i,r){let o=this.getAlignment(),n=this._rowType,a=ge.getImage(n.getImagePath());r.setAlignment(o);let l=new Or({words:e,width:i,attributes:r,image:a,imageInsets:n.insetsForWidth(i),capInsets:n.getCapInsets(),backgroundColor:S.WHITE,centerOffset:0,textScaleFactor:.7,isMasked:this._isMaskedRandomizer.nextBool()});this._rowType===$.Box&&(l.serverImageSmoothingFix=!0);let u=l.getSize();return this.getSquareLayout()?u.height=u.width:u.height=Math.max(u.height,u.width*n.getMinimumHeightRatio()),l}},ze=Zo;P(ze,"defaultFontIdentifiers",["imgly_font_galano_grotesque_bold"]),P(ze,"Alignment",{Left:"left",Center:"center",Right:"right"}),P(ze,"ValidAlignments",[Zo.Alignment.Left,Zo.Alignment.Center,Zo.Alignment.Right]),P(ze,"identifier","imgly_text_design_masked");ze.prototype.availableOptions=N(D({},qe.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:ze.defaultFontIdentifiers},squareLayout:{type:h.BOOLEAN,default:!0}})});var Ar,Kv=_(()=>{O();$o();At();ws();Ar=class extends ze{constructor(...e){super(...e);this._possibleRowTypes=[$.Badge1,$.Badge2,$.Badge3,$.Badge4],this._rowTypesRandomizer=new ne(0),this._isMaskedRandomizer=new ne(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._possibleRowTypes),r.setLineSpacing(.9);let o=super._randomLayoutRow(e,t,i,r);return o.set({textScaleFactor:.9}),o}};P(Ar,"defaultFontIdentifiers",["imgly_font_campton_bold"]),P(Ar,"identifier","imgly_text_design_masked_badge"),P(Ar,"ValidAlignments",[ze.Alignment.Center]);Ar.prototype.availableOptions=N(D({},ze.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:Ar.defaultFontIdentifiers}})});var Bt,Hu=_(()=>{O();$o();At();ws();Bt=class extends ze{constructor(...e){super(...e);this._possibleRowTypes=[$.SpeechBubble1,$.SpeechBubble3],this._rowTypesRandomizer=new ne(0),this._isMaskedRandomizer=new ne(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_rowTypes(e){return this._possibleRowTypes}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._rowTypes(e)),r.setLineSpacing(.9);let o=super._randomLayoutRow(e,t,i,r);return o.set({textScaleFactor:1,minimumHeight:i*this._rowType.getMinimumHeightRatio(),sizeToFitContent:this._rowType.getSizeToFitContent(),centeredVertically:!0}),o}};P(Bt,"defaultFontIdentifiers",["imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_roboto_black","imgly_font_roboto_light"]),P(Bt,"identifier","imgly_text_design_masked_speech_bubble");Bt.prototype.availableOptions=N(D({},ze.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:Bt.defaultFontIdentifiers},squareLayout:{type:h.BOOLEAN,default:!1},alignment:{type:h.STRING,default:"left",available:ze.ValidAlignments}})});var Cs,Xv=_(()=>{O();$o();ws();Hu();Cs=class extends Bt{constructor(...e){super(...e);this._possibleRowTypes=[$.SpeechBubble2,$.SpeechBubble4,$.SpeechBubble2,$.SpeechBubble4,$.SpeechBubble5],this._possibleRowTypesForMin15=this._possibleRowTypes.slice(0,2),this._possibleRowTypesForMax14=this._possibleRowTypes.slice(2)}_rowTypes(e){return e.countNumberOfCharacters()<15?this._possibleRowTypesForMax14:this._possibleRowTypesForMin15}};P(Cs,"defaultFontIdentifiers",["imgly_font_permanent_marker"]),P(Cs,"identifier","imgly_text_design_masked_speech_bubble_comic");Cs.prototype.availableOptions=N(D({},Bt.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:Cs.defaultFontIdentifiers}})});var Ds,Yv=_(()=>{O();ju();ws();Ds=class extends ze{_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){let o=this._alignmentRandomizer.pickNext(ze.ValidAlignments);return r.setAlignment(o),new Or({words:e,width:i,attributes:r,image:null,backgroundColor:S.WHITE,centerOffset:0,sizeToFitContent:!0,isMasked:!1,autoAdjustTextColor:!1})}};P(Ds,"defaultFontIdentifiers",["imgly_font_abril_fatface_regular"]),P(Ds,"identifier","imgly_text_design_multiline");Ds.prototype.availableOptions=N(D({},ze.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:Ds.defaultFontIdentifiers}})});var nF,qu,Jv=_(()=>{O();({Rectangle:nF}=L),qu=class extends J{getContentFrame(){let e=this.getFrame().clone(),t=e.width*.1;return e.insetBy(t,t)}intersects(e){return this.getFrame().intersects(e.getFrame())}};qu.prototype.availableOptions={frame:{type:h.OBJECT,default:new nF}}});var $v,oi,Ku=_(()=>{O();Ht();Rr();Vh();Jv();({Rectangle:$v}=L),oi=class extends xs{constructor(...e){super(...e);this._MAX_TRIES=1e3,this._PRECISION=1e3}render(e,t,i,r,o){let{imagePaths:n,relativeParticleSize:a}=this._options;if(n.length<=0)return;let l=t.width/t.height,u=new $v(Math.round(i.left*this._PRECISION),Math.round(i.top*this._PRECISION*l),this._PRECISION,this._PRECISION);u.width-=u.x+Math.round(i.right*this._PRECISION),u.height-=u.y+Math.round(i.bottom*this._PRECISION*l);let c=[],p=0,m=0;for(;p<this.getParticleCount()&&m<this._MAX_TRIES;){let d=a/2,f=Math.round(d*this._PRECISION),b=Math.round(d*this._PRECISION*l),y=Math.floor(this._PRECISION)-f,g=Math.floor(this._PRECISION)-b,C=o.nextInRange(f,y),x=o.nextInRange(b,g),v=new $v(C-f,x-b,2*f,2*b);!v.intersects(u)&&!this.hasCollision(c,v)&&(c.push(new qu({frame:v})),p+=1),m+=1}for(let d=0;d<c.length;d++){let f=c[d],b=o.pickNext(n),y=ge.getImage(b),g=o.nextInRange(140,230)/255,C=t.width/this._PRECISION,x=t.height/this._PRECISION,v=f.getContentFrame();v.x*=C,v.y*=x,v.width*=C,v.height*=x;let M=r.clone();M.a=g,Yi(e,y,v,M,"source-atop")}}hasCollision(e,t){for(let i=0;i<e.length;i++)if(t.intersects(e[i].getFrame()))return!0;return!1}};oi.prototype.availableOptions=N(D({},xs.prototype.availableOptions),{particleCount:{type:h.NUMBER,default:50},relativeParticleSize:{type:h.NUMBER,default:.08},imagePaths:{type:h.ARRAY,default:[]}})});var Qo,Zv=_(()=>{O();Ku();Qo=class extends oi{};P(Qo,"Images",["text-design/images/imgly_text_design_particle_brush_01.png","text-design/images/imgly_text_design_particle_brush_02.png","text-design/images/imgly_text_design_particle_brush_03.png","text-design/images/imgly_text_design_particle_brush_04.png","text-design/images/imgly_text_design_particle_brush_05.png","text-design/images/imgly_text_design_particle_brush_06.png","text-design/images/imgly_text_design_particle_brush_07.png","text-design/images/imgly_text_design_particle_brush_08.png","text-design/images/imgly_text_design_particle_brush_09.png","text-design/images/imgly_text_design_particle_brush_10.png"]);Qo.prototype.availableOptions=N(D({},oi.prototype.availableOptions),{imagePaths:{type:h.ARRAY,default:[...Qo.Images]},relativeParticleSize:{type:h.NUMBER,default:.12}})});var en,Qv=_(()=>{O();Ku();en=class extends oi{};P(en,"Images",["text-design/images/imgly_text_design_particle_circle_01.png","text-design/images/imgly_text_design_particle_circle_02.png","text-design/images/imgly_text_design_particle_circle_03.png","text-design/images/imgly_text_design_particle_circle_04.png","text-design/images/imgly_text_design_particle_circle_05.png","text-design/images/imgly_text_design_particle_circle_06.png","text-design/images/imgly_text_design_particle_circle_07.png","text-design/images/imgly_text_design_particle_circle_08.png","text-design/images/imgly_text_design_particle_circle_09.png","text-design/images/imgly_text_design_particle_circle_10.png"]);en.prototype.availableOptions=N(D({},oi.prototype.availableOptions),{imagePaths:{type:h.ARRAY,default:[...en.Images]},relativeParticleSize:{type:h.NUMBER,default:.12}})});var tn,ew=_(()=>{O();Ku();tn=class extends oi{};P(tn,"Images",["text-design/images/imgly_text_design_particle_triangle_01.png","text-design/images/imgly_text_design_particle_triangle_02.png","text-design/images/imgly_text_design_particle_triangle_03.png","text-design/images/imgly_text_design_particle_triangle_04.png","text-design/images/imgly_text_design_particle_triangle_05.png","text-design/images/imgly_text_design_particle_triangle_06.png","text-design/images/imgly_text_design_particle_triangle_07.png","text-design/images/imgly_text_design_particle_triangle_08.png","text-design/images/imgly_text_design_particle_triangle_09.png","text-design/images/imgly_text_design_particle_triangle_10.png"]);tn.prototype.availableOptions=N(D({},oi.prototype.availableOptions),{imagePaths:{type:h.ARRAY,default:[...tn.Images]}})});var Ir,st,Xu=_(()=>{O();At();It();Kt();ku();Tu();Ht();Er();Yo();Ir=class extends qe{constructor(...e){super(...e);this._relativeInsets=new Q(0,0,0,0),this._INVALID_FONTS_IF_LESS_THEN_5_CHARS=["imgly_font_montserrat_light"],this._INVALID_FONTS_IF_LESS_THEN_4_CHARS=["imgly_font_montserrat_light","imgly_font_wolesbro"],this._lineCount=0,this._decorativeRowCreated=!1,this._useImageRowRandomizer=new ne(0),this._rowTypeRandomizer=new ne(0),this._lineDecorativeTypeRandomizer=new ne(0),this._seedPool.push(this._useImageRowRandomizer),this._seedPool.push(this._rowTypeRandomizer),this._seedPool.push(this._lineDecorativeTypeRandomizer)}getImagePaths(){return[...Ir.DecoratorImages,...Ir.RowImages]}_fontForRow(e,t){let i=t.countNumberOfCharacters(),r=this.getFontIdentifiers();return i<4?r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(o)<0):i<5&&(r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(o)<0)),r[e%r.length]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_modifiedLines(e){return this._lineCount=e.length,e}generateLayoutData(e,t){return this._decorativeRowCreated=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){let o=r.getFontIdentifier(),n=e;switch(o){case"imgly_font_wolesbro":n=new rt().set(e.getLowerCase());break;case"imgly_font_permanent_marker":n=new rt().set(e.getUpperCase());break;default:break}let a=this.getDecorativeRowsInTheMiddleOnly()&&(t===0||t===this._lineCount-1);if(this._useImageRowRandomizer.nextBool()||this._decorativeRowCreated||a)return new Pe({words:n,width:i,attributes:r});this._decorativeRowCreated=!0;let[l,u]=this._randomDecoratorImages();return new wi({words:e,width:i,attributes:r,leftImage:l,rightImage:u})}_layoutRows(e,t){let i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;let r=.0625*t,o=new Ke({width:t,height:r,image:ge.getImage(this._rowTypeRandomizer.pickNext(Ir.RowImages))}).layout(),n=new Ke({width:t,height:r,image:ge.getImage(this._rowTypeRandomizer.pickNext(Ir.RowImages))}).layout();return[o,...i,n]}_randomDecoratorImages(){return this._lineDecorativeTypeRandomizer.nextInRange(0,1)?Ir.DecoratorImages.slice(0,2).map(e=>ge.getImage(e)):Ir.DecoratorImages.slice(2).map(e=>ge.getImage(e))}},st=Ir;P(st,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),P(st,"identifier","imgly_text_design_sunshine"),P(st,"RowImages",[Ke.RowImages.decorative1,Ke.RowImages.decorative2,Ke.RowImages.decorative3,Ke.RowImages.decorative4]),P(st,"DecoratorImages",["text-design/images/imgly_text_design_asset_decorative_03.png","text-design/images/imgly_text_design_asset_decorative_04.png","text-design/images/imgly_text_design_asset_decorative_07.png","text-design/images/imgly_text_design_asset_decorative_08.png"]);st.prototype.availableOptions=N(D({},qe.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:st.defaultFontIdentifiers},relativeLineSpacing:{type:h.NUMBER,default:.025/3*4},decorationsVisible:{type:h.BOOLEAN,default:!0},decorativeRowsInTheMiddleOnly:{type:h.BOOLEAN,default:!1}})});var Pr,$i,tw=_(()=>{O();Zv();Qv();ew();At();It();Ht();Xu();Pr=class extends st{constructor(...e){super(...e);this._relativeInsets=new Q(.3,.3,.3,.3),this._backgroundRandomizer=new ne(0),this._decoTypeRandomizer=new ne(0),this._seedPool.push(this._backgroundRandomizer),this._seedPool.push(this._decoTypeRandomizer)}getImagePaths(){return[...st.RowImages,...E.Array.flatten(Pr.Backgrounds.map(e=>e.getImagePaths())),...Pr.DecoratorImages]}_getBackground(){return this._backgroundRandomizer.pickNext(Pr.Backgrounds)}_randomDecoratorImages(){switch(this._decoTypeRandomizer.nextInRange(0,2)){case 0:return Pr.DecoratorImages.slice(0,2).map(e=>ge.getImage(e));case 1:case 2:return Pr.DecoratorImages.slice(2).map(e=>ge.getImage(e));default:return B.warn("TextDesignParticles#_randomDecoratorImages: Number generated not in valid range."),Pr.DecoratorImages.slice(2).map(e=>ge.getImage(e))}}},$i=Pr;P($i,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),P($i,"identifier","imgly_text_design_particles"),P($i,"Backgrounds",[new Qo,new en,new tn]),P($i,"DecoratorImages",["text-design/images/imgly_text_design_particle_holder_01.png","text-design/images/imgly_text_design_particle_holder_02.png","text-design/images/imgly_text_design_particle_holder_03.png","text-design/images/imgly_text_design_particle_holder_04.png"]);$i.prototype.availableOptions=N(D({},st.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:$i.defaultFontIdentifiers},decorationsVisible:{type:h.BOOLEAN,default:!1},decorativeRowsInTheMiddleOnly:{type:h.BOOLEAN,default:!0}})});var ks,iw=_(()=>{O();At();It();Uh();Yo();ks=class extends qe{constructor(...e){super(...e);this._relativeInsets=new Q(.1,0,0,0),this._rowTypeRandomizer=new ne(0),this._seedPool.push(this._rowTypeRandomizer)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){let o=super._randomLayoutRow(e,t,i,r);return o.setShearingAngle(this.getShearingAngle()),o}_layoutRows(e,t){let i=super._layoutRows(e,t),r=E.values(Rt.FormType),o=30,n=new Rt({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout(),a=new Rt({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout();return[n,...i,a]}};P(ks,"defaultFontIdentifiers",["imgly_font_campton_bold"]),P(ks,"identifier","imgly_text_design_rotated");ks.prototype.availableOptions=N(D({},qe.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:ks.defaultFontIdentifiers},relativeLineSpacing:{type:h.NUMBER,default:.025/3},shearingAngle:{type:h.NUMBER,default:-.1}})});var Yu,rw=_(()=>{It();Tu();Ht();Xu();Yu=class extends st{constructor(...e){super(...e);this._relativeInsets=new Q(0,.3,0,.3)}_layoutRows(e,t){let i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;let r=25,o=new Ke({width:t,height:r,image:ge.getImage(this._rowTypeRandomizer.pickNext(st.RowImages))}).layout(),n=new Ke({width:t,height:r,image:ge.getImage(this._rowTypeRandomizer.pickNext(st.RowImages))}).layout();return[o,...i,n]}};P(Yu,"identifier","imgly_text_design_sunshine-v3_1_0")});var Ts,sw=_(()=>{O();$o();ws();Hu();Ts=class extends Bt{constructor(...e){super(...e);this._possibleRowTypes=[$.Watercolor1,$.Watercolor2,$.Watercolor3]}};P(Ts,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro"]),P(Ts,"identifier","imgly_text_design_watercolor");Ts.prototype.availableOptions=N(D({},Bt.prototype.availableOptions),{fontIdentifiers:{type:h.ARRAY,default:Ts.defaultFontIdentifiers},alignment:{type:h.STRING,default:ze.Alignment.Center,available:ze.ValidAlignments}})});var aF,Ju,Yh,ow=_(()=>{O();At();vu();ju();xi();Rr();({Rectangle:aF}=L),Ju=1e3,Yh=class{constructor(){this._layoutData=null,this._layout=null,this._text="",this._seed=0,this._debugMode=!1,this.randomizer=new ne}createLayout(e,t,i){this._layout=e,this._text=t,this._seed=i,e.seed(i),this._layoutData=e.generateLayoutData(t,Ju)}calculateAspect(){return this._layoutData?this._layoutData.getSize().aspect():(B.warn("TextDesignRenderer#calculateAspect: No layout data"),1)}draw(e,t,i,r){let o=this._layoutData;if(this._layoutData){let n=new Se(Ju,Ju/t.aspect()),a=t.width/Ju,l=o.getRelativeInsets().clone().scale(n.width),u=o.getRelativeLineSpacing()*n.width,c=l.top;e.save(),this.randomizer.seed(this._seed);let p=o.getBackground();p&&p.render(e,t,o.getRelativeInsets(),r?S.WHITE:i,this.randomizer),e.scale(a,a),o.getRows().forEach(m=>{e.save();let d=m.getAttributes();if(e.transform(1,m.getShearingAngle(),0,1,l.left,c),d.setTextColor(r?S.WHITE:i.clone()),d.setTintColor(r?S.WHITE:i.clone()),(m instanceof Ji||m instanceof Or)&&(m.setBackgroundColor(r?S.WHITE:i.clone()),m.setIsUsedInInvertedLayout(r)),this._debugMode&&(m._debugMode=!0),m.willRender(e),m.render(e),m.didRender(e),this._debugMode){let f=m._getFrame(),b=m._getTextFrame();Xo(e,f,S.GREEN),Xo(e,b,S.BLUE),m._getLayoutElements().forEach(y=>{let g=y.getFrame(),C=m._getTextFrameForElement(y);Xo(e,g,new S(1,1,0)),Xo(e,C,new S(0,1,1))})}c+=m.getSize().height+u,e.restore()}),this._debugMode&&Xo(e,new aF(0,0,n.width,n.height),S.RED),e.restore()}}}});var Mr,rn,$u,nw=_(()=>{O();Ho();Jo();uv();Gh();cv();Wh();mv();jh();hv();ws();Kv();Hu();Xv();Yv();tw();iw();Xu();rw();sw();At();xi();Ht();ow();({Vector2:Mr}=L),rn=class extends yi{constructor(e,t){super(e,t);this._isDisposed=!1,this._renderer=new Yh,this._canvas=E.createCanvas(),this._context=this._canvas.getContext("2d"),this._texture=R.Texture.fromCanvas(this._canvas),this._sprite.setTexture(this._texture),this._aspect=1,this._isLayoutDirty=!0,this.getSeed()<0&&this.setSeed(ne.TimeSeed())}seed(e){this.setSeed(e||ne.TimeSeed()),this._isLayoutDirty=!0}_updateLayout(){let e=this.getLayout();return e?(this._renderer.createLayout(e,this.getText(),this.getSeed()),this._aspect=this._renderer.calculateAspect(),this._isLayoutDirty=!1,!0):null}applyTransform(e){super.applyTransform(e);let t={};this._options.dimensions&&(t.width=e.applyToRelativeSize(this.getWidth())),this.set(t,!1)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}update(e,t){let i=this._isLayoutDirty;if(this._isDisposed||i&&!this._updateLayout())return;let r=this.getWidth()*t.min()/e.getTextureScale(),o=r/this._aspect,n=new Mr(r,o),a=new Mr(Math.round(r*2),Math.round(o*2)).clamp(new Mr(1,1),new Mr(1/0,1/0)),l=e.getRenderer(),u=l.getMaxDimensions()||1/0;a.x>u&&(a.x=u,a.y=Math.round(a.x/this._aspect)),a.y>u&&(a.y=u,a.x=Math.round(a.y*this._aspect));let c=E.ensureCanvasDimensions(this._canvas,a);(i||c)&&(this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._renderer.draw(this._context,new Se(a.x,a.y),this.getColor(),this.getInverted()),this.setDimensions(n),this._texture.getBaseTexture().update(),l.isOfType(K.WEBGL)&&l.updateTexture(this._texture.getBaseTexture())),super.update(e,t),this._applyFlip()}_applyFlip(){let e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}_optionEquals(e,t){if(e==="layout"){let{layout:i}=this._options;return!(!i&&t||!t&&i||!t.constructor||!i.constructor||i.constructor.identifier!==t.constructor.identifier)}return super._optionEquals(e,t)}serializeOptions(e,t=!1){if(e&&this.getPadding()<0){let r=e.indexOf("padding");r>-1&&e.splice(r,1)}let i=super.serializeOptions(e,t);return e||(i.type="textdesign"),i}_getTexture(){return this._texture}canBeFlippedHorizontally(){return!1}canBeDuplicated(){return!0}canMaskCanvas(){return!0}canAdjustPadding(){return!0}dispose(){this._isDisposed=!0,this._texture.dispose(),this._sprite.dispose()}};rn.Layouts={TextDesignBlocks:Ze,TextDesignBlocksCondensed:_s,TextDesignBlocksLight:vi,TextDesignCelebrate:Mt,TextDesignCelebrateSimple:bs,TextDesignEqualWidth:Di,TextDesignEqualWidthFat:vs,TextDesignMasked:ze,TextDesignMaskedBadge:Ar,TextDesignMaskedSpeechBubble:Bt,TextDesignMaskedSpeechBubbleComic:Cs,TextDesignMultiline:Ds,TextDesignWatercolor:Ts,TextDesignSunshine:st,TextDesignParticles:$i,TextDesignRotated:ks};rn.LegacyLayouts={TextDesignBlocksLightV310:ys,TextDesignSunshineV310:Yu};rn.AssetManager=ge;rn.prototype.availableOptions={id:{type:h.STRING,default:()=>E.getUUID()},position:{type:h.VECTOR2,default:new Mr(.5,.5)},dimensions:{type:h.VECTOR2,default:Mr.NULL},anchor:{type:h.VECTOR2,default:new Mr(0,0)},pivot:{type:h.VECTOR2,default:new Mr(.5,.5)},rotation:{type:h.NUMBER,default:0},flipHorizontally:{type:h.BOOLEAN,default:!1},flipVertically:{type:h.BOOLEAN,default:!1},layout:{type:h.OBJECT,default:null,setter(s){return this._isLayoutDirty=!0,s}},text:{type:h.STRING,default:"",setter(s){return this._isLayoutDirty=!0,s}},color:{type:h.COLOR,default:S.BLACK,setter(s){return this._isLayoutDirty=!0,s}},padding:{type:h.NUMBER,default:.01,minValue:.01},width:{type:h.NUMBER,default:.8},inverted:{type:h.BOOLEAN,default:!1,setter(s){return this._isLayoutDirty=!0,s}},seed:{type:h.NUMBER,default:-1}};$u=rn});var Jh,Zu,Qu,aw=_(()=>{O();Ho();Xh();({Vector2:Jh}=L),Zu=class extends yi{constructor(...e){super(...e);this._textRenderer=new jv(this,this._operation),this._textRenderer.rotation=this.getRotation(),this._sprite.setTexture(this._textRenderer.getFinalTexture()),this._hitTestSprite.setTexture(this._textRenderer.getTexture())}serializeOptions(e,t=!1){let i=super.serializeOptions(e,t);return e||(i.type="text"),i}getDOMStyle(e,t){let i=this.getFontSize()*t.y;return{fontWeight:this._options.fontWeight,fontSize:`${i}px`,fontStyle:this._options.fontStyle,fontFamily:this._options.fontFamily,lineHeight:`${this.getAbsoluteTextHeight(t)*this.getLineHeight()}px`,color:this._options.color.toRGBA(),backgroundColor:this._options.backgroundColor.toRGBA(),textAlign:this._options.alignment}}getAbsoluteTextHeight(e){let t=this.getFontSize()*e.y,i=this.getTextMetrics();if(i){let r=1/i.unitsPerEm*t,o=i.ascender*r,n=i.descender*r;return o+Math.abs(n)}return t*this.getLineHeight()*1.1}getDimensions(e,t){return this._textRenderer.getDimensions(e,t)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}applyTransform(e){super.applyTransform(e),this.set({fontSize:e.scaleSize(this.getFontSize(),"y"),maxWidth:e.scaleSize(this.getMaxWidth(),"x")},!1)}applyRotation(e){super.applyRotation(e);let t=(e+360)%360,i=this._operation.getInputDimensions();(t===90||t===270)&&(this.setMaxWidth(this.getMaxWidth()/i.x*i.y),this.setFontSize(this.getFontSize()/i.y*i.x))}setOption(e,t){let{flipHorizontally:i,flipVertically:r}=this._options;if(e==="rotation"){let o=t;i&&(o=Math.PI*2-o),r&&(o=Math.PI*2-o),this._options.rotation=o,this._textRenderer&&(this._textRenderer.rotation=o),this._rotation=o,this.emit("update");return}super.setOption(e,t)}getOption(e){return e==="rotation"?this._rotation:super.getOption(e)}getHitTestDisplayObject(){return this._hitTestSprite}update(e,t){if(this._sprite.setVisible(this._options.visible),!this._options.visible)return;this._textRenderer.update(e,t);let i=this._textRenderer.getFinalTexture();i.getBaseTexture().update();let o=e.getRenderer();o.isOfType(K.WEBGL)&&o.updateTexture(i.getBaseTexture()),super.update(e,t),this._sprite.setRotation(0),this._textRenderer.getTexture().getBaseTexture().update(),this._hitTestSprite.setRotation(this._rotation),this._hitTestSprite.updateTransform(),this._applyFlip()}_applyFlip(){let e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1,this.setRotation(this._rotation)),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1,this.setRotation(this._rotation)),this._sprite.setScale(e)}_getTexture(){return this._textRenderer.getFinalTexture()}dispose(){super.dispose(),this._textRenderer.dispose(),this._hitTestSprite.dispose(),this._sprite.dispose()}canBeFlippedHorizontally(){return!1}canAdjustPadding(){return!1}};Zu.prototype.availableOptions={id:{type:h.STRING,default:()=>E.getUUID()},fontSize:{type:h.NUMBER,default:.1},characterSpacing:{type:h.NUMBER,default:0},lineHeight:{type:h.NUMBER,default:1.1},fontIdentifier:{type:h.STRING},fontFamily:{type:h.STRING,default:"Times New Roman"},fontWeight:{type:h.ALL,default:"normal"},fontStyle:{type:h.STRING,default:"normal"},textMetrics:{type:h.OBJECT,default:null},outlineWidth:{type:h.NUMBER,default:0},outlineColor:{type:h.COLOR,default:S.BLACK},alignment:{type:h.STRING,default:"left",available:["left","center","right"]},verticalAlignment:{type:h.STRING,default:"top",available:["top","center","bottom"]},color:{type:h.COLOR,default:new S(1,0,0,1)},backgroundColor:{type:h.COLOR,default:S.TRANSPARENT},position:{type:h.VECTOR2,default:new Jh(.5,.5)},anchor:{type:h.VECTOR2,default:new Jh(0,0)},pivot:{type:h.VECTOR2,default:new Jh(.5,.5)},rotation:{type:h.NUMBER,default:0},text:{type:h.STRING,required:!0},maxWidth:{type:h.NUMBER,default:.5},maxHeight:{type:h.NUMBER,default:0},visible:{type:h.BOOLEAN,default:!0},flipHorizontally:{type:h.BOOLEAN,default:!1},flipVertically:{type:h.BOOLEAN,default:!1}};Zu.type="text";Qu=Zu});var $h,Zi,lw,uw=_(()=>{O();Ho();Bh();iv();nw();aw();({Vector2:$h}=L),Zi=class extends ce{constructor(...e){super(...e);this.setSmoothDownscaling(this._sdk.getOptions().smoothDownscaling),this._onSpriteUpdate=this._onSpriteUpdate.bind(this),this._maskCanvas=E.createCanvas(),this._options.sprites.slice().forEach(i=>{this.removeSprite(i),this.addSprite(i)})}getSpritesOfType(e){return this._options.sprites.filter(t=>t instanceof e)}rotate(e){this._options.sprites.forEach(t=>{t.applyRotation(e)})}flip(e){this._options.sprites.forEach(t=>{t.applyFlip(e)})}_onSpriteUpdate(e,t){this.emit("update",this),this.setDirty(!0)}_applyRotation(e,t){this._options.sprites.forEach(i=>i.applyRotation(e,t))}transform(e){this._options.sprites.forEach(t=>t.applyTransform(e))}scale(e){this._options.sprites.forEach(t=>t.applyScale(e))}serializeOption(e,t=!1){return e==="sprites"?this._options.sprites.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createSticker(e){return new bu(this,e)}createText(e){return new Qu(this,e)}createBrush(e){return new ps(this,e)}createTextDesign(e){return new $u(this,e)}addSprite(e){this._options.sprites.push(e);let t=this.getSmoothDownscaling();e.setSmoothDownscaling&&e.setSmoothDownscaling(t),this._container.addChild(e.getDisplayObject()),this.setDirty(!0),e.on("update",this._onSpriteUpdate),this.emit("update",this,this._options.sprites)}removeSprite(e){let{sprites:t}=this._options,i=t.indexOf(e);return i!==-1?(e.off("update",this._onSpriteUpdate),this._container.removeChild(e.getDisplayObject()),t.splice(i,1),this.setDirty(!0),!0):!1}_getOrientatedStageSize(){let e=this._sdk.getSprite().getTexture().getFrame(),t=this._sdk.getOperationsStack().getByIdentifier("orientation");if(t){let r=t?t.getRotation():0;return r===270||r===90?new $h(e.height,e.width):new $h(e.width,e.height)}let i=this._sdk.getOperationsStack().getByIdentifier("output");return i?i.getOutputResolution():new $h(e.width,e.height)}_render(e){let t=this._container,{sprites:i}=this._options,r=e.getDimensions().clone().floor(),o=new R.Container;return o.addChild(this._sprite),Promise.all(i.map(n=>n.validateSettings())).then(()=>{i.forEach(n=>n.update(this._sdk,r))}).then(()=>{this._renderTexture.clear(),i.forEach(n=>{n.getInverted&&n.getInverted()?(this._renderTexture.render(o),this._renderTexture.render(this._renderMaskedSprite(n.getDisplayObject(),n.getColor?n.getColor():S.WHITE,n.getPadding?n.getPadding():-1)),o=new R.Container):o.addChild(n.getDisplayObject())}),this._renderTexture.render(o),t.addChild(this._sprite),i.forEach(n=>t.addChild(n.getDisplayObject()))})}_renderMaskedSprite(e,t,i){let r=this._maskCanvas,o=e.getWorldTransform(),n=this._getOrientatedStageSize();E.ensureCanvasDimensions(r,n);let a=r.getContext("2d");if(a.clearRect(0,0,r.width,r.height),a.save(),a.fillStyle=t.toRGBA(),i<0)a.fillRect(0,0,n.x,n.y);else{let c=Math.abs(e.getWidth()/e.getScale().x),p=Math.abs(e.getHeight()/e.getScale().y),m=c*i;a.transform(o.a,o.b,o.c,o.d,o.tx,o.ty),a.fillRect(-m,-m,c+m*2,p+m*2)}a.restore(),a.save(),a.globalCompositeOperation="destination-out",e._renderCanvas({getCurrentRenderTarget:()=>({getPixelRatio:()=>1}),beforeDraw:c=>{let p=e.getWidth(),m=e.getHeight(),d=e.getScale(),f=d.x<0,b=d.y<0;c.translate(p,m),c.scale(f?-1:1,b?-1:1),c.translate(-p,-m)},getContext:()=>a}),a.restore();let l=new R.Container,u=new R.Sprite(R.Texture.fromCanvas(r));return l.addChild(u),l}takeSpriteToFront(e){let{sprites:t}=this._options,i=t.indexOf(e);if(i===-1)return;E.moveArrayItem(t,i,t.length-1);let r=e.getDisplayObject();this._container.removeChild(r),this._container.addChild(r),this.setDirty(!0)}getSpritesAtPosition(e,t){let i=[];this._options.sprites.forEach(c=>c.update(this._sdk,t));let r=this._sdk.getSprite(),o=r.getWorldTransform().applyInverseToVector(e),{width:n,height:a}=r.getTexture().getFrame(),l=r.getAnchor().clone().multiply(-n,-a);o.subtract(l);let u=this._options.sprites.slice(0).reverse();for(let c=0,p=u.length;c<p;c++){let m=u[c];m.getHitTestDisplayObject().isAtPosition(o)&&i.push(m)}return i}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._options.sprites.forEach(r=>{r.setDirtyForRenderer(e,t,i)})}dispose(){super.dispose(),this._options.sprites.forEach(e=>{e.dispose()})}};Zi.StickerSprite=bu;Zi.TextSprite=Qu;Zi.BrushSprite=ps;Zi.TextDesignSprite=$u;Zi.identifier="sprite";Zi.prototype.availableOptions={sprites:{type:h.ARRAY,default:[],setter(s,e){return s=s.map((t,i)=>{if(t instanceof yi)return t;let r=D({},t);switch(delete r.type,t.type){case"text":return new Qu(this,r);case"sticker":return new bu(this,r);case"brush":return new ps(this,r);case"textdesign":return new $u(this,r);default:return B.error(this.constructor.name,`Invalid sprite type: ${t.type}`),null}}),e||(this._options.sprites&&this._options.sprites.slice().forEach(i=>{i.dispose(),this.removeSprite(i)}),s.forEach(t=>{this.addSprite(t)})),s}},smoothDownscaling:{type:h.BOOLEAN,default:!1}};X.Operations.SpriteOperation=Zi;lw=Zi});var cw,mw,dw,hw=_(()=>{O();({Vector2:cw}=L),mw=class{constructor(e,t){this._options=t,this._oldOptions={start:e.getStart().clone(),end:e.getEnd().clone(),rotation:e.getRotation(),textureScale:e.getTextureScale()},this._inputDimensions=e.getInputDimensions(!1),this._rotationDelta=t.rotation-e.getRotation(),this._deltaCos=Math.cos(this._rotationDelta),this._deltaSin=Math.sin(this._rotationDelta),this._oldAbsoluteSize=this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions),this._newAbsoluteSize=t.end.clone().subtract(t.start).multiply(this._inputDimensions),this._absoluteStartDiff=this._oldOptions.start.clone().subtract(t.start).multiply(this._inputDimensions),this._scaleRatio=e.calculateScale(t.rotation)/e.calculateScale(),this._sizeFactor=this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize),this._textureScaleFactor=this._options.textureScale/e.getTextureScale()}applyToRelativePoint(e){let t=this._oldOptions.start,i=this._oldOptions.end,o=t.clone().add(i.clone().subtract(t).divide(2)).multiply(this._inputDimensions),n=e.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2)),l=o.clone().add(n).clone().subtract(this._inputDimensions.clone().divide(2)),u=new cw(l.x*this._deltaCos-l.y*this._deltaSin,l.x*this._deltaSin+l.y*this._deltaCos),c=this._inputDimensions.clone().divide(2).add(u),p=this._options.start.clone().multiply(this._inputDimensions);return c.clone().subtract(p).divide(this._newAbsoluteSize)}applyToRelativeSize(e){return e*this._oldAbsoluteSize.min()/this._newAbsoluteSize.min()}applyToDimensions(e){return e=e.clone().multiply(this._scaleRatio),this._options.textureScale&&e.multiply(this._textureScaleFactor),e}scaleSize(e,t="y"){return e/this._sizeFactor[t]}applyToRotation(e){return(e+this._rotationDelta)%(Math.PI*2)}invert(){let e=this._options.start.clone(),t=this._options.end.clone(),i=this._inputDimensions,r=-this._rotationDelta,o=Math.cos(r),n=Math.sin(r),a=this._oldAbsoluteSize,l=this._newAbsoluteSize,u=e.clone().subtract(t).multiply(i),c=1/this._scaleRatio,p=new cw(1/this._sizeFactor.x,1/this._sizeFactor.y),m=1/this._textureScaleFactor,d=this._oldOptions;return this._oldOptions=this._options,this._options=d,this._inputDimensions=i,this._rotationDelta=r,this._deltaCos=o,this._deltaSin=n,this._oldAbsoluteSize=l,this._newAbsoluteSize=a,this._absoluteStartDiff=u,this._scaleRatio=c,this._sizeFactor=p,this._textureScaleFactor=m,this}},dw=mw});var Zh,sn,pw,fw=_(()=>{O();hw();({Vector2:Zh}=L),sn=class extends ce{_render(e){this._sprite.setRotation(0);let t=e.getDimensions(),{start:i,end:r,rotation:o,textureScale:n}=this._options,l=r.clone().subtract(i).clone().divide(2),u=i.clone().add(l),p=this.calculateScale()*n,m=t.clone().multiply(p).multiply(l);return this._sprite.setAnchor(u),this._sprite.setRotation(o),this._sprite.setScale(p,p),this._sprite.setPosition(m),this._renderTexture.render(this._container),Promise.resolve()}calculateScale(e=this._options.rotation){let t=this.getInputDimensions(!1),i=new Zh(Math.abs(t.x*Math.cos(e))+Math.abs(t.y*Math.sin(e)),Math.abs(t.x*Math.sin(e))+Math.abs(t.y*Math.cos(e))),r=t.clone().subtract(i.clone()).divide(2).abs(),o=1;return r.y>r.x?o=r.y*2/t.y+1:o=r.x*2/t.x+1,o}getNewDimensions(e){let{start:t,end:i,textureScale:r}=this._options,o=this.calculateScale();return e.clone().multiply(r*o).multiply(i.clone().subtract(t)).round()}flip(e){let{start:t,end:i}=this._options,r=t.clone();e==="horizontal"?(t.set(1-i.x,t.y),i.set(1-r.x,i.y)):e==="vertical"&&(t.set(t.x,1-i.y),i.set(i.x,1-r.y))}rotate(e){let{start:t,end:i}=this._options,r=(e+360)%360,o=Math.floor(r/90);for(let n=0;n<o;n++){let a=t.clone();t.set(1-i.y,a.x),i.set(1-a.y,i.x)}}_onBeforeExport(){this._wasEnabledBeforeExport=this.getEnabled(),this.setEnabled(!0)}_onAfterExport(){this.setEnabled(this._wasEnabledBeforeExport,!0)}};sn.identifier="transform";sn.prototype.availableOptions={start:{type:h.VECTOR2,default:new Zh(0,0)},end:{type:h.VECTOR2,default:new Zh(1,1)},textureScale:{type:h.NUMBER,default:1},rotation:{type:h.NUMBER,default:0}};sn.TransformChange=dw;X.Operations.TransformOperation=sn;pw=sn});var xa,gw,_w=_(()=>{we();O();us();xa=class extends ce{constructor(...e){super(...e);this._watermarkImage=null;this._watermarkTexture=null;this._loadWatermarkImage=()=>{if(!this._watermarkImage){if(!(this._options.watermarkURI instanceof window.Image)){let e={value:this._options.crossOrigin,cors:!0};return mt.loadImage(this._options.watermarkURI,e).then(t=>{this._watermarkImage=t})}this._watermarkImage=this._options.watermarkURI}return Promise.resolve()};this._setWatermarkalignment=(e,t)=>{let i=Math.min(t.x,t.y)*E.clamp(this._options.inset,0,1);switch(this._options.alignment){case"center":this._watermarkSprite.setPosition(new z(t.x-e.x,t.y-e.y).divide(2));break;case"top-left":this._watermarkSprite.setPosition(new z(i,i));break;case"top-right":this._watermarkSprite.setPosition(new z(t.x-e.x-i,i));break;case"bottom-left":this._watermarkSprite.setPosition(new z(i,t.y-e.y-i));break;case"bottom-right":this._watermarkSprite.setPosition(new z(t.x-e.x-i,t.y-e.y-i));break;default:this._watermarkSprite.setPosition(new z(0,0));break}};this._watermarkSprite=new R.Sprite,this._watermarkSprite.setAnchor(0,0),this._container.addChild(this._watermarkSprite)}_render(e){let{alpha:t,size:i}=this._options;return this._loadWatermarkImage().then(()=>{if(this._watermarkImage){this._watermarkTexture||(this._watermarkTexture=R.Texture.fromImage(this._watermarkImage),this._watermarkSprite.setTexture(this._watermarkTexture));let r=e.getDimensions(),{width:o,height:n}=this._watermarkImage,a=E.resizeVectorToFit(new z(o,n),r.clone().multiply(E.clamp(i,0,1)));this._setWatermarkalignment(a,r),this._watermarkSprite.setWidth(a.x),this._watermarkSprite.setHeight(a.y),this._watermarkSprite.setAlpha(t),this._renderTexture&&this._renderTexture.render(this._container)}return Promise.resolve()})}dispose(){super.dispose(),this._watermarkSprite.dispose()}};xa.identifier="watermark";xa.prototype.availableOptions={watermarkURI:{type:h.STRING,required:!0},alignment:{type:h.STRING,default:"top-right"},inset:{type:h.NUMBER,default:"0.05"},size:{type:h.NUMBER,default:"0.2"},alpha:{type:h.NUMBER,default:1},crossOrigin:{type:h.STRING,default:"anonymous"}};X.Operations.WatermarkOperation=xa;gw=xa});var lF,yw=_(()=>{O();zy();Vy();u0();m0();h0();x0();k0();S0();A0();P0();L0();W0();tv();uw();fw();_w();lF=[Ly,Wy,l0,d0,b0,D0,F0,O0,B0,G0,ev,lw,pw,gw,I0,c0];X.AllOperations=lF});var ki=_(()=>{yw();ra();ra()});var bw,xw=_(()=>{bw=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}}]},{fontFamily:"Archivo",variations:[{identifier:"imgly_font_archivo_black",fontWeight:"normal",filePath:"fonts/imgly_font_archivo_black.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_bungee_inline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_campton_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Carter",variations:[{identifier:"imgly_font_carter_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_carter_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}}]},{fontFamily:"Codystar",variations:[{identifier:"imgly_font_codystar",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_codystar.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}}]},{fontFamily:"Fira Sans",variations:[{identifier:"imgly_font_fira_sans_regular",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_fira_sans_regular.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Krona One",variations:[{identifier:"imgly_font_krona_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_krona_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}}]},{fontFamily:"Kumar One Outline",variations:[{identifier:"imgly_font_kumar_one_outline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_kumar_one_outline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}}]},{fontFamily:"Molle",variations:[{identifier:"imgly_font_molle",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_molle.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}}]},{fontFamily:"Monoton",variations:[{identifier:"imgly_font_monoton",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_monoton.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}}]},{fontFamily:"Nixie One",variations:[{identifier:"imgly_font_nixie_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_nixie_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}}]},{fontFamily:"Notable",variations:[{identifier:"imgly_font_notable",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_notable.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}}]},{fontFamily:"Oswald SemiBold",variations:[{identifier:"imgly_font_oswald_semi_bold",fontWeight:600,fontStyle:"normal",filePath:"fonts/imgly_font_oswald_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}}]},{fontFamily:"Palanquin Dark SemiBold",variations:[{identifier:"imgly_font_palanquin_dark_semi_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_palanquin_dark_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}}]},{fontFamily:"Poppins",variations:[{identifier:"imgly_font_poppins",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_poppins.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_permanent_marker.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sancreek",variations:[{identifier:"imgly_font_sancreek",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sancreek.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}}]},{fontFamily:"Stint Ultra Expanded",variations:[{identifier:"imgly_font_stint_ultra_expanded",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_stint_ultra_expanded.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}}]},{fontFamily:"VT323",variations:[{identifier:"imgly_font_vt323",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_vt323.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Yeseva One",variations:[{identifier:"imgly_font_yeseva_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_yeseva_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}}]}]});var vw,ww=_(()=>{vw=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Abril Fatface",variations:[{identifier:"imgly_font_abril_fatface_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_abril_fatface_regular.woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}}]},{fontFamily:"Amberlight",variations:[{identifier:"imgly_font_amberlight",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_amberlight.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_bungee_inline.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_campton_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Handycheera",variations:[{identifier:"imgly_font_handycheera_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_handycheera_regular.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}}]},{fontFamily:"Montserrat Light",variations:[{identifier:"imgly_font_montserrat_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_montserrat_light.woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_heavy",fontWeight:900,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_heavy.woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_permanent_marker.woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Petit Formal Script",variations:[{identifier:"imgly_font_petit_formal_script",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_petit_formal_script.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}}]},{fontFamily:"Rasa",variations:[{identifier:"imgly_font_rasa_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_regular.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontWeight:500,fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_500.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_black.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_light.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sue Ellen Francisco",variations:[{identifier:"imgly_font_sue_ellen_francisco",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sue_ellen_francisco.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}}]},{fontFamily:"Ultra",variations:[{identifier:"imgly_font_ultra",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_ultra.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}}]},{fontFamily:"Wolesbro",variations:[{identifier:"imgly_font_wolesbro",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_wolesbro.woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}]}]});var Cw,Dw=_(()=>{Cw=[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",dimensions:{x:300,y:300},forceDimensions:!1,lockDimensions:!0},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:{x:1200,y:627}},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:{x:940,y:788}},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:{x:851,y:315}}]}]});var kw,Tw,Rw=_(()=>{ki();xw();ww();Dw();kw=[];typeof X.Operations.SpriteOperation!="undefined"&&kw.push(X.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);Tw={TRANSFORM_RATIO_CATEGORIES:Cw,FONTS:bw,TEXT_DESIGN_FONTS:vw,BRUSHES:kw}});var uF,Ew,Fw=_(()=>{Jn();uF=N(D({},Oo),{LOAD:"load",SAVE:"save",EDITOR_RESIZE:"editor:resize",ZOOM:"editor:zoom",ZOOM_CHANGED:"editor:zoom_changed",HISTORY_REDO:"history:redo",HISTORY_BEFORE_REDO:"history:before-redo",TEXT_SCALED:"editor:text:scaled",TRANSFORM_RESIZE:"transform:resize",TRANSFORM_AFTER_EDIT:"transform:after-edit",ADDED_STICKER:"sticker:added-sticker",SPRITES_DESELECTED:"editor:sprite:deselected-all",CANVAS_FOCUS:"canvas:focus"}),Ew=uF});var Re,Sw=_(()=>{Rw();Fw();Re={EVENTS:Ew,DEFAULTS:Tw}});function cF(){let{userAgent:s,appVersion:e}=navigator;return e.indexOf("MSIE")!==-1?e.match(/MSIE\s+?([0-9]+)/i)[1]:s.indexOf("Trident")!==-1?s.match(/rv:([0-9]+)/i)[1]:!1}var Ow,Aw=_(()=>{Ow={getIEVersion:cF}});var mF,ec,dF,yt,Iw=_(()=>{ki();vo();ii();Aw();mF=X.Utils,{Vector2:ec}=X.Math,dF={getInnerDimensionsForElement(s){let e=new ec(s.offsetWidth,s.offsetHeight),t=window.getComputedStyle(s,null);return e.x-=parseInt(t.getPropertyValue("padding-left"),10),e.x-=parseInt(t.getPropertyValue("padding-right"),10),e.y-=parseInt(t.getPropertyValue("padding-top"),10),e.y-=parseInt(t.getPropertyValue("padding-bottom"),10),e},getEventPosition(s){let e=s.clientX,t=s.clientY;if(s.type.indexOf("touch")!==-1){if(!s.touches.length)return;e=s.touches[0].clientX,t=s.touches[0].clientY}return new ec(e,t)},createTransparentPatternCanvas(){let s=document.createElement("canvas"),e=s.getContext("2d");return s.width=10,s.height=10,e.fillStyle="white",e.fillRect(0,0,s.width,s.height),e.fillStyle="#cccccc",e.fillRect(0,0,s.width/2,s.height/2),e.fillRect(s.width/2,s.height/2,s.width,s.height),s},supportsMSBlob(){return typeof document.createElement("canvas").msToBlob!="undefined"},translate(s,e,t={}){let i=this.fetch(s,e);if(!i)return B.info("Utils#translate",`Unable to translate \`${e}\``),null;for(let r in t)i=i.replace(`\${${r}}`,t[r]);return i},fetch(s,e,t){e=e.replace(/\[(\w+)]/g,".$1"),e=e.replace(/^\./,"");let i=e.split(".");for(let r=0;r<i.length;r++){let o=i[r];if(s=s[o],!s)break}return typeof s=="undefined"?!1:s},isMobile(){let s=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4))},select(s,e,t=null){t||(t=r=>r);let i=[];return e.forEach(r=>{s.forEach(o=>{t(o)===r&&i.push(o)})}),i},getJSONP(s){return new Gt(s).load()},cloneCategories(s,e){return s.map(t=>(t=mF.clone(t),t[e]=t[e].slice(0),t))},mergeCategories(s,e,t){s=this.cloneCategories(s,t);let i=null;return e.forEach(r=>{s.forEach(o=>{r.identifier===o.identifier&&(i=o)}),i?i[t]=i[t].concat(r[t]):s.push(r)}),s},wrapFiltersInCategories(s,e){return s.map(t=>{let i=t;return e in i||(i={identifier:`imgly_filters_wrapped-${t.identifier}`,displayFlat:!0,[e]:[t]}),i})},getStyleObject(s){let e=window.getComputedStyle(s),t={};for(let i in e){let r=e.getPropertyValue(i),o=i.replace(/-([a-z])/g,(n,a)=>a.toUpperCase());r!==""&&(t[o]=r)}return t},styleElement(s,e){for(let t in e)s.style[t]=e[t]},debounce(s,e,t){let i;return function(...r){let o=()=>{i=null,t||s.apply(this,r)},n=t&&!i;clearTimeout(i),i=setTimeout(o,e),n&&s.apply(this,r)}},getScrollbarWidth(){let s=document.createElement("div");s.style.visibility="hidden",s.style.width="100px",s.style.msOverflowStyle="scrollbar",document.body.appendChild(s);let e=s.offsetWidth;s.style.overflow="scroll";let t=document.createElement("div");t.style.width="100%",s.appendChild(t);let i=t.offsetWidth;return s.parentNode.removeChild(s),e-i},findIntegerFraction(s,e=100){let t=Number.MAX_VALUE,i=0,r=0,o=1,n=1;for(let a=0;a<e;a++){let l=o/n-s;if(l<0)o++;else if(l>0)n++;else return new ec(o,n);let u=Math.abs(o/n-s);u<t&&(t=u,i=o,r=n)}return new ec(i,r)},toFixed(s,e=2){let t=s.toFixed(e);return parseFloat(t)},capitalize(s){return s.charAt(0).toUpperCase()+s.slice(1)},flipObject(s){let e={};for(let t in s)e[s[t]]=t;return e},Browser:Ow},yt=dF});var Qh,pe,XX,va,be,Br,ep,W,ae,YX,JX,$X,we=_(()=>{ki();Jn();yo();ii();Sw();Iw();({Base64:Qh}=X),{Color:pe}=X,{ColorMatrix:XX}=X.Math,{EventEmitter:va}=X,be=X.Utils,{RenderType:Br}=X,{ImageFormat:ep}=X,W=X,{Vector2:ae}=X.Math,{Rectangle:YX}=X.Math,{Range:JX}=X.Math,$X=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Wn()});var on,Rs,tp=_(()=>{we();on=class{constructor(e,t,i=!1){this._ui=e,this._options=t,this._categoriesById={},this._filtersByIdentifier={identity:W.Operations.FilterOperation.Filters.IdentityFilter},this._categories=yt.wrapFiltersInCategories(Vi.DEFAULTS.FILTERS.slice(0),on.CATEGORY_ITEMS_PROPERTY),this._customAssetsAllowed=i||e.getEditor().getSDK()._l.areCustomAssetsAllowed(),this._customAssetsAllowed&&this._options.categories&&(this._options.categories=yt.wrapFiltersInCategories(this._options.categories,on.CATEGORY_ITEMS_PROPERTY)),this._initCategories()}instantiateFilterWithIdentifier(e){let t={value:this._ui._options.crossOrigin,cors:!0},i=this.getFilterByIdentifier(e);if(!i)return Promise.reject(new Error(`Unknown filter with identifier \`${e}\`!`));if(!(i.prototype instanceof W.Operations.FilterOperation.Filter)){let{lutImage:r,resolution:o,horizontalTileCount:n,verticalTileCount:a}=i,{lightColor:l,darkColor:u}=i;if(l&&u)return l=pe.fromHex(l),u=pe.fromHex(u),Promise.resolve(new W.Operations.FilterOperation.Filters.DuoToneFilter({lightColor:l,darkColor:u}));let c;this._ui.getPreloader&&(c=this._ui.getPreloader().getAsset(r));let p;return c?p=Promise.resolve(c):p=mt.loadImage(this._ui.getAssetPath(r),t),p.then(()=>mt.loadImage(this._ui.getAssetPath(r),t).then(m=>new W.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:m,resolution:o,horizontalTileCount:n,verticalTileCount:a})))}return Promise.resolve(new i)}_initCategories(){if(this._customAssetsAllowed&&this._options.categories&&(this._options.replaceCategories?this._categories=yt.wrapFiltersInCategories(this._options.categories,on.CATEGORY_ITEMS_PROPERTY):this._categories=yt.mergeCategories(this._categories,this._options.categories,on.CATEGORY_ITEMS_PROPERTY)),this._customAssetsAllowed&&this._options.availableFilters){let t=[];this._categories.forEach(i=>{let r=i.filters.filter(o=>this._options.availableFilters.indexOf(o.identifier)!==-1);r.length>0&&t.push({identifier:i.identifier,defaultName:i.defaultName,filters:r})}),this._categories=t}let e={identifier:"all",defaultName:"All",visible:!1,filters:this._categories.length<=0?[]:this._categories.map(t=>t.filters).reduce((t,i)=>t.concat(i))};this._categories.unshift(e),this._categoriesById.all=e,this._categories.forEach(t=>{this._categoriesById[t.identifier]=t}),e.filters.forEach(t=>{this._filtersByIdentifier[t.identifier]=t})}getFiltersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown filter category '${e}'`);return this._categoriesById[e].filters}getItemsByCategory(e){return this.getFiltersForCategory(e)}getFilterByIdentifier(e){return this._filtersByIdentifier[e]}getCategories(){return this._categories}getCategoryByIdentifier(e){return this._categoriesById[e]}},Rs=on;P(Rs,"CATEGORY_ITEMS_PROPERTY","filters")});var wa,Pw=_(()=>{ki();wa=class extends J{};wa.prototype.availableOptions={fontFamily:{type:h.STRING,required:!0},variations:{type:h.ARRAY,required:!0}}});var hF,Es,ip=_(()=>{ki();hF={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"},Es=class extends J{getLabel(){let e=hF[this._options.fontWeight];switch(this._options.fontStyle){case"italic":e+=" Italic";break}return e}};Es.prototype.availableOptions={identifier:{type:h.STRING,required:!0},fontFamily:{type:h.STRING,required:!0},fontWeight:{type:h.ALL,default:400},fontStyle:{type:h.STRING,default:"normal"},textMetrics:{type:h.OBJECT,default:null},provider:{type:h.STRING,available:["google","file"]},filePath:{type:h.STRING},default:{type:h.BOOLEAN,default:!1},font:{type:h.OBJECT}}});var ut,Lr=_(()=>{we();Pw();ip();ii();um();ut=class{constructor(e,t){this._ui=e,this._options=t,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}_initFonts(){let{fonts:e,replaceFonts:t,availableVariations:i,isTextDesign:r}=this._options,o=!0;o=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed(),e&&o&&e.forEach(({variations:l},u)=>{l&&l.forEach((c,p)=>{if(Bi[c.identifier]){let m=ho(c.identifier,!0);e[u].variations[p].identifier=m;let{fontFamily:d}=Re.DEFAULTS.FONTS.find(f=>f.variations.some(b=>b.identifier===m));e[u].fontFamily=d}})});let n=r?Re.DEFAULTS.TEXT_DESIGN_FONTS:Re.DEFAULTS.FONTS;o&&(t?n=e:n=n.concat(e||[]));let a;n=n.map(l=>{let{fontFamily:u}=l,{variations:c}=l;if(o&&i&&(c=c.filter(m=>i.indexOf(m.identifier)!==-1)),c.length===0)return null;let p=new wa({fontFamily:u});return c=c.map(m=>{let d=new Es(m);return d.setFontFamily(u),d.setFont(p),m.default&&!a&&(a=d),d.getTextMetrics()==null&&B.warn(`Missing font metrics for ${d.getIdentifier()}. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.`),this._variationsByIdentifier[d.getIdentifier()]=d,d}),p.setVariations(c),this._fontsByFontFamily[u]=p,p}).filter(l=>l),a||([a]=n[0].getVariations()),this._defaultVariation=a,this._fonts=n}getFonts(){return this._fonts}getFontByFontFamily(e){return this._fontsByFontFamily[e]}getVariationByIdentifier(e){return this._variationsByIdentifier[ho(e)]}getVariationsByIdentifier(){return D({},this._variationsByIdentifier)}getDefaultVariation(){return this._defaultVariation}}});var Yt,nn=_(()=>{we();Yt=class{constructor(e,t={}){this._ui=e,this._options=t,this._defaultLayouts=W.Operations.SpriteOperation.TextDesignSprite.Layouts,this._legacyLayouts=W.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts,this._layouts=[],this._init()}_init(){let{availableLayouts:e}=this._options,t=D(D({},this._defaultLayouts),this._legacyLayouts);this._layouts=Object.keys(t).map(i=>({identifier:t[i].identifier,layout:t[i]})),e&&(e.push(...Object.values(this._legacyLayouts).map(i=>i.identifier)),this._layouts=this._layouts.filter(i=>e.indexOf(i.identifier)>=0))}getLayoutByIdentifier(e){let t=be.Array.find(this._layouts,i=>i.identifier===e);return t&&t.layout}getLayouts(){return[...this._layouts]}getDefaultLayout(){return this.getLayouts()[0]}}});var pF,fF,Ca,Mw=_(()=>{ip();pF=30,fF="abcdefghijklmnopqrstuvwxzy",Ca=class{constructor(e){this._fontVariation=e||new Es({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}_createRuler(){this._ruler=document.createElement("div"),this._ruler.innerText=fF,document.body.appendChild(this._ruler),this._setRulerStyle()}_setRulerStyle(){this._ruler.style.cssText=`
      position: absolute;
      top: -9999px;
      left: -9999px;
      opacity: 0;
      display: inline-block;
      font: ${this._fontVariation.getFontStyle()} ${this._fontVariation.getFontWeight()} ${pF}px ${this._fontVariation.getFontFamily()};
    `}setFontVariation(e){this._fontVariation=e,this._setRulerStyle()}getWidth(){return this._ruler?this._ruler.offsetWidth:-1}dispose(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)}}});var Bw,gF,_F,sc,Lw=_(()=>{Mw();Bw=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Wn(),gF=50,_F=5e3,sc=class{constructor(e){this._fontVariation=e,this._defaultFontRuler=new Ca,this._customFontRuler=new Ca(this._fontVariation)}observe(){let e=Bw();return new Promise((t,i)=>{let r=window.setInterval(()=>{if(this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth())return window.clearInterval(r),t();if(Bw()-e>=_F){let n=new Error(`Failed to load font ${this._fontVariation.getFontFamily()}.`);return n.font=this._fontVariation,i(n)}},gF)})}dispose(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()}}});var an,rp=_(()=>{ki();Lw();an=class{constructor(e){this._ui=e,this._fonts=[],this._observers=[]}add(e){this._fonts.push(e)}load(){return this._fonts.length===0?Promise.resolve():(this._observers=[],this._fonts.forEach(e=>{this._observers.push(new sc(e))}),E.executePromises(this._observers.map(e=>e.observe())))}dispose(){this._observers.forEach(e=>e.dispose())}}});var oc,zw=_(()=>{rp();oc=class extends an{load(){return Promise.resolve()}}});var yF,nc,Nw=_(()=>{rp();yF={italic:"i"},nc=class extends an{load(){return this._fonts.length&&this._addStylesheetTag(),super.load()}_addStylesheetTag(){let e=this._getFamiliesString(),t=document.createElement("link");t.rel="stylesheet",t.href=`https://fonts.googleapis.com/css?family=${e}`,document.getElementsByTagName("head")[0].appendChild(t)}_getFamiliesString(){let e={};this._fonts.forEach(i=>{let r=i.getFontFamily(),o=i.getFontStyle(),n=i.getFontWeight();e[r]=e[r]||[],typeof n!="undefined"?e[r].push(`${n}${yF[o]||""}`):e[r].push(400)});let t=[];for(let i in e){let r=e[i],o=r.length?`:${r.join(",")}`:"",n=i.replace(" ","+")+o;t.push(n)}return t.join("|")}}});var zr,ac=_(()=>{zw();Nw();zr=class{constructor(e,t){this._ui=e,this._fonts=t,this._loadedFonts=[]}setFonts(e){this._fonts=e}needsToLoad(){for(let e=0;e<this._fonts.length;e++){let t;if(this._fonts[e].getVariations().forEach(i=>{t=t||i.getProvider()}),!!t)return!0}}fontLoaded(e){let t=e.getFontFamily();return this._loadedFonts.indexOf(t)!==-1}setFontLoaded(e){if(!this.fontLoaded(e)){let t=e.getFontFamily();this._loadedFonts.push(t)}}load(){let e=this._fonts,t={google:new nc(this._ui),file:new oc(this._ui)},i=()=>{for(let o in t)t[o].dispose()};e.filter(o=>!this.fontLoaded(o)).forEach(o=>{o.getVariations().forEach(n=>{let a=n.getProvider();if(!a)return;t[a].add(n)})});let r=[];for(let o in t)r.push(t[o].load());return Promise.all(r).then(()=>{i(),e.forEach(o=>{this.setFontLoaded(o)})}).catch(o=>{throw i(),o})}}});var lc,Uw=_(()=>{we();lc=class{constructor(e,t){this._ui=e,this._options=t,this._brushes=[],this._brushesById={},this._addBrushes(Re.DEFAULTS.BRUSHES);let{brushes:i,replaceBrushes:r,availableBrushes:o}=this._options;this._options.brushes&&this._addBrushes(i,r),o&&(this._brushes=this._brushes.filter(n=>o.indexOf(n.identifier)!==-1))}_addBrushes(e,t){t&&(this._brushes=[],this._brushesById={}),e.forEach(i=>{this._brushes.push(i),this._brushesById[i.identifier]=i})}getBrushByIdentifier(e){return this._brushesById[e]}getBrushes(){return this._brushes}getFirstBrush(){return this._brushes[0]}}});var Gw,Ww,Vw=_(()=>{Gw=class{constructor(){this._assetsByGroupId={}}addAsset(e,t,i=!1){this._assetsByGroupId[e]?i?this._assetsByGroupId[e].unshift(t):this._assetsByGroupId[e].push(t):this._assetsByGroupId[e]=[t]}setAssets(e,t){this._assetsByGroupId[e]=t}getAssets(e){return this._assetsByGroupId[e]=this._assetsByGroupId[e]||[],this._assetsByGroupId[e]}},Ww=Gw});var sp,Nr,uc=_(()=>{we();ki();Vw();Jn();vo();sp="imgly_sticker_custom",Nr=class{constructor(e,t,i){this._ui=e,this._options=t,this._dynamicAssetsLibrary=i||this._ui.getEditor().getDynamicAssetsLibrary()||new Ww,this._categoriesById={},this._categories=[],this._stickersById={},this._customStickerCanvas=E.createCanvas(),this.reload()}reload(){this._categoriesById={},this._categories=[],this._stickersById={};let e=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();this._addCategories(Vi.DEFAULTS.STICKER_CATEGORIES);let{categories:t,replaceCategories:i}=this._options;if(e&&this._options.categories?this._addCategories(t,i):(this._updateCategoriesMap(),this._updateAllCategory()),e){let r=this._dynamicAssetsLibrary.getAssets("sticker");if(r.length>0){let o=this._createCustomStickerCategory(r);this._addCategories([o],!1,!0)}}}loadExternal(e){return new Gt(e).load().then(i=>{this._addCategories(i.categories,this._options.replaceCategories)})}_addCategories(e,t=!1,i=!1){t?this._categories=e.slice(0):i?this._categories=this._mergeCategories(e,this._categories):this._categories=this._mergeCategories(this._categories,e),this._updateCategoriesMap(),this._updateAllCategory()}_mergeCategories(e,t){e=yt.cloneCategories(e,"stickers");for(let i of t){let r=!1;for(let o of e)if(i.identifier===o.identifier){for(let n of i.stickers){let a=!1;for(let l of o.stickers)if(n.identifier===l.identifier){Object.assign(l,n),a=!0;break}a||o.stickers.push(n)}r=!0;break}r||e.push(i)}return e}_updateCategoriesMap(){this._categoriesById={},this._categories.forEach(e=>{this._categoriesById[e.identifier]=e}),this._categories.forEach(e=>{e.stickers.forEach(t=>{this._stickersById[t.identifier]=t})}),typeof this._options.availableStickers!="undefined"&&this._options.availableStickers!==null&&(this._categories.forEach(e=>{e.identifier!==sp&&(e.stickers=e.stickers.filter(t=>this._options.availableStickers.indexOf(t.identifier)!==-1))}),this._categories=this._categories.filter(e=>e.stickers.length>0)),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(e=>e.stickers).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}renderStickerThumbnailFromImage(e){let t=this._customStickerCanvas,i=t.getContext("2d");i.save();let r=62,o=r/e.width,n=o*e.height;t.width=r,t.height=r,i.clearRect(0,0,e.width,e.height),i.translate(0,.5*(t.height-n)),i.scale(o,o),i.drawImage(e,0,0);let a=t.toDataURL("image/png");return i.restore(),{data:a,width:r,height:n}}addCustomStickerFromImage(e,t,i="none"){let r=g=>{let x=this._ui.getEditor().getSDK().getRenderer(),v=new ae(g.width,g.height),M=this._ui.getEditor().getMaxMegapixels()*1e6,w=x.getMaxDimensions(),k=v.x*v.y>M,q=w!==null&&(v.x>w||v.y>w);if(k){let Z=g.width/g.height,re=g.height/g.width;w=new ae(Math.sqrt(M*Z),Math.sqrt(M*re)).floor().max()}let j=v.clone();return(k||q)&&(v.x/v.y>1?(j.x=w,j.y=w/v.x*v.y):(j.x=w/v.y*v.x,j.y=w)),j},o=(g,C)=>{let x=g.x/g.y;return x>1?new ae(C,C/x):new ae(C*x,C)},n=e.src.substring(0,14)==="data:image/svg";e=this._ui.getEditor().getSDK().correctExifOrientation(e);let l=o(new ae(e.width,e.height),2048),u=n?l:r(e),c=this._customStickerCanvas,p=c.getContext("2d");p.save();let m=this.renderStickerThumbnailFromImage(e);n?(e.width>e.height?(c.width=2048,c.height=2048/e.width*e.height):(c.height=2048,c.width=2048/e.height*e.width),e.width=c.width,e.height=c.height):(c.width=u.x,c.height=u.y,p.scale(u.x/e.width,u.y/e.height)),p.drawImage(e,0,0,e.width,e.height);let d=c.toDataURL();p.restore();let f={identifier:E.generateUUID(),defaultName:t||"",tintMode:i,images:{mediaThumb:{uris:[m.data],rawData:!0,width:m.width,height:m.height},mediaBase:{uris:n?[d,e.src]:[d],rawData:!0,isSVG:n,width:u.x,height:u.y}}},b=this._dynamicAssetsLibrary;b.addAsset("sticker",f,!0);let y=b.getAssets("sticker");if(y.length===1){let g=this._createCustomStickerCategory(y);this._addCategories([g],!1,!0)}else this.getCategory(sp).stickers=y,this._updateAllCategory();this._updateCategoriesMap()}_createCustomStickerCategory(e){return{identifier:sp,defaultName:"Custom",metaData:{backgroundImage:e[e.length-1].images.mediaBase.uris[0],rawData:!0},stickers:e}}getStickersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown sticker category '${e}'`);return this._categoriesById[e].stickers}getStickerByIdentifier(e){return this._stickersById[e]}getCategories(e=!1){return e?[this._allCategory].concat(this._categories):this._categories}getCategory(e){return this._categoriesById[e]}static getURLForSticker(e,t="base"){let{images:i}=e,r=t==="base"&&i.mediaBase||i.mediaThumb,o=r.uris||[r.uri];if(!yt.Browser.getIEVersion()){let a=o.filter(l=>/\.svg$/i.test(l));return a.length?a[0]:o[0]}let n=o.filter(a=>!/\.svg$/i.test(a));return n.length?n[0]:o[0]}}});var jw,op,Ss,np=_(()=>{we();ac();Uw();tp();Lr();uc();jw=Ur(ol());typeof W.Operations.SpriteOperation!="undefined"&&(op=W.Operations.SpriteOperation.BrushSprite);Ss=class{constructor(e,t){this._editor=e,this._ui=this._editor.getUI(),this._data=t,this._filterManager=new Rs(this._ui,this._getOptions("filter")),this._stickerManager=new Nr(this._ui,this._getOptions("sticker")),this._brushManager=new lc(this._ui,this._getOptions("brush")),this._fontManager=new ut(this._ui,this._getOptions("text"))}_getOptions(e){let{controls:t}=this._editor,i={};t&&t.get(e)&&(i=t.get(e).defaultOptions);let r=this._editor.getOptions();return be.deepDefaults({},r.editor.controlsOptions[e]||{},i)}deserialize(){return this._validateVersion().then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_validateVersion(){return this._data.version!==this.constructor.version?Promise.reject(new Error(`Invalid version ${this._data.version}, expected ${this.constructor.version}`)):Promise.resolve()}_deserializeInputImage(){return new Promise((e,t)=>{let{data:i,type:r}=this._data.inputImage;if(i&&r){let o=new window.Image;o.addEventListener("load",()=>{this._editor.setImage(o),e()}),o.src=`data:${r};base64,${i}`}else e()})}_deserializeOperations(){return Ge(this,null,function*(){let{operations:e}=this._data;return(0,jw.default)(e,t=>Ge(this,null,function*(){return this._deserializeOperation(t)}))})}_deserializeOperation(e){switch(e.type){case"crop":return this._deserializeCropOperation(e);case"orientation":return this._deserializeOrientationOperation(e);case"filter":return this._deserializeFilterOperation(e);case"adjustments":return this._deserializeAdjustmentsOperation(e);case"sprite":return this._deserializeSpriteOperation(e);case"focus":return this._deserializeFocusOperation(e)}}_deserializeCropOperation(e){let{options:t}=e,{rotation:i}=t,r=ae.fromObject(t.start),o=ae.fromObject(t.end);i>Math.PI&&(i-=Math.PI*2);let n={start:r,end:o};typeof i!="undefined"&&(n.rotation=i);let a=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(a,n),a.set(n),Promise.resolve(a)}_deserializeOrientationOperation(e){let{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}_deserializeFilterOperation(e){let{options:t}=e;return this._filterManager.getFilterByIdentifier(t.name)?this._filterManager.instantiateFilterWithIdentifier(t.name).then(i=>{let r=this._editor.operations.getOrCreate("filter");return r.set({identifier:t.name,filter:i,intensity:t.intensity}),r}):(B.warn("Deserializer",`Unknown filter \`${t.name}\``),Promise.resolve())}_deserializeAdjustmentsOperation(e){let{AdjustmentsOperation:t}=W.Operations,{options:i}=e,r=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],o={};return r.forEach(n=>{if(typeof i[n]=="undefined")return;let{minValue:a,midValue:l,maxValue:u}=t.prototype.availableOptions[n],c=i[n];c=c<0?l+(l-a)*c:l+(u-l)*c,o[n]=c}),Promise.resolve(this._editor.operations.getOrCreate("adjustments",o))}_deserializeSpriteOperation(e){let{options:t}=e,i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();let r=t.sprites.map(o=>this._deserializeSprite(i,o)).filter(o=>o);return Promise.all(r).then(o=>(i.setSprites(o.filter(n=>n)),i))}_deserializeSprite(e,t){switch(t.type){case"sticker":return this._deserializeSticker(e,t);case"text":return this._deserializeText(e,t);case"brush":return this._deserializeBrush(e,t);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(e,t)}}_deserializeSticker(e,t){let{SpriteOperation:i}=W.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.name),n=this._stickerManager.getURLForSticker(o);return o?new Promise((a,l)=>{let u=new window.Image;u.addEventListener("load",()=>{let c=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:p,flipHorizontally:m,flipVertically:d}=r,f={identifier:r.name,image:u,position:ae.fromObject(r.position),dimensions:ae.fromObject(r.dimensions),rotation:p,flipHorizontally:m,flipVertically:d,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(b=>{typeof r.adjustments[b]!="undefined"&&(f.adjustments[b]=r.adjustments[b]+c[b].default)}),a(e.createSticker(f))}),u.crossOrigin=this._editor.getCrossOrigin(),u.src=this._editor.getUI().getAssetPath(n)}):(B.warn("Deserializer",`Unknown sticker '${r.name}'. Skipping sprite.`),Promise.resolve())}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:o,fontFamily:n,fontWeight:a,alignment:l,rotation:u,maxWidth:c,color:p,backgroundColor:m}=i,d=new zr(this._ui),f=this._fontManager.getFontByFontFamily(n);return f||(f=this._fontManager.getDefaultFont()),d.setFonts([f]),d.load().then(()=>{let b=e.createText({fontSize:r,lineHeight:o,fontFamily:n,fontWeight:a,alignment:l,rotation:u,maxWidth:c,text:i.text,color:pe.fromArray(p),backgroundColor:pe.fromArray(m),position:ae.fromObject(i.position)});return b._edited=!0,b})}_deserializeBrush(e,t){let{options:i}=t,{paths:r}=i,o=e.createBrush();return r.forEach(n=>{this._deserializeBrushPath(o,n)}),Promise.resolve(o)}_deserializeBrushPath(e,t){let{points:i}=t,r=this._createBrushForPath(t),o=e.createPath(r);o.setClosed(!0),i.forEach(n=>{o.addControlPoint(ae.fromObject(n))})}_createBrushForPath(e){let{color:t,size:i}=e,o={color:pe.fromArray(t),size:i},n=this._brushManager.getFirstBrush();if(n.prototype&&n.prototype instanceof op){let u=n;return new u(o)}let a=D({},n);delete a.image;class l extends op{}return l.identifier=n.identifier,new l(D(D({},a),o))}_deserializeFocusOperation(e){let{options:t}=e.options;switch(e.options.type){case"radial":{let{position:i,radius:r,gradientRadius:o,blurRadius:n}=t;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:ae.fromObject(i),radius:r,gradientRadius:o,blurRadius:n}))}case"linear":{let{start:i,end:r,size:o,gradientSize:n,blurRadius:a}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:ae.fromObject(i),end:ae.fromObject(r),size:o,gradientSize:n,blurRadius:a}))}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{r===e&&(t=!0),!t&&(i=r.getNewDimensions(i))}),i}};Ss.version="1.0.0"});var ln,Os,ap=_(()=>{we();ln=Math.PI*2,Os=class{constructor(e){this._editor=e,this._serializeOperations=this._serializeOperations.bind(this)}serialize(e={}){this._options=N(D({},e),{image:!0});let t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)}_serializeInputImage(e){let t=this._editor.getImage(),{width:i,height:r}=t;if(!this._options.image)return e.inputImage={width:i,height:r},Promise.resolve(e);let o=be.createCanvas();o.width=t.width,o.height=t.height,o.getContext("2d").drawImage(t,0,0);let a=o.toDataURL(ep.PNG);return e.inputImage={type:ep.PNG,data:a.replace(/^data:image\/(.*?);base64,/,""),width:i,height:r},Promise.resolve(e)}_serializeOperations(e){let t=[];return this._editor.operations.getStack().forEach(r=>{let o=this._serializeOperation(r,t);o&&t.push(o)}),e.operations=t.filter(r=>r),Promise.resolve(e)}_serializeOperation(e,t){switch(e.constructor.identifier){case"transform":return this._serializeTransformOperation(e);case"orientation":return this._serializeOrientationOperation(e);case"filter":return this._serializeFilterOperation(e);case"adjustments":return this._serializeAdjustmentsOperation(e);case"sprite":return this._serializeSpriteOperation(e,t);case"radial-focus":return this._serializeRadialFocusOperation(e);case"mirrored-focus":return this._serializeLinearFocusOperation(e);default:B.warn(`Unable to serialize operation of type ${e.constructor.identifier}`)}}_serializeTransformOperation(e){let t=e.serializeOptions(["start","end","rotation"],!0);return t.rotation=(t.rotation+ln)%ln,{type:"crop",options:t}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeFilterOperation(e){return e.getIdentifier()==="identity"?null:{type:"filter",options:{intensity:e.getIntensity(),name:e.getIdentifier()}}}_serializeAdjustmentsOperation(e){let{availableOptions:t}=e,i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],r={};return i.forEach(o=>{let n=t[o],a=e.getOption(o),{minValue:l,midValue:u,maxValue:c}=n;r[o]=a<=u?(a-l)/(u-l)-1:(a-u)/(c-u)}),{type:"adjustments",options:r}}_serializeSpriteOperation(e,t){let i=t.filter(n=>n.type==="sprite"),r,o=!0;if(i.length?(r=i.pop(),o=!1):r={type:"sprite",options:{sprites:[]}},e.getSprites().forEach(n=>{let a=null;n instanceof e.constructor.StickerSprite?a=this._serializeSticker(e,n):n instanceof e.constructor.TextSprite?a=this._serializeText(e,n):n instanceof e.constructor.BrushSprite?a=this._serializeBrush(e,n):n instanceof e.constructor.TextDesignSprite&&(a=this._serializeTextDesign&&this._serializeTextDesign(e,n)),a&&r.options.sprites.push(a)}),o)return r}_serializeSticker(e,t){let i=t.getAdjustments(),r=t.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);r.name=r.identifier,delete r.identifier,r.rotation=(r.rotation+ln)%ln;let o=i.availableOptions;return r.adjustments={brightness:i.getBrightness()-o.brightness.default,saturation:i.getSaturation()-o.saturation.default,contrast:i.getContrast()-o.contrast.default},{type:"sticker",options:r}}_serializeText(e,t){let i=t.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return i.rotation=(i.rotation+ln)%ln,{type:"text",options:i}}_serializeBrush(e,t){return{type:"brush",options:{paths:t.getPaths().map(i=>this._serializePath(i))}}}_serializePath(e){let t=e.getBrush().serializeOptions(["color","size"],!0);return t.points=e.getControlPoints().map(i=>i.getPosition().toObject()),t}_serializeRadialFocusOperation(e){return{type:"focus",options:{type:"radial",options:e.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}}_serializeLinearFocusOperation(e){return{type:"focus",options:{type:"linear",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{r===e&&(t=!0),!t&&(i=r.getNewDimensions(i))}),i}};Os.version="1.0.0"});var Hw={};Ne(Hw,{default:()=>cc});var cc,qw=_(()=>{np();ap();cc=class{constructor(e){this._editor=e}serialize(...e){return new Os(this._editor).serialize(...e)}deserialize(e){return new Ss(this._editor,e).deserialize()}};cc.version="1.0.0"});var As,lp=_(()=>{we();np();As=class extends Ss{_deserializeOperation(e){return e.type==="selective-blur"?this._deserializeSelectiveBlurOperation(e):super._deserializeOperation(e)}_deserializeCropOperation(e){let{options:t}=e,{rotation:i}=t,r=ae.fromObject(t.start),o=ae.fromObject(t.end),n=t.dimensions?ae.fromObject(t.dimensions):null;if(o.x-r.x<=0||o.y-r.y<=0)throw new Error(`A crop should not result in negative or zero dimensions - start: ${r} - end: ${o}`);i>Math.PI&&(i-=Math.PI*2);let a={start:r,end:o};typeof i!="undefined"&&(a.rotation=i);let l=this._editor.operations.getOrCreate("transform");if(!l)return Promise.resolve();if(this._editor.broadcastTransform(l,a),l.set(a),n){let u=o.clone().subtract(r),c=l.getInputDimensions(!1).multiply(u);l.setTextureScale(n.x/c.x)}return Promise.resolve(l)}};As.version="1.0.1"});var Kw,Is,up=_(()=>{ap();Kw=Math.PI*2,Is=class extends Os{_serializeTransformOperation(e){let t=e.serializeOptions(["start","end","rotation","textureScale"],!0);return t.rotation=(t.rotation+Kw)%Kw,t.textureScale!==1&&(t.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete t.textureScale,{type:"crop",options:t}}};Is.version="1.0.1"});var Xw={};Ne(Xw,{default:()=>mc});var mc,Yw=_(()=>{lp();up();mc=class{constructor(e){this._editor=e}serialize(...e){return new Is(this._editor).serialize(...e)}deserialize(e){return new As(this._editor,e).deserialize()}};mc.version="1.0.1"});var un,Da,Jw=_(()=>{yo();we();({OptionType:un}=W),Da=class extends W.Configurable{constructor(e,t={}){super(t);this._loaded=!1,this._loading=!1,this._ui=e,this._frame=W.Utils.deepClone(this._options)}load(){if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;let{imageGroups:e}=this._frame,t=[];return["top","left","right","bottom"].forEach(i=>{if(!(i in e))return;let r=e[i];["start","mid","end"].forEach(o=>{o in r&&t.push(this._loadPart(i,o))})}),Promise.all(t).then(()=>{this._loaded=!0,this._loading=!1}).catch(i=>{this._loaded=!1,this._loading=!1})}_loadPart(e,t){let{imageGroups:i}=this._frame,r=i[e][t],o=r;return typeof r!="string"&&"image"in r&&(o=r.image),mt.load(this._ui.getAssetPath(o)).then(n=>(typeof r!="string"?this._frame.imageGroups[e][t].image=n:this._frame.imageGroups[e][t]=n,n))}getFrame(){return this._frame}};Da.prototype.availableOptions={identifier:{type:un.STRING,required:!0},defaultName:{type:un.STRING},thumbnail:{type:un.STRING},tintable:{type:un.BOOLEAN,default:!1},layoutMode:{type:un.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:un.OBJECT,required:!0}}});var dc,$w=_(()=>{we();dc=class{constructor(e,t){this._ui=e,this._options=t,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(Vi.DEFAULTS.FRAME_CATEGORIES),this._customAssetsAllowed=e.getEditor().getSDK()._l.areCustomAssetsAllowed();let{categories:i,replaceCategories:r}=this._options;this._customAssetsAllowed&&this._options.categories?this._addCategories(i,r):this._updateAllCategory()}_addCategories(e,t=!1){t?this._categories=e.slice(0):this._categories=yt.mergeCategories(this._categories,e,"frames"),this._categoriesById={},this._categories.forEach(r=>{this._categoriesById[r.identifier]=r});let{availableFrames:i}=this._options;this._customAssetsAllowed&&i&&this._categories.forEach(r=>{r.frames=r.frames.filter(o=>i.indexOf(o.identifier)!==-1)}),this._categories.forEach(r=>{r.frames.forEach(o=>{this._framesById[o.identifier]=o})}),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(e=>e.frames).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}getFramesForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown frame category '${e}'`);return this._categoriesById[e].frames}getFrameByIdentifier(e){return this._framesById[e]}getCategories(){return this._categories}getCategory(e){return this._categoriesById[e]}}});var hc,Zw=_(()=>{we();hc=class{constructor(e,t){this._ui=e,this._options=t,this._overlays=Vi.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={};let i=e.getEditor().getSDK()._l.areCustomAssetsAllowed();i&&t.overlays&&(t.replaceOverlays?this._overlays=t.overlays:this._overlays=this._overlays.concat(t.overlays)),i&&t.availableOverlays&&(this._overlays=this._overlays.filter(r=>t.availableOverlays.indexOf(r.identifier)!==-1)),this._overlays.forEach(r=>{this._overlaysByIdentifier[r.identifier]=r})}getOverlays(){return this._overlays}getOverlayByIdentifier(e){return this._overlaysByIdentifier[e]}}});var Qi,cn,pc=_(()=>{we();({OverlayFilter:Qi}=W.Engine.Filters),cn={[Qi.BLEND_MODES.NORMAL]:"normal",[Qi.BLEND_MODES.OVERLAY]:"overlay",[Qi.BLEND_MODES.HARD_LIGHT]:"hard light",[Qi.BLEND_MODES.SOFT_LIGHT]:"soft light",[Qi.BLEND_MODES.MULTIPLY]:"multiply",[Qi.BLEND_MODES.DARKEN]:"darken",[Qi.BLEND_MODES.LIGHTEN]:"lighten",[Qi.BLEND_MODES.SCREEN]:"screen",[Qi.BLEND_MODES.COLOR_BURN]:"color burn"}});var bF,Ps,cp=_(()=>{we();ac();Jw();yo();$w();Zw();uc();lp();pc();bF=be.flipObject(cn),Ps=class extends As{constructor(...e){super(...e);this._frameManager=new dc(this._ui,this._getOptions("frame"));let t=this._getOptions("overlay");t&&(this._overlayManager=new hc(this._ui,t))}_deserializeSprite(e,t){return t.type==="frame"?this._deserializeFrame(e,t):t.type==="overlay"?this._deserializeOverlay(e,t):super._deserializeSprite(e,t)}_deserializeOperation(e){return e.type==="transform"?this._deserializeTransformOperation(e):super._deserializeOperation(e)}_deserializeOrientationOperation(e){if(this._data.meta&&this._data.meta.platform!=="html5")return super._deserializeOrientationOperation(e);let{rotation:t,flipHorizontally:i,flipVertically:r}=e.options,o=t===90&&!i&&!r;return o|=t===90&&i&&r,o|=t===270&&!i&&!r,o|=t===270&&i&&r,o&&(e.options.flipHorizontally=!e.options.flipHorizontally,e.options.flipVertically=!e.options.flipVertically),super._deserializeOrientationOperation(e)}_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;let i=be.Array.find(this._data.operations,r=>r.type==="orientation");if(i){let{options:r}=i,{rotation:o,flipHorizontally:n,flipVertically:a}=r;(o===90||o===270)&&(!n&&a||n&&!a)&&(n=!n,a=!a),t.rotate(r.rotation),n&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),a&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t})}_deserializeFrame(e,t){let{identifier:i}=t.options,r=this._frameManager.getFrameByIdentifier(i);if(!r)return B.warn("Deserializer",`Unknown frame \`${i}\`. Skipping frame.`),Promise.resolve();let o=new Da(this._ui,r);return o.load().then(()=>{this._editor.operations.getOrCreate("frame",{frame:o.getFrame()})})}_deserializeOverlay(e,t){let{blendMode:i,intensity:r,identifier:o}=t.options,n=this._overlayManager.getOverlayByIdentifier(o);if(!n)return B.warn("Deserializer",`Unknown overlay \`${o}\`. Skipping overlay.`),Promise.resolve();let a=this._editor.getUI().getAssetPath(n.image);return mt.load(a).then(l=>{this._editor.operations.getOrCreate("overlay",{alpha:r,identifier:o,blendMode:parseInt(bF[i||n.blendMode],10),image:l})})}_createBrushForPath(e){let t=super._createBrushForPath(e);return typeof e.hardness!="undefined"&&t.hasOption("hardness")&&t.setHardness(e.hardness),t}_deserializeSticker(e,t){let{SpriteOperation:i}=W.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.identifier),n=Nr.getURLForSticker(o,"base");if(!o)return B.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();let a=e.getInputDimensions(!1);return new Promise((l,u)=>{let c=new window.Image;c.addEventListener("load",()=>{let p=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:m,flipHorizontally:d,flipVertically:f}=r,b={identifier:r.identifier,image:c,position:ae.fromObject(r.position),dimensions:ae.fromObject(r.dimensions).multiply(a.min()),rotation:m,flipHorizontally:d,flipVertically:f,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(y=>{typeof r.adjustments[y]!="undefined"&&(b.adjustments[y]=r.adjustments[y]+p[y].default)}),typeof r.tintColor!="undefined"&&typeof o.tintMode!="undefined"&&(b.tintColor=pe.fromArray(r.tintColor),b.tintMode=o.tintMode),l(e.createSticker(b))}),c.crossOrigin=this._editor.getCrossOrigin(),c.src=this._editor.getUI().getAssetPath(n)})}_deserializeFilterOperation(e){let{options:t}=e;return this._filterManager.getFilterByIdentifier(t.identifier)?this._filterManager.instantiateFilterWithIdentifier(t.identifier).then(i=>{let r=this._editor.operations.getOrCreate("filter");if(!!r)return r.set({identifier:t.identifier,filter:i,intensity:t.intensity}),r}):(B.warn("Deserializer",`Unknown filter \`${t.identifier}\``),Promise.resolve())}_deserializeFocusOperation(e){let{options:t,type:i}=e.options;if(i!=="radial")return super._deserializeFocusOperation(e);let r=this._editor.getImage(),o=r.width/r.height,{start:n,end:a,gradientRadius:l,blurRadius:u}=t,c=ae.fromObject(a).subtract(ae.fromObject(n)).multiply(o,1).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:ae.fromObject(n),radius:c,gradientRadius:l,blurRadius:u}))}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:a,rotation:l,maxWidth:u,color:c,backgroundColor:p}=i,m=new zr(this._ui),d=this._fontManager.getVariationByIdentifier(n);return d?m.setFonts([d.getFont()]):d=this._fontManager.getDefaultFont(),m.load().then(()=>{let f=e.getInputDimensions(!1),b=u*f.min()/f.x,y=e.createText({fontSize:r,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),alignment:a,rotation:l,maxWidth:b,text:i.text,color:pe.fromArray(c),backgroundColor:pe.fromArray(p),position:ae.fromObject(i.position)});return y._edited=!0,y})}};Ps.version="2.0.0"});var Ms,mp=_(()=>{up();pc();Ms=class extends Is{_serializeSticker(e,t){let i=e.getInputDimensions(!1),r=super._serializeSticker(e,t);return t.getTintMode()!=="none"&&(r.options.tintColor=t.serializeOption("tintColor",!0)),r.options.dimensions=t.getDimensions().clone().divide(i.min()).toObject(),r.options.identifier=r.options.name,delete r.options.name,r}_serializePath(e){let t=super._serializePath(e),i=e.getBrush();return i.hasOption("hardness")&&(t.hardness=i.getOption("hardness")),t}_serializeOperation(e,t){return e.constructor.identifier==="frame"?(this._serializeFrameOperation(e,t),null):e.constructor.identifier==="overlay"?(this._serializeOverlayOperation(e,t),null):super._serializeOperation(e,t)}_serializeFrameOperation(e,t){let i=t.filter(o=>o.type==="sprite"),r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"frame",options:this._getFrameOptions(e)})}_serializeOverlayOperation(e,t){if(!e.getIdentifier())return;let i=t.filter(o=>o.type==="sprite"),r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"overlay",options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:cn[e.getBlendMode()]}})}_getFrameOptions(e){return{identifier:e.getFrame().identifier}}_serializeOrientationOperation(e){let t=super._serializeOrientationOperation(e);return(t.options.rotation===90||t.options.rotation===270)&&(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),t}_serializeTransformOperation(e){let{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();let r=t.get("orientation");e.rotate(-r.getRotation()),r.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),r.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1))}let i=super._serializeTransformOperation(e);return i.type="transform",i}_serializeText(e,t){let i=super._serializeText(e,t),r=e.getInputDimensions(!1);return i.options.fontIdentifier=t.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*r.x/r.min(),delete i.options.fontFamily,i}_serializeFilterOperation(e){let t=super._serializeFilterOperation(e);return t?(t.options.identifier=t.options.name,delete t.options.name,t):null}_serializeRadialFocusOperation(e){let t=super._serializeRadialFocusOperation(e),i=t.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,t}};Ms.version="2.0.0"});var Qw={};Ne(Qw,{default:()=>fc});var fc,eC=_(()=>{cp();mp();fc=class{constructor(e){this._editor=e}serialize(...e){return new Ms(this._editor).serialize(...e)}deserialize(e){return new Ps(this._editor,e).deserialize()}};fc.version="2.0.0"});var dp,Bs,hp=_(()=>{we();yo();Lr();uc();nn();cp();typeof W.Operations.SpriteOperation!="undefined"&&(dp=W.Operations.SpriteOperation.BrushSprite.Brush);Bs=class extends Ps{_deserializeSticker(e,t){let{SpriteOperation:i}=W.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.identifier);if(!o)return B.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();let{mediaBase:n}=o.images,a=Nr.getURLForSticker(o,"base"),l=n.rawData?n.uris[0]:this._editor.getUI().getAssetPath(a),u=e.getInputDimensions(!1);return mt.load(l).then(c=>{let p=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:m,flipHorizontally:d,flipVertically:f}=r,b={identifier:r.identifier,image:c,position:ae.fromObject(r.position),dimensions:ae.fromObject(r.dimensions).multiply(u.min()),rotation:m||0,flipHorizontally:d,flipVertically:f,resizeMode:o.resizeMode||"keepAspect",adjustments:{}};return typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(y=>{typeof r.adjustments[y]!="undefined"&&(b.adjustments[y]=r.adjustments[y]+p[y].default)}),typeof r.tintMode!="undefined"&&typeof r.tintColor!="undefined"?(b.tintColor=pe.fromArray(r.tintColor.rgba),b.tintMode=r.tintMode):typeof r.tintColor!="undefined"&&typeof o.tintMode!="undefined"&&(b.tintColor=pe.fromArray(r.tintColor.rgba),b.tintMode=o.tintMode),typeof r.alpha!="undefined"&&(b.alpha=r.alpha),e.createSticker(b)})}_deserializeTransformOperation(e){return super._deserializeTransformOperation(e).then(t=>{if(!!t)return t._ratio=null,t})}_deserializeInputImage(){let{data:e,type:t,uri:i}=this._data.image;return e&&t&&(i=`data:${t};base64,${e}`),i?mt.load(i).then(r=>{this._editor.setImage(r)}):Promise.resolve()}_deserializeAdjustmentsOperation(e){let{AdjustmentsOperation:t}=W.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;let{options:r}=e,o=["gamma","whites","blacks","temperature"],n={};return o.forEach(a=>{if(typeof r[a]=="undefined")return;let{minValue:l,midValue:u,maxValue:c}=t.prototype.availableOptions[a],p=r[a];p=p<0?u+(u-l)*p:u+(c-u)*p,n[a]=p}),i.set(n),i})}_deserializeFocusOperation(e){let{options:t}=e.options;switch(e.options.type){case"radial":return super._deserializeFocusOperation(e);case"linear":{let{start:i,end:r,blurRadius:o}=t;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:ae.fromObject(i),controlPoint2:ae.fromObject(r),blurRadius:o}))}case"mirrored":{let{start:i,end:r,size:o,gradientSize:n,blurRadius:a}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:ae.fromObject(i),end:ae.fromObject(r),size:o,gradientSize:n,blurRadius:a}))}case"gaussian":{let{blurRadius:i}=t;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:i}))}}}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:a,rotation:l,maxWidth:u,color:c,backgroundColor:p}=i,m=this._ui.getFontLoader(),d=this._fontManager.getVariationByIdentifier(n);return d?m.setFonts([d.getFont()]):d=this._fontManager.getDefaultVariation(),m.load().then(()=>{let f=e.getInputDimensions(!1),b=u*f.min()/f.x,y=e.createText({fontSize:r,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:a,rotation:l,maxWidth:b,text:i.text,color:pe.fromArray(c.rgba),backgroundColor:pe.fromArray(p.rgba),position:ae.fromObject(i.position)});return y._edited=!0,y})}_createBrushForPath(e){let{identifier:t,color:i,size:r,hardness:o}=e.brush,a={color:pe.fromArray(i.rgba),size:r};typeof o!="undefined"&&(a.hardness=o);let l=this._brushManager.getBrushByIdentifier(t);if(l||(l=this._brushManager.getFirstBrush()),l.prototype&&l.prototype instanceof dp){let p=l;return new p(a)}let u=D({},l);delete u.image;class c extends dp{}return c.identifier=l.identifier,new c(D(D({},u),a))}_deserializeFrame(e,t){return super._deserializeFrame(e,t).then(()=>{let i=this._editor.operations.get("frame"),{size:r,alpha:o,tintColor:n}=t.options,a={};typeof r!="undefined"&&(a.scale=r),typeof o!="undefined"&&(a.alpha=o),typeof n!="undefined"&&(a.tintColor=pe.fromArray(n.rgba)),i.set(a)})}_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:p,inverted:m}=i,{identifier:d}=i;d===W.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=W.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===W.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=W.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f=new Yt(this._ui,this._getOptions("textdesign")),b=new ut(this._ui,{fonts:Re.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:y}=e.constructor.TextDesignSprite,g=this._ui.getFontLoader(),C=f.getLayoutByIdentifier(d),x=new C;return g.setFonts(b.getFonts()),y.setFonts(D(D({},y.getFonts()),b.getVariationsByIdentifier())),g.load().then(()=>{let v=x.getImagePaths().map(M=>({path:M,fullPath:this._ui.getAssetPath(M),image:null}));return y.loadImages(v).then(()=>(x.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:pe.fromArray(u.rgba),width:c,seed:p,inverted:m,layout:x})))})}};Bs.version="3.0.0"});var Ls,pp=_(()=>{ki();Ls=class extends J{};Ls.prototype.availableOptions={identifier:{type:h.STRING,required:!0},defaultName:{type:h.STRING,required:!0},ratio:{type:h.ALL,required:!1,default:null},selected:{type:h.BOOLEAN,required:!1},dimensions:{type:h.VECTOR2,required:!1},lockDimensions:{type:h.BOOLEAN,required:!1,default:null},forceDimensions:{type:h.BOOLEAN,required:!1,default:null}}});var zs,fp=_(()=>{we();pp();mp();zs=class extends Ms{serialize(e={}){return super.serialize(e).then(t=>(t.meta={platform:"html5",version:this._editor.getSDK().version,createdAt:be.ISODateString(new Date)},t.image=t.inputImage,delete t.inputImage,t))}_serializeSticker(e,t){let i=super._serializeSticker(e,t);return i.options.alpha=t.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i}_serializeText(e,t){let i=super._serializeText(e,t);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i}_serializePath(e){let t=super._serializePath(e);delete t.hardness,delete t.size,delete t.color;let i=e.getBrush();t.brush=i.serializeOptions(["identifier","size","color"],!0),typeof t.brush.identifier=="undefined"&&delete t.brush.identifier,t.brush.color={rgba:t.brush.color};let r=i.getOption("hardness");return r!=="undefined"&&(t.brush.hardness=r),t}_serializeFrameOperation(e,t){super._serializeFrameOperation(e,t);let i=t.filter(o=>o.type==="sprite"),r;if(i.length){r=i.pop();let o=r.options.sprites.filter(l=>l.type==="frame")[0];e.getTintColor().equals(new pe(1,1,1,0))||(o.options.tintColor={rgba:e.serializeOption("tintColor",!0)});let a=e.serializeOptions(["scale","alpha"],!0);o.options=D(D({},o.options),a),o.options.size=o.options.scale,delete o.options.scale}}_serializeTransformOperation(e){let t=super._serializeTransformOperation(e);if(e._ratio){let i;e._ratio instanceof Ls?i=e._ratio.getIdentifier():i=e._ratio.identifier,t.options.meta={identifier:i}}return delete t.options.scale,t}_serializeAdjustmentsOperation(e){let t=super._serializeAdjustmentsOperation(e),i=["gamma","whites","blacks","temperature"],{availableOptions:r}=e,o={};return i.forEach(n=>{let a=r[n],l=e.getOption(n),{minValue:u,midValue:c,maxValue:p}=a;o[n]=l<=c?(l-u)/(c-u)-1:(l-c)/(p-c)}),t.options=D(D({},t.options),o),t}_serializeOperation(e,t){switch(e.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(e);case"linear-focus":return this._serializeLinearFocusOperation(e);case"blur":return this._serializeBlurOperation(e);default:return super._serializeOperation(e,t)}}_serializeMirroredFocusOperation(e){return{type:"focus",options:{type:"mirrored",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_serializeLinearFocusOperation(e){let t=e.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return t.start=t.controlPoint1,delete t.controlPoint1,t.end=t.controlPoint2,delete t.controlPoint2,{type:"focus",options:{type:"linear",options:t}}}_serializeBlurOperation(e){return{type:"focus",options:{type:"gaussian",options:e.serializeOptions(["blurRadius"],!0)}}}};zs.version="3.0.0"});var tC={};Ne(tC,{default:()=>gc});var gc,iC=_(()=>{hp();fp();gc=class{constructor(e){this._editor=e}serialize(...e){return new zs(this._editor).serialize(...e)}deserialize(e){return new Bs(this._editor,e).deserialize()}};gc.version="3.0.0"});var Ns,gp=_(()=>{we();Lr();nn();hp();Ns=class extends Bs{_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:p,inverted:m}=i,{identifier:d}=i;d===W.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=W.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===W.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=W.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f=new Yt(this._ui,this._getOptions("textdesign")),b=new ut(this._ui,{fonts:Re.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:y}=e.constructor.TextDesignSprite,g=this._ui.getFontLoader(),C=f.getLayoutByIdentifier(d),x=new C;return g.setFonts(b.getFonts()),y.setFonts(D(D({},y.getFonts()),b.getVariationsByIdentifier())),g.load().then(()=>{let v=x.getImagePaths().map(M=>({path:M,fullPath:this._ui.getAssetPath(M),image:null}));return y.loadImages(v).then(()=>(x.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:pe.fromArray(u.rgba),width:c,seed:p,inverted:m,layout:x})))})}};Ns.version="3.1.0"});var Us,_p=_(()=>{we();fp();Us=class extends zs{_serializeTextDesign(e,t){let i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],!0);i.color={rgba:i.color};let r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),{type:"textdesign",options:i}}};Us.version="3.1.0"});var rC={};Ne(rC,{default:()=>_c});var _c,sC=_(()=>{gp();_p();_c=class{constructor(e){this._editor=e}serialize(...e){return new Us(this._editor).serialize(...e)}deserialize(e){return new Ns(this._editor,e).deserialize()}};_c.version="3.1.0"});var Gs,yp=_(()=>{we();Lr();nn();gp();Gs=class extends Ns{_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:p,inverted:m}=i,{identifier:d}=i;d===W.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=W.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===W.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=W.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f="padding"in i?i.padding/c:-1,b=new Yt(this._ui,this._getOptions("textdesign")),y=new ut(this._ui,{fonts:Re.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=e.constructor.TextDesignSprite,C=this._ui.getFontLoader(),x=b.getLayoutByIdentifier(d),v=new x;return C.setFonts(y.getFonts()),g.setFonts(D(D({},g.getFonts()),y.getVariationsByIdentifier())),C.load().then(()=>{let M=v.getImagePaths().map(w=>({path:w,fullPath:this._ui.getAssetPath(w),image:null}));return g.loadImages(M).then(()=>(v.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:pe.fromArray(u.rgba),width:c,seed:p,inverted:m,layout:v,padding:f})))})}};Gs.version="3.2.0"});var Ws,bp=_(()=>{_p();Ws=class extends Us{_serializeTextDesign(e,t){let i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted","padding"],!0);i.color={rgba:i.color};let r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),i.padding*=i.width,{type:"textdesign",options:i}}};Ws.version="3.2.0"});var oC={};Ne(oC,{default:()=>yc});var yc,nC=_(()=>{yp();bp();yc=class{constructor(e){this._editor=e}serialize(...e){return new Ws(this._editor).serialize(...e)}deserialize(e){return new Gs(this._editor,e).deserialize()}};yc.version="3.2.0"});var Vs,xp=_(()=>{yp();Vs=class extends Gs{_deserializeOperation(e){return super._deserializeOperation(e)}_deserializeOrientationOperation(e){let{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}};Vs.version="3.4.0"});var js,vp=_(()=>{pc();bp();js=class extends Ws{_serializeOperation(e,t){switch(e.constructor.identifier){case"artfilter":return this._serializeStyle(e);default:return super._serializeOperation(e,t)}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeStyle(e){let{identifier:t,intensity:i,blendMode:r}=e.getOptions(),{tileEdgeLength:o,overlappingFactor:n}=e.getStyleTransferModel().getOptions();return{type:"artFilter",options:{identifier:t,intensity:i,blendMode:cn[r],tileEdgeLength:o,overlappingFactor:n}}}};js.version="3.4.0"});var aC={};Ne(aC,{default:()=>bc});var bc,lC=_(()=>{xp();vp();bc=class{constructor(e){this._editor=e}serialize(...e){return new js(this._editor).serialize(...e)}deserialize(e){return new Vs(this._editor,e).deserialize()}};bc.version="3.4.0"});var Hs,wp=_(()=>{we();Lr();nn();xp();Hs=class extends Vs{_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:p,inverted:m,identifier:d}=i,f="padding"in i?i.padding/c:-1,b=new Yt(this._ui,this._getOptions("textdesign")),y=new ut(this._ui,{fonts:Re.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=e.constructor.TextDesignSprite,C=this._ui.getFontLoader(),x=b.getLayoutByIdentifier(d),v=new x;return C.setFonts(y.getFonts()),g.setFonts(D(D({},g.getFonts()),y.getVariationsByIdentifier())),C.load().then(()=>{let M=v.getImagePaths().map(w=>({path:w,fullPath:this._ui.getAssetPath(w),image:null}));return g.loadImages(M).then(()=>(v.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:pe.fromArray(u.rgba),width:c,seed:p,inverted:m,layout:v,padding:f})))})}};Hs.version="3.5.0"});var qs,Cp=_(()=>{vp();qs=class extends js{};qs.version="3.5.0"});var uC={};Ne(uC,{default:()=>xc});var xc,cC=_(()=>{wp();Cp();xc=class{constructor(e){this._editor=e}serialize(...e){return new qs(this._editor).serialize(...e)}deserialize(e){return new Hs(this._editor,e).deserialize()}};xc.version="3.5.0"});var Ks,Dp=_(()=>{we();wp();Ks=class extends Hs{_deserializeAdjustmentsOperation(e){let{AdjustmentsOperation:t}=W.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;let{options:r}=e,o="sharpness",n={};if(typeof r[o]=="undefined")return;let{minValue:a,midValue:l,maxValue:u}=t.prototype.availableOptions[o],c=r[o];return c=c<0?l+(l-a)*c:l+(u-l)*c,n[o]=c,i.set(n),i})}};Ks.version="3.6.0"});var Xs,kp=_(()=>{Cp();Xs=class extends qs{_serializeAdjustmentsOperation(e){let t=super._serializeAdjustmentsOperation(e),i="sharpness",{availableOptions:r}=e,o={},n=r[i],a=e.getOption(i),{minValue:l,midValue:u,maxValue:c}=n;return o[i]=a<=u?(a-l)/(u-l)-1:(a-u)/(c-u),t.options=D(D({},t.options),o),t}};Xs.version="3.6.0"});var mC={};Ne(mC,{default:()=>vc});var vc,dC=_(()=>{Dp();kp();vc=class{constructor(e){this._editor=e}serialize(...e){return new Xs(this._editor).serialize(...e)}deserialize(e){return new Ks(this._editor,e).deserialize()}};vc.version="3.6.0"});var Ys,Tp=_(()=>{ki();Dp();Ys=class extends Ks{deserialize(){return this._validateVersion().then(()=>this._deserializeAssetLibrary()).then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_deserializeAssetLibrary(){return new Promise((e,t)=>{let i=this._data;if(!i.assetLibrary){e();return}let{assets:r}=i.assetLibrary,o=[];for(let n in r)o.push(this._deserializeCustomAssets(n,r[n]));return Promise.all(o).then(()=>{e()}).catch(n=>{console.error(n),t(n)})})}_deserializeCustomAssets(e,t){switch(e){case"stickers":return this._deserializeCustomStickerAssets(t);default:return Promise.reject(new Error(`Unknown asset type: ${e}`))}}_deserializeCustomStickerAssets(e){let t="none",i=this._editor.getOptions().editor;i&&i.controlsOptions&&i.controlsOptions.sticker&&(t=i.controlsOptions.sticker.customStickerTintMode||"none");let r=e.map(o=>new Promise((n,a)=>{let{identifier:l,raster:u}=o,c=o.svg!==void 0,p=`data:${u.type};base64,${u.data}`,m=new wt;m.onload=()=>{m=this._editor.getSDK().correctExifOrientation(m),m.toDataURL&&(p=m.toDataURL());let f={data:"",width:1,height:1};f=this._stickerManager.renderStickerThumbnailFromImage(m);let b={identifier:l,defaultName:o.name||"",tintMode:t,images:{mediaBase:{uris:[p],rawData:!0,isSVG:c,width:m.width,height:m.height},mediaThumb:{uris:[f.data],rawData:!0,width:f.width,height:f.height}}};if(c){let y=`data:image/svg+xml;base64,${o.svg.data}`;b.images.mediaBase.uris.push(y)}n(b)},m.onerror=()=>{a(new Error(`Invalid base64 data: ${p}`))},m.src=p}));return Promise.all(r).then(o=>{this._editor.getDynamicAssetsLibrary().setAssets("sticker",o),this._stickerManager.reload()})}};Ys.version="3.7.0"});var Js,Rp=_(()=>{kp();Js=class extends Xs{serialize(e={}){return super.serialize(e).then(t=>this._serializeAssetLibrary(t).then(i=>i))}_serializeAssetLibrary(e){if(!this._editor.getDynamicAssetsLibrary)return Promise.resolve(e);let t=this._editor.getDynamicAssetsLibrary(),i=this._serializeCustomStickerAssets(e,t);return i.length===0||(e.assetLibrary={assets:{stickers:i}}),Promise.resolve(e)}_serializeCustomStickerAssets(e,t){let i=t.getAssets("sticker");if(i.length===0)return[];let r=e.operations.filter(a=>a.type==="sprite").flatMap(a=>a.options.sprites).filter(a=>a.type==="sticker").map(a=>a.options.identifier),o={};return r.forEach(a=>{o[a]=!0}),i.filter(a=>o[a.identifier]).map(a=>{let{identifier:l,defaultName:u,images:c}=a,p=c.mediaBase.uris[0],{isSVG:m}=c.mediaBase,f=/^data:(image\/(jpeg|png));base64,(.*)$/g.exec(p),b=f[1],y=f[3],g={identifier:l,name:u,raster:{type:b,data:y}};return u&&(g.name=u),m&&(g.svg={data:c.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),g})}};Js.version="3.7.0"});var hC={};Ne(hC,{default:()=>wc});var wc,pC=_(()=>{Tp();Rp();wc=class{constructor(e){this._editor=e}serialize(...e){return new Js(this._editor).serialize(...e)}deserialize(e){return new Ys(this._editor,e).deserialize()}};wc.version="3.7.0"});var $s,Ep=_(()=>{Tp();$s=class extends Ys{};$s.version="3.8.0"});var Zs,Fp=_(()=>{Rp();Zs=class extends Js{_serializeSticker(e,t){let i=super._serializeSticker(e,t);return i.options.tintMode=t.getTintMode(),i}};Zs.version="3.8.0"});var fC={};Ne(fC,{default:()=>Cc});var Cc,gC=_(()=>{Ep();Fp();Cc=class{constructor(e){this._editor=e}serialize(...e){return new Zs(this._editor).serialize(...e)}deserialize(e){return new $s(this._editor,e).deserialize()}};Cc.version="3.8.0"});var ka,_C=_(()=>{we();Ep();ka=class extends $s{_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;let i=be.Array.find(this._data.operations,r=>r.type==="orientation");if(i){let{options:r}=i;t.rotate(r.rotation),r.flipHorizontally&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),r.flipVertically&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t._ratio=null,t})}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:a,rotation:l,maxWidth:u,color:c,backgroundColor:p}=i,m=this._ui.getFontLoader(),d=this._fontManager.getVariationByIdentifier(n);return d?m.setFonts([d.getFont()]):d=this._fontManager.getDefaultVariation(),m.load().then(()=>{let f=e.getInputDimensions(!1),b=f.min(),y=f.x,g=f.y,C=u*b/y,x=r*b/g,v=e.createText({fontSize:x,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:a,rotation:l,maxWidth:C,text:i.text,color:pe.fromArray(c.rgba),backgroundColor:pe.fromArray(p.rgba),position:ae.fromObject(i.position)});return v._edited=!0,v})}};ka.version="3.9.0"});var yC,Ta,bC=_(()=>{pp();Fp();yC=Math.PI*2,Ta=class extends Zs{_serializeTransformOperation(e){let{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();let o=t.get("orientation");o.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),o.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1)),e.rotate(-o.getRotation())}let i=e.serializeOptions(["start","end","rotation","textureScale"],!0);i.rotation=(i.rotation+yC)%yC,i.textureScale!==1&&(i.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete i.textureScale;let r={type:"transform",options:i};if(e._ratio){let o;e._ratio instanceof Ls?o=e._ratio.getIdentifier():o=e._ratio.identifier,r.options.meta={identifier:o}}return delete r.options.scale,r}_serializeText(e,t){let i=e.getInputDimensions(!1),r=super._serializeText(e,t);return r.options.fontSize=r.options.fontSize*i.y/i.min(),r}};Ta.version="3.9.0"});var xC={};Ne(xC,{default:()=>Dc});var Dc,vC=_(()=>{_C();bC();Dc=class{constructor(e){this._editor=e}serialize(...e){return new Ta(this._editor).serialize(...e)}deserialize(e){return new ka(this._editor,e).deserialize()}};Dc.version="3.9.0"});var AC="An invariant failed, however the error is obfuscated because this is an production build.",Ea=[];Object.freeze(Ea);var Hp={};Object.freeze(Hp);var IC={};function to(){return typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:IC}function Ft(){return++G.mobxGuid}function Te(s){throw sr(!1,s),"X"}function sr(s,e){if(!s)throw new Error("[mobx] "+(e||AC))}var qp=[];function Ti(s,e){return!1}function Pc(s){var e=!1;return function(){if(!e)return e=!0,s.apply(this,arguments)}}var Kp=function(){};function PC(s){var e=[];return s.forEach(function(t){e.indexOf(t)===-1&&e.push(t)}),e}function Mc(s){return s!==null&&typeof s=="object"}function io(s){if(s===null||typeof s!="object")return!1;var e=Object.getPrototypeOf(s);return e===Object.prototype||e===null}function MC(s){if(ro(s)||Ii(s))return s;if(Array.isArray(s))return new Map(s);if(io(s)){var e=new Map;for(var t in s)e.set(t,s[t]);return e}else return Te("Cannot convert to map from '"+s+"'")}function BC(s,e){for(var t=0;t<e.length;t++)Ri(s,e[t],s[e[t]])}function Ri(s,e,t){Object.defineProperty(s,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}function mn(s,e,t){Object.defineProperty(s,e,{enumerable:!1,writable:!1,configurable:!0,value:t})}function LC(s,e){}function or(s,e){var t="isMobX"+s;return e.prototype[t]=!0,function(i){return Mc(i)&&i[t]===!0}}function zC(s,e){return typeof s=="number"&&typeof e=="number"&&isNaN(s)&&isNaN(e)}function ro(s){return to().Map!==void 0&&s instanceof to().Map}function dn(s){return s instanceof Set}function Ei(s){for(var e=[];;){var t=s.next();if(t.done)break;e.push(t.value)}return e}function Xp(){return typeof Symbol=="function"&&Symbol.toPrimitive||"@@toPrimitive"}function Yp(s){return s===null?null:typeof s=="object"?""+s:s}function Jp(s,e){for(var t=s.next();!t.done;)e(t.value),t=s.next()}function $p(){return typeof Symbol=="function"&&Symbol.iterator||"@@iterator"}function Bc(s,e){mn(s,$p(),e)}function hn(s){return s[$p()]=NC,s}function Lc(){return typeof Symbol=="function"&&Symbol.toStringTag||"@@toStringTag"}function NC(){return this}var Fa=function(){function s(e){e===void 0&&(e="Atom@"+Ft()),this.name=e,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=_e.NOT_TRACKING}return s.prototype.onBecomeUnobserved=function(){},s.prototype.onBecomeObserved=function(){},s.prototype.reportObserved=function(){return pf(this)},s.prototype.reportChanged=function(){Si(),cD(this),Oi()},s.prototype.toString=function(){return this.name},s}(),zc=or("Atom",Fa);function Zp(s,e,t){e===void 0&&(e=Kp),t===void 0&&(t=Kp);var i=new Fa(s);return CD(i,e),vf(i,t),i}function Qp(s,e){return s===e}function UC(s,e){return Qc(s,e)}function GC(s,e){return Qc(s,e,1)}function WC(s,e){return zC(s,e)||Qp(s,e)}var Sa={identity:Qp,structural:UC,default:WC,shallow:GC};var Nc=function(s,e){return Nc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},Nc(s,e)};function ef(s,e){Nc(s,e);function t(){this.constructor=s}s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Be=function(){return Be=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Be.apply(this,arguments)};function Uc(s,e){var t=typeof Symbol=="function"&&s[Symbol.iterator];if(!t)return s;var i=t.call(s),r,o=[],n;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){n={error:a}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return o}function Gc(){for(var s=[],e=0;e<arguments.length;e++)s=s.concat(Uc(arguments[e]));return s}var VC={},jC={};function HC(s,e){var t=e?VC:jC;return t[s]||(t[s]={configurable:!0,enumerable:e,get:function(){return Gr(this),this[s]},set:function(i){Gr(this),this[s]=i}})}function Gr(s){if(s.__mobxDidRunLazyInitializers!==!0){var e=s.__mobxDecorators;if(e){Ri(s,"__mobxDidRunLazyInitializers",!0);for(var t in e){var i=e[t];i.propertyCreator(s,i.prop,i.descriptor,i.decoratorTarget,i.decoratorArguments)}}}}function tf(s,e){return function(){var i,r=function(n,a,l,u){if(u===!0)return e(n,a,l,n,i),null;if(!Object.prototype.hasOwnProperty.call(n,"__mobxDecorators")){var c=n.__mobxDecorators;Ri(n,"__mobxDecorators",Be({},c))}return n.__mobxDecorators[a]={prop:a,propertyCreator:e,descriptor:l,decoratorTarget:n,decoratorArguments:i},HC(a,s)};return qC(arguments)?(i=Ea,r.apply(null,arguments)):(i=Array.prototype.slice.call(arguments),r)}}function qC(s){return(s.length===2||s.length===3)&&typeof s[1]=="string"||s.length===4&&s[3]===!0}function pn(s,e,t){return Ga(s)?s:Array.isArray(s)?et.array(s,{name:t}):io(s)?et.object(s,void 0,{name:t}):ro(s)?et.map(s,{name:t}):dn(s)?et.set(s,{name:t}):s}function KC(s,e,t){return s==null||uo(s)||lo(s)||Ii(s)||cr(s)?s:Array.isArray(s)?et.array(s,{name:t,deep:!1}):io(s)?et.object(s,void 0,{name:t,deep:!1}):ro(s)?et.map(s,{name:t,deep:!1}):dn(s)?et.set(s,{name:t,deep:!1}):Te(!1)}function Oa(s){return s}function XC(s,e,t){return Qc(s,e)?e:s}function Aa(s){sr(s);var e=tf(!0,function(i,r,o,n,a){var l=o?o.initializer?o.initializer.call(i):o.value:void 0;UD(i,r,l,s)}),t=(typeof process!="undefined"&&process.env,e);return t.enhancer=s,t}var rf={deep:!0,name:void 0,defaultDecorator:void 0},YC={deep:!1,name:void 0,defaultDecorator:void 0};Object.freeze(rf);Object.freeze(YC);function so(s){return s==null?rf:typeof s=="string"?{name:s,deep:!0}:s}function Ia(s){return s.defaultDecorator?s.defaultDecorator.enhancer:s.deep===!1?Oa:pn}var Wc=Aa(pn),JC=Aa(KC),sf=Aa(Oa),$C=Aa(XC);function ZC(s,e,t){if(typeof arguments[1]=="string")return Wc.apply(null,arguments);if(Ga(s))return s;var i=io(s)?et.object(s,e,t):Array.isArray(s)?et.array(s,e):ro(s)?et.map(s,e):dn(s)?et.set(s,e):s;if(i!==s)return i;Te(!1)}var of={box:function(s,e){arguments.length>2&&Fi("box");var t=so(e);return new ar(s,Ia(t),t.name,!0,t.equals)},shallowBox:function(s,e){return arguments.length>2&&Fi("shallowBox"),Ti("observable.shallowBox","observable.box(value, { deep: false })"),et.box(s,{name:e,deep:!1})},array:function(s,e){arguments.length>2&&Fi("array");var t=so(e);return new ui(s,Ia(t),t.name)},shallowArray:function(s,e){return arguments.length>2&&Fi("shallowArray"),Ti("observable.shallowArray","observable.array(values, { deep: false })"),et.array(s,{name:e,deep:!1})},map:function(s,e){arguments.length>2&&Fi("map");var t=so(e);return new Wa(s,Ia(t),t.name)},shallowMap:function(s,e){return arguments.length>2&&Fi("shallowMap"),Ti("observable.shallowMap","observable.map(values, { deep: false })"),et.map(s,{name:e,deep:!1})},set:function(s,e){arguments.length>2&&Fi("set");var t=so(e);return new ja(s,Ia(t),t.name)},object:function(s,e,t){typeof arguments[1]=="string"&&Fi("object");var i=so(t);return DD({},s,e,i)},shallowObject:function(s,e){return typeof arguments[1]=="string"&&Fi("shallowObject"),Ti("observable.shallowObject","observable.object(values, {}, { deep: false })"),et.object(s,{},{name:e,deep:!1})},ref:sf,shallow:JC,deep:Wc,struct:$C},et=ZC;Object.keys(of).forEach(function(s){return et[s]=of[s]});function Fi(s){Te("Expected one or two arguments to observable."+s+". Did you accidentally try to use observable."+s+" as decorator?")}var Pa=tf(!1,function(s,e,t,i,r){var o=t.get,n=t.set,a=r[0]||{};GD(s,e,Be({get:o,set:n},a))}),QC=Pa({equals:Sa.structural}),eD=function(e,t,i){if(typeof t=="string"||e!==null&&typeof e=="object"&&arguments.length===1)return Pa.apply(null,arguments);var r=typeof t=="object"?t:{};return r.get=e,r.set=typeof t=="function"?t:r.set,r.name=r.name||e.name||"",new lr(r)};eD.struct=QC;var _e;(function(s){s[s.NOT_TRACKING=-1]="NOT_TRACKING",s[s.UP_TO_DATE=0]="UP_TO_DATE",s[s.POSSIBLY_STALE=1]="POSSIBLY_STALE",s[s.STALE=2]="STALE"})(_e||(_e={}));var Jt;(function(s){s[s.NONE=0]="NONE",s[s.LOG=1]="LOG",s[s.BREAK=2]="BREAK"})(Jt||(Jt={}));var Ma=function(){function s(e){this.cause=e}return s}();function fn(s){return s instanceof Ma}function Vc(s){switch(s.dependenciesState){case _e.UP_TO_DATE:return!1;case _e.NOT_TRACKING:case _e.STALE:return!0;case _e.POSSIBLY_STALE:{for(var e=Hc(!0),t=no(),i=s.observing,r=i.length,o=0;o<r;o++){var n=i[o];if(La(n)){if(G.disableErrorBoundaries)n.get();else try{n.get()}catch(a){return nr(t),gn(e),!0}if(s.dependenciesState===_e.STALE)return nr(t),gn(e),!0}}return lf(s),nr(t),gn(e),!1}}}function oo(s){var e=s.observers.length>0;G.computationDepth>0&&e&&Te(!1),!G.allowStateChanges&&(e||G.enforceActions==="strict")&&Te(!1)}function tD(s){}function nf(s,e,t){var i=Hc(!0);lf(s),s.newObserving=new Array(s.observing.length+100),s.unboundDepsCount=0,s.runId=++G.runId;var r=G.trackingDerivation;G.trackingDerivation=s;var o;if(G.disableErrorBoundaries===!0)o=e.call(t);else try{o=e.call(t)}catch(n){o=new Ma(n)}return G.trackingDerivation=r,rD(s),s.observing.length===0&&iD(s),gn(i),o}function iD(s){}function rD(s){for(var e=s.observing,t=s.observing=s.newObserving,i=_e.UP_TO_DATE,r=0,o=s.unboundDepsCount,n=0;n<o;n++){var a=t[n];a.diffValue===0&&(a.diffValue=1,r!==n&&(t[r]=a),r++),a.dependenciesState>i&&(i=a.dependenciesState)}for(t.length=r,s.newObserving=null,o=e.length;o--;){var a=e[o];a.diffValue===0&&df(a,s),a.diffValue=0}for(;r--;){var a=t[r];a.diffValue===1&&(a.diffValue=0,uD(a,s))}i!==_e.UP_TO_DATE&&(s.dependenciesState=i,s.onBecomeStale())}function jc(s){var e=s.observing;s.observing=[];for(var t=e.length;t--;)df(e[t],s);s.dependenciesState=_e.NOT_TRACKING}function af(s){var e=no(),t=s();return nr(e),t}function no(){var s=G.trackingDerivation;return G.trackingDerivation=null,s}function nr(s){G.trackingDerivation=s}function Hc(s){var e=G.allowStateReads;return G.allowStateReads=s,e}function gn(s){G.allowStateReads=s}function lf(s){if(s.dependenciesState!==_e.UP_TO_DATE){s.dependenciesState=_e.UP_TO_DATE;for(var e=s.observing,t=e.length;t--;)e[t].lowestObserverState=_e.UP_TO_DATE}}var Ba=0,sD=1,uf=Object.getOwnPropertyDescriptor(function(){},"name"),DF=uf&&uf.configurable;function Wr(s,e){var t=function(){return cf(s,e,this,arguments)};return t.isMobxAction=!0,t}function cf(s,e,t,i){var r=oD(s,t,i);try{return e.apply(t,i)}catch(o){throw r.error=o,o}finally{nD(r)}}function oD(s,e,t){var i=tt()&&!!s,r=0;if(i){r=Date.now();var o=t&&t.length||0,n=new Array(o);if(o>0)for(var a=0;a<o;a++)n[a]=t[a];$t({type:"action",name:s,object:e,arguments:n})}var l=no();Si();var u=_n(!0),c=Hc(!0),p={prevDerivation:l,prevAllowStateChanges:u,prevAllowStateReads:c,notifySpy:i,startTime:r,actionId:sD++,parentActionId:Ba};return Ba=p.actionId,p}function nD(s){Ba!==s.actionId&&Te("invalid action stack. did you forget to finish an action?"),Ba=s.parentActionId,s.error!==void 0&&(G.suppressReactionErrors=!0),yn(s.prevAllowStateChanges),gn(s.prevAllowStateReads),Oi(),nr(s.prevDerivation),s.notifySpy&&Zt({time:Date.now()-s.startTime}),G.suppressReactionErrors=!1}function kF(s,e){var t=_n(s),i;try{i=e()}finally{yn(t)}return i}function _n(s){var e=G.allowStateChanges;return G.allowStateChanges=s,e}function yn(s){G.allowStateChanges=s}var ar=function(s){ef(e,s);function e(t,i,r,o,n){r===void 0&&(r="ObservableValue@"+Ft()),o===void 0&&(o=!0),n===void 0&&(n=Sa.default);var a=s.call(this,r)||this;return a.enhancer=i,a.name=r,a.equals=n,a.hasUnreportedChange=!1,a.value=i(t,void 0,r),o&&tt()&&Vr({type:"create",name:a.name,newValue:""+a.value}),a}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.set=function(t){var i=this.value;if(t=this.prepareNewValue(t),t!==G.UNCHANGED){var r=tt();r&&$t({type:"update",name:this.name,newValue:t,oldValue:i}),this.setNewValue(t),r&&Zt()}},e.prototype.prepareNewValue=function(t){if(oo(this),ai(this)){var i=li(this,{object:this,type:"update",newValue:t});if(!i)return G.UNCHANGED;t=i.newValue}return t=this.enhancer(t,this.value,this.name),this.equals(this.value,t)?G.UNCHANGED:t},e.prototype.setNewValue=function(t){var i=this.value;this.value=t,this.reportChanged(),Qt(this)&&ei(this,{type:"update",object:this,newValue:t,oldValue:i})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(t){return bn(this,t)},e.prototype.observe=function(t,i){return i&&t({object:this,type:"update",newValue:this.value,oldValue:void 0}),xn(this,t)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.value+"]"},e.prototype.valueOf=function(){return Yp(this.get())},e}(Fa);ar.prototype[Xp()]=ar.prototype.valueOf;var aD=or("ObservableValue",ar),lr=function(){function s(e){this.dependenciesState=_e.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=_e.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Ft(),this.value=new Ma(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=Jt.NONE,sr(e.get,"missing option for computed: get"),this.derivation=e.get,this.name=e.name||"ComputedValue@"+Ft(),e.set&&(this.setter=Wr(this.name+"-setter",e.set)),this.equals=e.equals||(e.compareStructural||e.struct?Sa.structural:Sa.default),this.scope=e.context,this.requiresReaction=!!e.requiresReaction,this.keepAlive=!!e.keepAlive}return s.prototype.onBecomeStale=function(){dD(this)},s.prototype.onBecomeUnobserved=function(){},s.prototype.onBecomeObserved=function(){},s.prototype.get=function(){this.isComputing&&Te("Cycle detected in computation "+this.name+": "+this.derivation),G.inBatch===0&&this.observers.length===0&&!this.keepAlive?Vc(this)&&(this.warnAboutUntrackedRead(),Si(),this.value=this.computeValue(!1),Oi()):(pf(this),Vc(this)&&this.trackAndCompute()&&mD(this));var e=this.value;if(fn(e))throw e.cause;return e},s.prototype.peek=function(){var e=this.computeValue(!1);if(fn(e))throw e.cause;return e},s.prototype.set=function(e){if(this.setter){sr(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=!1}}else sr(!1,!1)},s.prototype.trackAndCompute=function(){tt()&&Vr({object:this.scope,type:"compute",name:this.name});var e=this.value,t=this.dependenciesState===_e.NOT_TRACKING,i=this.computeValue(!0),r=t||fn(e)||fn(i)||!this.equals(e,i);return r&&(this.value=i),r},s.prototype.computeValue=function(e){this.isComputing=!0,G.computationDepth++;var t;if(e)t=nf(this,this.derivation,this.scope);else if(G.disableErrorBoundaries===!0)t=this.derivation.call(this.scope);else try{t=this.derivation.call(this.scope)}catch(i){t=new Ma(i)}return G.computationDepth--,this.isComputing=!1,t},s.prototype.suspend=function(){this.keepAlive||(jc(this),this.value=void 0)},s.prototype.observe=function(e,t){var i=this,r=!0,o=void 0;return xD(function(){var n=i.get();if(!r||t){var a=no();e({type:"update",object:i,newValue:n,oldValue:o}),nr(a)}r=!1,o=n})},s.prototype.warnAboutUntrackedRead=function(){},s.prototype.toJSON=function(){return this.get()},s.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},s.prototype.valueOf=function(){return Yp(this.get())},s}();lr.prototype[Xp()]=lr.prototype.valueOf;var La=or("ComputedValue",lr);var za=function(){function s(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return s}(),Na=!0,mf=!1,G=function(){var s=to();return s.__mobxInstanceCount>0&&!s.__mobxGlobals&&(Na=!1),s.__mobxGlobals&&s.__mobxGlobals.version!==new za().version&&(Na=!1),Na?s.__mobxGlobals?(s.__mobxInstanceCount+=1,s.__mobxGlobals.UNCHANGED||(s.__mobxGlobals.UNCHANGED={}),s.__mobxGlobals):(s.__mobxInstanceCount=1,s.__mobxGlobals=new za):(setTimeout(function(){mf||Te("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new za)}();function lD(){(G.pendingReactions.length||G.inBatch||G.isRunningReactions)&&Te("isolateGlobalState should be called before MobX is running any reactions"),mf=!0,Na&&(--to().__mobxInstanceCount==0&&(to().__mobxGlobals=void 0),G=new za)}function uD(s,e){var t=s.observers.length;t&&(s.observersIndexes[e.__mapid]=t),s.observers[t]=e,s.lowestObserverState>e.dependenciesState&&(s.lowestObserverState=e.dependenciesState)}function df(s,e){if(s.observers.length===1)s.observers.length=0,hf(s);else{var t=s.observers,i=s.observersIndexes,r=t.pop();if(r!==e){var o=i[e.__mapid]||0;o?i[r.__mapid]=o:delete i[r.__mapid],t[o]=r}delete i[e.__mapid]}}function hf(s){s.isPendingUnobservation===!1&&(s.isPendingUnobservation=!0,G.pendingUnobservations.push(s))}function Si(){G.inBatch++}function Oi(){if(--G.inBatch==0){yf();for(var s=G.pendingUnobservations,e=0;e<s.length;e++){var t=s[e];t.isPendingUnobservation=!1,t.observers.length===0&&(t.isBeingObserved&&(t.isBeingObserved=!1,t.onBecomeUnobserved()),t instanceof lr&&t.suspend())}G.pendingUnobservations=[]}}function pf(s){tD(s);var e=G.trackingDerivation;return e!==null?(e.runId!==s.lastAccessedBy&&(s.lastAccessedBy=e.runId,e.newObserving[e.unboundDepsCount++]=s,s.isBeingObserved||(s.isBeingObserved=!0,s.onBecomeObserved())),!0):(s.observers.length===0&&G.inBatch>0&&hf(s),!1)}function cD(s){if(s.lowestObserverState!==_e.STALE){s.lowestObserverState=_e.STALE;for(var e=s.observers,t=e.length;t--;){var i=e[t];i.dependenciesState===_e.UP_TO_DATE&&(i.isTracing!==Jt.NONE&&ff(i,s),i.onBecomeStale()),i.dependenciesState=_e.STALE}}}function mD(s){if(s.lowestObserverState!==_e.STALE){s.lowestObserverState=_e.STALE;for(var e=s.observers,t=e.length;t--;){var i=e[t];i.dependenciesState===_e.POSSIBLY_STALE?i.dependenciesState=_e.STALE:i.dependenciesState===_e.UP_TO_DATE&&(s.lowestObserverState=_e.UP_TO_DATE)}}}function dD(s){if(s.lowestObserverState===_e.UP_TO_DATE){s.lowestObserverState=_e.POSSIBLY_STALE;for(var e=s.observers,t=e.length;t--;){var i=e[t];i.dependenciesState===_e.UP_TO_DATE&&(i.dependenciesState=_e.POSSIBLY_STALE,i.isTracing!==Jt.NONE&&ff(i,s),i.onBecomeStale())}}}function ff(s,e){if(console.log("[mobx.trace] '"+s.name+"' is invalidated due to a change in: '"+e.name+"'"),s.isTracing===Jt.BREAK){var t=[];gf(kD(s),t,1),new Function(`debugger;
/*
Tracing '`+s.name+`'

You are entering this break point because derivation '`+s.name+"' is being traced and '"+e.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(s instanceof lr?s.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+t.join(`
`)+`
*/
    `)()}}function gf(s,e,t){if(e.length>=1e3){e.push("(and many more)");return}e.push(""+new Array(t).join("	")+s.name),s.dependencies&&s.dependencies.forEach(function(i){return gf(i,e,t+1)})}var qc=function(){function s(e,t,i,r){e===void 0&&(e="Reaction@"+Ft()),r===void 0&&(r=!1),this.name=e,this.onInvalidate=t,this.errorHandler=i,this.requiresObservable=r,this.observing=[],this.newObserving=[],this.dependenciesState=_e.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Ft(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=Jt.NONE}return s.prototype.onBecomeStale=function(){this.schedule()},s.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,G.pendingReactions.push(this),yf())},s.prototype.isScheduled=function(){return this._isScheduled},s.prototype.runReaction=function(){if(!this.isDisposed){if(Si(),this._isScheduled=!1,Vc(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&tt()&&Vr({name:this.name,type:"scheduled-reaction"})}catch(e){this.reportExceptionInDerivation(e)}}Oi()}},s.prototype.track=function(e){Si();var t=tt(),i;t&&(i=Date.now(),$t({name:this.name,type:"reaction"})),this._isRunning=!0;var r=nf(this,e,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&jc(this),fn(r)&&this.reportExceptionInDerivation(r.cause),t&&Zt({time:Date.now()-i}),Oi()},s.prototype.reportExceptionInDerivation=function(e){var t=this;if(this.errorHandler){this.errorHandler(e,this);return}if(G.disableErrorBoundaries)throw e;var i="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";G.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(i,e),tt()&&Vr({type:"error",name:this.name,message:i,error:""+e}),G.globalReactionErrorHandlers.forEach(function(r){return r(e,t)})},s.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Si(),jc(this),Oi()))},s.prototype.getDisposer=function(){var e=this.dispose.bind(this);return e.$mobx=this,e},s.prototype.toString=function(){return"Reaction["+this.name+"]"},s.prototype.trace=function(e){e===void 0&&(e=!1),SD(this,e)},s}();var _f=100,Kc=function(s){return s()};function yf(){G.inBatch>0||G.isRunningReactions||Kc(hD)}function hD(){G.isRunningReactions=!0;for(var s=G.pendingReactions,e=0;s.length>0;){++e===_f&&(console.error("Reaction doesn't converge to a stable state after "+_f+" iterations."+(" Probably there is a cycle in the reactive function: "+s[0])),s.splice(0));for(var t=s.splice(0),i=0,r=t.length;i<r;i++)t[i].runReaction()}G.isRunningReactions=!1}var Ua=or("Reaction",qc);function pD(s){var e=Kc;Kc=function(t){return s(function(){return e(t)})}}function tt(){return!!G.spyListeners.length}function Vr(s){if(!!G.spyListeners.length)for(var e=G.spyListeners,t=0,i=e.length;t<i;t++)e[t](s)}function $t(s){var e=Be(Be({},s),{spyReportStart:!0});Vr(e)}var fD={spyReportEnd:!0};function Zt(s){Vr(s?Be(Be({},s),{spyReportEnd:!0}):fD)}function gD(s){return G.spyListeners.push(s),Pc(function(){G.spyListeners=G.spyListeners.filter(function(e){return e!==s})})}function _D(){Te(!1)}function bf(s){return function(e,t,i){if(i){if(i.value)return{value:Wr(s,i.value),enumerable:!1,configurable:!0,writable:!0};var r=i.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return Wr(s,r.call(this))}}}return yD(s).apply(this,arguments)}}function yD(s){return function(e,t,i){Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:function(){},set:function(r){Ri(this,t,xf(s,r))}})}}function bD(s,e,t,i){return i===!0?(Xc(s,e,t.value),null):t?{configurable:!0,enumerable:!1,get:function(){return Xc(this,e,t.value||t.initializer.call(this)),this[e]},set:_D}:{enumerable:!1,configurable:!0,set:function(r){Xc(this,e,r)},get:function(){}}}var xf=function(e,t,i,r){if(arguments.length===1&&typeof e=="function")return Wr(e.name||"<unnamed action>",e);if(arguments.length===2&&typeof t=="function")return Wr(e,t);if(arguments.length===1&&typeof e=="string")return bf(e);if(r===!0)e[t]=Wr(e.name||t,i.value);else return bf(t).apply(null,arguments)};xf.bound=bD;function TF(s,e){var t=typeof s=="string"?s:s.name||"<unnamed action>",i=typeof s=="function"?s:e;return cf(t,i,this,void 0)}function Xc(s,e,t){Ri(s,e,Wr(e,t.bind(s)))}function xD(s,e){e===void 0&&(e=Hp);var t=e&&e.name||s.name||"Autorun@"+Ft(),i=!e.scheduler&&!e.delay,r;if(i)r=new qc(t,function(){this.track(a)},e.onError,e.requiresObservable);else{var o=wD(e),n=!1;r=new qc(t,function(){n||(n=!0,o(function(){n=!1,r.isDisposed||r.track(a)}))},e.onError,e.requiresObservable)}function a(){s(r)}return r.schedule(),r.getDisposer()}var vD=function(s){return s()};function wD(s){return s.scheduler?s.scheduler:s.delay?function(e){return setTimeout(e,s.delay)}:vD}function CD(s,e,t){return wf("onBecomeObserved",s,e,t)}function vf(s,e,t){return wf("onBecomeUnobserved",s,e,t)}function wf(s,e,t,i){var r=typeof i=="function"?mr(e,t):mr(e),o=typeof i=="function"?i:t,n=r[s];return typeof n!="function"?Te(!1):(r[s]=function(){n.call(this),o.call(this)},function(){r[s]=n})}function RF(s){var e=s.enforceActions,t=s.computedRequiresReaction,i=s.computedConfigurable,r=s.disableErrorBoundaries,o=s.arrayBuffer,n=s.reactionScheduler,a=s.reactionRequiresObservable,l=s.observableRequiresReaction;if(s.isolateGlobalState===!0&&lD(),e!==void 0){(typeof e=="boolean"||e==="strict")&&Ti(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);var u=void 0;switch(e){case!0:case"observed":u=!0;break;case!1:case"never":u=!1;break;case"strict":case"always":u="strict";break;default:Te("Invalid value for 'enforceActions': '"+e+"', expected 'never', 'always' or 'observed'")}G.enforceActions=u,G.allowStateChanges=!(u===!0||u==="strict")}t!==void 0&&(G.computedRequiresReaction=!!t),a!==void 0&&(G.reactionRequiresObservable=!!a),l!==void 0&&(G.observableRequiresReaction=!!l,G.allowStateReads=!G.observableRequiresReaction),i!==void 0&&(G.computedConfigurable=!!i),r!==void 0&&(r===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),G.disableErrorBoundaries=!!r),typeof o=="number"&&$c(o),n&&pD(n)}function DD(s,e,t,i){if(!1&&t)for(var r in t);i=so(i);var o=i.defaultDecorator||(i.deep===!1?sf:Wc);Gr(s),Zc(s,i.name,o.enhancer),Si();try{for(var n=Object.getOwnPropertyNames(e),a=0,l=n.length;a<l;a++){var r=n[a],u=Object.getOwnPropertyDescriptor(e,r),c=t&&r in t?t[r]:u.get?Pa:o,p=c(s,r,u,!0);p&&Object.defineProperty(s,r,p)}}finally{Oi()}return s}function kD(s,e){return Cf(mr(s,e))}function Cf(s){var e={name:s.name};return s.observing&&s.observing.length>0&&(e.dependencies=PC(s.observing).map(Cf)),e}function TD(){this.message="FLOW_CANCELLED"}TD.prototype=Object.create(Error.prototype);function RD(s,e){if(s==null)return!1;if(e!==void 0){if(uo(s)){var t=s.$mobx;return t.values&&!!t.values[e]}return!1}return uo(s)||!!s.$mobx||zc(s)||Ua(s)||La(s)}function Ga(s){return arguments.length!==1&&Te(!1),RD(s)}function ED(s){return uo(s)?s.$mobx.getKeys():Ii(s)||cr(s)?Ei(s.keys()):lo(s)?s.map(function(e,t){return t}):Te(!1)}var FD={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function ao(s,e,t,i){return i.detectCycles&&s.set(e,t),t}function ur(s,e,t){if(!e.recurseEverything&&!Ga(s)||typeof s!="object")return s;if(s===null)return null;if(s instanceof Date)return s;if(aD(s))return ur(s.get(),e,t);Ga(s)&&ED(s);var i=e.detectCycles===!0;if(i&&s!==null&&t.has(s))return t.get(s);if(lo(s)||Array.isArray(s)){var r=ao(t,s,[],e),o=s.map(function(f){return ur(f,e,t)});r.length=o.length;for(var n=0,a=o.length;n<a;n++)r[n]=o[n];return r}if(cr(s)||Object.getPrototypeOf(s)===Set.prototype)if(e.exportMapsAsObjects===!1){var l=ao(t,s,new Set,e);return s.forEach(function(f){l.add(ur(f,e,t))}),l}else{var u=ao(t,s,[],e);return s.forEach(function(f){u.push(ur(f,e,t))}),u}if(Ii(s)||Object.getPrototypeOf(s)===Map.prototype)if(e.exportMapsAsObjects===!1){var c=ao(t,s,new Map,e);return s.forEach(function(f,b){c.set(b,ur(f,e,t))}),c}else{var p=ao(t,s,{},e);return s.forEach(function(f,b){p[b]=ur(f,e,t)}),p}var m=ao(t,s,{},e);for(var d in s)m[d]=ur(s[d],e,t);return m}function Df(s,e){typeof e=="boolean"&&(e={detectCycles:e}),e||(e=FD),e.detectCycles=e.detectCycles===void 0?e.recurseEverything===!0:e.detectCycles===!0;var t;return e.detectCycles&&(t=new Map),ur(s,e,t)}function SD(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];var t=!1;typeof s[s.length-1]=="boolean"&&(t=s.pop());var i=OD(s);if(!i)return Te(!1);i.isTracing===Jt.NONE&&console.log("[mobx.trace] '"+i.name+"' tracing enabled"),i.isTracing=t?Jt.BREAK:Jt.LOG}function OD(s){switch(s.length){case 0:return G.trackingDerivation;case 1:return mr(s[0]);case 2:return mr(s[0],s[1])}}function Ai(s,e){e===void 0&&(e=void 0),Si();try{return s.apply(e)}finally{Oi()}}function ai(s){return s.interceptors!==void 0&&s.interceptors.length>0}function bn(s,e){var t=s.interceptors||(s.interceptors=[]);return t.push(e),Pc(function(){var i=t.indexOf(e);i!==-1&&t.splice(i,1)})}function li(s,e){var t=no();try{var i=s.interceptors;if(i)for(var r=0,o=i.length;r<o&&(e=i[r](e),sr(!e||e.type,"Intercept handlers should return nothing or a change object"),!!e);r++);return e}finally{nr(t)}}function Qt(s){return s.changeListeners!==void 0&&s.changeListeners.length>0}function xn(s,e){var t=s.changeListeners||(s.changeListeners=[]);return t.push(e),Pc(function(){var i=t.indexOf(e);i!==-1&&t.splice(i,1)})}function ei(s,e){var t=no(),i=s.changeListeners;if(!!i){i=i.slice();for(var r=0,o=i.length;r<o;r++)i[r](e);nr(t)}}var AD=1e4,ID=function(){var s=!1,e={};return Object.defineProperty(e,"0",{set:function(){s=!0}}),Object.create(e)["0"]=1,s===!1}(),Yc=0,Jc=function(){function s(){}return s}();function PD(s,e){typeof Object.setPrototypeOf!="undefined"?Object.setPrototypeOf(s.prototype,e):typeof s.prototype.__proto__!="undefined"?s.prototype.__proto__=e:s.prototype=e}PD(Jc,Array.prototype);Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(s){Object.defineProperty(Jc.prototype,s,{configurable:!0,writable:!0,value:Array.prototype[s]})});var kf=function(){function s(e,t,i,r){this.array=i,this.owned=r,this.values=[],this.lastKnownLength=0,this.atom=new Fa(e||"ObservableArray@"+Ft()),this.enhancer=function(o,n){return t(o,n,e+"[..]")}}return s.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},s.prototype.dehanceValues=function(e){return this.dehancer!==void 0&&e.length>0?e.map(this.dehancer):e},s.prototype.intercept=function(e){return bn(this,e)},s.prototype.observe=function(e,t){return t===void 0&&(t=!1),t&&e({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),xn(this,e)},s.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},s.prototype.setArrayLength=function(e){if(typeof e!="number"||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e!==t)if(e>t){for(var i=new Array(e-t),r=0;r<e-t;r++)i[r]=void 0;this.spliceWithArray(t,0,i)}else this.spliceWithArray(e,t-e)},s.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=t,t>0&&e+t+1>Yc&&$c(e+t+1)},s.prototype.spliceWithArray=function(e,t,i){var r=this;oo(this.atom);var o=this.values.length;if(e===void 0?e=0:e>o?e=o:e<0&&(e=Math.max(0,o+e)),arguments.length===1?t=o-e:t==null?t=0:t=Math.max(0,Math.min(t,o-e)),i===void 0&&(i=Ea),ai(this)){var n=li(this,{object:this.array,type:"splice",index:e,removedCount:t,added:i});if(!n)return Ea;t=n.removedCount,i=n.added}i=i.length===0?i:i.map(function(u){return r.enhancer(u,void 0)});var a=i.length-t;this.updateArrayLength(o,a);var l=this.spliceItemsIntoValues(e,t,i);return(t!==0||i.length!==0)&&this.notifyArraySplice(e,i,l),this.dehanceValues(l)},s.prototype.spliceItemsIntoValues=function(e,t,i){var r;if(i.length<AD)return(r=this.values).splice.apply(r,Gc([e,t],i));var o=this.values.slice(e,e+t);return this.values=this.values.slice(0,e).concat(i,this.values.slice(e+t)),o},s.prototype.notifyArrayChildUpdate=function(e,t,i){var r=!this.owned&&tt(),o=Qt(this),n=o||r?{object:this.array,type:"update",index:e,newValue:t,oldValue:i}:null;r&&$t(Be(Be({},n),{name:this.atom.name})),this.atom.reportChanged(),o&&ei(this,n),r&&Zt()},s.prototype.notifyArraySplice=function(e,t,i){var r=!this.owned&&tt(),o=Qt(this),n=o||r?{object:this.array,type:"splice",index:e,removed:i,added:t,removedCount:i.length,addedCount:t.length}:null;r&&$t(Be(Be({},n),{name:this.atom.name})),this.atom.reportChanged(),o&&ei(this,n),r&&Zt()},s}(),ui=function(s){ef(e,s);function e(t,i,r,o){r===void 0&&(r="ObservableArray@"+Ft()),o===void 0&&(o=!1);var n=s.call(this)||this,a=new kf(r,i,n,o);if(mn(n,"$mobx",a),t&&t.length){var l=_n(!0);n.spliceWithArray(0,0,t),yn(l)}return ID&&Object.defineProperty(a.array,"0",MD),n}return e.prototype.intercept=function(t){return this.$mobx.intercept(t)},e.prototype.observe=function(t,i){return i===void 0&&(i=!1),this.$mobx.observe(t,i)},e.prototype.clear=function(){return this.splice(0)},e.prototype.concat=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),t.map(function(r){return lo(r)?r.peek():r}))},e.prototype.replace=function(t){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,t)},e.prototype.toJS=function(){return this.slice()},e.prototype.toJSON=function(){return this.toJS()},e.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},e.prototype.find=function(t,i,r){r===void 0&&(r=0),arguments.length===3&&Ti("The array.find fromIndex argument to find will not be supported anymore in the next major");var o=this.findIndex.apply(this,arguments);return o===-1?void 0:this.get(o)},e.prototype.findIndex=function(t,i,r){r===void 0&&(r=0),arguments.length===3&&Ti("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var o=this.peek(),n=o.length,a=r;a<n;a++)if(t.call(i,o[a],a,this))return a;return-1},e.prototype.splice=function(t,i){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(t);case 2:return this.$mobx.spliceWithArray(t,i)}return this.$mobx.spliceWithArray(t,i,r)},e.prototype.spliceWithArray=function(t,i,r){return this.$mobx.spliceWithArray(t,i,r)},e.prototype.push=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=this.$mobx;return r.spliceWithArray(r.values.length,0,t),r.values.length},e.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},e.prototype.shift=function(){return this.splice(0,1)[0]},e.prototype.unshift=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=this.$mobx;return r.spliceWithArray(0,0,t),r.values.length},e.prototype.reverse=function(){var t=this.slice();return t.reverse.apply(t,arguments)},e.prototype.sort=function(t){var i=this.slice();return i.sort.apply(i,arguments)},e.prototype.remove=function(t){var i=this.$mobx.dehanceValues(this.$mobx.values).indexOf(t);return i>-1?(this.splice(i,1),!0):!1},e.prototype.move=function(t,i){Ti("observableArray.move is deprecated, use .slice() & .replace() instead");function r(a){if(a<0)throw new Error("[mobx.array] Index out of bounds: "+a+" is negative");var l=this.$mobx.values.length;if(a>=l)throw new Error("[mobx.array] Index out of bounds: "+a+" is not smaller than "+l)}if(r.call(this,t),r.call(this,i),t!==i){var o=this.$mobx.values,n;t<i?n=Gc(o.slice(0,t),o.slice(t+1,i+1),[o[t]],o.slice(i+1)):n=Gc(o.slice(0,i),[o[t]],o.slice(i,t),o.slice(t+1)),this.replace(n)}},e.prototype.get=function(t){var i=this.$mobx;if(i){if(t<i.values.length)return i.atom.reportObserved(),i.dehanceValue(i.values[t]);console.warn("[mobx.array] Attempt to read an array index ("+t+") that is out of bounds ("+i.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},e.prototype.set=function(t,i){var r=this.$mobx,o=r.values;if(t<o.length){oo(r.atom);var n=o[t];if(ai(r)){var a=li(r,{type:"update",object:this,index:t,newValue:i});if(!a)return;i=a.newValue}i=r.enhancer(i,n);var l=i!==n;l&&(o[t]=i,r.notifyArrayChildUpdate(t,i,n))}else if(t===o.length)r.spliceWithArray(t,0,[i]);else throw new Error("[mobx.array] Index out of bounds, "+t+" is larger than "+o.length)},e}(Jc);Bc(ui.prototype,function(){this.$mobx.atom.reportObserved();var s=this,e=0;return hn({next:function(){return e<s.length?{value:s[e++],done:!1}:{done:!0,value:void 0}}})});Object.defineProperty(ui.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(s){this.$mobx.setArrayLength(s)}});Ri(ui.prototype,Lc(),"Array");["indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(s){var e=Array.prototype[s];sr(typeof e=="function","Base function not defined on Array prototype: '"+s+"'"),Ri(ui.prototype,s,function(){return e.apply(this.peek(),arguments)})});["every","filter","forEach","map","some"].forEach(function(s){var e=Array.prototype[s];sr(typeof e=="function","Base function not defined on Array prototype: '"+s+"'"),Ri(ui.prototype,s,function(t,i){var r=this,o=this.$mobx;o.atom.reportObserved();var n=o.dehanceValues(o.values);return n[s](function(a,l){return t.call(i,a,l,r)},i)})});["reduce","reduceRight"].forEach(function(s){Ri(ui.prototype,s,function(){var e=this,t=this.$mobx;t.atom.reportObserved();var i=arguments[0];return arguments[0]=function(r,o,n){return o=t.dehanceValue(o),i(r,o,n,e)},t.values[s].apply(t.values,arguments)})});BC(ui.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var MD=Tf(0);function Tf(s){return{enumerable:!1,configurable:!1,get:function(){return this.get(s)},set:function(e){this.set(s,e)}}}function BD(s){Object.defineProperty(ui.prototype,""+s,Tf(s))}function $c(s){for(var e=Yc;e<s;e++)BD(e);Yc=s}$c(1e3);var LD=or("ObservableArrayAdministration",kf);function lo(s){return Mc(s)&&LD(s.$mobx)}var zD={},Wa=function(){function s(e,t,i){if(t===void 0&&(t=pn),i===void 0&&(i="ObservableMap@"+Ft()),this.enhancer=t,this.name=i,this.$mobx=zD,this._keysAtom=Zp(this.name+".keys()"),typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(e)}return s.prototype._has=function(e){return this._data.has(e)},s.prototype.has=function(e){var t=this;if(!G.trackingDerivation)return this._has(e);var i=this._hasMap.get(e);if(!i){var r=i=new ar(this._has(e),Oa,this.name+"."+Va(e)+"?",!1);this._hasMap.set(e,r),vf(r,function(){return t._hasMap.delete(e)})}return i.get()},s.prototype.set=function(e,t){var i=this._has(e);if(ai(this)){var r=li(this,{type:i?"update":"add",object:this,newValue:t,name:e});if(!r)return this;t=r.newValue}return i?this._updateValue(e,t):this._addValue(e,t),this},s.prototype.delete=function(e){var t=this;if(oo(this._keysAtom),ai(this)){var i=li(this,{type:"delete",object:this,name:e});if(!i)return!1}if(this._has(e)){var r=tt(),o=Qt(this),i=o||r?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;return r&&$t(Be(Be({},i),{name:this.name,key:e})),Ai(function(){t._keysAtom.reportChanged(),t._updateHasMapEntry(e,!1);var a=t._data.get(e);a.setNewValue(void 0),t._data.delete(e)}),o&&ei(this,i),r&&Zt(),!0}return!1},s.prototype._updateHasMapEntry=function(e,t){var i=this._hasMap.get(e);i&&i.setNewValue(t)},s.prototype._updateValue=function(e,t){var i=this._data.get(e);if(t=i.prepareNewValue(t),t!==G.UNCHANGED){var r=tt(),o=Qt(this),n=o||r?{type:"update",object:this,oldValue:i.value,name:e,newValue:t}:null;r&&$t(Be(Be({},n),{name:this.name,key:e})),i.setNewValue(t),o&&ei(this,n),r&&Zt()}},s.prototype._addValue=function(e,t){var i=this;oo(this._keysAtom),Ai(function(){var a=new ar(t,i.enhancer,i.name+"."+Va(e),!1);i._data.set(e,a),t=a.value,i._updateHasMapEntry(e,!0),i._keysAtom.reportChanged()});var r=tt(),o=Qt(this),n=o||r?{type:"add",object:this,name:e,newValue:t}:null;r&&$t(Be(Be({},n),{name:this.name,key:e})),o&&ei(this,n),r&&Zt()},s.prototype.get=function(e){return this.has(e)?this.dehanceValue(this._data.get(e).get()):this.dehanceValue(void 0)},s.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},s.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},s.prototype.values=function(){var e=this,t=this.keys();return hn({next:function(){var i=t.next(),r=i.done,o=i.value;return{done:r,value:r?void 0:e.get(o)}}})},s.prototype.entries=function(){var e=this,t=this.keys();return hn({next:function(){var i=t.next(),r=i.done,o=i.value;return{done:r,value:r?void 0:[o,e.get(o)]}}})},s.prototype.forEach=function(e,t){var i=this;this._keysAtom.reportObserved(),this._data.forEach(function(r,o){return e.call(t,i.get(o),o,i)})},s.prototype.merge=function(e){var t=this;return Ii(e)&&(e=e.toJS()),Ai(function(){var i=_n(!0);try{io(e)?Object.keys(e).forEach(function(r){return t.set(r,e[r])}):Array.isArray(e)?e.forEach(function(r){var o=Uc(r,2),n=o[0],a=o[1];return t.set(n,a)}):ro(e)?e.constructor!==Map?Te("Cannot initialize from classes that inherit from Map: "+e.constructor.name):e.forEach(function(r,o){return t.set(o,r)}):e!=null&&Te("Cannot initialize map from "+e)}finally{yn(i)}}),this},s.prototype.clear=function(){var e=this;Ai(function(){af(function(){e._data.forEach(function(t,i){return e.delete(i)})})})},s.prototype.replace=function(e){var t=this;return Ai(function(){var i=MC(e),r=new Map,o=!1;if(Jp(t._data.keys(),function(c){if(!i.has(c)){var p=t.delete(c);if(p)o=!0;else{var m=t._data.get(c);r.set(c,m)}}}),Jp(i.entries(),function(c){var p=Uc(c,2),m=p[0],d=p[1],f=t._data.has(m);if(t.set(m,d),t._data.has(m)){var b=t._data.get(m);r.set(m,b),f||(o=!0)}}),!o)if(t._data.size!==r.size)t._keysAtom.reportChanged();else for(var n=t._data.keys(),a=r.keys(),l=n.next(),u=a.next();!l.done;){if(l.value!==u.value){t._keysAtom.reportChanged();break}l=n.next(),u=a.next()}t._data=r}),this},Object.defineProperty(s.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),s.prototype.toPOJO=function(){var e=this,t={};return this.forEach(function(i,r){return t[typeof r=="symbol"?r:Va(r)]=e.get(r)}),t},s.prototype.toJS=function(){return new Map(this)},s.prototype.toJSON=function(){return this.toPOJO()},s.prototype.toString=function(){var e=this;return this.name+"[{ "+Ei(this.keys()).map(function(t){return Va(t)+": "+(""+e.get(t))}).join(", ")+" }]"},s.prototype.observe=function(e,t){return xn(this,e)},s.prototype.intercept=function(e){return bn(this,e)},s}();function Va(s){return s&&s.toString?s.toString():new String(s).toString()}Bc(Wa.prototype,function(){return this.entries()});mn(Wa.prototype,Lc(),"Map");var Ii=or("ObservableMap",Wa),ND={},ja=function(){function s(e,t,i){if(t===void 0&&(t=pn),i===void 0&&(i="ObservableSet@"+Ft()),this.name=i,this.$mobx=ND,this._data=new Set,this._atom=Zp(this.name),typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(r,o){return t(r,o,i)},e&&this.replace(e)}return s.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},s.prototype.clear=function(){var e=this;Ai(function(){af(function(){e._data.forEach(function(t){e.delete(t)})})})},s.prototype.forEach=function(e,t){var i=this;this._atom.reportObserved(),this._data.forEach(function(r){e.call(t,r,r,i)})},Object.defineProperty(s.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),s.prototype.add=function(e){var t=this;if(oo(this._atom),ai(this)){var i=li(this,{type:"add",object:this,newValue:e});if(!i)return this}if(!this.has(e)){Ai(function(){t._data.add(t.enhancer(e,void 0)),t._atom.reportChanged()});var r=tt(),o=Qt(this),i=o||r?{type:"add",object:this,newValue:e}:null;o&&ei(this,i)}return this},s.prototype.delete=function(e){var t=this;if(ai(this)){var i=li(this,{type:"delete",object:this,oldValue:e});if(!i)return!1}if(this.has(e)){var r=tt(),o=Qt(this),i=o||r?{type:"delete",object:this,oldValue:e}:null;return Ai(function(){t._atom.reportChanged(),t._data.delete(e)}),o&&ei(this,i),!0}return!1},s.prototype.has=function(e){return this._atom.reportObserved(),this._data.has(this.dehanceValue(e))},s.prototype.entries=function(){var e=0,t=Ei(this.keys()),i=Ei(this.values());return hn({next:function(){var r=e;return e+=1,r<i.length?{value:[t[r],i[r]],done:!1}:{done:!0}}})},s.prototype.keys=function(){return this.values()},s.prototype.values=function(){this._atom.reportObserved();var e=this,t=0,i;return this._data.values!==void 0?i=Ei(this._data.values()):(i=[],this._data.forEach(function(r){return i.push(r)})),hn({next:function(){return t<i.length?{value:e.dehanceValue(i[t++]),done:!1}:{done:!0}}})},s.prototype.replace=function(e){var t=this;return cr(e)&&(e=e.toJS()),Ai(function(){var i=_n(!0);try{Array.isArray(e)?(t.clear(),e.forEach(function(r){return t.add(r)})):dn(e)?(t.clear(),e.forEach(function(r){return t.add(r)})):e!=null&&Te("Cannot initialize set from "+e)}finally{yn(i)}}),this},s.prototype.observe=function(e,t){return xn(this,e)},s.prototype.intercept=function(e){return bn(this,e)},s.prototype.toJS=function(){return new Set(this)},s.prototype.toString=function(){return this.name+"[ "+Ei(this.keys()).join(", ")+" ]"},s}();Bc(ja.prototype,function(){return this.values()});mn(ja.prototype,Lc(),"Set");var cr=or("ObservableSet",ja),Rf=function(){function s(e,t,i){this.target=e,this.name=t,this.defaultEnhancer=i,this.values={}}return s.prototype.read=function(e,t){if(!(this.target!==e&&(this.illegalAccess(e,t),!this.values[t])))return this.values[t].get()},s.prototype.write=function(e,t,i){var r=this.target;r!==e&&this.illegalAccess(e,t);var o=this.values[t];if(o instanceof lr){o.set(i);return}if(ai(this)){var n=li(this,{type:"update",object:r,name:t,newValue:i});if(!n)return;i=n.newValue}if(i=o.prepareNewValue(i),i!==G.UNCHANGED){var a=Qt(this),l=tt(),n=a||l?{type:"update",object:r,oldValue:o.value,name:t,newValue:i}:null;l&&$t(Be(Be({},n),{name:this.name,key:t})),o.setNewValue(i),a&&ei(this,n),l&&Zt()}},s.prototype.remove=function(e){if(!!this.values[e]){var t=this.target;if(ai(this)){var i=li(this,{object:t,name:e,type:"remove"});if(!i)return}try{Si();var r=Qt(this),o=tt(),n=this.values[e].get();this.keys&&this.keys.remove(e),delete this.values[e],delete this.target[e];var i=r||o?{type:"remove",object:t,oldValue:n,name:e}:null;o&&$t(Be(Be({},i),{name:this.name,key:e})),r&&ei(this,i),o&&Zt()}finally{Oi()}}},s.prototype.illegalAccess=function(e,t){console.warn("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},s.prototype.observe=function(e,t){return xn(this,e)},s.prototype.intercept=function(e){return bn(this,e)},s.prototype.getKeys=function(){var e=this;return this.keys===void 0&&(this.keys=new ui(Object.keys(this.values).filter(function(t){return e.values[t]instanceof ar}),Oa,"keys("+this.name+")",!0)),this.keys.slice()},s}();function Zc(s,e,t){e===void 0&&(e=""),t===void 0&&(t=pn);var i=s.$mobx;return i||(io(s)||(e=(s.constructor.name||"ObservableObject")+"@"+Ft()),e||(e="ObservableObject@"+Ft()),i=new Rf(s,e,t),mn(s,"$mobx",i),i)}function UD(s,e,t,i){var r=Zc(s);if(LC(s,e),ai(r)){var o=li(r,{object:s,name:e,type:"add",newValue:t});if(!o)return;t=o.newValue}var n=r.values[e]=new ar(t,i,r.name+"."+e,!1);t=n.value,Object.defineProperty(s,e,WD(e)),r.keys&&r.keys.push(e),jD(r,s,e,t)}function GD(s,e,t){var i=Zc(s);t.name=i.name+"."+e,t.context=s,i.values[e]=new lr(t),Object.defineProperty(s,e,VD(e))}var Ef=Object.create(null),Ff=Object.create(null);function WD(s){return Ef[s]||(Ef[s]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,s)},set:function(e){this.$mobx.write(this,s,e)}})}function Sf(s){var e=s.$mobx;return e||(Gr(s),s.$mobx)}function VD(s){return Ff[s]||(Ff[s]={configurable:G.computedConfigurable,enumerable:!1,get:function(){return Sf(this).read(this,s)},set:function(e){Sf(this).write(this,s,e)}})}function jD(s,e,t,i){var r=Qt(s),o=tt(),n=r||o?{type:"add",object:e,name:t,newValue:i}:null;o&&$t(Be(Be({},n),{name:s.name,key:t})),r&&ei(s,n),o&&Zt()}var HD=or("ObservableObjectAdministration",Rf);function uo(s){return Mc(s)?(Gr(s),HD(s.$mobx)):!1}function mr(s,e){if(typeof s=="object"&&s!==null){if(lo(s))return e!==void 0&&Te(!1),s.$mobx.atom;if(cr(s))return s.$mobx;if(Ii(s)){var t=s;if(e===void 0)return t._keysAtom;var i=t._data.get(e)||t._hasMap.get(e);return i||Te(!1),i}if(Gr(s),e&&!s.$mobx&&s[e],uo(s)){if(!e)return Te(!1);var i=s.$mobx.values[e];return i||Te(!1),i}if(zc(s)||La(s)||Ua(s))return s}else if(typeof s=="function"&&Ua(s.$mobx))return s.$mobx;return Te(!1)}function Of(s,e){if(s||Te("Expecting some object"),e!==void 0)return Of(mr(s,e));if(zc(s)||La(s)||Ua(s)||Ii(s)||cr(s))return s;if(Gr(s),s.$mobx)return s.$mobx;Te(!1)}function qD(s,e){var t;return e!==void 0?t=mr(s,e):uo(s)||Ii(s)||cr(s)?t=Of(s):t=mr(s),t.name}var Af=Object.prototype.toString;function Qc(s,e,t){return t===void 0&&(t=-1),em(s,e,t)}function em(s,e,t,i,r){if(s===e)return s!==0||1/s==1/e;if(s==null||e==null)return!1;if(s!==s)return e!==e;var o=typeof s;if(o!=="function"&&o!=="object"&&typeof e!="object")return!1;s=If(s),e=If(e);var n=Af.call(s);if(n!==Af.call(e))return!1;switch(n){case"[object RegExp]":case"[object String]":return""+s==""+e;case"[object Number]":return+s!=+s?+e!=+e:+s==0?1/+s==1/e:+s==+e;case"[object Date]":case"[object Boolean]":return+s==+e;case"[object Symbol]":return typeof Symbol!="undefined"&&Symbol.valueOf.call(s)===Symbol.valueOf.call(e)}var a=n==="[object Array]";if(!a){if(typeof s!="object"||typeof e!="object")return!1;var l=s.constructor,u=e.constructor;if(l!==u&&!(typeof l=="function"&&l instanceof l&&typeof u=="function"&&u instanceof u)&&"constructor"in s&&"constructor"in e)return!1}if(t===0)return!1;t<0&&(t=-1),i=i||[],r=r||[];for(var c=i.length;c--;)if(i[c]===s)return r[c]===e;if(i.push(s),r.push(e),a){if(c=s.length,c!==e.length)return!1;for(;c--;)if(!em(s[c],e[c],t-1,i,r))return!1}else{var p=Object.keys(s),m=void 0;if(c=p.length,Object.keys(e).length!==c)return!1;for(;c--;)if(m=p[c],!(KD(e,m)&&em(s[m],e[m],t-1,i,r)))return!1}return i.pop(),r.pop(),!0}function If(s){return lo(s)?s.peek():ro(s)||Ii(s)||dn(s)||cr(s)?Ei(s.entries()):s}function KD(s,e){return Object.prototype.hasOwnProperty.call(s,e)}try{}catch(s){tm=to(),typeof process=="undefined"&&(tm.process={}),tm.process.env={}}var tm;(function(){function s(){}if(s.name!=="testCodeMinification"&&!1)var e})();var XD="$mobx";typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:gD,extras:{getDebugName:qD},$mobx:XD});function FF(s){return!Object.prototype.hasOwnProperty.call(s,"name")}function SF(s){return!Object.prototype.hasOwnProperty.call(s,"name")}var Je;(function(p){p.UNDO="undo",p.REDO="redo",p.DELETE="delete",p.BRING_TO_FRONT="bringtofront",p.EDIT="edit",p.DUPLICATE="duplicate",p.ADD="add",p.FLIP="flip",p.INVERT="invert",p.CLOSE="close",p.EXPORT="export"})(Je||(Je={}));var We;(function(m){m.LIBRARY="library",m.TRANSFORM="transform",m.FILTER="filter",m.ADJUSTMENT="adjustment",m.FOCUS="focus",m.STICKER="sticker",m.TEXT="text",m.TEXT_DESIGN="textdesign",m.OVERLAY="overlay",m.FRAME="frame",m.BRUSH="brush",m.CUSTOM="customTool"})(We||(We={}));var ci;(function(t){t.TEXT="text",t.CARD="card"})(ci||(ci={}));var Pf;(function(i){i.LARGE="large",i.MEDIUM="medium",i.SMALL="small"})(Pf||(Pf={}));var Mf;(function(r){r.ERROR="error",r.WARNING="warning",r.INFO="info",r.TEXT_EDIT="textEdit"})(Mf||(Mf={}));var Bf=class{constructor(){this.enabled=!0;this.threshold=20;this.snapToHorizontalCenter=!0;this.snapToVerticalCenter=!0;this.snapToLeft=.1;this.snapToRight=.1;this.snapToTop=.1;this.snapToBottom=.1}},Lf=class{constructor(){this.enabled=!0;this.threshold=20;this.angles=[0,45,90,135,180,225,270,315]}},YD=class{constructor(){this.position=new Bf;this.rotation=new Lf}};var im;(function(o){o.CENTER="center",o.TOP_LEFT="top-left",o.TOP_RIGHT="top-right",o.BOTTOM_LEFT="bottom-left",o.BOTTOM_RIGHT="bottom-right"})(im||(im={}));var JD=class{constructor(){this.watermarkURI="";this.alignment=im.TOP_RIGHT;this.inset=.05;this.size=.2}};var zf;(function(e){e.OBJECT="object"})(zf||(zf={}));var $D=class{};var Pi;(function(r){r.IMAGE="image",r.DATA_URL="data-url",r.BLOB="blob",r.MSBLOB="ms-blob"})(Pi||(Pi={}));var jr;(function(t){t.PNG="image/png",t.JPEG="image/jpeg"})(jr||(jr={}));var Nf;(function(l){l.BMP="image/bmp",l.GIF="image/gif",l.ICO="image/x-icon",l.JPEG="image/jpeg",l.PNG="image/png",l.SVG="image/svg+xml",l.TIFF="image/tiff",l.WEBP="image/webp"})(Nf||(Nf={}));var ZD=class{constructor(){this.order="default";this.language="en";this.theme="dark";this.assetBaseUrl="assets/";this.assetResolver={};this.displayResizeWarning=!1;this.displayCloseWarning=!0;this.displayCanvasRendererWarning=!0;this.displayToolControlBarTitle=!0;this.displaySerializationModal=!0;this.forceCrop=!1;this.enableZoom=!0;this.scaleImageToFit=!0;this.restrictZoomOutToDefault=!0;this.defaultTool=We.FILTER}};We.FILTER,We.FOCUS,We.ADJUSTMENT,We.LIBRARY,We.OVERLAY,We.STICKER,We.TEXT,We.TEXT_DESIGN,We.FRAME,We.BRUSH,We.TRANSFORM,We.CUSTOM;var nt;(function(m){m.BRIGHTNESS="brightness",m.CONTRAST="contrast",m.SATURATION="saturation",m.CLARITY="clarity",m.SHADOWS="shadows",m.HIGHLIGHTS="highlights",m.EXPOSURE="exposure",m.GAMMA="gamma",m.BLACKS="blacks",m.WHITES="whites",m.TEMPERATURE="temperature",m.SHARPNESS="sharpness"})(nt||(nt={}));var HF=Object.values(nt).reduce((s,e)=>(s[e]=!0,s),{});var co;(function(r){r.RemoveAdjustmentButton="removeAdjustmentButton",r.Expandable="expandable",r.Separator="separator",r.Items="items"})(co||(co={}));var QD=class{constructor(){this.categories=[];this.flattenCategories=!1;this.advancedUIToolControlBarOrder=[{type:co.Expandable,children:[co.RemoveAdjustmentButton,co.Separator]},co.Items]}};var ek=class{};var Hr;(function(o){o.RemoveFilterButton="removeFilterButton",o.FilterIntensitySlider="filterIntensitySlider",o.Expandable="expandable",o.Separator="separator",o.Items="items"})(Hr||(Hr={}));var rm;(function(e){e.FilterIntensity="filterIntensity"})(rm||(rm={}));var tk=class{constructor(){this.categories=[];this.flattenCategories=!1;this.categoryHeaderType=ci.CARD;this.enablePreviewThumbnails=!1;this.advancedUIToolControlBarOrder=[{type:Hr.Expandable,children:[Hr.RemoveFilterButton,Hr.FilterIntensitySlider,Hr.Separator]},Hr.Items];this.basicUIToolControlBarTabsOrder=[rm.FilterIntensity]}};function Uf(s){return s.lightColor!==void 0}function Gf(s){return s.lutURI!==void 0}var U;(function(T){T.Desert="imgly_duotone_desert",T.Peach="imgly_duotone_peach",T.Clash="imgly_duotone_clash",T.Plum="imgly_duotone_plum",T.Breezy="imgly_duotone_breezy",T.DeepBlue="imgly_duotone_deepblue",T.Frog="imgly_duotone_frog",T.Sunset="imgly_duotone_sunset",T.AD1920="imgly_lut_ad1920",T.Greyed="imgly_lut_bw",T.Dusty="imgly_lut_x400",T.Litho="imgly_lut_litho",T.Sepia="imgly_lut_sepiahigh",T.Weathered="imgly_lut_plate",T.HardStuff="imgly_lut_sin",T.Polaroid="imgly_lut_blues",T.Sunny70s="imgly_lut_front",T.Oldtimer="imgly_lut_texas",T.Inferno="imgly_lut_celsius",T.Snappy="imgly_lut_cool",T.Chestnut="imgly_lut_chest",T.Softy="imgly_lut_winter",T.Pebble="imgly_lut_kdynamic",T.Moss="imgly_lut_fall",T.Lemon="imgly_lut_lenin",T.GreenGap="imgly_lut_pola669",T.Colla="imgly_lut_elder",T.Solanus="imgly_lut_orchid",T.Kalmen="imgly_lut_bleached",T.Joran="imgly_lut_bleachedblue",T.Levante="imgly_lut_breeze",T.Zephyr="imgly_lut_blueshadows",T.Golden="imgly_lut_sunset",T.LowFire="imgly_lut_eighties",T.Sunrise="imgly_lut_evening",T.FlatBlack="imgly_lut_k2",T.Pumpkin="imgly_lut_nogreen",T.Ancient="imgly_lut_ancient",T.Candy="imgly_lut_cottoncandy",T.Classic="imgly_lut_classic",T.Colorful="imgly_lut_colorful",T.Creamy="imgly_lut_creamy",T.Fixie="imgly_lut_fixie",T.Food="imgly_lut_food",T.Fridge="imgly_lut_fridge",T.Glam="imgly_lut_glam",T.Gobblin="imgly_lut_gobblin",T.Hicon="imgly_lut_highcontrast",T.HighCarb="imgly_lut_highcarb",T.K1="imgly_lut_k1",T.K6="imgly_lut_k6",T.Keen="imgly_lut_keen",T.Lomo="imgly_lut_lomo",T.Lomo100="imgly_lut_lomo100",T.Lucid="imgly_lut_lucid",T.Mellow="imgly_lut_mellow",T.Neat="imgly_lut_neat",T.Pale="imgly_lut_pale",T.Pitched="imgly_lut_pitched",T.PolaSX="imgly_lut_polasx",T.Pro400="imgly_lut_pro400",T.Quozi="imgly_lut_quozi",T.Settled="imgly_lut_settled",T.Seventies="imgly_lut_seventies",T.Soft="imgly_lut_soft",T.Steel="imgly_lut_steel",T.Summer="imgly_lut_summer",T.Tender="imgly_lut_tender",T.Twilight="imgly_lut_twilight"})(U||(U={}));var mi;(function(a){a.DuoTone="imgly_filter_category_duotone",a.BW="imgly_filter_category_bw",a.Vintage="imgly_filter_category_vintage",a.Smooth="imgly_filter_category_smooth",a.Cold="imgly_filter_category_cold",a.Warm="imgly_filter_category_warm",a.Legacy="imgly_filter_category_legacy"})(mi||(mi={}));var qr;(function(o){o.RemoveFocusButton="removeFocusButton",o.FocusIntensitySlider="focusIntensitySlider",o.Expandable="expandable",o.Separator="separator",o.Items="items"})(qr||(qr={}));var sm;(function(e){e.FocusIntensity="focusIntensity"})(sm||(sm={}));var ik=class{constructor(){this.items=[];this.advancedUIToolControlBarOrder=[{type:qr.Expandable,children:[qr.RemoveFocusButton,qr.FocusIntensitySlider,qr.Separator]},qr.Items];this.basicUIToolControlBarTabsOrder=[sm.FocusIntensity]}};var Kr;(function(r){r.RADIAL="radial",r.LINEAR="linear",r.MIRRORED="mirrored",r.GAUSSIAN="gaussian"})(Kr||(Kr={}));var Mi;(function(a){a.RemoveFrameButton="removeFrameButton",a.FrameOpacitySlider="frameOpacitySlider",a.FrameSizeSlider="frameSizeSlider",a.FrameColorList="frameColorList",a.Separator="separator",a.Items="items",a.Expandable="expandable"})(Mi||(Mi={}));var vn;(function(i){i.FrameSize="frameSize",i.FrameOpacity="frameOpacity",i.FrameColor="frameColor"})(vn||(vn={}));var rk=class{constructor(){this.items=[];this.advancedUIToolControlBarOrder=[{type:Mi.Expandable,children:[Mi.RemoveFrameButton,Mi.FrameOpacitySlider,Mi.FrameSizeSlider,Mi.FrameColorList,Mi.Separator]},Mi.Items];this.basicUIToolControlBarTabsOrder=[vn.FrameOpacity,vn.FrameSize,vn.FrameColor]}};var om=class{constructor(e){this.name=e.name,this.coverImageUrl=e.coverImageUrl}loadCoverImage(e="anonymous"){return new Promise((t,i)=>{let r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${this.coverImage}`))}),r.crossOrigin=e,r.src=this.coverImageUrl,this.coverImage=r})}};var nm=class{constructor(e){this.title=e.title,this.category=e.category||e.title,this.thumbUrl=e.thumbUrl,this.rawUrl=e.rawUrl,this.authorName=e.authorName,this.authorAvatar=e.authorAvatar}loadThumbImage(e="anonymous"){return new Promise((t,i)=>{let r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${this.thumbUrl}`))}),r.crossOrigin=e,r.src=this.thumbUrl,this.thumbImage=r})}getThumbImage(){return this.thumbUrl}};var Ha=class{getData(e){return new Promise((t,i)=>{let r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="json",r.onload=()=>{let{status:o}=r;o===200?t(r.response):i(new Error(`HTTP Status ${o}`))},r.send()})}};var am=class{loadJSON(e){return new Ha().getData(e)}getCategories(){return Promise.resolve([])}searchImages(e){return Promise.resolve([])}};var lm=class extends am{loadData(){return this.data?Promise.resolve(this.data):this.loadJSON("https://img.ly/static/libraries/unsplash/metadata.json").then(e=>(typeof e=="string"&&(e=JSON.parse(e)),this.data=e,e))}getCategories(){return this.loadData().then(e=>e.categories.map(t=>new om({name:t.name,coverImageUrl:t.coverImage})))}searchImages(e){return this.loadData().then(t=>t.images.filter(i=>{let r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").split(/\s+/);for(let o=0;o<r.length;o+=1){let n=r[o];if(!new RegExp(n,"i").test(i.title))return!1}return!0}).map(i=>new nm(i)))}};var Xr;(function(o){o.UploadImageButton="uploadImageButton",o.OpenWebcamButton="openWebcamButton",o.SearchFieldInput="searchFieldInput",o.Separator="separator",o.Items="items"})(Xr||(Xr={}));var sk=class{constructor(){this.enableWebcam=!1;this.enableUpload=!1;this.provider=lm;this.flattenCategories=!1;this.categoryHeaderType=ci.CARD;this.advancedUIToolControlBarOrder=[Xr.SearchFieldInput,Xr.UploadImageButton,Xr.OpenWebcamButton,Xr.Separator,Xr.Items]}};var dr;(function(n){n.RemoveOverlayButton="removeOverlayButton",n.OverlayOpacitySlider="overlayOpacitySlider",n.OverlayBlendModeCarousel="overlayBlendModeCarousel",n.Expandable="expandable",n.Separator="separator",n.Items="items"})(dr||(dr={}));var qa;(function(t){t.OverlayOpacity="overlayOpacity",t.OverlayBlendMode="overlayBlendMode"})(qa||(qa={}));var ok=class{constructor(){this.items=[];this.advancedUIToolControlBarOrder=[{type:dr.Expandable,children:[dr.RemoveOverlayButton,dr.OverlayBlendModeCarousel,dr.OverlayOpacitySlider,dr.Separator]},dr.Items];this.basicUIToolControlBarTabsOrder=[qa.OverlayBlendMode,qa.OverlayOpacity]}};var oe;(function(u){u.NORMAL="normal",u.OVERLAY="overlay",u.SOFT_LIGHT="softLight",u.HARD_LIGHT="hardLight",u.MULTIPLY="multiply",u.DARKEN="darken",u.COLOR_BURN="colorBurn",u.SCREEN="screen",u.LIGHTEN="lighten"})(oe||(oe={}));var He;(function(g){g.Bokeh="imgly_overlay_bokeh",g.Chop="imgly_overlay_chop",g.Clouds="imgly_overlay_clouds",g.Golden="imgly_overlay_golden",g.Grain="imgly_overlay_grain",g.Hearts="imgly_overlay_hearts",g.LightLeak1="imgly_overlay_lightleak1",g.LightLeak2="imgly_overlay_lightleak2",g.Metal="imgly_overlay_metal",g.Mosaic="imgly_overlay_mosaic",g.Painting="imgly_overlay_painting",g.Paper="imgly_overlay_paper",g.Rain="imgly_overlay_rain",g.Vintage="imgly_overlay_vintage",g.Wall1="imgly_overlay_wall1",g.Wall2="imgly_overlay_wall2",g.Wood="imgly_overlay_wood"})(He||(He={}));var Yr;(function(o){o.UploadStickerButton="uploadStickerButton",o.StickerOpacitySlider="stickerOpacitySlider",o.StickerColorList="stickerColorList",o.Separator="separator",o.Items="items"})(Yr||(Yr={}));var Ka;(function(t){t.StickerColor="stickerColor",t.StickerOpacity="stickerOpacity"})(Ka||(Ka={}));var nk=class{constructor(){this.categories=[];this.canvasActions=[Je.BRING_TO_FRONT,Je.FLIP,Je.DUPLICATE,Je.DELETE];this.flattenCategories=!1;this.categoryHeaderType=ci.CARD;this.enableCustomUpload=!0;this.customStickerResizeMode="keepAspect";this.customStickerTintMode="none";this.advancedUIToolControlBarOrder=[Yr.UploadStickerButton,Yr.StickerOpacitySlider,Yr.StickerColorList,Yr.Separator,Yr.Items];this.basicUIToolControlBarTabsOrder=[Ka.StickerColor,Ka.StickerOpacity]}};var zt;(function(u){u.NewTextButton="newTextButton",u.FontFamilyDropdown="fontFamilyDropdown",u.FontSizeInput="fontSizeInput",u.TextAligmentList="textAlignmentList",u.Separator="separator",u.Inline="inline",u.TextColorList="textColorList",u.BackgroundColorList="backgroundColorList",u.LineSpacingSlider="lineSpacingSlider"})(zt||(zt={}));var Jr;(function(o){o.FontSize="fontSize",o.TextAligment="textAlignment",o.TextColor="textColor",o.BackgroundColor="backgroundColor",o.LineSpacing="lineSpacing"})(Jr||(Jr={}));var ak=class{constructor(){this.fonts=[];this.canvasActions=[Je.EDIT,Je.BRING_TO_FRONT,Je.DUPLICATE,Je.DELETE];this.allowEmojis=!1;this.disableAutoScaling=!1;this.addDefaultTextOnEnter=!0;this.advancedUIToolControlBarOrder=[zt.NewTextButton,zt.FontFamilyDropdown,{type:zt.Inline,children:[zt.FontSizeInput,zt.TextAligmentList]},zt.Separator,zt.TextColorList,zt.BackgroundColorList,zt.Separator,zt.LineSpacingSlider];this.basicUIToolControlBarTabsOrder=[Jr.FontSize,Jr.TextAligment,Jr.TextColor,Jr.BackgroundColor,Jr.LineSpacing]}};function Wf(s){return s.provider===void 0||s.provider==="file"}function Vf(s){return s.provider==="google"}var hr;(function(n){n.RemoveBrushButton="removeBrushButton",n.BrushColorList="brushColorList",n.BrushSizeSlider="brushSizeSlider",n.BrushHardnessSlider="brushHardnessSlider",n.Expandable="expandable",n.Separator="separator"})(hr||(hr={}));var wn;(function(i){i.BrushSize="brushSize",i.BrushHardness="brushHardness",i.BrushColor="brushColor"})(wn||(wn={}));var lk=class{constructor(){this.defaultSize=.05;this.defaultHardness=.5;this.advancedUIToolControlBarOrder=[{type:hr.Expandable,children:[hr.RemoveBrushButton,hr.Separator]},hr.BrushHardnessSlider,hr.BrushSizeSlider,hr.BrushColorList];this.basicUIToolControlBarTabsOrder=[wn.BrushColor,wn.BrushSize,wn.BrushHardness]}};var $r;(function(o){o.NewTextDesignButton="newTextDesignButton",o.ShuffleLayoutButton="shuffleLayoutButton",o.TextDesignColorList="textDesignColorList",o.Separator="separator",o.Items="items"})($r||($r={}));var uk=class{constructor(){this.items=[];this.canvasActions=[Je.EDIT,Je.BRING_TO_FRONT,Je.INVERT,Je.DUPLICATE,Je.DELETE];this.allowEmojis=!1;this.addDefaultTextOnEnter=!0;this.advancedUIToolControlBarOrder=[$r.NewTextDesignButton,$r.ShuffleLayoutButton,$r.TextDesignColorList,$r.Separator,$r.Items]}};var Zr;(function(o){o.ResetTransformButton="resetTransformButton",o.KeepResolutionCheckbox="keepResolutionCheckbox",o.CropSizeInput="cropSizeInput",o.Separator="separator",o.Items="items"})(Zr||(Zr={}));var Cn;(function(i){i.CropSize="cropSize",i.FlipRotate="flipRotate",i.Resolution="resolution"})(Cn||(Cn={}));var ck=class{constructor(){this.categories=[];this.enableRotation=!0;this.enableFlip=!0;this.flattenCategories=!1;this.categoryHeaderType=ci.TEXT;this.advancedUIToolControlBarOrder=[Zr.ResetTransformButton,Zr.KeepResolutionCheckbox,Zr.CropSizeInput,Zr.Separator,Zr.Items];this.basicUIToolControlBarTabsOrder=[Cn.CropSize,Cn.FlipRotate,Cn.Resolution]}};var jf;(function(v){v.CommonCategory="imgly_transforms_common",v.FacebookCategory="imgly_transforms_facebook",v.TwitterCategory="imgly_transforms_twitter",v.InstagramCategory="imgly_transforms_instagram",v.Custom="imgly_transform_common_custom",v.Square="imgly_transform_common_square",v.ThreeByFour="imgly_transform_common_3",v.FourByThree="imgly_transform_common_4",v.NineBySixteen="imgly_transform_common_9",v.SixteenByNine="imgly_transform_common_16",v.FacebookPost="imgly_transform_facebook_post",v.FacebookProfile="imgly_transform_facebook_profile",v.FacebookTitle="imgly_transform_facebook_title",v.InstagramLandscape="imgly_transform_instagram_landscape",v.InstagramPortrait="imgly_transform_instagram_portrait",v.InstagramSquare="imgly_transform_instagram_square",v.InstagramStory="imgly_transform_instagram_story",v.TwitterPost="imgly_transform_twitter_post",v.TwitterProfile="imgly_transform_twitter_profile",v.TwitterTitle="imgly_transform_twitter_title"})(jf||(jf={}));var Hf;(function(m){m.EXPORT="export",m.CLOSE="close",m.HISTORY_UNDO="historyUndo",m.HISTORY_REDO="historyRedo",m.HISTORY_CHANGE="historyChange",m.EDITOR_READY="editorReady",m.ERROR_IMAGE_LOADING="errorImageLoading",m.IMAGE_LOAD="imageLoad",m.TOOL_ENTER="toolEnter",m.STICKER_UPLOAD_ADD="stickerUploadAdd",m.ERROR_WEBGL_CONTEXT_LOST="errorWebGLContextLost",m.CROP_DIMENSIONS_CHANGE="cropDimensionsChange"})(Hf||(Hf={}));var mo=class{constructor(){this.events={}}addListener(e,t){return(this.events[e]||(this.events[e]=[])).push(t),this}removeListener(e,t){let i=this.events[e];if(!i)return this;let r=i.lastIndexOf(t);return r===-1?this:(i.splice(r,1),this)}removeAllListeners(e){return this.events[e]=void 0,this}on(e,t){return this.addListener(e,t)}off(e,t){return this.removeListener(e,t)}emit(e,...t){let i=this.events[e];return!i||!i.length?!1:(i.slice(0).forEach(r=>r.apply(null,t)),!0)}};var Dn=()=>typeof window!="undefined"&&window.navigator&&window.navigator.userAgent||"",qf=(s=Dn())=>s.indexOf("Edge")!==-1,Xa=(s=Dn())=>!!s.match(/msie|trident/i),ZA=(s=Dn())=>!!s.match(/windows/i),QA=(s=Dn())=>s.indexOf("Safari")!==-1&&s.indexOf("Chrome")===-1,eI=(s=Dn())=>!!s.match(/iP(hone|od|ad)|AppleWebKit/),tI=()=>{if(typeof document=="undefined")return!1;let s=document.createElement("canvas"),e=s.getContext("webgl")||s.getContext("experimental-webgl");return e&&e instanceof WebGLRenderingContext};function Ya(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{let e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)})}var Ee=class{static fromSize(e){return new Ee(e.width,e.height)}static distance(e,t){let i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}static dot(e,t){return e.x*t.x+e.y*t.y}static lerp(e,t,i){let r=Math.min(Math.max(i,0),1);return new Ee(e.x*r+t.x*(1-r),e.y*r+t.y*(1-r))}static lerpUnclamped(e,t,i){return new Ee(e.x*i+t.x*(1-i),e.y*i+t.y*(1-i))}static proportionalFit(e,t){let i=e.x/e.y,r=t.x/t.y;return i>r?t.multiply(e.y/t.y):t.multiply(e.x/t.x)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){let e=this.magnitude;return new Ee(this.x/e,this.y/e)}get floored(){return new Ee(Math.floor(this.x),Math.floor(this.y))}get rounded(){return new Ee(Math.round(this.x),Math.round(this.y))}get min(){return Math.min(this.x,this.y)}get max(){return Math.max(this.x,this.y)}get abs(){return new Ee(Math.abs(this.x),Math.abs(this.y))}get swapped(){return new Ee(this.y,this.x)}constructor(e,t){typeof e=="number"?(this.x=e,this.y=t):(this.x=e.x,this.y=e.y)}clone(){return new Ee(this.x,this.y)}add(e,t){return typeof e=="number"?new Ee(this.x+e,this.y+t):new Ee(this.x+e.x,this.y+e.y)}subtract(e,t){return typeof e=="number"?new Ee(this.x-e,this.y-t):new Ee(this.x-e.x,this.y-e.y)}multiply(e,t){return typeof e=="number"?new Ee(this.x*e,this.y*(t===void 0?e:t)):new Ee(this.x*e.x,this.y*e.y)}divide(e,t){return typeof e=="number"?new Ee(this.x/e,this.y/(t===void 0?e:t)):new Ee(this.x/e.x,this.y/e.y)}equals(e){return this.x===e.x&&this.y===e.y}clamp(e,t){let i=Math.max(e.x,Math.min(t.x,this.x)),r=Math.max(e.y,Math.min(t.y,this.y));return new Ee(i,r)}},le=Ee;le.ZERO=new Ee(0,0),le.ONE=new Ee(1,1),le.UP=new Ee(0,1),le.DOWN=new Ee(0,-1),le.RIGHT=new Ee(1,0),le.LEFT=new Ee(-1,0);var Ja;(function(F){F[F.EditorContainer=0]="EditorContainer",F[F.ToolControlBar=1]="ToolControlBar",F[F.ToolControlBarExpandableControls=2]="ToolControlBarExpandableControls",F[F.CanvasContainer=3]="CanvasContainer",F[F.Canvas=4]="Canvas",F[F.MainBarButtonClose=5]="MainBarButtonClose",F[F.MainBarButtonExport=6]="MainBarButtonExport",F[F.MainBarButtonUndo=7]="MainBarButtonUndo",F[F.MainBarButtonRedo=8]="MainBarButtonRedo",F[F.MainBarButtonZoom=9]="MainBarButtonZoom",F[F.Tooltip=10]="Tooltip",F[F.Cursor=11]="Cursor",F[F.CursorContainer=12]="CursorContainer",F[F.NummericInput=13]="NummericInput",F[F.BrushSize=14]="BrushSize",F[F.BrushHardness=15]="BrushHardness",F[F.Dialog=16]="Dialog",F[F.DialogBody=17]="DialogBody",F[F.CardContainer=18]="CardContainer",F[F.CategoryItemsContainer=19]="CategoryItemsContainer",F[F.ToolbarItem=20]="ToolbarItem",F[F.ColorList=21]="ColorList",F[F.NoResult=22]="NoResult",F[F.CardLabel=23]="CardLabel",F[F.CardAvatar=24]="CardAvatar",F[F.Dropdown=25]="Dropdown",F[F.DropdownList=26]="DropdownList",F[F.TextAlignment=27]="TextAlignment",F[F.Sprite=28]="Sprite",F[F.SpriteTopLeft=29]="SpriteTopLeft",F[F.SpriteTopRight=30]="SpriteTopRight",F[F.SpriteBottomLeft=31]="SpriteBottomLeft",F[F.SpriteBottomRight=32]="SpriteBottomRight",F[F.Knob=33]="Knob",F[F.TextWidth=34]="TextWidth",F[F.ToolbarWrapper=35]="ToolbarWrapper",F[F.MainCanvasActionBar=36]="MainCanvasActionBar",F[F.SpriteActions=37]="SpriteActions",F[F.CarouselSlider=38]="CarouselSlider",F[F.CropMask=39]="CropMask",F[F.FlipRotateControls=40]="FlipRotateControls",F[F.RotateSlider=41]="RotateSlider",F[F.CropTopRight=42]="CropTopRight",F[F.CropTopLeft=43]="CropTopLeft",F[F.CropBottomRight=44]="CropBottomRight",F[F.CropBottomLeft=45]="CropBottomLeft",F[F.Watermark=46]="Watermark",F[F.Toolbar=47]="Toolbar",F[F.CanvasBar=48]="CanvasBar",F[F.Checkbox=49]="Checkbox",F[F.Focus=50]="Focus",F[F.SnappingLine=51]="SnappingLine",F[F.LibraryUploadButton=52]="LibraryUploadButton",F[F.LibraryWebcamButton=53]="LibraryWebcamButton",F[F.ZoomLevel=54]="ZoomLevel"})(Ja||(Ja={}));var Kf={};for(let s in Ja){let e=Ja[s];typeof e=="string"&&(Kf[e]=e)}var nI=Kf,Xf,aI=Boolean(typeof window!="undefined"&&((Xf=window.Cypress)==null?void 0:Xf.env("pesdk")));um();var Yf={};Ne(Yf,{isMobile:()=>cm});function cm(){if(typeof navigator=="undefined")return!1;let s=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4))}var uI=s=>{s.preventDefault(),s.stopPropagation()};var Jf=(...s)=>{};var fI=typeof window!="undefined"?window.performance.now.bind(window.performance):Jf();var kn=class{constructor(e){this.text=e;this.lastOffsetWidth=-1;let t="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.element=document.createElement("div"),this.element.setAttribute("aria-hidden","true"),this.element.appendChild(document.createTextNode(e)),this.collapsible=document.createElement("span"),this.expandable=document.createElement("span"),this.collapsibleInner=document.createElement("span"),this.expandableInner=document.createElement("span"),this.collapsible.style.cssText=t,this.expandable.style.cssText=t,this.expandableInner.style.cssText=t,this.collapsibleInner.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.collapsible.appendChild(this.collapsibleInner),this.expandable.appendChild(this.expandableInner),this.element.appendChild(this.collapsible),this.element.appendChild(this.expandable)}getElement(){return this.element}setFont(e){this.element.style.cssText=`max-width:none;
      min-width:20px;
      min-height:20px;
      display:inline-block;
      overflow:hidden;
      position:absolute;
      width:auto;
      margin:0;
      padding:0;
      top:-999px;
      white-space:nowrap;
      font-synthesis:none;
      font:${e};`}getWidth(){return this.element.offsetWidth}setWidth(e){this.element.style.width=`${e}px`}onResize(e){let t=()=>{this.onScroll(e)};this.collapsible.addEventListener("scroll",t),this.expandable.addEventListener("scroll",t),this.reset()}reset(){let e=this.getWidth(),t=e+100;return this.expandableInner.style.width=`${t}px`,this.expandable.scrollLeft=t,this.collapsible.scrollLeft=this.collapsible.scrollWidth+100,this.lastOffsetWidth!==e?(this.lastOffsetWidth=e,!0):!1}onScroll(e){this.reset()&&this.element.parentNode!==null&&e(this.lastOffsetWidth)}};var Ae=class{static getUserAgent(){return window.navigator.userAgent}static getNavigatorVendor(){return window.navigator.vendor}static hasWebKitFallbackBug(){if(Ae.HAS_WEBKIT_FALLBACK_BUG===null){let e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(Ae.getUserAgent());Ae.HAS_WEBKIT_FALLBACK_BUG=!!e&&(parseInt(e[1],10)<536||parseInt(e[1],10)===536&&parseInt(e[2],10)<=11)}return Ae.HAS_WEBKIT_FALLBACK_BUG}static hasSafari10Bug(){if(Ae.HAS_SAFARI_10_BUG===null)if(Ae.supportsNativeFontLoading()&&/Apple/.test(Ae.getNavigatorVendor())){let e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(Ae.getUserAgent());Ae.HAS_SAFARI_10_BUG=!!e&&parseInt(e[1],10)<603}else Ae.HAS_SAFARI_10_BUG=!1;return Ae.HAS_SAFARI_10_BUG}static supportsNativeFontLoading(){return Ae.SUPPORTS_NATIVE_FONT_LOADING===null&&(Ae.SUPPORTS_NATIVE_FONT_LOADING=!!document.fonts),Ae.SUPPORTS_NATIVE_FONT_LOADING}static supportsStretch(){if(Ae.SUPPORTS_STRETCH===null){let e=document.createElement("div");try{e.style.font="condensend 100px sans-serif"}catch(t){Ae.SUPPORTS_STRETCH=!1}Ae.SUPPORTS_STRETCH=e.style.font!==""}return Ae.SUPPORTS_STRETCH}constructor(e){this.font=D({fontFamily:"normal",fontStyle:"normal",fontWeight:"normal",fontStretch:"normal"},e)}load(e,t){let i="BESbswy",r=null,o=t||Ae.DEFAULT_TIMEOUT,n=this.getTime();return new Promise((a,l)=>{if(Ae.supportsNativeFontLoading()&&!Ae.hasSafari10Bug()){let u=new Promise((p,m)=>{let d=()=>{this.getTime()-n>=o?m(new Error(""+o+"ms timeout exceeded")):document.fonts.load(this.getStyle(`"${this.font.fontFamily}"`),i).then(b=>{b.length>=1?p():setTimeout(d,25)},l)};d()}),c=new Promise((p,m)=>{r=setTimeout(()=>{m(new Error(`${o} ms timeout exceeded`))},o)});Promise.race([c,u]).then(()=>{clearTimeout(r),a(this)},l)}else{let u=new kn(i),c=new kn(i),p=new kn(i),m=-1,d=-1,f=-1,b=-1,y=-1,g=-1,C=document.createElement("div"),x=()=>{C.parentNode!==null&&C.parentNode.removeChild(C)},v=()=>{if((m!==-1&&d!==-1||m!==-1&&f!==-1||d!==-1&&f!==-1)&&(m===d||m===f||d===f)){if(Ae.hasWebKitFallbackBug()&&(m===b&&d===b&&f===b||m===y&&d===y&&f===y||m===g&&d===g&&f===g))return;x(),clearTimeout(r),a(this)}};C.dir="ltr",u.setFont(this.getStyle("sans-serif")),c.setFont(this.getStyle("serif")),p.setFont(this.getStyle("monospace")),C.appendChild(u.getElement()),C.appendChild(c.getElement()),C.appendChild(p.getElement()),document.body.appendChild(C),b=u.getWidth(),y=c.getWidth(),g=p.getWidth();let M=()=>{if(this.getTime()-n>=o)x(),l(new Error(`${o} ms timeout exceeded`));else{let k=document.hidden;(k===!0||k===void 0)&&(m=u.getWidth(),d=c.getWidth(),f=p.getWidth(),v()),r=setTimeout(M,50)}};M(),u.onResize(w=>{m=w,v()}),u.setFont(this.getStyle(`"${this.font.fontFamily}",sans-serif`)),c.onResize(w=>{d=w,v()}),c.setFont(this.getStyle(`"${this.font.fontFamily}",serif`)),p.onResize(w=>{f=w,v()}),p.setFont(this.getStyle(`"${this.font.fontFamily}",monospace`))}})}getStyle(e){return[this.font.fontStyle,this.font.fontWeight,Ae.supportsStretch()?this.font.fontStretch:"","100px",e].join(" ")}getTime(){return new Date().getTime()}},pr=Ae;pr.HAS_WEBKIT_FALLBACK_BUG=null,pr.HAS_SAFARI_10_BUG=null,pr.SUPPORTS_STRETCH=null,pr.SUPPORTS_NATIVE_FONT_LOADING=null,pr.DEFAULT_TIMEOUT=6e4;var Li;(function(t){t.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",t.IMAGE_DOWNSCALED="imageDownscaled"})(Li||(Li={}));var Tn=class extends mo{constructor(e,t){super();this.image=e,this.options=t}needsResize(){let e=this.resizedDimensions();return e.x<this.image.width||e.y<this.image.height}resizedDimensions(){let{options:e}=this,t={width:this.image.width,height:this.image.height},i=le.fromSize(t),r=le.fromSize(t),{maxMegaPixels:o}=e;if(o){let l=(cm()?o.mobile:o.desktop)*1e6,u=t.width/t.height,c=t.height/t.width,p=new le(Math.floor(Math.sqrt(l*u)),Math.floor(Math.sqrt(l*c)));p.x<=t.width&&p.y<=t.height&&(i=p)}let n=e.maxDimensions;n&&(n.height<t.height||n.width<t.width)&&(r=new le(n.width,n.height));let a=new le(Math.min(i.x,r.x),Math.min(i.y,r.y));return le.proportionalFit(a,le.fromSize(t)).floored}downscaleIfNecessary(){let e=this.resizedDimensions();if(!(e.x<this.image.width||e.y<this.image.height))return this.image;this.emit(Li.BEGAN_IMAGE_DOWNSCALING,this.image);let i=document.createElement("canvas");i.width=e.x,i.height=e.y;let r=i.getContext("2d"),{image:o}=this;return r.imageSmoothingQuality="high",r.drawImage(o,0,0,o.width,o.height,0,0,e.x,e.y),this.emit(Li.IMAGE_DOWNSCALED,{width:e.x,height:e.y}),i}downscaleImageIfNecessary(){let e=this.image,t=this.resizedDimensions();if(!(t.x<this.image.width||t.y<this.image.height))return e;this.emit(Li.BEGAN_IMAGE_DOWNSCALING,e);let r=new Image;return r.width=t.x,r.height=t.y,r.src=e.src,this.emit(Li.IMAGE_DOWNSCALED,{width:t.x,height:t.y}),r}};var mk=s=>s.key==="Enter",dk=s=>s.key==="Escape",TI=s=>e=>{mk(e)&&s(e)},RI=s=>e=>{dk(e)&&s(e)};function hk(s,e){let t=0;for(let i=s.length-1;i>=0;i--){let r=s[i];r==="."?s.splice(i,1):r===".."?(s.splice(i,1),t++):t&&(s.splice(i,1),t--)}if(e)for(;t--;t)s.unshift("..");return s}function pk(s){return s.charAt(0)==="/"}function fk(s){let e=pk(s),t=s.substr(-1)==="/";return s=hk(s.split("/").filter(Boolean),!e).join("/"),!s&&!e&&(s="."),s&&t&&(s+="/"),(e?"/":"")+s}var Rn=(...s)=>fk(s.join("/"));var xk=Ur(Zf()),OI=(s,e,[t,i],r=0)=>{let o=s[e];if(o){if(o<t)return console.error(`${e} must be greater than or equal to ${t}`),t;if(o>i)return console.error(`${e} must be less than or equal to ${i}`),i}return o||r},AI=(s,e,t=[1,1,1,1])=>{let i=s[e],r=!0;return i&&i.forEach(o=>{o<0&&(console.error(`${o} in ${e} must be greater than or equal to 0`),r=!1),o>1&&(console.error(`${o} in ${e} must be less than or equal to 1`),r=!1)}),r&&i||t};var PI=s=>s*.08,MI=s=>s*.03;var Qf=(s,e)=>{let t=s.indexOf(e);if(!(t===-1||!s.length))return t===s.length-1?s[0]:s[t+1]},eg=(s,e)=>{let t=s.indexOf(e);if(!(t===-1||!s.length))return t===0?s[s.length-1]:s[t-1]};var En={},mm=({src:s,crossOrigin:e,key:t,resolve:i,reject:r})=>{En[t]=s;let o=new Image;o.onload=()=>{En[t]===s&&(i(o),delete En[t])},o.onerror=n=>{En[t]===s&&(r(n),delete En[t])},o.crossOrigin=e,o.src=s};var vk=new RegExp(/\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83D\uDC68\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83D\uDC68\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83D\uDC68\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83D\uDC68\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC69(?:\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFC-\uDFFF]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68\u200D(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])|\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC68(?:\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D[\uDC67-\uDC69])\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F)|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83C\uDFF3\uFE0F\u200D\u26A7|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D[\u2695\u2696\u2708]\uFE0F|\uD83D\uDC69\u200D(?:\uD83D[\uDC67\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D\uDC3B\u200D\u2744|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDF])\u200D[\u2640\u2642])\uFE0F|\uD83E\uDDD1\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83D[\uDC68\uDC69])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D[\u2695\u2696\u2708]\uFE0F)|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC08\u200D\u2B1B|\uD83E\uDDD1\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDC66\uDC67\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC3\uDFC7]|\uD83D[\uDC43\uDC4A-\uDC4C\uDC4F\uDC50\uDC66-\uDC69\uDC6B-\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270C\u270D]|\uD83C[\uDFC2\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC46-\uDC49\uDC4D\uDC4E\uDD74\uDD75\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9\u23EA\u23ED-\u23EF\u23F1-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7\u26F8\u26FA\u26FD\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2753\u2757\u2763\u2764\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF0D-\uDF0F\uDF15\uDF1C\uDF21\uDF24-\uDF2C\uDF36\uDF78\uDF7D\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFA7\uDFAC-\uDFAE\uDFC6\uDFCD\uDFCE\uDFD4-\uDFE0\uDFED\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC08\uDC15\uDC1F\uDC26\uDC3F\uDC41\uDC53\uDC6A\uDC7D\uDCA3\uDCB0\uDCB3\uDCBB\uDCBF\uDCCB\uDCDA\uDCDF\uDCE4-\uDCE6\uDCEA-\uDCED\uDCF7\uDCF9-\uDCFB\uDCFD\uDD08\uDD0D\uDD12\uDD13\uDD49\uDD4A\uDD50-\uDD67\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDE10\uDE87\uDE8D\uDE91\uDE94\uDE98\uDEAD\uDEB2\uDEB9\uDEBA\uDEBC\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|[\u23E9-\u23F3\u23F8-\u23FA\u25FB-\u25FE\u2614\u2615\u267F\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]/g),rP=s=>s.replace(vk,"");var Fn=s=>{try{return new URL(s),!0}catch(e){return!1}};var nP=s=>s instanceof HTMLImageElement;var wk=[{identifier:"basics",name:"Basics",items:[{identifier:nt.BRIGHTNESS},{identifier:nt.CONTRAST},{identifier:nt.SATURATION},{identifier:nt.GAMMA}]},{identifier:"refinements",name:"Refinements",items:[{identifier:nt.CLARITY},{identifier:nt.SHADOWS},{identifier:nt.HIGHLIGHTS},{identifier:nt.EXPOSURE},{identifier:nt.BLACKS},{identifier:nt.WHITES},{identifier:nt.TEMPERATURE},{identifier:nt.SHARPNESS}]}],Za=wk;var Ck=[{identifier:mi.DuoTone,name:"DuoTone",thumbnailURI:"./categories/duotone.jpg",items:[{identifier:U.Desert,name:"Desert",thumbnailURI:"./items/imgly_duotone_desert.jpg",lightColor:"#e1de9a",darkColor:"#cb2129",defaultIntensity:.5},{identifier:U.Peach,name:"Peach",thumbnailURI:"./items/imgly_duotone_peach.jpg",lightColor:"#e9abb8",darkColor:"#0040ff",defaultIntensity:.5},{identifier:U.Clash,name:"Clash",thumbnailURI:"./items/imgly_duotone_clash.jpg",lightColor:"#f41a0f",darkColor:"#23007c",defaultIntensity:.5},{identifier:U.Plum,name:"Plum",thumbnailURI:"./items/imgly_duotone_plum.jpg",lightColor:"#74d7ff",darkColor:"#23007c",defaultIntensity:.5},{identifier:U.Breezy,name:"Breezy",thumbnailURI:"./items/imgly_duotone_breezy.jpg",lightColor:"#68fdff",darkColor:"#c20000",defaultIntensity:.5},{identifier:U.DeepBlue,name:"Deep Blue",thumbnailURI:"./items/imgly_duotone_deepblue.jpg",lightColor:"#2de9eb",darkColor:"#58007c",defaultIntensity:.5},{identifier:U.Frog,name:"Frog",thumbnailURI:"./items/imgly_duotone_frog.jpg",lightColor:"#5bff60",darkColor:"#7f23a9",defaultIntensity:.5},{identifier:U.Sunset,name:"Sunset",thumbnailURI:"./items/imgly_duotone_sunset.jpg",lightColor:"#f8ea46",darkColor:"#c400be",defaultIntensity:.5}]},{identifier:mi.BW,name:"B & W",thumbnailURI:"./categories/b&w.jpg",items:[{identifier:U.AD1920,name:"1920 A.D.",thumbnailURI:"./items/imgly_lut_ad1920.jpg",lutURI:"./items/imgly_lut_ad1920_5_5_128.png",defaultIntensity:1},{identifier:U.Greyed,name:"Greyed",thumbnailURI:"./items/imgly_lut_bw.jpg",lutURI:"./items/imgly_lut_bw_5_5_128.png",defaultIntensity:1},{identifier:U.Dusty,name:"Dusty",thumbnailURI:"./items/imgly_lut_x400.jpg",lutURI:"./items/imgly_lut_dusty_5_5_128.png",defaultIntensity:1},{identifier:U.Litho,name:"Litho",thumbnailURI:"./items/imgly_lut_litho.jpg",lutURI:"./items/imgly_lut_litho_5_5_128.png",defaultIntensity:1},{identifier:U.Sepia,name:"Sepia",thumbnailURI:"./items/imgly_lut_sepiahigh.jpg",lutURI:"./items/imgly_lut_sepia_5_5_128.png",defaultIntensity:1},{identifier:U.Weathered,name:"Weathered",thumbnailURI:"./items/imgly_lut_plate.jpg",lutURI:"./items/imgly_lut_weathered_5_5_128.png",defaultIntensity:1},{identifier:U.HardStuff,name:"Hard Stuff",thumbnailURI:"./items/imgly_lut_sin.jpg",lutURI:"./items/imgly_lut_hard_stuff_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8}]},{identifier:mi.Vintage,name:"Vintage",thumbnailURI:"./categories/vintage.jpg",items:[{identifier:U.Polaroid,name:"Polaroid",thumbnailURI:"./items/imgly_lut_blues.jpg",lutURI:"./items/imgly_lut_polaroid_5_5_128.png",defaultIntensity:1},{identifier:U.Sunny70s,name:"Sunny 70s",thumbnailURI:"./items/imgly_lut_front.jpg",lutURI:"./items/imgly_lut_sunny_70s_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Oldtimer,name:"Oldtimer",thumbnailURI:"./items/imgly_lut_texas.jpg",lutURI:"./items/imgly_lut_oldtimer_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Inferno,name:"Inferno",thumbnailURI:"./items/imgly_lut_celsius.jpg",lutURI:"./items/imgly_lut_inferno_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Snappy,name:"Snappy",thumbnailURI:"./items/imgly_lut_cool.jpg",lutURI:"./items/imgly_lut_snappy_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Smooth,name:"Smooth",thumbnailURI:"./categories/smooth.jpg",items:[{identifier:U.Chestnut,name:"Chestnut",thumbnailURI:"./items/imgly_lut_chest.jpg",lutURI:"./items/imgly_lut_chestnut_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Softy,name:"Softy",thumbnailURI:"./items/imgly_lut_winter.jpg",lutURI:"./items/imgly_lut_softly_5_5_128.png",defaultIntensity:1},{identifier:U.Pebble,name:"Pebble",thumbnailURI:"./items/imgly_lut_kdynamic.jpg",lutURI:"./items/imgly_lut_pebble_5_5_128.png",defaultIntensity:1},{identifier:U.Moss,name:"Moss",thumbnailURI:"./items/imgly_lut_fall.jpg",lutURI:"./items/imgly_lut_moss_5_5_128.png",defaultIntensity:1},{identifier:U.Lemon,name:"Lemon",thumbnailURI:"./items/imgly_lut_lenin.jpg",lutURI:"./items/imgly_lut_lemon_5_5_128.png",defaultIntensity:1},{identifier:U.GreenGap,name:"Green Gap",thumbnailURI:"./items/imgly_lut_pola669.jpg",lutURI:"./items/imgly_lut_green_gap_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Cold,name:"Cold",thumbnailURI:"./categories/cold.jpg",items:[{identifier:U.Colla,name:"Colla",thumbnailURI:"./items/imgly_lut_elder.jpg",lutURI:"./items/imgly_lut_colla_5_5_128.png",defaultIntensity:1},{identifier:U.Solanus,name:"Solanus",thumbnailURI:"./items/imgly_lut_orchid.jpg",lutURI:"./items/imgly_lut_solanus_5_5_128.png",defaultIntensity:1},{identifier:U.Kalmen,name:"Kalmen",thumbnailURI:"./items/imgly_lut_bleached.jpg",lutURI:"./items/imgly_lut_kalmen_5_5_128.png",defaultIntensity:1},{identifier:U.Joran,name:"Joran",thumbnailURI:"./items/imgly_lut_bleachedblue.jpg",lutURI:"./items/imgly_lut_joran_5_5_128.png",defaultIntensity:1},{identifier:U.Levante,name:"Levante",thumbnailURI:"./items/imgly_lut_breeze.jpg",lutURI:"./items/imgly_lut_levante_5_5_128.png",defaultIntensity:1},{identifier:U.Zephyr,name:"Zephyr",thumbnailURI:"./items/imgly_lut_blueshadows.jpg",lutURI:"./items/imgly_lut_zephyr_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Warm,name:"Warm",thumbnailURI:"./categories/warm.jpg",items:[{identifier:U.Golden,name:"Golden",thumbnailURI:"./items/imgly_lut_sunset.jpg",lutURI:"./items/imgly_lut_golden_5_5_128.png",defaultIntensity:1},{identifier:U.LowFire,name:"Low Fire",thumbnailURI:"./items/imgly_lut_eighties.jpg",lutURI:"./items/imgly_lut_low_fire_5_5_128.png",defaultIntensity:1},{identifier:U.Sunrise,name:"Sunrise",thumbnailURI:"./items/imgly_lut_evening.jpg",lutURI:"./items/imgly_lut_sunrise_5_5_128.png",defaultIntensity:1},{identifier:U.FlatBlack,name:"Flat Black",thumbnailURI:"./items/imgly_lut_k2.jpg",lutURI:"./items/imgly_lut_flat_black_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Pumpkin,name:"Pumpkin",thumbnailURI:"./items/imgly_lut_nogreen.jpg",lutURI:"./items/imgly_lut_pumpkin_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Legacy,name:"Legacy",thumbnailURI:"./categories/legacy.jpg",items:[{identifier:U.Ancient,name:"Ancient",thumbnailURI:"./items/imgly_lut_ancient.jpg",lutURI:"./items/imgly_lut_ancient_5_5_128.png",defaultIntensity:1},{identifier:U.Candy,name:"Candy",thumbnailURI:"./items/imgly_lut_cottoncandy.jpg",lutURI:"./items/imgly_lut_cottoncandy_5_5_128.png",defaultIntensity:1},{identifier:U.Classic,name:"Classic",thumbnailURI:"./items/imgly_lut_classic.jpg",lutURI:"./items/imgly_lut_classic_5_5_128.png",defaultIntensity:1},{identifier:U.Colorful,name:"Colorful",thumbnailURI:"./items/imgly_lut_colorful.jpg",lutURI:"./items/imgly_lut_colorful_5_5_128.png",defaultIntensity:1},{identifier:U.Creamy,name:"Creamy",thumbnailURI:"./items/imgly_lut_creamy.jpg",lutURI:"./items/imgly_lut_creamy_5_5_128.png",defaultIntensity:1},{identifier:U.Fixie,name:"Fixie",thumbnailURI:"./items/imgly_lut_fixie.jpg",lutURI:"./items/imgly_lut_fixie_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Food,name:"Food",thumbnailURI:"./items/imgly_lut_food.jpg",lutURI:"./items/imgly_lut_food_5_5_128.png",defaultIntensity:1},{identifier:U.Fridge,name:"Fridge",thumbnailURI:"./items/imgly_lut_fridge.jpg",lutURI:"./items/imgly_lut_fridge_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Glam,name:"Glam",thumbnailURI:"./items/imgly_lut_glam.jpg",lutURI:"./items/imgly_lut_glam_5_5_128.png",defaultIntensity:1},{identifier:U.Gobblin,name:"Gobblin",thumbnailURI:"./items/imgly_lut_gobblin.jpg",lutURI:"./items/imgly_lut_gobblin_5_5_128.png",defaultIntensity:1},{identifier:U.Hicon,name:"Hicon",thumbnailURI:"./items/imgly_lut_highcontrast.jpg",lutURI:"./items/imgly_lut_highcontrast_5_5_128.png",defaultIntensity:1},{identifier:U.HighCarb,name:"High Carb",thumbnailURI:"./items/imgly_lut_highcarb.jpg",lutURI:"./items/imgly_lut_highcarb_5_5_128.png",defaultIntensity:1},{identifier:U.K1,name:"K1",thumbnailURI:"./items/imgly_lut_k1.jpg",lutURI:"./items/imgly_lut_k1_5_5_128.png",defaultIntensity:1},{identifier:U.K6,name:"K6",thumbnailURI:"./items/imgly_lut_k6.jpg",lutURI:"./items/imgly_lut_k6_5_5_128.png",defaultIntensity:1},{identifier:U.Keen,name:"Keen",thumbnailURI:"./items/imgly_lut_keen.jpg",lutURI:"./items/imgly_lut_keen_5_5_128.png",defaultIntensity:1},{identifier:U.Lomo,name:"Lomo",thumbnailURI:"./items/imgly_lut_lomo.jpg",lutURI:"./items/imgly_lut_lomo_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Lomo100,name:"Lomo 100",thumbnailURI:"./items/imgly_lut_lomo100.jpg",lutURI:"./items/imgly_lut_lomo100_5_5_128.png",defaultIntensity:1},{identifier:U.Lucid,name:"Lucid",thumbnailURI:"./items/imgly_lut_lucid.jpg",lutURI:"./items/imgly_lut_lucid_5_5_128.png",defaultIntensity:1},{identifier:U.Mellow,name:"Mellow",thumbnailURI:"./items/imgly_lut_mellow.jpg",lutURI:"./items/imgly_lut_mellow_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:U.Neat,name:"Neat",thumbnailURI:"./items/imgly_lut_neat.jpg",lutURI:"./items/imgly_lut_neat_5_5_128.png",defaultIntensity:1},{identifier:U.Pale,name:"Pale",thumbnailURI:"./items/imgly_lut_pale.jpg",lutURI:"./items/imgly_lut_pale_5_5_128.png",defaultIntensity:1},{identifier:U.Pitched,name:"Pitched",thumbnailURI:"./items/imgly_lut_pitched.jpg",lutURI:"./items/imgly_lut_pitched_5_5_128.png",defaultIntensity:1},{identifier:U.PolaSX,name:"Pola SX",thumbnailURI:"./items/imgly_lut_polasx.jpg",lutURI:"./items/imgly_lut_polasx_5_5_128.png",defaultIntensity:1},{identifier:U.Pro400,name:"Pro 400",thumbnailURI:"./items/imgly_lut_pro400.jpg",lutURI:"./items/imgly_lut_pro400_5_5_128.png",defaultIntensity:1},{identifier:U.Quozi,name:"Quozi",thumbnailURI:"./items/imgly_lut_quozi.jpg",lutURI:"./items/imgly_lut_quozi_5_5_128.png",defaultIntensity:1},{identifier:U.Settled,name:"Settled",thumbnailURI:"./items/imgly_lut_settled.jpg",lutURI:"./items/imgly_lut_settled_5_5_128.png",defaultIntensity:1},{identifier:U.Seventies,name:"Seventies",thumbnailURI:"./items/imgly_lut_seventies.jpg",lutURI:"./items/imgly_lut_seventies_5_5_128.png",defaultIntensity:1},{identifier:U.Soft,name:"Soft",thumbnailURI:"./items/imgly_lut_soft.jpg",lutURI:"./items/imgly_lut_soft_5_5_128.png",defaultIntensity:1},{identifier:U.Steel,name:"Steel",thumbnailURI:"./items/imgly_lut_steel.jpg",lutURI:"./items/imgly_lut_steel_5_5_128.png",defaultIntensity:1},{identifier:U.Summer,name:"Summer",thumbnailURI:"./items/imgly_lut_summer.jpg",lutURI:"./items/imgly_lut_summer_5_5_128.png",defaultIntensity:1},{identifier:U.Tender,name:"Tender",thumbnailURI:"./items/imgly_lut_tender.jpg",lutURI:"./items/imgly_lut_tender_5_5_128.png",defaultIntensity:1},{identifier:U.Twilight,name:"Twilight",thumbnailURI:"./items/imgly_lut_twilight.jpg",lutURI:"./items/imgly_lut_twilight_5_5_128.png",defaultIntensity:1}]}],Qa=Ck;var Dk=[{identifier:Kr.RADIAL,thumbnailURI:"./items/radial.png"},{identifier:Kr.MIRRORED,thumbnailURI:"./items/mirrored.png"},{identifier:Kr.LINEAR,thumbnailURI:"./items/linear.png"},{identifier:Kr.GAUSSIAN,thumbnailURI:"./items/gaussian.png"}],dm=Dk;var kk=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}},{identifier:"imgly_font_amaticsc",fontFamily:"Amatic SC",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}},{identifier:"imgly_font_archivo_black",fontFamily:"Archivo",fontWeight:"normal",fontURI:"./fonts/imgly_font_archivo_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_fira_sans_regular",fontFamily:"Fira Sans",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_fira_sans_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_carter_one",fontFamily:"Carter One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_carter_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}},{identifier:"imgly_font_codystar",fontFamily:"Codystar",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_codystar.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_krona_one",fontFamily:"Krona One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_krona_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}},{identifier:"imgly_font_kumar_one_outline",fontFamily:"Kumar One Outline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_kumar_one_outline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}},{identifier:"imgly_font_molle",fontFamily:"Molle",fontWeight:"normal",fontStyle:"italic",fontURI:"./fonts/imgly_font_molle.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}},{identifier:"imgly_font_monoton",fontFamily:"Monoton",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_monoton.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}},{identifier:"imgly_font_nixie_one",fontFamily:"Nixie One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_nixie_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}},{identifier:"imgly_font_notable",fontFamily:"Notable",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_notable.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_oswald_semi_bold",fontFamily:"Oswald SemiBold",googleFamily:"Oswald",fontWeight:600,fontStyle:"normal",fontURI:"./fonts/imgly_font_oswald_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}},{identifier:"imgly_font_palanquin_dark_semi_bold",fontFamily:"Palanquin Dark SemiBold",googleFamily:"Palanquin Dark",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_palanquin_dark_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}},{identifier:"imgly_font_poppins",fontFamily:"Poppins",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_poppins.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}},{identifier:"imgly_font_roboto_black_italic",fontFamily:"Roboto Black",fontWeight:"bold",fontStyle:"italic",googleFamily:"Roboto",fontURI:"./fonts/imgly_font_roboto_black_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontFamily:"Roboto Light",googleFamily:"Roboto",fontWeight:300,fontStyle:"italic",fontURI:"./fonts/imgly_font_roboto_light_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sancreek",fontFamily:"Sancreek",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sancreek.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}},{identifier:"imgly_font_stint_ultra_expanded",fontFamily:"Stint Ultra Expanded",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_stint_ultra_expanded.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}},{identifier:"imgly_font_vt323",fontFamily:"VT323",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_vt323.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_yeseva_one",fontFamily:"Yeseva One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_yeseva_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",googleFamily:"Montserrat",fontWeight:300,fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_roboto_black",fontFamily:"Roboto Black",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light",fontFamily:"Roboto Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sue_ellen_francisco",fontFamily:"Sue Ellen Francisco",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sue_ellen_francisco.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}],el=kk;var tg=["imgly_font_open_sans_bold","imgly_font_aleo_bold","imgly_font_amaticsc","imgly_font_archivo_black","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_carter_one","imgly_font_codystar","imgly_font_fira_sans_regular","imgly_font_galano_grotesque_bold","imgly_font_krona_one","imgly_font_kumar_one_outline","imgly_font_lobster","imgly_font_molle","imgly_font_monoton","imgly_font_nixie_one","imgly_font_notable","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_oswald_semi_bold","imgly_font_palanquin_dark_semi_bold","imgly_font_poppins","imgly_font_permanent_marker","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sancreek","imgly_font_stint_ultra_expanded","imgly_font_trash_hand","imgly_font_vt323","imgly_font_yeseva_one"],ig=["imgly_font_abril_fatface_regular","imgly_font_amberlight","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_galano_grotesque_bold","imgly_font_handycheera_regular","imgly_font_montserrat_light","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_heavy","imgly_font_permanent_marker","imgly_font_petit_formal_script","imgly_font_rasa_500","imgly_font_rasa_regular","imgly_font_roboto_black","imgly_font_roboto_light","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sue_ellen_francisco","imgly_font_ultra","imgly_font_wolesbro"];var Tk=[{identifier:"imgly_frame_dia",name:"Dia",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_left.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_right.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",name:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",name:"Black Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",name:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",name:"Low Poly",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}}],tl=Tk;var Rk=[{identifier:He.Golden,name:"Golden",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_golden.jpg",thumbnailURI:"./items/imgly_overlay_golden_thumb.jpg"},{identifier:He.LightLeak1,name:"Lightleak",defaultBlendMode:oe.SCREEN,overlayURI:"./items/imgly_overlay_lightleak1.jpg",thumbnailURI:"./items/imgly_overlay_lightleak1_thumb.jpg"},{identifier:He.Rain,name:"Rain",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_rain.jpg",thumbnailURI:"./items/imgly_overlay_rain_thumb.jpg"},{identifier:He.Mosaic,name:"Mosaic",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_mosaic.jpg",thumbnailURI:"./items/imgly_overlay_mosaic_thumb.jpg"},{identifier:He.Vintage,name:"Vintage",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_vintage.jpg",thumbnailURI:"./items/imgly_overlay_vintage_thumb.jpg"},{identifier:He.Paper,name:"Paper",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_paper.jpg",thumbnailURI:"./items/imgly_overlay_paper_thumb.jpg"},{identifier:He.Bokeh,name:"Bokeh",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_bokeh.jpg",thumbnailURI:"./items/imgly_overlay_bokeh_thumb.jpg"},{identifier:He.Hearts,name:"Hearts",defaultBlendMode:oe.SCREEN,overlayURI:"./items/imgly_overlay_hearts.jpg",thumbnailURI:"./items/imgly_overlay_hearts_thumb.jpg"},{identifier:He.LightLeak2,name:"Lightleak 2",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_lightleak2.jpg",thumbnailURI:"./items/imgly_overlay_lightleak2_thumb.jpg"},{identifier:He.Wood,name:"Wood",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_wood.jpg",thumbnailURI:"./items/imgly_overlay_wood_thumb.jpg"},{identifier:He.Chop,name:"Chop",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_chop.jpg",thumbnailURI:"./items/imgly_overlay_chop_thumb.jpg"},{identifier:He.Metal,name:"Metal",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_metal.jpg",thumbnailURI:"./items/imgly_overlay_metal_thumb.jpg"},{identifier:He.Painting,name:"Painting",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_painting.jpg",thumbnailURI:"./items/imgly_overlay_painting_thumb.jpg"},{identifier:He.Grain,name:"Grain",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_grain.jpg",thumbnailURI:"./items/imgly_overlay_grain_thumb.jpg"},{identifier:He.Clouds,name:"Clouds",defaultBlendMode:oe.SOFT_LIGHT,overlayURI:"./items/imgly_overlay_clouds.jpg",thumbnailURI:"./items/imgly_overlay_clouds_thumb.jpg"},{identifier:He.Wall1,name:"Wall",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_wall1.jpg",thumbnailURI:"./items/imgly_overlay_wall1_thumb.jpg"},{identifier:He.Wall2,name:"Wall 2",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_wall2.jpg",thumbnailURI:"./items/imgly_overlay_wall2_thumb.jpg"}],il=Rk;var Ek=[{identifier:"imgly_sticker_emoticons",name:"Emoticons",thumbnailURI:"./categories/emoticons.png",items:[{identifier:"imgly_sticker_emoticons_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_grin.svg",tintMode:"none",name:"Grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_laugh",stickerURI:"./emoticons/imgly_sticker_emoticons_laugh.svg",tintMode:"none",name:"Laugh",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smile",stickerURI:"./emoticons/imgly_sticker_emoticons_smile.svg",tintMode:"none",name:"Smile",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_wink.svg",tintMode:"none",name:"Wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tongue_out_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_tongue_out_wink.svg",tintMode:"none",name:"Tongue out wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angel",stickerURI:"./emoticons/imgly_sticker_emoticons_angel.svg",tintMode:"none",name:"Angel",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kisses",stickerURI:"./emoticons/imgly_sticker_emoticons_kisses.svg",tintMode:"none",name:"Kisses",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loving",stickerURI:"./emoticons/imgly_sticker_emoticons_loving.svg",tintMode:"none",name:"Loving",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kiss",stickerURI:"./emoticons/imgly_sticker_emoticons_kiss.svg",tintMode:"none",name:"Kiss",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wave",stickerURI:"./emoticons/imgly_sticker_emoticons_wave.svg",tintMode:"none",name:"Wave",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_nerd",stickerURI:"./emoticons/imgly_sticker_emoticons_nerd.svg",tintMode:"none",name:"Nerd",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cool",stickerURI:"./emoticons/imgly_sticker_emoticons_cool.svg",tintMode:"none",name:"Cool",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_blush",stickerURI:"./emoticons/imgly_sticker_emoticons_blush.svg",tintMode:"none",name:"Blush",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_duckface",stickerURI:"./emoticons/imgly_sticker_emoticons_duckface.svg",tintMode:"none",name:"Duckface",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_furious.svg",tintMode:"none",name:"Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angry",stickerURI:"./emoticons/imgly_sticker_emoticons_angry.svg",tintMode:"none",name:"Angry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_steaming_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_steaming_furious.svg",tintMode:"none",name:"Steaming Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sad",stickerURI:"./emoticons/imgly_sticker_emoticons_sad.svg",tintMode:"none",name:"Sad",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_anxious",stickerURI:"./emoticons/imgly_sticker_emoticons_anxious.svg",tintMode:"none",name:"Anxious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_cry.svg",tintMode:"none",name:"Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sobbing",stickerURI:"./emoticons/imgly_sticker_emoticons_sobbing.svg",tintMode:"none",name:"Sobbing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loud_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_loud_cry.svg",tintMode:"none",name:"Loud Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wide_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_wide_grin.svg",tintMode:"none",name:"Wide grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_impatient",stickerURI:"./emoticons/imgly_sticker_emoticons_impatient.svg",tintMode:"none",name:"Impatient",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tired",stickerURI:"./emoticons/imgly_sticker_emoticons_tired.svg",tintMode:"none",name:"Tired",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_asleep",stickerURI:"./emoticons/imgly_sticker_emoticons_asleep.svg",tintMode:"none",name:"Asleep",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sleepy",stickerURI:"./emoticons/imgly_sticker_emoticons_sleepy.svg",tintMode:"none",name:"Sleepy",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_deceased",stickerURI:"./emoticons/imgly_sticker_emoticons_deceased.svg",tintMode:"none",name:"Deceased",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_attention",stickerURI:"./emoticons/imgly_sticker_emoticons_attention.svg",tintMode:"none",name:"Attention",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_question",stickerURI:"./emoticons/imgly_sticker_emoticons_question.svg",tintMode:"none",name:"Question",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",stickerURI:"./emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg",tintMode:"none",name:"Not speaking to you",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sick",stickerURI:"./emoticons/imgly_sticker_emoticons_sick.svg",tintMode:"none",name:"Sick",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pumpkin",stickerURI:"./emoticons/imgly_sticker_emoticons_pumpkin.svg",tintMode:"none",name:"Pumpkin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_boxer",stickerURI:"./emoticons/imgly_sticker_emoticons_boxer.svg",tintMode:"none",name:"Boxer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_idea",stickerURI:"./emoticons/imgly_sticker_emoticons_idea.svg",tintMode:"none",name:"Idea",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smoking",stickerURI:"./emoticons/imgly_sticker_emoticons_smoking.svg",tintMode:"none",name:"Smoking",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_beer",stickerURI:"./emoticons/imgly_sticker_emoticons_beer.svg",tintMode:"none",name:"Beer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skateboard",stickerURI:"./emoticons/imgly_sticker_emoticons_skateboard.svg",tintMode:"none",name:"Skateboard",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_guitar",stickerURI:"./emoticons/imgly_sticker_emoticons_guitar.svg",tintMode:"none",name:"Guitar",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_music",stickerURI:"./emoticons/imgly_sticker_emoticons_music.svg",tintMode:"none",name:"Music",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sunbathing",stickerURI:"./emoticons/imgly_sticker_emoticons_sunbathing.svg",tintMode:"none",name:"Sunbathing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hippie",stickerURI:"./emoticons/imgly_sticker_emoticons_hippie.svg",tintMode:"none",name:"Hippie",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_humourous",stickerURI:"./emoticons/imgly_sticker_emoticons_humourous.svg",tintMode:"none",name:"Humourous",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hitman",stickerURI:"./emoticons/imgly_sticker_emoticons_hitman.svg",tintMode:"none",name:"Hitman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_harry_potter",stickerURI:"./emoticons/imgly_sticker_emoticons_harry_potter.svg",tintMode:"none",name:"Harry Potter",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_business",stickerURI:"./emoticons/imgly_sticker_emoticons_business.svg",tintMode:"none",name:"Business",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_batman",stickerURI:"./emoticons/imgly_sticker_emoticons_batman.svg",tintMode:"none",name:"Batman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skull",stickerURI:"./emoticons/imgly_sticker_emoticons_skull.svg",tintMode:"none",name:"Skull",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_ninja",stickerURI:"./emoticons/imgly_sticker_emoticons_ninja.svg",tintMode:"none",name:"Ninja",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_masked",stickerURI:"./emoticons/imgly_sticker_emoticons_masked.svg",tintMode:"none",name:"Masked",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_alien",stickerURI:"./emoticons/imgly_sticker_emoticons_alien.svg",tintMode:"none",name:"Alien",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wrestler",stickerURI:"./emoticons/imgly_sticker_emoticons_wrestler.svg",tintMode:"none",name:"Wrestler",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_devil",stickerURI:"./emoticons/imgly_sticker_emoticons_devil.svg",tintMode:"none",name:"Devil",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_star",stickerURI:"./emoticons/imgly_sticker_emoticons_star.svg",tintMode:"none",name:"Star",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_baby_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_baby_chicken.svg",tintMode:"none",name:"Baby Chicken",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_rabbit",stickerURI:"./emoticons/imgly_sticker_emoticons_rabbit.svg",tintMode:"none",name:"Rabbit",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pig",stickerURI:"./emoticons/imgly_sticker_emoticons_pig.svg",tintMode:"none",name:"Pig",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_chicken.svg",tintMode:"none",name:"Chicken",resizeMode:"keepAspect"}]},{identifier:"imgly_sticker_shapes",name:"Shapes",thumbnailURI:"./categories/shapes.png",items:[{identifier:"imgly_sticker_shapes_badge_01",stickerURI:"./shapes/imgly_sticker_shapes_badge_01.svg",tintMode:"solid",name:"Shape Badge 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_04",stickerURI:"./shapes/imgly_sticker_shapes_badge_04.svg",tintMode:"solid",name:"Shape Badge 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_12",stickerURI:"./shapes/imgly_sticker_shapes_badge_12.svg",tintMode:"solid",name:"Shape Badge 12",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_06",stickerURI:"./shapes/imgly_sticker_shapes_badge_06.svg",tintMode:"solid",name:"Shape Badge 06",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_13",stickerURI:"./shapes/imgly_sticker_shapes_badge_13.svg",tintMode:"solid",name:"Shape Badge 13",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_36",stickerURI:"./shapes/imgly_sticker_shapes_badge_36.svg",tintMode:"solid",name:"Shape Badge 36",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_08",stickerURI:"./shapes/imgly_sticker_shapes_badge_08.svg",tintMode:"solid",name:"Shape Badge 08",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_11",stickerURI:"./shapes/imgly_sticker_shapes_badge_11.svg",tintMode:"solid",name:"Shape Badge 11",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_35",stickerURI:"./shapes/imgly_sticker_shapes_badge_35.svg",tintMode:"solid",name:"Shape Badge 35",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_28",stickerURI:"./shapes/imgly_sticker_shapes_badge_28.svg",tintMode:"solid",name:"Shape Badge 28",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_32",stickerURI:"./shapes/imgly_sticker_shapes_badge_32.svg",tintMode:"solid",name:"Shape Badge 32",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_15",stickerURI:"./shapes/imgly_sticker_shapes_badge_15.svg",tintMode:"solid",name:"Shape Badge 15",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_20",stickerURI:"./shapes/imgly_sticker_shapes_badge_20.svg",tintMode:"solid",name:"Shape Badge 20",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_18",stickerURI:"./shapes/imgly_sticker_shapes_badge_18.svg",tintMode:"solid",name:"Shape Badge 18",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_19",stickerURI:"./shapes/imgly_sticker_shapes_badge_19.svg",tintMode:"solid",name:"Shape Badge 19",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_02",stickerURI:"./shapes/imgly_sticker_shapes_arrow_02.svg",tintMode:"solid",name:"Shape Arrow 02",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_03",stickerURI:"./shapes/imgly_sticker_shapes_arrow_03.svg",tintMode:"solid",name:"Shape Arrow 03",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_01",stickerURI:"./shapes/imgly_sticker_shapes_spray_01.svg",tintMode:"solid",name:"Shape Spray 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_04",stickerURI:"./shapes/imgly_sticker_shapes_spray_04.svg",tintMode:"solid",name:"Shape Spray 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_03",stickerURI:"./shapes/imgly_sticker_shapes_spray_03.svg",tintMode:"solid",name:"Shape Spray 03",resizeMode:"keepAspect"}]}],rl=Ek;var Fk=[{thumbnailURI:"./items/dark/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/dark/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/dark/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/dark/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/dark/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/dark/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/dark/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/dark/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/dark/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/dark/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/dark/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/dark/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/dark/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/dark/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],rg=Fk;var Sk=[{thumbnailURI:"./items/light/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/light/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/light/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/light/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/light/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/light/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/light/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/light/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/light/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/light/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/light/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/light/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/light/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/light/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],sg=Sk;var Ok=[{identifier:"imgly_transforms_common",name:"Common",items:[{identifier:"imgly_transform_common_custom",name:"Custom",thumbnailURI:"",ratio:"*"},{identifier:"imgly_transform_common_square",name:"Square",thumbnailURI:"",ratio:1},{identifier:"imgly_transform_common_4",name:"4:3",thumbnailURI:"",ratio:4/3},{identifier:"imgly_transform_common_16",name:"16:9",thumbnailURI:"",ratio:16/9},{identifier:"imgly_transform_common_3",name:"3:4",thumbnailURI:"",ratio:3/4},{identifier:"imgly_transform_common_9",name:"9:16",thumbnailURI:"",ratio:9/16}]},{identifier:"imgly_transforms_facebook",name:"Facebook",items:[{identifier:"imgly_transform_facebook_profile",name:"Profile",thumbnailURI:"",dimensions:{x:300,y:300},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_title",name:"Title",thumbnailURI:"",dimensions:{x:1200,y:627},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_post",name:"Post",thumbnailURI:"",dimensions:{x:940,y:788},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_instagram",name:"Instagram",items:[{identifier:"imgly_transform_instagram_landscape",name:"Landscape",thumbnailURI:"",dimensions:{x:1080,y:566},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_portrait",name:"Portrait",thumbnailURI:"",dimensions:{x:1080,y:1350},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_square",name:"Square",thumbnailURI:"",dimensions:{x:1080,y:1080},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_story",name:"Story",thumbnailURI:"",dimensions:{x:1080,y:1920},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_twitter",name:"Twitter",items:[{identifier:"imgly_transform_twitter_post",name:"Post",thumbnailURI:"",dimensions:{x:1024,y:512},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_profile",name:"Profile",thumbnailURI:"",dimensions:{x:400,y:400},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_title",name:"Title",thumbnailURI:"",dimensions:{x:1500,y:500},forceDimensions:!0,lockDimensions:!0}]}],sl=Ok;var gg=Ur(ol());var zk={italic:"i"},Sn=class{constructor(e){this.assetManager=e;this.injectedFonts={};this.loadedFonts={};this.isFontLoaded=e=>this.loadedFonts[e]!==void 0;this.getGoogleFamiliesString=e=>{let t=e.reduce((i,r)=>{let{fontFamily:o,fontStyle:n,fontWeight:a=400}=r;return i[o]=(i[o]||[]).concat(`${a}${zk[n]||""}`),i},{});return Object.keys(t).map(i=>{let r=t[i].length?`:${t[i].join(",")}`:"";return i.replace(" ","+")+r}).join("|")}}static createFontFacesCSS(e,t){return e.map(i=>{let r=t(i.fontURI);return`@font-face {
        font-family: "${i.fontFamily}";
        src: url('${r}') format('${i.format||"woff"}');
        font-weight: ${i.fontWeight||"normal"};
        font-style: ${i.fontStyle||"normal"};
      }`})}getFontWithId(e){let t=this.assetManager.getFontAsset(e);if(!t)throw new Error("The requested font does not exist as an asset.");return t}injectAllFonts(){let e=this.assetManager.getFontAssets();this.injectFonts(e)}loadAllFonts(){return Ge(this,null,function*(){let e=this.assetManager.getFontAssets();return this.loadFonts(e)})}loadFontsWithIdentifiers(e){return Ge(this,null,function*(){let t=e.map(i=>this.getFontWithId(i));return this.loadFonts(t)})}loadFonts(e){return Ge(this,null,function*(){return this.injectFonts(e),(0,gg.default)(e,t=>this.loadFont(t,!1),{stopOnError:!1}).then(()=>{})})}loadFont(e,t=!0){return Ge(this,null,function*(){return new Promise((i,r)=>{this.isFontLoaded(e.identifier)&&i(),t&&this.injectFonts([e]),new pr(e).load().then(()=>{this.loadedFonts[e.identifier]=e,i()}).catch(n=>{r(e.identifier)})})})}loadFontWithIdentifier(e,t=!0){return Ge(this,null,function*(){let i=this.assetManager.getFontAsset(e);if(!i)throw new Error(`The requested font asset with identifier ${e} does not exist!`);return this.loadFont(i,t)})}injectFonts(e,t=this.assetManager.getPathForCategory("font")){let i=e.filter(Vf),r=e.filter(Wf);i.length>0&&this.addGoogleFontLinks(i),r.length>0&&this.addWebFontCSS(r,t)}addGoogleFontLinks(e){let t=e.filter(n=>!this.injectedFonts[n.identifier]);if(t.length===0)return;let i=this.getGoogleFamiliesString(t),r=document.createElement("link");r.rel="stylesheet",r.href=`https://fonts.googleapis.com/css?family=${i}`,document.getElementsByTagName("head")[0].appendChild(r),e.forEach(n=>{this.injectedFonts[n.identifier]=n})}addWebFontCSS(e,t){let i=e.filter(a=>!this.injectedFonts[a.identifier]);if(i.length===0)return;let o=`
      /* Injected by PhotoEditorSDK */
      ${Sn.createFontFacesCSS(i,t).join(`
`)}
    `,n=document.createElement("style");n.innerHTML=o,document.head.appendChild(n),e.forEach(a=>{this.injectedFonts[a.identifier]=a})}};var pm=class{constructor(e,t=!1,i){this.assetResolver=i;this.basePath="assets/";this.areCustomAssetsAllowed=!1;this.getAssets=e=>{switch(e){case"overlay":return this.overlayAssets;case"filter":return this.filterCategories;case"font":return this.fontAssets;case"focus":return this.focusAssets;case"adjustment":return this.adjustmentCategories;case"sticker":return this.stickerCategories;case"textdesign":return this.textDesignAssets;case"frame":return this.frameAssets;case"transform":return this.transformCategories}return[]};this.getPath=(e,t)=>{let{assetResolver:i={}}=this,r=t&&i.item?i.item(t,e):t;if((r==null?void 0:r.match(/data:image/g))||(r==null?void 0:r.match(/(ftp|http|https):\/\//))&&Fn(r))return r;if(!r&&Fn(e))return e;let o=r?Rn(e,r):Rn(e),n;if(this.basePath.match(/(ftp|http|https):\/\//)){let{length:a}=this.basePath;this.basePath[a-1]!=="/"&&(this.basePath=`${this.basePath}/`),n=this.basePath+o}else n=Rn(this.basePath,o);return i.path?i.path(n,e,r):n};this.getPathForCategory=e=>(...t)=>this.getPath(e,...t);this.addCustomStickerAsset=(e,t,i)=>{e.forEach(r=>{let{thumbnailURI:o,name:n,stickerURI:a,identifier:l,tintMode:u,resizeMode:c}=r,p=this.stickerCategories.find(d=>d.identifier===t),m={identifier:l,name:n,thumbnailURI:o,stickerURI:a,tintMode:u,resizeMode:c};if(p)p.items.push(m),p.thumbnailURI=o;else{let d={identifier:t,name:i,thumbnailURI:o,items:[m]};this.stickerCategories=[d,...this.stickerCategories]}}),this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[])};this.getItemPath=(e,t,i)=>{let r=e.find(o=>o.identifier===t);return r&&(r[i]||r.path)||""};this.isNonExistingFont=e=>!el.find(t=>t.identifier===e.identifier)&&!Bi[e.identifier];this.replaceDeprecatedFont=e=>Bi[e.identifier]?el.find(t=>t.identifier===ho(e.identifier,!0)):e;var p,m;(e==null?void 0:e.basePath)&&(this.basePath=e.basePath),this.areCustomAssetsAllowed=t;let r=Qa.reduce(this.allOptions,[]);e&&e.filter?this.filterCategories=this.configuredCategory(Qa,e.filter,r):this.filterCategories=Qa,this.lutFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>Gf(d)),this.duoToneFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>Uf(d));let o=Za.reduce(this.allOptions,[]);e&&e.adjustment?this.adjustmentCategories=this.configuredCategory(Za,e.adjustment,o):this.adjustmentCategories=Za,this.fontAssets=el.reduce(this.allOptions,[]);let n=tg.map(d=>this.getFontAsset(d));if(((m=(p=e==null?void 0:e.text)==null?void 0:p.fonts)==null?void 0:m.length)>0){n=e.text.fonts.map(f=>{if(this.isNonExistingFont(f))return f;let b=this.replaceDeprecatedFont(f);return this.getFontAsset(b.identifier)});let d=e.text.fonts.filter(this.isNonExistingFont);this.fontAssets=e.text.fonts?[...this.fontAssets,...d]:this.fontAssets}this.textToolFontAssets=n;let a=e&&e.focus&&e.focus.items&&e.focus.items.length?e.focus.items.map(d=>dm.find(f=>f.identifier===d.identifier)):dm;this.focusAssets=a,e&&e.overlay&&e.overlay.items?this.overlayAssets=this.configuredItem(e.overlay.items,il,il):this.overlayAssets=il,e&&e.frame&&e.frame.items?this.frameAssets=this.configuredItem(e.frame.items,tl,tl):this.frameAssets=tl;let l=rl.reduce(this.allOptions,[]);e&&e.sticker?this.stickerCategories=this.configuredCategory(rl,e.sticker,l):this.stickerCategories=rl,this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[]);let u=rg;e&&e.theme==="light"&&(u=sg),this.textDesignAssets=e&&e.textdesign&&e.textdesign.items&&e.textdesign.items.length?e.textdesign.items.map(d=>u.find(f=>f.identifier===d.identifier)):u,this.textDesignToolFontAssets=ig.map(d=>this.getFontAsset(d));let c=sl.reduce(this.allOptions,[]);e&&e.transform?this.transformCategories=this.configuredCategory(sl,e.transform,c,We.TRANSFORM):this.transformCategories=sl,this.transformAssets=this.transformCategories.reduce(this.allOptions,[]),this.fontManager=new Sn(this)}getFontManager(){return this.fontManager}getAssetSource(e,t){switch(e){case"filter":if(this.getLUTFilterAsset(t))return this.getPath(e,this.getItemPath(this.lutFilterAssets,t,"lutURI"));break;case"overlay":return this.getPath(e,this.getItemPath(this.overlayAssets,t,"overlayURI"));case"font":return this.getPath(e,this.getItemPath(this.fontAssets,t,"fontURI"));case"sticker":let r=this.stickerAssets.find(o=>o.identifier===t);if(r){if(r.stickerURI.substr(0,10)==="data:image")return r.stickerURI;if(t.includes("imgly_sticker")&&r.stickerURI.includes(".svg")&&Xa()){let n=this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI")).split("/");return n.splice(n.length-1,0,"base"),n[n.length-1]=n[n.length-1].replace(".svg",".png"),n.join("/")}return this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI"))}throw new Error("Cannot resolve this type of sticker asset yet");case"textdesign":return this.getPath(Rn(e,"engine"),t);case"frame":return this.getPath(e,t)}throw new Error("Cannot resolve this type of asset yet")}getDuotoneFilterAsset(e){return this.duoToneFilterAssets.filter(t=>t.identifier===e)[0]}getLUTFilterAsset(e){return this.lutFilterAssets.filter(t=>t.identifier===e)[0]}getOverlayAsset(e){return this.overlayAssets.filter(t=>t.identifier===e)[0]}getStickerAsset(e){return this.stickerAssets.filter(t=>t.identifier===e)[0]}getFontAsset(e){return this.fontAssets.filter(t=>t.identifier===e)[0]}getTextDesignAssets(e){return this.textDesignAssets.filter(t=>t.identifier===e)[0]}getFrameAsset(e){return this.frameAssets.filter(t=>t.identifier===e)[0]}getFontAssets(){return this.fontAssets}getFontAssetsForText(){return this.textToolFontAssets}getFontAssetsForTextDesign(){return this.textDesignToolFontAssets}getFrameAssets(){return this.frameAssets}allOptions(e,t){return Object.prototype.hasOwnProperty.call(t,"items")?[...e,...t.items]:[...e,t]}configuredCategory(e,t,i,r){return t.categories&&t.categories.length?t.categories.reduce((o,n)=>{let a=e.find(l=>l.identifier===n.identifier);return a?o.push(N(D(D({},a),n),{items:this.configuredItem(n.items,i,a.items,r).filter(Boolean)})):(this.areCustomAssetsAllowed||r===We.TRANSFORM)&&o.push(N(D({},n),{items:this.configuredItem(n.items,i,n.items,r).filter(Boolean)})),o},[]):e}configuredItem(e,t,i,r){return e&&e.length?e.reduce((o,n)=>{let a=t.find(l=>l.identifier===n.identifier);return a?o.push(D(D({},a),n)):(this.areCustomAssetsAllowed||r===We.TRANSFORM)&&o.push(n),o},[]).filter(Boolean):i}};var fm=class{static contains(e,t){return t.x>=e.minX&&t.x<=e.maxX&&t.y>=e.minY&&t.y<=e.maxY}constructor(e,t,i,r){if(typeof e=="number")if(typeof t=="number"&&i!==void 0&&r!==void 0)this.origin={x:e,y:t},this.size={width:i||0,height:r||0};else throw new Error("Invalid arguments passed to Rect. Expected (number, number, number, number)");else{if(this.origin=e,typeof t=="number")throw new Error("Invalid arguments passed to Rect. Expected (Float2, Size)");this.size=t}}get minX(){return this.origin.x}get minY(){return this.origin.y}get midX(){return this.origin.x+.5*this.size.width}get midY(){return this.origin.y+.5*this.size.height}get maxX(){return this.origin.x+this.size.width}get maxY(){return this.origin.y+this.size.height}get width(){return this.size.width}get height(){return this.size.height}},Ve=fm;Ve.ZERO=new fm({x:0,y:0},{width:0,height:0});var zi=class{constructor(e,t,i,r,o,n){this.a=e;this.b=t;this.c=i;this.d=r;this.tx=o;this.ty=n}static fromScale(e,t){return new zi(e,0,0,t,0,0)}static fromRotation(e){let t=Math.cos(e),i=Math.sin(e);return new zi(t,-i,i,t,0,0)}static fromRotationDeg(e){let t=Math.PI*e/180;return this.fromRotation(t)}static fromTranslation(e,t){return new zi(1,0,0,1,e,t)}static fromTRS(e,t,i,r,o){let n=Math.cos(i),a=Math.sin(i);return new zi(r*n,-o*a,r*a,o*n,e,t)}static multiply(e,t){let i=e.a*t.a+e.b*t.c,r=e.a*t.b+e.b*t.d,o=e.c*t.a+e.d*t.c,n=e.c*t.b+e.d*t.d,a=e.a*t.tx+e.b*t.ty+e.tx,l=e.c*t.tx+e.d*t.ty+e.ty;return new zi(i,r,o,n,a,l)}static transformPoint(e,t){return{x:e.a*t.x+e.b*t.y+e.tx,y:e.c*t.x+e.d*t.y+e.ty}}static getInverted(e){let t=e.a*e.d-e.b*e.c;if(t===0)return e;let i=1/t,r=i*e.d,o=-i*e.b,n=-i*e.c,a=i*e.a,l=i*(e.b*e.ty-e.d*e.tx),u=i*(e.c*e.tx-e.a*e.ty);return new zi(r,o,n,a,l,u)}},ie=zi;ie.IDENTITY=zi.fromScale(1,1);function _g(s){return typeof s=="number"}var gm=s=>s<0;var _m=s=>gm(s)?-s:s;var nl=s=>s*(Math.PI/180),Nk=s=>s*(180/Math.PI),Nt;(function(r){r[r.Top=0]="Top",r[r.Right=90]="Right",r[r.Bottom=180]="Bottom",r[r.Left=270]="Left"})(Nt||(Nt={}));var al={[0]:nl(0),[90]:nl(90),[180]:nl(180),[270]:nl(270)},yg=Object.values(al),ym=s=>{let e=Math.round(Nk(_m(s)));return gm(s)&&(e===270?e=90:e===90&&(e=270)),al[e%360]},wM=s=>s===0?s:360-_m(s),CM=s=>Qf(yg,ym(s)),DM=s=>eg(yg,ym(s)),kM=s=>{let e=ym(s);return e===al[270]||e===al[90]};var je=class{static get IDENTITY(){return new je({x:0,y:0})}constructor(e,t={x:1,y:1},i=0){this.position=e,this.scale=t,this.rotation=i}};var H={};Ne(H,{absoluteToRelativePoint:()=>Kk,absoluteToRelativeSize:()=>Hk,getBaseLocalToWorldMatrix:()=>ll,getLocalToParentMatrix:()=>xg,getLocalToWorldMatrix:()=>po,getPointInWorldSpace:()=>vm,getRotationBetweenCoordinateSpaces:()=>Xk,getScalarInWorldSpace:()=>Wk,getSizeInOutputSpace:()=>Vk,getSizeInWorldSpace:()=>vg,pointFromSpaceToSpace:()=>On,rectTransformToAffineTransform:()=>bm,relativeToAbsolutePoint:()=>qk,relativeToAbsoluteSize:()=>jk,scalarFromSpaceToSpace:()=>xm,sizeFromSpaceToSpace:()=>Gk});function bg(s){return s.x!==void 0}function bm(s){return ie.fromTRS(s.position.x,s.position.y,s.rotation,s.scale.x,s.scale.y)}function Uk(s){return s.getBaseLocalToParentMatrix?s.getBaseLocalToParentMatrix():bm(s.getTransform())}function ll(s){let e=s.getParent(),t=Uk(s);if(e===void 0)return t;let i=ll(e);return ie.multiply(i,t)}function xg(s){return s.getLocalToParentMatrix?s.getLocalToParentMatrix():bm(s.getTransform())}function po(s){let e=s.getParent(),t=xg(s);if(e===void 0)return t;let i=po(e);return ie.multiply(i,t)}function On(s,e,t,i=!1){let r=e.type==="output"&&i?ll(e):po(e),o=t.type==="output"&&i?ll(t):po(t),n=ie.getInverted(o);return ie.transformPoint(n,ie.transformPoint(r,s))}function xm(s,e,t){let i=new le(s,0),r=new le(On(i,e,t)),o=new le(On(le.ZERO,e,t));return le.distance(o,r)}function Gk(s,e,t){let i=bg(s)?s.x:s.width,r=bg(s)?s.y:s.height,o=xm(i,e,t),n=xm(r,e,t);return{width:o,height:n}}function vm(s,e){let t=po(e);return ie.transformPoint(t,s)}function Wk(s,e){let t=new le(s,0),i=new le(vm(t,e)),r=new le(vm(le.ZERO,e));return le.distance(i,r)}function vg(s){let e=po(s),t=s.getBounds(),i={x:t.width,y:0},r={x:0,y:t.height},o=new le(ie.transformPoint(e,le.ZERO)),n=new le(ie.transformPoint(e,i)),a=new le(ie.transformPoint(e,r)),l=le.distance(o,n),u=le.distance(o,a);return{width:l,height:u}}function Vk(s,e){let t=vg(s),i=e.getTransform().scale,r={x:1/i.x,y:1/i.y};return{width:t.width*r.x,height:t.height*r.y}}function jk(s,e){let t=e.getBounds();return{width:s.width*t.width,height:s.height*t.height}}function Hk(s,e){let t=e.getBounds();return{width:s.width/t.width,height:s.height/t.height}}function qk(s,e,t=!0){let i=e.getBounds();return{x:s.x*i.width+(t?0:i.minX),y:s.y*i.height+(t?0:i.minY)}}function Kk(s,e,t=!0){let i=e.getBounds();return{x:(s.x-(t?0:i.minX))/i.width,y:(s.y-(t?0:i.minY))/i.height}}function Xk(s,e){let i=On({x:1,y:0},s,e,!0),r=On(le.ZERO,s,e,!0);return Math.atan2(i.y-r.y,i.x-r.x)}function wg(s){return typeof s!="string"&&!Array.isArray(s)&&s.a===void 0}function Cg(s){return typeof s!="string"&&Array.isArray(s)&&s.length===3}function Dg(s){return typeof s!="string"&&!Array.isArray(s)&&s.a!==void 0}function kg(s){return typeof s!="string"&&Array.isArray(s)&&s.length===4}function Tg(s){return typeof s=="string"}var An;(function(i){i.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",i.IMAGE_DOWNSCALED="imageDownscaled",i.WEBGL_CONTEXT_LOST="context-lost"})(An||(An={}));var wm=class{constructor(e,t){this.engine=t;this.transform=je.IDENTITY;this.canvasPivot={x:0,y:0};this.previewQuality=1;this.canvas=e}get quality(){return this.previewQuality}setQuality(e){this.previewQuality=Math.min(Math.max(e,.01),1)}getTransform(){return this.transform}setTransform(e){this.transform=e}getPosition(){return this.transform.position}setPosition(e,t){let i;typeof e=="number"?i={x:e,y:t===void 0?e:t}:i=e;let{scale:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new je(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;typeof e!="number"?i=e:i={x:e,y:t===void 0?e:t};let{position:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new je(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){let{position:t}=this.transform,{scale:i}=this.transform;this.setTransform(new je(t,i,e))}getCanvasPivot(){return this.canvasPivot}setCanvasPivot(e,t){typeof e=="number"?this.canvasPivot={x:e,y:typeof t===void 0?e:t}:this.canvasPivot=e}getCanvasBounds(){let e=this.canvasPivot,{width:t,height:i}=this.canvas;return new Ve(-e.x*t,-e.y*i,t,i)}};function ul(s){return s.getTransform!==void 0}function Rg(s){return s.getContainer!==void 0}var Cm=s=>2*Math.PI-s,Yk=s=>-s,WB=({rotation:s,outputRotation:e=0,flipHorizontally:t,flipVertically:i})=>{let r=s;return t&&(r=Cm(r)),i&&(r=Yk(r)),r+e};we();vo();tp();Lr();nn();we();var Fs=class{static downloadDataURL(e,t="photoeditorsdk-export"){let i=this.createBlobURLFromDataURL(e),r=this.getExtensionFromDataURL(e),o=document.createElement("a");o.download=`${t}.${r}`,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o)}static downloadMSBlob(e,t="photoeditorsdk-export"){navigator.msSaveBlob&&navigator.msSaveBlob(e,`${t}.png`)}static getExtensionFromDataURL(e){return e.split(",")[0].split(":")[1].split(";")[0].split("/").pop()}static createBlobURLFromDataURL(e){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return e;let t=Qh.decode(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r);for(let a=0;a<t.length;a++)o[a]=t[a];let n=new window.Blob([r],{type:i});return window.URL.createObjectURL(n)}};we();var tc=class{constructor(e,t,i){this._sdk=e,this._options=t,this._download=i}export(){let e=this._getRenderType();return this._sdk.export(e,this._options.format,this._options.quality).then(t=>(this._download&&this._downloadData(e,t),t))}_downloadData(e,t){switch(e){case Br.DATAURL:Fs.downloadDataURL(t,this._options.fileBasename);break;case Br.MSBLOB:Fs.downloadMSBlob(t,this._options.fileBasename);break}}_getRenderType(){let e=this._options;return e.type!==Br.IMAGE||!this._download?e.type:yt.supportsMSBlob()?Br.MSBLOB:Br.DATAURL}};Lr();we();we();var ic=class{constructor(e,t,i){this._editor=e,this._sdk=t,this._mediator=i,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}exists(e){return!!this._map[e]}add(e){let{identifier:t}=e.constructor;e.on("update",()=>{this._mediator.emit(Re.EVENTS.OPERATION_UPDATED,e)});let i=this._preferredOrder.indexOf(t);if(i===-1)throw new Error(`EditorOperations#add: \`${t}\` does not appear in \`operationsOrder\``);this._stack.set(i,e),this._map[t]=e,this._mediator.emit(Re.EVENTS.OPERATION_CREATED,e)}remove(e,t=!0){let i=typeof e=="object"?e.constructor.identifier:e,r=this._stack.getStack();e=this.get(i),delete this._map[i];let o=r.map(n=>n.constructor.identifier).indexOf(i);if(o!==-1){this._stack.removeAt(o);for(let n=o+1;n<r.length;n++){let a=r[n];!a||a.setDirty(!0)}t&&this._mediator.emit(Re.EVENTS.OPERATION_REMOVED,e)}}get(e){return this._map[e]}getOrCreate(e,t={}){if(this._map[e]){let o=this._map[e];return o.set(t,!1),o}let i=this._available[e],r=new i(this._sdk,t);return this.add(r),r}getStack(){return this._stack}reset(){this._map={}}_fixStack(){let e=this._stack.getStack().slice();this._stack.clear(),e.forEach(t=>{this.add(t)})}};we();var rc=class{constructor(e,t,i){this._image=e,this._maxPixels=t,this._maxDimensions=i}needsResize(){let e=new ae(this._image.width,this._image.height),i=e.x*e.y>this._maxPixels,r=this._maxDimensions!==null&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return i||r}resize(){let e=null,t=null,i=this._maxDimensions;return new Promise((r,o)=>{window.setTimeout(()=>{let a=new ae(this._image.width,this._image.height).clone();if(a.x*a.y>this._maxPixels&&(a.copy(this._getDimensionsByMaxPixels()),e="maxMegaPixels"),i!==null&&(a.x>i||a.y>i)){let l=Math.min(i/a.x,i/a.y);a.multiply(l),e="maxDimensions"}a.floor(),t=this._createResizedImageCanvas(a),r({canvas:t,dimensions:a,reason:e})},1e3)})}_createResizedImageCanvas(e,t=e){let i=this._image,r=document.createElement("canvas");r.width=e.x,r.height=e.y;let o=e.clone().subtract(t).divide(2);return r.getContext("2d").drawImage(i,0,0,i.width,i.height,o.x,o.y,t.x,t.y),r}_getDimensionsByMaxPixels(){let e=this._image,t=this._maxPixels,i=e.width/e.height,r=e.height/e.width;return new ae(Math.sqrt(t*i),Math.sqrt(t*r)).floor()}};var wC=class extends va{constructor(e,t,i,r=!1){super();this._ui=e,this._options=t,this._mediator=i,this._shallow=r,r||(this._initSDK(),this.operations=new ic(this,this._sdk,this._mediator))}_initFonts(){let e=be.defaults(this._options.editor.controlsOptions.text,{additionalFonts:[],replaceFonts:!1,availableVariations:null});this._fontManager=new ut(this._ui,e);let t=this._fontManager.getFonts(),i=this._ui.getFontLoader();i.setFonts(t),i.load()}setImage(e=this._options.editor.image,t=!0){t&&this.reset();let i=null;i=this._sdk.parseExif(e),this._setImage(e,i)}_initSDK(){let{logLevel:e,displayWelcomeMessage:t,debug:i,license:r,crossOrigin:o,watermark:n}=this._options,{smoothDownscaling:a,smoothUpscaling:l,preferredRenderer:u,pixelRatio:c,transparent:p,clearColor:m}=this._options.editor,d;Array.isArray(m)?d=pe.fromArray(m):typeof m=="string"?d=pe.fromHex(m):m instanceof pe&&(d=m.clone());let f={logLevel:e,debug:i,displayWelcomeMessage:t,pixelRatio:c,smoothDownscaling:a,smoothUpscaling:l,transparent:p,crossOrigin:o,clearColor:d,license:r,watermark:n};this._sdk=new W(u,f)}getMaxMegapixels(){let{maxMegaPixels:e}=this._options.editor;return e}getCrossOrigin(){return be.getCrossOriginValue(this._options.crossOrigin||"anonymous")}getOutputDimensions(e=!1){return this._sdk.getOutputDimensions(e)}getOutputTextureDimensions(e=!1){return this._sdk.getOutputTextureDimensions(e)}getFinalDimensions(e=!1){return this._sdk.getFinalDimensions(e)}_setImage(e=this._options.editor.image,t=null){this._sdk.setAllOperationsToDirty(),this._options.editor.image=e,this._sdk.setImage(e,t)}_ensureImageIsResized(){let e=this._sdk.getImage(),t=this._sdk.getRenderer(),i=this.getMaxMegapixels(),r=i?i*1e6:null,o=t.getMaxDimensions(),n=new rc(e,r,o);return!this._resizedImage&&n.needsResize()?n.resize().then(({canvas:a,dimensions:l,reason:u})=>(this._resizedImage=a,this._sdk.setImage(a),a)):Promise.resolve(e)}export(e=!1){return this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty(),this._ensureImageIsResized().then(t=>{let i=this._options.editor.export;return new tc(this._sdk,i,e).export().then(o=>(this.emit("export",o),this._mediator.emit(Re.EVENTS.EXPORT,o,this),this._watermarkOperation&&(this._watermarkOperation.setEnabled(!0),this._sdk.render()),this._sdk.setAllOperationsToDirty(),o))})}broadcastTransform(e,t){let i=new W.Operations.TransformOperation.TransformChange(e,t);["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"].forEach(o=>{let n=this.operations.get(o);!n||n.transform(i)})}broadcastFlip(e){["mirrored-focus","radial-focus","linear-focus","sprite","selective-blur"].forEach(i=>{let r=this.operations.get(i);!r||r.flip(e)})}broadcastRotate(e){["transform","mirrored-focus","linear-focus","radial-focus","sprite","selective-blur"].forEach(i=>{let r=this.operations.get(i);!r||r.rotate(e)})}_initSerializers(){this._serializers={"1.0.0":(qw(),Hw).default,"1.0.1":(Yw(),Xw).default,"2.0.0":(eC(),Qw).default,"3.0.0":(iC(),tC).default,"3.1.0":(sC(),rC).default,"3.2.0":(nC(),oC).default,"3.4.0":(lC(),aC).default,"3.5.0":(cC(),uC).default,"3.6.0":(dC(),mC).default,"3.7.0":(pC(),hC).default,"3.8.0":(gC(),fC).default,"3.9.0":(vC(),xC).default}}serialize(e={},t="3.9.0"){let i=this._serializers[t];return i?new i(this).serialize(e):Promise.reject(new Error(`No serializer for version ${t} found.`))}deserialize(e){let t=this._serializers[e.version];return t?new t(this).deserialize(e):Promise.reject(new Error(`No serializer for version ${e.version} found.`))}save(e=!1,t=!1){let i=this._options.editor.save;return this.serialize({image:t}).then(r=>{let o=JSON.stringify(r,null,2);if(e){let n=`data:text/json;charset=utf-8;base64,${window.encodeURI(window.btoa(o))}`;Fs.downloadDataURL(n,i.fileBasename)}return o})}reset(){this._sdk.reset(),this.operations.reset()}dispose(){this.stop(),this._sdk.dispose()}getRenderer(){return this._sdk.getRenderer()}getSDK(){return this._sdk}getInputDimensions(){return this._sdk.getInputDimensions()}getImage(){return this._sdk.getImage()}getOptions(){return this._options}getUI(){return this._ui}getMediator(){return this._mediator}},CC=wC;ac();var er=class extends va{constructor(e={}){super();this._mediator=new va,this._fontLoader=new zr(this),this._options=e,this._initOptions(),this._initEvents(),this._disposed=!1,this._isReady=!1,this._editor=new CC(this,this._options,this._mediator),this._options.editor.image&&this._editor.setImage(this._options.editor.image),this._mediator.once(Re.EVENTS.EDITOR_READY,()=>{this._isReady=!0}),B.setLevel(this._options.logLevel)}export(...e){return this._editor.export(...e)}serialize(...e){return this._editor.serialize(...e)}deserialize(e){return this._editor.deserialize(e)}getEditor(){return this._editor}isReady(){return this._isReady}onReady(e){this._isReady?e():this._mediator.once(Re.EVENTS.EDITOR_READY,e)}createFilter(e){return new Rs(this,this._getOptions("filter")).instantiateFilterWithIdentifier(e)}getTextDesignLayoutByID(e){let t=new Yt(this,this._getOptions("textDesign"));return new(t.getLayoutByIdentifier(e))}getTextDesignAssetManager(){return W.Operations.SpriteOperation.TextDesignSprite.AssetManager}getTextDesignFontManager(){return new ut(this,{fonts:Re.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0,isTextDesign:!0})}_getOptions(e){let t=this.getEditor(),{controls:i}=t,r={};i&&i.get(e)&&(r=i.get(e).defaultOptions);let o=t.getOptions();return be.deepDefaults({},o.editor.controlsOptions[e]||{},r)}_initOptions(){if(this._options=be.defaults(this._options,{language:"en",logLevel:"warn",crossOrigin:"anonymous",editor:{},assets:{},responsive:!1,preloader:!0,autoRun:!0}),this._options.editor=be.defaults(this._options.editor||{},{enableZoom:!0,enableDrag:!0,enableExport:!0,enableKeyboardControls:!0,enablePositionSnapping:!0,enableRotationSnapping:!0,enableSave:!1,enableLoad:!1,pixelRatio:Math.max(typeof window!="undefined"&&window.devicePixelRatio||1,1),preferredRenderer:"webgl",transparent:!0,clearColor:[0,0,0,0],displayResizeMessage:!0,maxMegaPixels:{},displayCloseButton:!1,undoMode:"global",defaultControl:"filter",forceCrop:!1,snappingOptions:{},tools:["transform","filter","adjustments","focus","text","textdesign","sticker","brush","frame","overlay","library","artfilter"],controlsOrder:[["library"],["artfilter","transform","filter","adjustments","focus"],["text","textdesign","sticker","brush","frame","overlay"]],operationsOrder:["exif-orientation","artfilter","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","linear-focus","blur","selective-blur","overlay","sprite","frame"],controlsOptions:{focus:{highQualityCanvasBlur:!1}}}),this._options.editor.snappingOptions=be.defaults(this._options.editor.snappingOptions,{position:{},rotation:{}}),this._options.editor.snappingOptions.position=be.defaults(this._options.editor.snappingOptions.position,{padding:{},threshold:20}),this._options.editor.snappingOptions.position.padding=be.defaults(this._options.editor.snappingOptions.position.padding,{left:.1,right:.1,top:.1,bottom:.1}),this._options.editor.snappingOptions.rotation=be.defaults(this._options.editor.snappingOptions.rotation,{angles:[0,45,90,135,180,225,270,315],threshold:20}),this._options.editor.controlsOptions.focus=be.defaults(this._options.editor.controlsOptions.focus,{highQualityCanvasBlur:!1}),this._options.editor.maxMegaPixels=be.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=be.defaults(this._options.editor.export||{},{format:"image/png",type:Br.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.editor.save=be.defaults(this._options.editor.save||{},{format:"text/json",download:!0,fileBasename:"photoeditorsdk-save"}),this._options.extensions=be.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=be.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null}),!(this._options.editor.image instanceof window.Image)){let e=new window.Image;this._options.editor.image&&(e.src=this._options.editor.image,this._options.editor.image=e)}}_initEvents(){this._mediator.pipeEvents(this)}_disposeEvents(){this._mediator.unpipeEvents(this)}setImage(e){this._editor.setImage(e)}getAssetPath(e,t=!1,i=!1){let{baseUrl:r,resolver:o}=this._options.assets,n=`${r}/${e}`;o=o||(c=>c),e.match(/(ftp|http|https):\/\//)&&(n=e);let a=e.replace(/assets\//,"").split("/"),l=a[0],u={};switch(l){case"art-filters":return u={identifier:a[1],type:a[2].split(".")[0]},o("art-filter",u);case"filters":return u={identifier:a[1].replace(/\.png$/g,"")},o("filter",u);case"fonts":return u={identifier:a[1].replace(/\.(woff|otf|ttf)$/g,"")},o("font",u);case"frames":return u={identifier:a[1],filename:a[2]},o("frame",u);case"overlays":return u={identifier:a[1].replace(/\.(png|jpg|jpeg)$/g,"")},o("overlay",u);case"stickers":{let c=a[3].endsWith(".svg"),p=a[3]==="thumbs";return u={category:a[1],identifier:(c?a[3]:a[4]).replace(/\.(png|svg)$/g,""),variant:c?"svg":p?"thumb":"base"},o("sticker",u)}case"text-design":return u={type:a[1]==="fonts"?"font":"image",identifier:a[2].replace(/\.(png|otf|ttf|woff2?)$/g,"")},o("text-design",u)}return typeof o!="undefined"&&o!==null&&(n=o(n)),n}getFontLoader(){return this._fontLoader}dispose(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._disposeEvents()}render(e){return this.deserialize(e).then(()=>this.export())}};er.prototype.identifier="engine-wrapper";er.Constants=Re;er.Events=Re.EVENTS;er.Utils=yt;er.JSONLoader=Gt;er.SDK=W;var Sp=class extends mo{constructor(e){super();this.config=e}getOutputDimensions(){let e=this.getOutputContainer();return e?e.getResolution():{width:0,height:0}}getSmallerOutputSide(){let e=this.getOutputContainer();if(!e)return 0;let t=e.getResolution();return Math.min(t.width,t.height)}convertPointFromPreviewIntoOutputSpace(e,t){let i=ie.getInverted(H.rectTransformToAffineTransform(t));return ie.transformPoint(i,e)}convertPointFromPreviewIntoWorldSpace(e,t,i){let r=ie.getInverted(H.rectTransformToAffineTransform(t)),o=i?this.getOutputContainer().getBaseLocalToParentMatrix():this.getOutputContainer().getLocalToParentMatrix(),n=ie.multiply(o,r);return ie.transformPoint(n,e)}convertPointFromPreviewIntoFlippedPreviewSpace(e){let t=this.getOutputContainer().getFlipTransformMatrix();return ie.transformPoint(t,e)}convertPointFromWorldIntoPreviewSpace(e,t){let i=H.rectTransformToAffineTransform(t),r=ie.getInverted(this.getOutputContainer().getLocalToParentMatrix()),o=ie.multiply(i,r);return ie.transformPoint(o,e)}convertPointFromOutputIntoPreviewSpace(e,t){let i=H.rectTransformToAffineTransform(t);return ie.transformPoint(i,e)}getContainersAtPreviewPoint(e,t){let i=new Array,r=this.convertPointFromPreviewIntoWorldSpace(e,t),o=this.getRootContainers();for(let n of o)this.accumulateContainersAtWorldPointInHierarchy(r,n,i);return i}isPreviewPointInContainer(e,t,i){let r=this.convertPointFromPreviewIntoWorldSpace(e,i);return this.isWorldPointInContainer(r,t)}isWorldPointInContainer(e,t){let i=H.getLocalToWorldMatrix(t),r=ie.getInverted(i),o=ie.transformPoint(r,e);return Ve.contains(t.getBounds(),o)}accumulateContainersAtWorldPointInHierarchy(e,t,i){this.isWorldPointInContainer(e,t)&&i.push(t);let r=t.getChildren();for(let o of r)ul(o)&&this.accumulateContainersAtWorldPointInHierarchy(e,o,i)}};var Xe=class{constructor(e){this.engine=e;this.id=Ya()}getID(){return this.id}getContainer(){return this.engine.getRootContainers()[0]}getIndexInParent(){let{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}isValid(){return this.getIndexInParent()!==-1}};var Op=class extends Xe{constructor(e,t,i){super(t);this.operation=i;this.type="adjustments";this.setProperties(e)}getProperties(){let e=this.operation.getOptions(),t=e.gamma-1;return{brightness:e.brightness||0,saturation:e.saturation||0,contrast:e.contrast||0,gamma:(t<0?2*t:t)||0,clarity:e.clarity||0,exposure:e.exposure||0,shadows:e.shadows*.5||0,highlights:e.highlights||0,whites:e.whites||0,blacks:e.blacks||0,temperature:e.temperature||0,sharpness:e.sharpness||0}}setProperties(e){e.gamma!==void 0&&(e.gamma=1+(e.gamma<0?.5*e.gamma:e.gamma)),e.shadows&&(e.shadows=e.shadows*2),this.operation.set(e)}getOperation(){return this.operation}getTypeIdentifier(){return"adjustments"}};var Et=s=>{if(Dg(s))return new W.Color(s.r,s.g,s.b,s.a);if(kg(s))return new W.Color(s[0],s[1],s[2],s[3]);if(wg(s))return new W.Color(s.r,s.g,s.b,1);if(Cg(s))return new W.Color(s[0],s[1],s[2],1);if(Tg(s)){let[e,t,i]=s.match(/[0-9A-fa-f]{1,2}/g);return new W.Color(parseInt(e,16)/255,parseInt(t,16)/255,parseInt(i,16)/255,1)}throw new Error("Invalid color type")};var fe=class{get x(){return this._x}get y(){return this._y}constructor(e=0,t=0){this._x=e,this._y=t}set(e,t){return this._x=e,this._y=t,this}clone(){return new fe(this._x,this._y)}copy(e){return this._x=e.x,this._y=e.y,this}clamped(e=this,t=this){let i=typeof e=="number"?{x:e,y:e}:e,r=typeof t=="number"?{x:t,y:t}:t;return this._x=Math.max(i.x,this._x),this._y=Math.max(i.y,this._y),this._x=Math.min(r.x,this._x),this._y=Math.min(r.y,this._y),this}divide(e,t){return typeof e=="number"||e===null?(this._x/=e,this._y/=typeof t=="undefined"?e:t):(this._x/=e.x,this._y/=e.y),this}subtract(e,t){return typeof e=="number"||e===null?(this._x-=e,this._y-=typeof t=="undefined"?e:t):(this._x-=e.x,this._y-=e.y),this}multiply(e,t){return typeof e=="number"||e===null?(this._x*=e,this._y*=typeof t=="undefined"?e:t):(this._x*=e.x,this._y*=e.y),this}add(e,t){return typeof e=="number"||e===null?(this._x+=e,this._y+=typeof t=="undefined"?e:t):(this._x+=e.x,this._y+=e.y),this}dot(e,t){return typeof e=="number"||e===null?this._x*e+this._y*(typeof t=="undefined"?e:t):this._x*e.x+this._y*e.y}equals(e,t){return typeof e=="number"||e===null?e===this._x&&t===this._y:e.x===this._x&&e.y===this._y}flip(){let e=this._x;return this._x=this._y,this._y=e,this}round(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this}ceil(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this}floor(){return this._x=this._x|0,this._y=this._y|0,this}abs(){return this._x=Math.abs(this._x),this._y=Math.abs(this._y),this}len(){return Math.sqrt(this._x*this._x+this._y*this._y)}min(){return Math.min(this._x,this._y)}max(){return Math.max(this._x,this._y)}toObject(){return{x:this._x,y:this._y}}toString(){return`Vector2({ x: ${this._x}, y: ${this._y} })`}roundDecimal(e){return this._x=parseFloat(this._x.toFixed(e)),this._y=parseFloat(this._y.toFixed(e)),this}asArray(e=!1){return e?[this._y,this._x]:[this._x,this._y]}static fromObject(e){return new fe(e.x,e.y)}static fromSize(e){return new fe(e.width,e.height)}static get NULL(){return new fe(0,0)}};var Lt=class{constructor(e){this.engine=e;this.id=Ya(),this.transform=je.IDENTITY,this.bounds=Ve.ZERO}getID(){return this.id}getParent(){let e=this.engine.getRootContainers();if(!(e.length===0||this.id===e[0].id))return e[0]}getIndexInParent(){let{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}getChildren(){let e=this.engine.getRootContainers();return e.length>0&&(this.id===e[0].id||this.id===this.engine.getOutputContainer().id)?this.engine.rootOperations:[]}getBounds(){return this.bounds}setPivotOnSelfAndSprite(e,t,i){typeof t=="number"?(this.setPivotInternal(t,i),e.setPivot(new fe(t,i))):(this.setPivotInternal(t),e.setPivot(fe.fromObject(t)))}setPivot(e,t){this.setPivotInternal(e,t)}getPivot(){let e=this.getBounds();return{x:-e.minX/e.width,y:-e.minY/e.height}}getTransform(){return this.transform}setTransform(e){this.transform=e}updateTransform(){this.setTransform(this.transform)}getPosition(){return this.transform.position}setPosition(e,t){let i;typeof e=="number"?i={x:e,y:t===void 0?e:t}:i=e;let{scale:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new je(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;typeof e!="number"?i=e:i={x:e,y:t===void 0?e:t};let{position:r,rotation:o}=this.transform;this.setTransform(new je(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){let{position:t,scale:i}=this.transform;this.setTransform(new je(t,i,e))}getSizeInWorldSpace(){return H.getSizeInWorldSpace(this)}getSizeInOutputSpace(){return H.getSizeInOutputSpace(this,this.engine.getOutputContainer())}setSizeInWorldSpace(e){let t=this.getBounds();this.setScale(e.width/t.width,e.height/t.height)}setSizeInOutputSpace(e){let t=this.engine.getOutputContainer().getScale();this.setSizeInWorldSpace({width:e.width/t.x,height:e.height/t.y})}isValid(){return this.getIndexInParent()!==-1}setPivotInternal(e,t){let i=this.getBounds();typeof e=="number"?this.setBoundsFromSize(i.width,i.height,{x:e,y:t}):this.setBoundsFromSize(i.width,i.height,e)}setBoundsFromSize(e,t,i=this.getPivot()){this.bounds=new Ve(-i.x*e,-i.y*t,e,t)}};var Ap=class extends Lt{constructor(e,t){super(t);this.type="drawing";this.drawing=e,this.operation=t.createSpriteOperation(),this.sprite=this.operation.createBrush({}),this.operation.addSprite(this.sprite),this.radialBrush=this.sprite._createRadialBrush();let r=t.getRootContainers()[0].getBounds();this.bounds=new Ve(0,0,r.width,r.height),this.setTransform(je.IDENTITY),this.operation.setDirty(!0),this.setData(e)}beginStroke(e){if(this.currentStroke)throw new Error("A brush stroke has already been started but not finished.");if(e.id!=="imgly_brush_radial")throw new Error("This adapter does not support any brush faces other than the radial img.ly brush.");this.currentBrush=e,this.currentStroke={brush:e,path:{controlPoints:[]}},this.radialBrush.setColor(Et(e.color)),this.radialBrush.setHardness(e.hardness),this.radialBrush.setSize(e.size),this.currentPath=this.sprite.createPath(this.radialBrush.clone())}addPointToCurrentStroke(e,t=!0){if(!this.currentStroke||!this.currentBrush||!this.currentPath)throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"');if(this.currentStroke.path.controlPoints.length){let l=this.currentStroke.path.controlPoints,u=l[l.length-1],c=this.currentBrush.size/10;if(Math.sqrt(e.x-u.x**2+(e.y-u.y**2))<c)return}let i=this.engine.getOutputContainer(),r=this.engine.getRootContainers()[0],o=H.pointFromSpaceToSpace(e,r,i,!0),n=H.absoluteToRelativePoint(o,i,!1),a=i.getBounds();this.currentPath.addControlPoint(fe.fromObject(n)),this.currentStroke.path.controlPoints.push(e),t&&this.sprite.render(fe.fromObject({x:a.width,y:a.height}))}endStroke(){if(!this.currentStroke||!this.currentPath||!this.currentBrush)return;this.currentStroke.path.controlPoints.length&&this.drawing.strokes.push(this.currentStroke),this.currentStroke=void 0,this.currentBrush=void 0,this.currentPath.setClosed(!0);let e=this.engine.getOutputContainer().getBounds();this.sprite.render(fe.fromObject({x:e.width,y:e.height})),this.currentPath=void 0}setData(e){this.drawing=D(D({},this.drawing),e),this.drawing.strokes&&(this.drawing.strokes=[]),this.sprite.clearPersistCanvas(),this.sprite.clearCanvas(),this.sprite.setPaths([]),this.drawStrokes(e.strokes)}getData(){return this.drawing}updateData(){this.setData(this.getData())}getOperation(){return this.operation}drawStrokes(e){e.forEach(t=>{this.beginStroke(t.brush),t.path.controlPoints.forEach(i=>{this.addPointToCurrentStroke(i,!0)}),this.endStroke()})}};var Ip=class extends Xe{constructor(e,t,i,r){super(r);this.filterOperation=t;this.type="duotone-filter";t.set({intensity:i.colorIntensity}),t.set({filter:e}),r.pesdk.setAllOperationsToDirty()}getProperties(){return{colorIntensity:this.filterOperation.getOptions().intensity}}setProperties(e){let i=this.filterOperation.getOptions().intensity;e.colorIntensity!==void 0&&(i=Math.min(Math.max(e.colorIntensity,0),1)),this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var Pp=class{constructor(e,t){this.engine=t;this.loaded=!1;this.loading=!1;this.asset=D({},e)}load(){return Ge(this,null,function*(){if(this.loaded)return Promise.resolve();if(this.loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this.loading=!0;let{imageGroups:e}=this.asset,t=[];return["top","left","right","bottom"].forEach(i=>{if(!e[i])return;let r=e[i];["start","mid","end"].forEach(o=>{o in r&&t.push(this.loadPart(i,o))})}),Promise.all(t).then(()=>{this.loaded=!0,this.loading=!1}).catch(()=>{this.loaded=!1,this.loading=!1})})}getFrame(){return N(D({},this.asset),{defaultName:this.asset.name,thumbnail:this.asset.thumbnailURI})}getIdentifier(){return this.asset.identifier}getDefaultName(){return this.asset.name}getThumbnail(){return this.asset.thumbnailURI}getTintable(){return this.asset.tintable||!1}getLayoutMode(){return this.asset.layoutMode}getImageGroups(){return this.asset.imageGroups}loadPart(e,t){return Ge(this,null,function*(){return new Promise((i,r)=>{let{imageGroups:o}=this.asset,n=o[e][t],a=n;typeof n!="string"&&"image"in n&&(a=n.image);let l=new Image;l.addEventListener("load",()=>{typeof n!="string"?this.asset.imageGroups[e][t].image=l:this.asset.imageGroups[e][t]=l,i(l)}),l.addEventListener("error",()=>{r(new Error(`Failed to load image at ${l.src}`))}),l.crossOrigin=this.engine.configuration.crossOrigin||"anonymus",l.src=this.engine.assetProvider.getAssetSource("frame",a)})})}};var Mp=class extends Xe{constructor(e,t,i){super(i);this.frameOperation=e;this.type="frame";this.setProperties(t),i.pesdk.setAllOperationsToDirty()}setProperties(e){if(this.props=D(D({},this.props),e),typeof e.opacity=="number"&&this.frameOperation.set({alpha:e.opacity}),e.tintColor&&this.frameOperation.set({tintColor:Et(e.tintColor)}),e.width){let t=this.engine.getOutputContainer().getBounds(),i=Math.min(t.width,t.height),r=e.width/i;this.frameOperation.set({scale:r})}this.frameOperation.setDirty(!0)}getProperties(){return this.props}getOperation(){return this.frameOperation}getTypeIdentifier(){return"frame"}};var Bp=class extends Xe{constructor(e,t,i){super(t);this.blurOperation=i;this.type="gaussian-blur";this.setProperties(e)}getProperties(){let e=this.engine.getOutputContainer(),t=e.getBounds(),i=Math.min(t.size.width,t.size.height);return{blurRadius:H.scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius*i,e,this.getContainer())}}setProperties(e){if(e.blurRadius!==void 0){let t=this.engine.pesdk.getOutputDimensions(),i=Math.min(t.x,t.y),r=this.getContainer(),o=this.engine.getOutputContainer(),a=H.scalarFromSpaceToSpace(e.blurRadius,r,o)/i;this.blurOperation.set({blurRadius:a})}}getOperation(){return this.blurOperation}getTypeIdentifier(){return"blur"}};var kc=class extends Lt{constructor(e,t){super(t);this.data=e;this.type="image";let i=t.configuration.downscaleOptions;if(!i)this.downscaleOptions={maxDimensions:{width:t.maxTextureDimension,height:t.maxTextureDimension}};else{let{maxDimensions:o}=i;this.downscaleOptions={maxMegaPixels:i.maxMegaPixels,maxDimensions:{width:Math.min(t.maxTextureDimension,o?o.width:Number.MAX_VALUE),height:Math.min(t.maxTextureDimension,o?o.height:Number.MAX_VALUE)}}}this.setData(e);let{image:r}=this.data;this.bounds=new Ve(le.ZERO,{width:r.width,height:r.height})}setData(e){if(this.data=D(D({},this.data),e),e.image){let{image:t}=e,i;if(t instanceof HTMLImageElement&&(i=this.engine.pesdk.parseExif(t),i)){let o=i.getTags();if(o&&o.Orientation){let n=o.Orientation!==1&&o.Orientation!==2,a=[2,4,5,7].indexOf(o.Orientation)!==-1;if(n||a){if(Xa()||qf()||!CSS.supports("image-orientation","from-image")){let l=this.engine.pesdk.createOperation("exif-orientation",{},!1);l.setTags(o),t=l.applyTo(t)}i.setOrientation(1),o.Orientation=1}}}let r=new Tn(t,this.downscaleOptions);r.on(Li.IMAGE_DOWNSCALED,({width:o,height:n})=>{this.engine.emit(An.IMAGE_DOWNSCALED,{width:o,height:n})}),r.on(Li.BEGAN_IMAGE_DOWNSCALING,()=>{this.engine.emit(An.BEGAN_IMAGE_DOWNSCALING)}),t=r.downscaleIfNecessary(),this.data.image=t,this.engine.pesdk.setImage(t,i),this.setBoundsFromSize(t.width,t.height)}}getData(){return this.data}setPivot(e,t){throw new Error("This container does not support modifying the pivot")}getOperation(){throw new Error("This container has no associated operation")}};var Lp=class extends Xe{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="linear-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=D(D({},this.props),e);let t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),n=i.getBaseLocalToParentMatrix(),a=H.getBaseLocalToWorldMatrix(o),l=ie.multiply(ie.getInverted(n),a),u=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){let c=H.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=c/u}if(e.start!==void 0){let c=ie.transformPoint(l,e.start),p=H.absoluteToRelativePoint(c,i,!1);t.controlPoint1=p}if(e.end!==void 0){let c=ie.transformPoint(l,e.end),p=H.absoluteToRelativePoint(c,i,!1);t.controlPoint2=p}this.blurOperation.set(t)}updateProperties(){let e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"linear-focus"}};var zp=class extends Xe{constructor(e,t,i,r){super(r);this.filter=e;this.filterOperation=t;this.props=i;this.type="lut-filter";t.set({intensity:i.intensity}),t.set({filter:e}),r.pesdk.setAllOperationsToDirty()}getProperties(){return{intensity:this.filterOperation.getOptions().intensity,lutImage:this.props.lutImage,horizontalTileCount:this.props.horizontalTileCount,verticalTileCount:this.props.verticalTileCount}}setProperties(e){let t=this.filterOperation.getOptions(),i=typeof e.intensity=="number"?e.intensity:t.intensity;this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var Np=class extends Xe{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="mirrored-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=D(D({},this.props),e);let t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),n=i.getBaseLocalToParentMatrix(),a=H.getBaseLocalToWorldMatrix(o),l=ie.multiply(ie.getInverted(n),a),u=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){let c=H.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=c/u}if(e.gradientSize!==void 0){let p=H.scalarFromSpaceToSpace(e.gradientSize,o,i)/u;t.gradientSize=p}if(e.clearAreaWidth!==void 0){let p=H.scalarFromSpaceToSpace(e.clearAreaWidth,o,i)/u;t.size=p*.5}if(e.mirrorAxisOrigin!==void 0){let c=ie.transformPoint(l,e.mirrorAxisOrigin),p=H.absoluteToRelativePoint(c,i,!1);t.start=p}if(e.mirrorAxisDirection!==void 0){let c=ie.transformPoint(l,e.mirrorAxisDirection),p=H.absoluteToRelativePoint(c,i,!1);t.end=p}this.blurOperation.set(t)}updateProperties(){let e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"mirrored-focus"}};var Tc=class extends Lt{constructor(e,t,i,r){super(r);this.settings=e;this.operation=t;this.flipOperation=i;this.type="output";this.flipTransform=ie.IDENTITY;this.blockTransformUpdate=!1;this.transformUpdateWhileBlock=!1;this.bounds=new Ve({x:0,y:0},this.settings.resolution),this.setData(e)}pauseChildrenUpdates(){this.transformUpdateWhileBlock=!1,this.blockTransformUpdate=!0}resumeChildrenUpdates(){this.blockTransformUpdate=!1,this.transformUpdateWhileBlock&&this.updateChildrenContainers()}setData(e){if(this.settings=D(D({},this.settings),e),e.resolution&&(this.setBoundsFromSize(e.resolution.width,e.resolution.height),this.setTransform(this.transform),this.operation.set({outputResolution:new fe(e.resolution.width,e.resolution.height)})),e.flipHorizontally!==void 0){let t=e.flipHorizontally;this.updateFlipTransform(),this.flipOperation.set({flipHorizontally:t})}if(e.flipVertically!==void 0){let t=e.flipVertically;this.updateFlipTransform(),this.flipOperation.set({flipVertically:t})}this.operation.setDirty(!0),this.flipOperation.setDirty(!0)}getData(){return this.settings}setResolution(e){this.setData({resolution:e})}getResolution(){return this.getData().resolution}setTransform(e){if(this.transform.rotation!==e.rotation||this.transform.position!==e.position||this.transform.scale!==e.scale){this.transform=e;let t=this.flipTransform;this.flipTransform=ie.IDENTITY;let i=this.engine.getRootContainers()[0],r=H.pointFromSpaceToSpace({x:0,y:0},i,this),o=-e.rotation,n=fe.fromObject(r).clone().subtract(fe.fromObject(this.getBounds().origin));this.operation.set({pivot:new fe(0,0),position:n,scale:new fe(1/e.scale.x,1/e.scale.y),rotation:o}),this.flipTransform=t,this.operation.setDirty(!0),this.updateChildrenContainers()}}rotate(e,t){let i=this.getPivot(),r=this.getBounds(),o={x:r.midX,y:r.midY},n=H.getPointInWorldSpace(o,this);this.setPivot(.5,.5),this.setPosition(n),this.setRotation(e),this.setResolution(t);let a={x:-t.width*(.5-i.x),y:-t.height*(.5-i.y)},l=H.getPointInWorldSpace(a,this);this.setPivot(i),this.setPosition(l),this.updateChildrenContainers()}setPivot(e,t){super.setPivotInternal(e,t),this.setTransform(this.transform)}getTransform(){return this.transform}getBaseLocalToParentMatrix(){return H.rectTransformToAffineTransform(this.getTransform())}getLocalToParentMatrix(){let e=H.rectTransformToAffineTransform(this.getTransform());return ie.multiply(e,this.flipTransform)}getFlipTransformMatrix(){return this.flipTransform}isValid(){return!0}getOperation(){return this.operation}updateFlipTransform(){let{flipHorizontally:e,flipVertically:t}=this.settings;if(!e&&!t)this.flipTransform=ie.IDENTITY;else{let i=this.getPivot(),r=this.getBounds(),o=e?-1:1,n=e?-2*(i.x-.5)*r.width:0,a=t?-1:1,l=t?-2*(i.y-.5)*r.height:0;this.flipTransform=new ie(o,0,0,a,n,l)}}updateChildrenContainers(){if(this.blockTransformUpdate){this.transformUpdateWhileBlock=!0;return}this.engine.rootOperations.forEach(e=>{ul(e)?(e.updateTransform(),"updateData"in e&&e.updateData()):"updateProperties"in e&&e.updateProperties()})}};var Rc=class extends Xe{constructor(e,t,i){super(i);this.overlayOperation=e;this.type="overlay";let r=t.blendMode||i.mapBlendMode(e.getBlendMode());e.set({blendMode:i.reverseMapBlendMode(r)}),e.set({image:t.image}),i.pesdk.setAllOperationsToDirty()}getProperties(){let e=this.overlayOperation.getOptions();return{image:e.image,blendMode:this.engine.mapBlendMode(e.blendMode),opacity:e.alpha}}setProperties(e){let t=this.overlayOperation.getOptions();typeof e.opacity=="number"&&(t.alpha=e.opacity),e.blendMode!==void 0&&(t.blendMode=this.engine.reverseMapBlendMode(e.blendMode)),this.overlayOperation.set(t),this.overlayOperation.setDirty(!0)}getOperation(){return this.overlayOperation}getTypeIdentifier(){return"overlay"}setFlipHorizontally(e){this.overlayOperation.setFlipHorizontally(e)}setFlipVertically(e){this.overlayOperation.setFlipVertically(e)}getFlipHorizontally(){return this.overlayOperation.getFlipHorizontally()}getFlipVertically(){return this.overlayOperation.getFlipVertically()}};var Up=class extends Xe{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="radial-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=D(D({},this.props),e);let t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),n=i.getBaseLocalToParentMatrix(),a=H.getBaseLocalToWorldMatrix(o),l=ie.multiply(ie.getInverted(n),a),u=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){let c=H.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=c/u}if(e.center!==void 0){let c=ie.transformPoint(l,e.center),p=H.absoluteToRelativePoint(c,i,!1);t.position=p}if(e.radius!==void 0){let p=H.scalarFromSpaceToSpace(e.radius,o,i)/u;t.radius=p}if(e.gradientSize!==void 0){let p=H.scalarFromSpaceToSpace(e.gradientSize,o,i)/u;t.gradientRadius=p}this.blurOperation.set(t)}updateProperties(){let e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"radial-focus"}};var Ec=class extends Lt{constructor(e,t){super(t);this.data=e;this.type="sticker";let i=e.image,r=this.engine.pesdk.parseExif(e.image);if(r){let n=r.getTags();if(n&&n.Orientation){let a=n.Orientation!==1&&n.Orientation!==2,l=[2,4,5,7].indexOf(n.Orientation)!==-1;if(a||l){let u=this.engine.pesdk.createOperation("exif-orientation",{},!1);u.setTags(n),i=u.applyTo(e.image),r.setOrientation(1),n.Orientation=1}}}i=new Tn(i,{maxMegaPixels:{desktop:10,mobile:5}}).downscaleImageIfNecessary(),this.operation=t.createSpriteOperation(),this.sprite=this.operation.createSticker({identifier:"",image:i,position:new fe(0,0),dimensions:new fe(1,1),rotation:0,smoothDownscaling:!1}),this.operation.addSprite(this.sprite),this.bounds=new Ve({x:0,y:0},{width:i.width,height:i.height}),this.setTransform(je.IDENTITY),this.sprite.setPivot(new fe(0,0)),this.operation.setDirty(!0),this.setData(e)}setData(e){this.data=D(D({},this.data),e),e.id&&(this.id=e.id),_g(e.opacity)&&e.opacity>=0&&this.sprite.setAlpha(e.opacity),e.tintColor&&this.sprite.setTintColor(Et(e.tintColor)),e.tintMode&&this.sprite.setTintMode(e.tintMode),this.operation.setDirty(!0)}getData(){return this.data}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);let t=this.engine.getOutputContainer(),i=this.getParent(),r={width:this.bounds.width*e.scale.x,height:this.bounds.height*e.scale.y},o=H.sizeFromSpaceToSpace(r,i,t);this.sprite.setDimensions(fe.fromSize(o));let n=H.pointFromSpaceToSpace(e.position,i,t,!0),a=H.absoluteToRelativePoint(n,t,!1);this.sprite.setPosition(new fe(a.x,a.y));let l=H.getRotationBetweenCoordinateSpaces(i,t),u=e.rotation+l;this.sprite.setRotation(u),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}};function xF(s,e){if(e){let t=1/e.unitsPerEm*s,i=e.ascender*t,r=e.descender*t;return i+Math.abs(r)}return s*1.1}var Fc=class{constructor(e){this.context=e;this.sourceLines=[];this.maxWidth=100}static buildWords(e){let t=[],i="",r=e.length;for(let o=0;o<r;o+=1){let n=e[o];i+=n,(n===" "||n==="-"||o===r-1)&&(t.push(i),i="")}return t}getLines(){let e=[],t=[],i=this.sourceLines.length;for(let r=0;r<i;r+=1){let o=this.sourceLines[r],n=Fc.buildWords(o),a=n.length;for(let l=0;l<a;l+=1){let u=n[l],c=t.concat(u).join("").replace(/\s+$/i,"");if(this.getWidth(c)>this.maxWidth){t.length>0&&(e.push(t.join("")),t=[u]);let m=u.replace(/\s+$/i,"");if(this.getWidth(m)>this.maxWidth){let d=this.splitWord(u);e=e.concat(d.lines),d.rest&&(t=[d.rest])}}else t.push(u)}e.push(t.join("")),t=[]}return e}splitWord(e){let t={lines:[],rest:null},i=e.length,r=[];for(let o=0;o<i;o+=1){let n=e[o];this.getWidth(r.concat(n).join(""))>this.maxWidth?(r.length>0&&t.lines.push(r.join("")),r=[n]):r.push(n),o===i-1&&r.length>0&&(t.rest=r.join(""))}return t}getWidth(e){return this.context.measureText(e).width}setText(e){this.sourceLines=e.split(`
`)}setMaxWidth(e){this.maxWidth=e}};function Sc(s,e,t,i,r,o,n){s.font=`${t.fontStyle||"normal"} ${t.fontWeight||"normal"} ${i}px "${t.fontFamily}"`;let a=new Fc(s);a.setText(e),a.setMaxWidth(o);let l=a.getLines().map(m=>m.replace(/\s+$/i,"")),u=xF(i,n),c=u*r,p=u/5;return{width:o+p*2,height:l.length*c+p*2}}var tr=class extends Lt{constructor(e,t){super(t);this.text=e;this.type="text";if(!tr.measureContext){let l=document.createElement("canvas");tr.measureContext=l.getContext("2d")}this.operation=t.createSpriteOperation();let i=this.engine.getOutputContainer(),r=this.getParent(),o=i.getBounds();this.sprite=this.operation.createText({text:e.text,position:new fe(0,0),rotation:0,fontSize:H.scalarFromSpaceToSpace(e.fontSize/o.height,r,i),lineHeight:e.lineHeight,fontIdentifier:e.fontIdentifier,alignment:e.alignment,color:Et(e.textColor),backgroundColor:Et(e.backgroundColor),maxWidth:H.scalarFromSpaceToSpace(e.width/o.width,r,i)});let n=t.assetProvider.getFontManager().getFontWithId(e.fontIdentifier);this.sprite.setFontFamily(n.fontFamily),this.sprite.setFontWeight(n.fontWeight||"normal"),this.sprite.setFontStyle(n.fontStyle||"normal"),this.sprite.setFontIdentifier(n.identifier),this.sprite.setTextMetrics(n.textMetrics),this.sprite.setPivot(new fe(0,0)),this.operation.addSprite(this.sprite);let a=Sc(tr.measureContext,e.text,n,e.fontSize,e.lineHeight,e.width,n.textMetrics);this.bounds=new Ve(0,0,a.width,a.height),this.setTransform(je.IDENTITY),this.operation.setDirty(!0)}setData(e){this.text=D(D({},this.text),e);let t=this.engine.assetProvider.getFontManager().getFontWithId(e.fontIdentifier||this.text.fontIdentifier);if(e.fontIdentifier&&(this.sprite.setFontFamily(t.fontFamily),this.sprite.setFontWeight(t.fontWeight||"normal"),this.sprite.setFontStyle(t.fontStyle||"normal"),this.sprite.setFontIdentifier(t.identifier),this.sprite.setTextMetrics(t.textMetrics)),e.id&&(this.id=e.id),e.text&&this.sprite.setText(e.text),e.fontSize){let r=this.engine.getOutputContainer(),o=this.getParent(),n=H.scalarFromSpaceToSpace(e.fontSize,o,r),a=r.getBounds();this.sprite.setFontSize(n/a.height)}if(e.alignment&&this.sprite.setAlignment(e.alignment),e.lineHeight&&this.sprite.setLineHeight(e.lineHeight),e.textColor&&this.sprite.setColor(Et(e.textColor)),e.backgroundColor&&this.sprite.setBackgroundColor(Et(e.backgroundColor)),e.width){let r=this.engine.getOutputContainer(),o=this.getParent(),n=H.scalarFromSpaceToSpace(e.width,o,r),a=r.getBounds();this.sprite.setMaxWidth(n/a.width)}let i=Sc(tr.measureContext,this.text.text,t,this.text.fontSize,this.text.lineHeight,this.text.width,t.textMetrics);this.setBoundsFromSize(i.width,i.height),this.operation.setDirty(!0)}getData(){return this.text}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);let t=this.engine.getOutputContainer(),i=this.getParent(),r=H.pointFromSpaceToSpace(e.position,i,t,!0),o=H.absoluteToRelativePoint(r,t,!1);this.sprite.setPosition(new fe(o.x,o.y));let n=H.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+n),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setRotation(this.getFlippedRotation({flipHorizontally:e})),this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setRotation(this.getFlippedRotation({flipVertically:e})),this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}getFlippedRotation({flipVertically:e,flipHorizontally:t}){let i=e||this.getFlipVertically(),r=t||this.getFlipHorizontally(),o=this.getRotation();return(i||r)&&(o=Cm(o)),o}};var Gp=1e3,Qs=class extends Lt{constructor(e,t,i){super(i);this.textDesign=e;this.layout=t;this.type="text-design";this.currentLayoutSize=void 0;this.layoutID=t.identifier,this.operation=i.createSpriteOperation();let r=this.engine.getOutputContainer(),o=this.getParent(),n=r.getBounds(),a=Math.min(n.width,n.height);t.seed(e.seed),this.bounds=this.calculateBounds(this.textDesign,this.layout);let l=e.width;this.sprite=this.operation.createTextDesign({text:e.text,layout:t,inverted:e.inverted,color:Et(e.color),width:H.scalarFromSpaceToSpace(e.width/a,o,r),padding:e.padding/l,seed:e.seed}),this.updatePivot(),this.operation.addSprite(this.sprite),this.setTransform(je.IDENTITY),this.operation.setDirty(!0)}static stringify(e){return JSON.stringify(e,Qs.serializer())}static serializer(){let e=[],t=[],i=(r,o)=>e[0]===o?"[Circular ~]":`[Circular ~.${t.slice(0,e.indexOf(o)).join(".")}]`;return function(o,n){let a=this;if(e.length>0){let l=e.indexOf(a);~l?(e.splice(l+1),t.splice(l,1/0,o)):(e.push(a),t.push(o)),~e.indexOf(n)&&(n=i.call(a,o,n))}else e.push(n);return n}}calculateBounds(e,t,i=!0){let r=e.inverted&&i?Math.max(0,2*e.padding):0,o=e.width/Gp;if(this.currentLayoutSize===void 0){t.seed(e.seed);let n=t.generateLayoutData(e.text,Gp);this.currentLayoutData=n,this.currentLayoutSize=n.getSize()}return new Ve(0,0,this.currentLayoutSize.width*o+r,this.currentLayoutSize.height*o+r)}findNextUniqueSeed(e,t,i){let r=i,o=this.currentLayoutData?Qs.stringify(this.currentLayoutData.getRows()):"",n;for(let a=0;a<20&&(t.seed(r),n=t.generateLayoutData(e.text,Gp),o===Qs.stringify(n.getRows()));a+=1)r+=1;return t.seed(r),this.currentLayoutData=n,r}setData(e){if(this.textDesign=D(D({},this.textDesign),e),e.id&&(this.id=e.id),e.padding!==void 0){let t=this.textDesign.width;this.sprite.setPadding(e.padding/t)}else e.width&&(this.textDesign.padding=this.sprite.getPadding()*this.textDesign.width);if(e.seed!==void 0&&(e.seed<0&&(e.seed=this.findNextUniqueSeed(this.textDesign,this.layout,Date.now()),this.textDesign.seed=e.seed),this.currentLayoutSize=void 0,this.layout.seed(e.seed),this.sprite.setSeed(e.seed),this.sprite.setLayout(this.layout)),e.color&&this.sprite.setColor(Et(e.color)),e.inverted!==void 0&&this.sprite.setInverted(e.inverted),e.text&&(this.currentLayoutSize=void 0,this.sprite.setText(e.text)),e.width){let t=this.engine.getOutputContainer(),i=this.getParent(),r=t.getBounds(),o=Math.min(r.width,r.height),n=H.scalarFromSpaceToSpace(e.width/o,i,t);this.sprite.setWidth(n)}if(e.padding!==void 0||e.seed!==void 0||e.inverted!==void 0||e.text||e.width){let t=this.calculateBounds(this.textDesign,this.layout);this.setBoundsFromSize(t.width,t.height),this.updatePivot()}this.operation.setDirty(!0)}getData(){return this.textDesign}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);let t=this.engine.getOutputContainer(),i=this.getParent();if(e.scale.x!==1||e.scale.y!==1)throw new Error("This engine doesn't support scaling TextDesign containers! You can change the bounds using the width property of the TextDesign data.");let r=H.pointFromSpaceToSpace(e.position,i,t,!0),o=H.absoluteToRelativePoint(r,t,!1);this.sprite.setPosition(new fe(o.x,o.y));let n=H.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+n),this.operation.setDirty(!0)}setPivot(e,t){typeof e=="number"?super.setPivot(e,t):super.setPivot(e),this.updatePivot()}getOperation(){return this.operation}getLayoutID(){return this.layoutID}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}updatePivot(){let e=this.textDesign.inverted?Math.max(0,this.textDesign.padding):0,t=new le(this.bounds.width-2*e,this.bounds.height-2*e),i=this.getPivot(),r=new le(i.x*this.bounds.width,i.y*this.bounds.height),o=new le(e,e),a=r.subtract(o).divide(t);this.sprite.setPivot(new fe(a.x,a.y))}};var{BLEND_MODES:Ye}=W.Operations.OverlayOperation,Oc="imgly_font_open_sans_bold",DC=class extends Sp{constructor(e){super(e);this.previews=Array();this.rootOperationStack=[];this.deferredRenderQueue=[];this.operationStackOffset=1;this.enforceOperationOrder=()=>{this.refreshFlipIndex(),this.refreshFrameIndex()};this.isSpriteTop=e=>this.rootOperationStack.findIndex(({id:i})=>e===i)+1===this.rootOperationStack.length;this.setWatermarkOpacity=e=>{let i=this.sdk.getOperationsStack().getByIdentifier("watermark");i&&i.set({alpha:e})};var i,r;this.assetProvider=e.assetProvider||new pm;let t;if(((i=e==null?void 0:e.watermark)==null?void 0:i.watermarkURI)&&typeof e.watermark.watermarkURI=="string"&&e.watermark.watermarkURI.slice(0,5)==="data:"?t=e.watermark.watermarkURI:((r=e==null?void 0:e.watermark)==null?void 0:r.watermarkURI)&&typeof e.watermark.watermarkURI=="string"&&e.watermark.watermarkURI.trim()&&(t=Fn(e.watermark.watermarkURI)?e.watermark.watermarkURI:this.assetProvider.getPath(e.watermark.watermarkURI)),this.wrapper=new er({license:e.license,crossOrigin:e.crossOrigin,assets:{resolver:(o,n)=>this.resolveAssetForSDK(o,n)},editor:{preferredRenderer:e.preferredRenderer,pixelRatio:1},watermark:N(D({},Df(e.watermark)),{watermarkURI:t})}),this.editor=this.wrapper.getEditor(),this.sdk=this.editor.getSDK(),this.sdk.setRenderMode("adapter"),this.tempCanvas=document.createElement("canvas"),this.sdk.setCanvas(this.tempCanvas),e.preferredRenderer==="webgl"){let o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl");this.maxTextureDimension=n.getParameter(n.MAX_TEXTURE_SIZE)}else this.maxTextureDimension=1/0}get configuration(){return this.config}get pesdk(){return this.sdk}get rootOperations(){return this.rootOperationStack}dispose(){this.pesdk.dispose(),this.wrapper.dispose()}render(e){return new Promise(t=>{let i=()=>new Promise(r=>{let{canvas:o}=e,n=e.getTransform(),a=this.outputContainer.getPivot(),l=e.getCanvasBounds(),u=e.quality,{tempCanvas:c}=this;this.sdk.setTextureQuality(u);let p=this.sdk.getOutputDimensions();return c.width=p.x,c.height=p.y,this.sdk.getRenderer().resizeTo(new fe(c.width,c.height)),this.sdk.render(!0).then(()=>{let m=o.getContext("2d");m.clearRect(0,0,o.width,o.height),m.save(),m.translate(-l.minX,-l.minY),m.translate(n.position.x,n.position.y),m.rotate(n.rotation),m.scale(n.scale.x,n.scale.y),m.translate(-a.x*c.width,-a.y*c.height),m.scale(1/e.quality,1/e.quality),m.drawImage(c,0,0),m.restore(),t(),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?(this.sdk.setAllOperationsToDirty(),Promise.resolve(this.deferredRenderQueue[0]().then(r))):r()})});this.deferredRenderQueue.push(i),this.deferredRenderQueue.length===1&&i()})}createPreview(e){let t=new wm(e,this);return this.previews.push(t),t}export(){return Ge(this,arguments,function*(e=Pi.IMAGE,t=jr.PNG,i=1){return new Promise(r=>{let o=()=>new Promise(n=>this.sdk.export(this.mapToRenderType(e),this.mapToImageFormat(t),i).then(a=>{r(a),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?Promise.resolve(this.deferredRenderQueue[0]().then(n)):n()}));this.deferredRenderQueue.push(o),this.deferredRenderQueue.length===1&&o()})})}getRootContainers(){return[this.rootContainer]}getOutputContainer(){return this.outputContainer}findContainerByID(e){return e===this.rootContainer.getID()?this.rootContainer:this.rootOperationStack.find(t=>t.getID()===e)}findEffectByID(e){return this.rootOperationStack.find(t=>t.getID()===e)}addImage(e,t,i){if(this.rootContainer)throw new Error("A background image already exists - did you mean to use addSticker?");let r=new kc(e,this);if(this.rootContainer=r,!this.outputContainer){let{width:o,height:n}=r.getBounds(),a={resolution:{width:o,height:n},flipHorizontally:!1,flipVertically:!1},l=this.sdk.createOperation("output",{},!1),u=this.sdk.createOperation("flip",{},!1);this.insertIntoOperationsStack(l,this.operationStackOffset-1),this.insertIntoOperationsStack(u,this.operationStackOffset),this.outputContainer=new Tc(a,l,u,this)}return r}addSticker(e,t,i){if(!t)throw new Error("This engine does not support adding stickers as root elements.");this.ensureContainerIsRoot(t);let r=new Ec(e,this);return this.addToStackAtIndex(r,i),r}addStickerFromAssets(e,t,i){if(!t)throw new Error("This engine does not support adding stickers as root elements.");return this.ensureContainerIsRoot(t),new Promise((r,o)=>{let n=new Image;n.onload=()=>{let a={image:n,opacity:1},l=new Ec(a,this);this.addToStackAtIndex(l,i),r(l)},n.onerror=a=>{o(a)},n.crossOrigin=this.config.crossOrigin||null,n.src=this.assetProvider.getAssetSource("sticker",e)})}addText(e,t,i){if(!t)throw new Error("This engine does not support adding text as root elements.");if(!this.assetProvider.getFontManager().isFontLoaded(e.fontIdentifier||Oc))throw new Error("Adding text synchronously only works if the required font is already loded! Consider using the asynchronous addTextWithFontLoading function instead!");this.ensureContainerIsRoot(t);let o=D({text:"",fontIdentifier:Oc,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),n=new tr(o,this);return this.addToStackAtIndex(n,i),n}addTextWithFontLoading(e,t,i){if(!t)throw new Error("This engine does not support adding text as root elements.");let r=this.assetProvider.getFontManager(),o=e.fontIdentifier||Oc;return new Promise((n,a)=>{r.loadFontWithIdentifier(o).then(()=>{this.ensureContainerIsRoot(t);let l=D({text:"",fontIdentifier:Oc,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),u=new tr(l,this);this.addToStackAtIndex(u,i),n(u)}).catch(a)})}addTextDesignAsync(e="imgly_text_design_blocks",t,i,r){return Ge(this,null,function*(){if(!i)throw new Error("This engine does not support adding TextDesign as a root element.");let o=D({seed:Date.now(),padding:0,text:"",color:[0,0,0],inverted:!1,width:100},t),n=this.wrapper.getTextDesignLayoutByID(e);if(!n)throw new Error(`The layout could not be loaded for the given id: ${e}`);let a=n.getImagePaths().map(d=>{let f=d.split("/").pop()||"";return{path:d,fullPath:this.assetProvider.getAssetSource("textdesign",f)}}),l=this.wrapper.getTextDesignAssetManager(),c=this.wrapper.getTextDesignFontManager().getVariationsByIdentifier();l.setFonts(c),yield l.loadImages(a),n.onImagesLoaded();let p=Object.keys(c);return this.assetProvider.getFontManager().loadFontsWithIdentifiers(p).then(()=>{this.ensureContainerIsRoot(i);let d=new Qs(o,n,this);return this.addToStackAtIndex(d,r),Promise.resolve(d)})})}addDrawing(e,t,i){if(!t)throw new Error("This engine does not support DrawingContainers as root elements.");this.ensureContainerIsRoot(t);let r=new Ap(e,this);return this.addToStackAtIndex(r,i),r}addGaussianBlur(e,t,i){this.ensureContainerIsRoot(t);let r=new Bp(e,this,this.sdk.createOperation("blur",{},!1));return this.addToStackAtIndex(r,i),r}addRadialBlur(e,t,i){this.ensureContainerIsRoot(t);let r=new Up(e,this,this.sdk.createOperation("radial-focus",{},!1));return this.addToStackAtIndex(r,i),r}addMirroredBlur(e,t,i){this.ensureContainerIsRoot(t);let r=new Np(e,this,this.sdk.createOperation("mirrored-focus",{},!1));return this.addToStackAtIndex(r,i),r}addLinearBlur(e,t,i){this.ensureContainerIsRoot(t);let r=new Lp(e,this,this.sdk.createOperation("linear-focus",{},!1));return this.addToStackAtIndex(r,i),r}addDuoToneFilter(e,t,i){throw new Error("Not supported! Use addDuoToneFilterFromAssets instead")}addDuoToneFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);let o=this.sdk.getOperationsStack().getByIdentifier("filter");o&&o.getIdentifier()!==e&&this.sdk.removeOperation(o);let n=o||this.sdk.createOperation("filter",{identifier:e},!1);return new Promise((a,l)=>{try{let u=this.assetProvider.getDuotoneFilterAsset(e),c={colorIntensity:u.defaultIntensity||0},p=new W.Operations.FilterOperation.Filters.DuoToneFilter({intensity:c.colorIntensity,lightColor:W.Color.fromHex(u.lightColor),darkColor:W.Color.fromHex(u.darkColor)}),m=new Ip(p,n,c,this);this.addToStackAtIndex(m,i),a(m)}catch(u){u&&l(u)}})}addLUTFilter(e,t,i){throw new Error("Not supported! Use addLUTFilterFromAssets instead")}addLUTFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);let o=this.sdk.getOperationsStack().getByIdentifier("filter");o&&o.getIdentifier()!==e&&this.sdk.removeOperation(o);let n=o||this.sdk.createOperation("filter",{identifier:e},!1);return this.getLutFilterImage(e).then(a=>{let l=this.assetProvider.getLUTFilterAsset(e),u={horizontalTileCount:l.horizontalTileCount||5,verticalTileCount:l.verticalTileCount||5,intensity:l.defaultIntensity||1},c=new W.Operations.FilterOperation.Filters.ThreeDLUTFilter(N(D({},u),{image:a})),p=N(D({},u),{lutImage:new Image}),m=new zp(c,n,p,this);return this.addToStackAtIndex(m,i),m})}getLutFilterImage(e){return new Promise((t,i)=>{mm({src:this.assetProvider.getAssetSource("filter",e),crossOrigin:this.config.crossOrigin||null,key:"filter",resolve:t,reject:i})})}addAdjustments(e,t,i){this.ensureContainerIsRoot(t);let r=new Op(e,this,this.sdk.createOperation("adjustments",{},!1));return this.addToStackAtIndex(r,i),r}addOverlay(e,t,i){this.ensureContainerIsRoot(t);let r=new Rc(this.sdk.createOperation("overlay",{},!1),e,this);return this.addToStackAtIndex(r,i),r}addOverlayFromAssets(e,t,i){return this.ensureContainerIsRoot(t),new Promise((r,o)=>{mm({src:this.assetProvider.getAssetSource("overlay",e),crossOrigin:this.config.crossOrigin||null,key:"overlay",resolve:n=>{let a=this.sdk.getOperationsStack(),l=a.getByIdentifier("overlay");l&&l.getIdentifier()!==e&&a.remove(l);let u=l||this.sdk.createOperation("overlay",{},!1),c={image:n,opacity:1,blendMode:oe.NORMAL},p=new Rc(u,c,this);this.addToStackAtIndex(p,i),r(p)},reject:o})})}addFrame(e,t,i){throw new Error("Not supported!")}addFrameFromAssets(e,t,i){return Ge(this,null,function*(){this.ensureContainerIsRoot(t);let r=this.assetProvider.getFrameAsset(e);if(!r)throw new Error(`The requested asset does not exist! ${e}`);let o=new Pp(r,this);yield o.load();let n=this.getOutputContainer().getBounds(),a=Math.min(n.width,n.height),l=this.sdk.createOperation("frame",{},!1);l.setFrame(o.getFrame());let u={opacity:1,tintColor:[1,1,1],tintable:!1,width:Math.max(1,.1*a),imageGroups:o.getFrame().imageGroups},c=new Mp(l,u,this);return this.addToStackAtIndex(c,i),Promise.resolve(c)})}removeEffect(e){if(!e.isValid())return;let i=e.getOperation();this.sdk.removeOperation(i),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}removeContainer(e){if(!e.isValid()||e.type==="output")return;let i=e.getOperation();this.sdk.removeOperation(i),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}refreshOutputIndex(){let e=this.sdk.getOperationsStack().getIndexByIdentifier("output");this.moveInOperationsStack(e,this.operationStackOffset-1)}refreshFlipIndex(){let e=this.sdk.getOperationsStack().getIndexByIdentifier("flip"),t=this.sdk.getOperationsStack().getStack().length-1;e!==t&&this.moveInOperationsStack(e,t)}refreshFrameIndex(){let e=this.sdk.getOperationsStack().getIndexByIdentifier("frame"),t=this.sdk.getOperationsStack().getStack().length-1;e!==-1&&e!==t&&this.moveInOperationsStack(e,t)}mapToRenderType(e){switch(e){case Pi.IMAGE:return W.RenderType.IMAGE;case Pi.DATA_URL:return W.RenderType.DATAURL;case Pi.BLOB:return W.RenderType.BLOB;case Pi.MSBLOB:return W.RenderType.MSBLOB;default:return W.RenderType.IMAGE}}mapToImageFormat(e){switch(e){case jr.PNG:return W.ImageFormat.PNG;case jr.JPEG:return W.ImageFormat.JPEG;default:return null}}mapBlendMode(e){switch(e){case Ye.NORMAL:return oe.NORMAL;case Ye.OVERLAY:return oe.OVERLAY;case Ye.HARD_LIGHT:return oe.HARD_LIGHT;case Ye.SOFT_LIGHT:return oe.SOFT_LIGHT;case Ye.MULTIPLY:return oe.MULTIPLY;case Ye.DARKEN:return oe.DARKEN;case Ye.LIGHTEN:return oe.LIGHTEN;case Ye.SCREEN:return oe.SCREEN;case Ye.COLOR_BURN:return oe.COLOR_BURN;default:return oe.NORMAL}}reverseMapBlendMode(e){switch(e){case oe.NORMAL:return Ye.NORMAL;case oe.OVERLAY:return Ye.OVERLAY;case oe.HARD_LIGHT:return Ye.HARD_LIGHT;case oe.SOFT_LIGHT:return Ye.SOFT_LIGHT;case oe.MULTIPLY:return Ye.MULTIPLY;case oe.DARKEN:return Ye.DARKEN;case oe.LIGHTEN:return Ye.LIGHTEN;case oe.SCREEN:return Ye.SCREEN;case oe.COLOR_BURN:return Ye.COLOR_BURN;default:return Ye.NORMAL}}createSpriteOperation(){return this.sdk.createOperation("sprite",{},!1)}moveIndex(e,t){let i=this.getSiblingIndex(e);if(i===-1)throw new Error("The item to be moved is not part of any stack.");this.moveInStack(this.rootOperationStack,i,t);let r=this.operationStackOffset;this.moveInOperationsStack(i+r,t+r),this.enforceOperationOrder()}ensureContainerIsRoot(e){if(e.getID()!==this.rootContainer.getID())throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container")}addToStackAtIndex(e,t){if(t&&t<0)throw new Error(`The given index may not be negative: ${t}`);t===void 0?this.rootOperationStack.push(e):this.rootOperationStack.splice(t,0,e);let i=this.rootOperationStack.length-1,r=t!==void 0?t:i;r+=this.operationStackOffset,Rg(e)?this.insertIntoOperationsStack(e.getOperation(),r):this.insertIntoOperationsStack(e.getOperation(),r),this.sdk.setAllOperationsToDirty()}insertIntoOperationsStack(e,t){let i=this.sdk.getOperationsStack().getStack(),r=i.length,o=Math.max(Math.min(t,r),0);for(let n=r-1;n>=o;n-=1){let a=i[n];i[n+1]=a}i[o]=e,this.sdk.setAllOperationsToDirty(),this.enforceOperationOrder()}moveInStack(e,t,i){let r=e.length,o=Math.max(Math.min(t,r-1),0),n=Math.max(Math.min(i,r-1),0);if(o===n)return;let a=e[o];if(o<n)for(let l=o+1;l<=n;l+=1)e[l-1]=e[l];else for(let l=o-1;l>=n;l-=1)e[l+1]=e[l];e[n]=a}moveInOperationsStack(e,t){let i=this.sdk.getOperationsStack().getStack(),r=i.length,o=Math.min(Math.max(0,e),r-1),n=Math.min(Math.max(0,t),r-1);if(o===n)return;let a=i[o];if(o<n)for(let l=o+1;l<=n;l+=1)i[l-1]=i[l];else for(let l=o-1;l>=n;l-=1)i[l+1]=i[l];i[n]=a,this.sdk.getOperationsStack().setAllToDirty()}getSiblingIndex(e){return e.getIndexInParent()}resolveAssetForSDK(e,t){switch(t=t,e){case"filter":return this.assetProvider.getAssetSource("filter",t.identifier);case"overlay":return this.assetProvider.getAssetSource("overlay",t.identifier);case"font":return this.assetProvider.getAssetSource("font",t.identifier)}return""}};var kC=class{constructor(e){this.isEmpty=!1;this.isValid=!1;this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel();this.areCustomAssetsAllowed=()=>this.isEmpty||!this.isValid||this.licenseChecker.areCustomAssetsAllowed();e&&e.length!==0?(this.licenseChecker=new W.LicenseChecker(e),this.isValid=this.licenseChecker.validate()):e===""&&(this.isEmpty=!0)}isToolAllowed(e){return this.licenseChecker&&this.isValid&&e!==We.CUSTOM?this.licenseChecker.isToolAllowed(e):!0}};export{D as a,N as b,vF as c,De as d,Ur as e,wF as f,Ge as g,Zp as h,et as i,eD as j,Hc as k,gn as l,kF as m,qc as n,gD as o,xf as p,TF as q,RF as r,kD as s,Df as t,XD as u,qf as v,Xa as w,ZA as x,QA as y,eI as z,tI as A,rP as B,Fn as C,nP as D,FF as E,SF as F,Je as G,We as H,ci as I,Pf as J,Mf as K,YD as L,im as M,JD as N,zf as O,$D as P,Pi as Q,jr as R,Nf as S,ZD as T,nt as U,HF as V,co as W,QD as X,ek as Y,Hr as Z,rm as _,tk as $,Uf as aa,Gf as ba,U as ca,mi as da,qr as ea,sm as fa,ik as ga,Kr as ha,Mi as ia,vn as ja,rk as ka,om as la,nm as ma,am as na,Xr as oa,sk as pa,dr as qa,qa as ra,ok as sa,oe as ta,He as ua,Yr as va,Ka as wa,nk as xa,zt as ya,Jr as za,ak as Aa,Wf as Ba,Vf as Ca,hr as Da,wn as Ea,lk as Fa,$r as Ga,uk as Ha,Zr as Ia,Cn as Ja,ck as Ka,jf as La,Hf as Ma,mo as Na,ho as Oa,Yf as Pa,Ya as Qa,uI as Ra,le as Sa,TI as Ta,RI as Ua,nI as Va,OI as Wa,AI as Xa,xk as Ya,PI as Za,MI as _a,ol as $a,pm as ab,_g as bb,nl as cb,Nk as db,Nt as eb,ym as fb,wM as gb,CM as hb,DM as ib,kM as jb,je as kb,W as lb,H as mb,wg as nb,Cg as ob,Dg as pb,kg as qb,An as rb,Cm as sb,WB as tb,Sc as ub,DC as vb,kC as wb};
/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */
/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
